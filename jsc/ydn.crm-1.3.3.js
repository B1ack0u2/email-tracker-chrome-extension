(function(){var h,aa=aa||{},r=this;function t(a){return void 0!==a}function ba(a){a=a.split(".");for(var b=r,c;c=a.shift();)if(null!=b[c])b=b[c];else return null;return b}function ca(){}function da(a){a.B=function(){return a.jh?a.jh:a.jh=new a}}
function ea(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function u(a){return"array"==ea(a)}function fa(a){var b=ea(a);return"array"==b||"object"==b&&"number"==typeof a.length}function v(a){return"string"==typeof a}function ga(a){return"boolean"==typeof a}function ha(a){return"number"==typeof a}function ia(a){return"function"==ea(a)}function x(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}function ja(a){return a[ka]||(a[ka]=++la)}
var ka="closure_uid_"+(1E9*Math.random()>>>0),la=0;function ma(a,b,c){return a.call.apply(a.bind,arguments)}function na(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function oa(a,b,c){oa=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ma:na;return oa.apply(null,arguments)}function pa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}}var z=Date.now||function(){return+new Date};
function qa(a,b){var c=a.split("."),d=r;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&t(b)?d[e]=b:d[e]?d=d[e]:d=d[e]={}}function A(a,b){function c(){}c.prototype=b.prototype;a.f=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.ak=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};function ra(a){a.prototype.then=a.prototype.then;a.prototype.$goog_Thenable=!0}function sa(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(b){return!1}};function ta(a){if(Error.captureStackTrace)Error.captureStackTrace(this,ta);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}A(ta,Error);ta.prototype.name="CustomError";var ua;function va(a,b){return 0==a.lastIndexOf(b,0)}function wa(a,b){var c=a.length-b.length;return 0<=c&&a.indexOf(b,c)==c}function xa(a,b){for(var c=a.split("%s"),d="",e=Array.prototype.slice.call(arguments,1);e.length&&1<c.length;)d+=c.shift()+e.shift();return d+c.join("%s")}function ya(a){return/^[\s\xa0]*$/.test(a)}function za(a){return a.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")}
var Aa=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};function Ba(a,b){return a.replace(/(\r\n|\r|\n)/g,b?"<br />":"<br>")}
function Ca(a){if(!Da.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Ea,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Fa,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Ga,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Ha,"&quot;"));-1!=a.indexOf("'")&&(a=a.replace(Ia,"&#39;"));-1!=a.indexOf("\x00")&&(a=a.replace(Ja,"&#0;"));return a}var Ea=/&/g,Fa=/</g,Ga=/>/g,Ha=/"/g,Ia=/'/g,Ja=/\x00/g,Da=/[\x00&<>"']/;
function Ka(a,b){var c={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"'},d;d=b?b.createElement("div"):r.document.createElement("div");return a.replace(La,function(a,b){var g=c[a];if(g)return g;if("#"==b.charAt(0)){var k=Number("0"+b.substr(1));isNaN(k)||(g=String.fromCharCode(k))}g||(d.innerHTML=a+" ",g=d.firstChild.nodeValue.slice(0,-1));return c[a]=g})}var La=/&([^;\s<&]+);?/g;function Ma(a){return Ba(a.replace(/  /g," &#160;"),void 0)}
function Na(a,b){for(var c=b.length,d=0;d<c;d++){var e=1==c?b:b.charAt(d);if(a.charAt(0)==e&&a.charAt(a.length-1)==e)return a.substring(1,a.length-1)}return a}var Oa={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"},Pa={"'":"\\'"};
function Qa(a){a=String(a);if(a.quote)return a.quote();for(var b=['"'],c=0;c<a.length;c++){var d=a.charAt(c),e=d.charCodeAt(0),f=c+1,g;if(!(g=Oa[d])){if(!(31<e&&127>e))if(d in Pa)d=Pa[d];else if(d in Oa)d=Pa[d]=Oa[d];else{e=d;g=d.charCodeAt(0);if(31<g&&127>g)e=d;else{if(256>g){if(e="\\x",16>g||256<g)e+="0"}else e="\\u",4096>g&&(e+="0");e+=g.toString(16).toUpperCase()}d=Pa[d]=e}g=d}b[f]=g}b.push('"');return b.join("")}function Ra(a,b){return-1!=a.indexOf(b)}
function Sa(a,b){for(var c=0,d=Aa(String(a)).split("."),e=Aa(String(b)).split("."),f=Math.max(d.length,e.length),g=0;0==c&&g<f;g++){var k=d[g]||"",l=e[g]||"",m=RegExp("(\\d*)(\\D*)","g"),n=RegExp("(\\d*)(\\D*)","g");do{var p=m.exec(k)||["","",""],q=n.exec(l)||["","",""];if(0==p[0].length&&0==q[0].length)break;c=Ta(0==p[1].length?0:parseInt(p[1],10),0==q[1].length?0:parseInt(q[1],10))||Ta(0==p[2].length,0==q[2].length)||Ta(p[2],q[2])}while(0==c)}return c}function Ta(a,b){return a<b?-1:a>b?1:0}
function Va(a){return String(a).replace(/\-([a-z])/g,function(a,c){return c.toUpperCase()})}function Wa(a){var b=v(void 0)?"undefined".replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08"):"\\s";return a.replace(new RegExp("(^"+(b?"|["+b+"]+":"")+")([a-z])","g"),function(a,b,e){return b+e.toUpperCase()})};function Xa(a,b){b.unshift(a);ta.call(this,xa.apply(null,b));b.shift()}A(Xa,ta);Xa.prototype.name="AssertionError";function Ya(a,b){throw new Xa("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1));};var Za=Array.prototype,$a=Za.indexOf?function(a,b,c){return Za.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(v(a))return v(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},ab=Za.lastIndexOf?function(a,b,c){return Za.lastIndexOf.call(a,b,null==c?a.length-1:c)}:function(a,b,c){c=null==c?a.length-1:c;0>c&&(c=Math.max(0,a.length+c));if(v(a))return v(b)&&1==b.length?a.lastIndexOf(b,c):-1;for(;0<=c;c--)if(c in a&&a[c]===b)return c;
return-1},bb=Za.forEach?function(a,b,c){Za.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=v(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},cb=Za.filter?function(a,b,c){return Za.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=0,g=v(a)?a.split(""):a,k=0;k<d;k++)if(k in g){var l=g[k];b.call(c,l,k,a)&&(e[f++]=l)}return e},db=Za.map?function(a,b,c){return Za.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=v(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=
b.call(c,f[g],g,a));return e},eb=Za.some?function(a,b,c){return Za.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=v(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1},fb=Za.every?function(a,b,c){return Za.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=v(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return!1;return!0};function gb(a,b){var c=0;bb(a,function(a,e,f){b.call(void 0,a,e,f)&&++c},void 0);return c}
function hb(a,b){var c=ib(a,b,void 0);return 0>c?null:v(a)?a.charAt(c):a[c]}function ib(a,b,c){for(var d=a.length,e=v(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1}function jb(a,b){return 0<=$a(a,b)}function kb(a){if(!u(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function lb(a,b){var c=$a(a,b),d;(d=0<=c)&&Za.splice.call(a,c,1);return d}function mb(a){return Za.concat.apply(Za,arguments)}
function nb(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function ob(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c],e;if(u(d)||(e=fa(d))&&Object.prototype.hasOwnProperty.call(d,"callee"))a.push.apply(a,d);else if(e)for(var f=a.length,g=d.length,k=0;k<g;k++)a[f+k]=d[k];else a.push(d)}}function pb(a,b,c,d){Za.splice.apply(a,qb(arguments,1))}function qb(a,b,c){return 2>=arguments.length?Za.slice.call(a,b):Za.slice.call(a,b,c)}
function rb(a,b,c){for(var d=0,e=a.length,f;d<e;){var g=d+e>>1,k;k=b(c,a[g]);0<k?d=g+1:(e=g,f=!k)}return f?d:~d}function sb(a,b){if(!fa(a)||!fa(b)||a.length!=b.length)return!1;for(var c=a.length,d=tb,e=0;e<c;e++)if(!d(a[e],b[e]))return!1;return!0}function ub(a,b){return a>b?1:a<b?-1:0}function tb(a,b){return a===b}function vb(a,b){var c=rb(a,wb||ub,b);0>c&&pb(a,-(c+1),0,b)};var xb;a:{var yb=r.navigator;if(yb){var zb=yb.userAgent;if(zb){xb=zb;break a}}xb=""};function Ab(a,b){for(var c in a)b.call(void 0,a[c],c,a)}function Bb(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function Cb(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}function Db(a,b){for(var c=fa(b),d=c?b:arguments,c=c?0:1;c<d.length&&(a=a[d[c]],t(a));c++);return a}function Eb(a,b){return b in a?a[b]:void 0}function Fb(a){var b={},c;for(c in a)b[c]=a[c];return b}var Gb="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
function Hb(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Gb.length;f++)c=Gb[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}}function Ib(a){var b=arguments.length;if(1==b&&u(arguments[0]))return Ib.apply(null,arguments[0]);if(b%2)throw Error("Uneven number of arguments");for(var c={},d=0;d<b;d+=2)c[arguments[d]]=arguments[d+1];return c}
function Jb(a){var b=arguments.length;if(1==b&&u(arguments[0]))return Jb.apply(null,arguments[0]);for(var c={},d=0;d<b;d++)c[arguments[d]]=!0;return c};function Kb(a){r.setTimeout(function(){throw a;},0)}var Lb;
function Mb(){var a=r.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&(a=function(){var a=document.createElement("iframe");a.style.display="none";a.src="";document.documentElement.appendChild(a);var b=a.contentWindow,a=b.document;a.open();a.write("");a.close();var c="callImmediate"+Math.random(),d="file:"==b.location.protocol?"*":b.location.protocol+"//"+b.location.host,a=oa(function(a){if(a.origin==d||a.data==c)this.port1.onmessage()},
this);b.addEventListener("message",a,!1);this.port1={};this.port2={postMessage:function(){b.postMessage(c,d)}}});if("undefined"!==typeof a&&!Ra(xb,"Trident")&&!Ra(xb,"MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){c=c.next;var a=c.Kg;c.Kg=null;a()};return function(a){d.next={Kg:a};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("script")?function(a){var b=document.createElement("script");b.onreadystatechange=function(){b.onreadystatechange=
null;b.parentNode.removeChild(b);b=null;a();a=null};document.documentElement.appendChild(b)}:function(a){r.setTimeout(a,0)}};function Nb(a,b){Ob||Pb();Qb||(Ob(),Qb=!0);Rb.push(new Sb(a,b))}var Ob;function Pb(){if(r.Promise&&r.Promise.resolve){var a=r.Promise.resolve();Ob=function(){a.then(Tb)}}else Ob=function(){var a=Tb;!ia(r.setImmediate)||r.di&&r.di.prototype.setImmediate==r.setImmediate?(Lb||(Lb=Mb()),Lb(a)):r.setImmediate(a)}}var Qb=!1,Rb=[];[].push(function(){Qb=!1;Rb=[]});function Tb(){for(;Rb.length;){var a=Rb;Rb=[];for(var b=0;b<a.length;b++){var c=a[b];try{c.a.call(c.b)}catch(d){Kb(d)}}}Qb=!1}
function Sb(a,b){this.a=a;this.b=b};function Ub(a,b){this.b=Vb;this.h=void 0;this.a=this.c=null;this.d=this.e=!1;try{var c=this;a.call(b,function(a){Wb(c,Xb,a)},function(a){if(!(a instanceof Yb))try{if(a instanceof Error)throw a;throw Error("Promise rejected.");}catch(b){}Wb(c,Zb,a)})}catch(d){Wb(this,Zb,d)}}var Vb=0,Xb=2,Zb=3;Ub.prototype.then=function(a,b,c){return $b(this,ia(a)?a:null,ia(b)?b:null,c)};ra(Ub);function ac(a){a.b==Vb&&Nb(function(){var a=new Yb(void 0);bc(this,a)},a)}
function bc(a,b){if(a.b==Vb)if(a.c){var c=a.c;if(c.a){for(var d=0,e=-1,f=0,g;g=c.a[f];f++)if(g=g.Pd)if(d++,g==a&&(e=f),0<=e&&1<d)break;0<=e&&(c.b==Vb&&1==d?bc(c,b):(d=c.a.splice(e,1)[0],cc(c,d,Zb,b)))}}else Wb(a,Zb,b)}function dc(a,b){a.a&&a.a.length||a.b!=Xb&&a.b!=Zb||ec(a);a.a||(a.a=[]);a.a.push(b)}
function $b(a,b,c,d){var e={Pd:null,qh:null,uh:null};e.Pd=new Ub(function(a,g){e.qh=b?function(c){try{var e=b.call(d,c);a(e)}catch(m){g(m)}}:a;e.uh=c?function(b){try{var e=c.call(d,b);!t(e)&&b instanceof Yb?g(b):a(e)}catch(m){g(m)}}:g});e.Pd.c=a;dc(a,e);return e.Pd}Ub.prototype.i=function(a){this.b=Vb;Wb(this,Xb,a)};Ub.prototype.t=function(a){this.b=Vb;Wb(this,Zb,a)};
function Wb(a,b,c){if(a.b==Vb){if(a==c)b=Zb,c=new TypeError("Promise cannot resolve to itself");else{if(sa(c)){a.b=1;c.then(a.i,a.t,a);return}if(x(c))try{var d=c.then;if(ia(d)){fc(a,c,d);return}}catch(e){b=Zb,c=e}}a.h=c;a.b=b;ec(a);b!=Zb||c instanceof Yb||gc(a,c)}}function fc(a,b,c){function d(b){f||(f=!0,a.t(b))}function e(b){f||(f=!0,a.i(b))}a.b=1;var f=!1;try{c.call(b,e,d)}catch(g){d(g)}}function ec(a){a.e||(a.e=!0,Nb(a.l,a))}
Ub.prototype.l=function(){for(;this.a&&this.a.length;){var a=this.a;this.a=[];for(var b=0;b<a.length;b++)cc(this,a[b],this.b,this.h)}this.e=!1};function cc(a,b,c,d){if(c==Xb)b.qh(d);else{for(;a&&a.d;a=a.c)a.d=!1;b.uh(d)}}function gc(a,b){a.d=!0;Nb(function(){a.d&&hc.call(null,b)})}var hc=Kb;function Yb(a){ta.call(this,a)}A(Yb,ta);Yb.prototype.name="cancel";/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/
function B(a,b){this.t=[];this.ja=a;this.F=b||null;this.e=this.b=!1;this.d=void 0;this.G=this.T=this.l=!1;this.i=0;this.c=null;this.C=0}function ic(a,b){if(a.b)a.d instanceof B&&ic(a.d);else{if(a.c){var c=a.c;delete a.c;b?ic(c,b):(c.C--,0>=c.C&&ic(c))}a.ja?a.ja.call(a.F,a):a.G=!0;a.b||a.p(new jc)}}h=B.prototype;h.Sd=function(a,b){this.l=!1;kc(this,a,b)};function kc(a,b,c){a.b=!0;a.d=c;a.e=!b;a.mf()}function lc(a){if(a.b){if(!a.G)throw new mc;a.G=!1}}h.callback=function(a){lc(this);kc(this,!0,a)};
h.p=function(a){lc(this);kc(this,!1,a)};h.n=function(a,b){return this.m(a,null,b)};h.Hc=function(a,b){return this.m(null,a,b)};h.V=function(a,b){return this.m(a,a,b)};h.m=function(a,b,c){this.t.push([a,b,c]);this.b&&this.mf();return this};h.then=function(a,b,c){var d,e,f=new Ub(function(a,b){d=a;e=b});this.m(d,function(a){a instanceof jc?ac(f):e(a)});return f.then(a,b,c)};ra(B);function nc(a,b){a.m(b.callback,b.p,b)}function oc(a){return eb(a.t,function(a){return ia(a[1])})}
B.prototype.mf=function(){this.i&&this.b&&oc(this)&&(pc(this.i),this.i=0);this.c&&(this.c.C--,delete this.c);for(var a=this.d,b=!1,c=!1;this.t.length&&!this.l;){var d=this.t.shift(),e=d[0],f=d[1],d=d[2];if(e=this.e?f:e)try{var g=e.call(d||this.F,a);t(g)&&(this.e=this.e&&(g==a||g instanceof Error),this.d=a=g);sa(a)&&(this.l=c=!0)}catch(k){a=k,this.e=!0,oc(this)||(b=!0)}}this.d=a;c&&(c=oa(this.Sd,this,!0),g=oa(this.Sd,this,!1),a instanceof B?(a.m(c,g),a.T=!0):a.then(c,g));b&&(a=new qc(a),rc[a.fe]=a,
this.i=a.fe)};function sc(a){var b=new B;b.callback(a);return b}function C(a){var b=new B;b.p(a);return b}function mc(){ta.call(this)}A(mc,ta);mc.prototype.message="Deferred has already fired";mc.prototype.name="AlreadyCalledError";function jc(){ta.call(this)}A(jc,ta);jc.prototype.message="Deferred was canceled";jc.prototype.name="CanceledError";function qc(a){this.fe=r.setTimeout(oa(this.b,this),0);this.a=a}qc.prototype.b=function(){delete rc[this.fe];throw this.a;};var rc={};
function pc(a){var b=rc[a];b&&(r.clearTimeout(b.fe),delete rc[a])};function tc(){0!=uc&&(vc[ja(this)]=this);this.t=this.t;this.Q=this.Q}var uc=0,vc={};tc.prototype.t=!1;tc.prototype.S=function(){if(!this.t&&(this.t=!0,this.u(),0!=uc)){var a=ja(this);delete vc[a]}};tc.prototype.u=function(){if(this.Q)for(;this.Q.length;)this.Q.shift()()};function wc(a){a&&"function"==typeof a.S&&a.S()};var xc,yc;function zc(){return r.navigator||null}var Ac=Ra(xb,"Opera")||Ra(xb,"OPR"),D=Ra(xb,"Trident")||Ra(xb,"MSIE"),Bc=Ra(xb,"Gecko")&&!Ra(xb.toLowerCase(),"webkit")&&!(Ra(xb,"Trident")||Ra(xb,"MSIE")),Cc=Ra(xb.toLowerCase(),"webkit");Cc&&Ra(xb,"Mobile");var Dc,Ec=zc();Dc=Ec&&Ec.platform||"";xc=Ra(Dc,"Mac");Ra(Dc,"Win");Ra(Dc,"Linux");yc=!!zc()&&Ra(zc().appVersion||"","X11");var Fc=xb;Fc&&Ra(Fc,"Android");Fc&&Ra(Fc,"iPhone");Fc&&Ra(Fc,"iPad");
function Gc(){var a=r.document;return a?a.documentMode:void 0}var Hc=function(){var a="",b;if(Ac&&r.opera)return a=r.opera.version,ia(a)?a():a;Bc?b=/rv\:([^\);]+)(\)|;)/:D?b=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:Cc&&(b=/WebKit\/(\S+)/);b&&(a=(a=b.exec(xb))?a[1]:"");return D&&(b=Gc(),b>parseFloat(a))?String(b):a}(),Ic={};function Jc(a){return Ic[a]||(Ic[a]=0<=Sa(Hc,a))}var Kc=r.document,Lc=Kc&&D?Gc()||("CSS1Compat"==Kc.compatMode?parseInt(Hc,10):5):void 0;var Mc=!D||D&&9<=Lc,Nc=!D||D&&9<=Lc,Oc=D&&!Jc("9");!Cc||Jc("528");Bc&&Jc("1.9b")||D&&Jc("8")||Ac&&Jc("9.5")||Cc&&Jc("528");Bc&&!Jc("8")||D&&Jc("9");function E(a,b){this.type=a;this.b=this.target=b;this.h=this.d=!1;this.zh=!0}E.prototype.S=function(){};E.prototype.stopPropagation=function(){this.d=!0};E.prototype.preventDefault=function(){this.h=!0;this.zh=!1};function Pc(a){Pc[" "](a);return a}Pc[" "]=ca;function Qc(a,b){E.call(this,a?a.type:"");this.e=this.b=this.target=null;this.a=this.clientY=this.clientX=0;this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.state=null;this.i=!1;this.c=null;a&&this.init(a,b)}A(Qc,E);var Rc=[1,4,2];
Qc.prototype.init=function(a,b){var c=this.type=a.type;this.target=a.target||a.srcElement;this.b=b;var d=a.relatedTarget;if(d){if(Bc){var e;a:{try{Pc(d.nodeName);e=!0;break a}catch(f){}e=!1}e||(d=null)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.e=d;this.clientX=void 0!==a.clientX?a.clientX:a.pageX;this.clientY=void 0!==a.clientY?a.clientY:a.pageY;this.a=a.keyCode||0;this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.i=xc?a.metaKey:
a.ctrlKey;this.state=a.state;this.c=a;a.defaultPrevented&&this.preventDefault()};function Sc(a){return(Mc?0==a.c.button:"click"==a.type?!0:!!(a.c.button&Rc[0]))&&!(Cc&&xc&&a.ctrlKey)}Qc.prototype.stopPropagation=function(){Qc.f.stopPropagation.call(this);this.c.stopPropagation?this.c.stopPropagation():this.c.cancelBubble=!0};
Qc.prototype.preventDefault=function(){Qc.f.preventDefault.call(this);var a=this.c;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Oc)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var Tc="closure_listenable_"+(1E6*Math.random()|0);function Uc(a){return!(!a||!a[Tc])}var Vc=0;function Wc(a,b,c,d,e){this.wc=a;this.proxy=null;this.src=b;this.type=c;this.Od=!!d;this.P=e;this.key=++Vc;this.removed=this.Nd=!1}function Xc(a){a.removed=!0;a.wc=null;a.proxy=null;a.src=null;a.P=null};function Yc(a){this.src=a;this.a={};this.b=0}Yc.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.a[f];a||(a=this.a[f]=[],this.b++);var g=Zc(a,b,d,e);-1<g?(b=a[g],c||(b.Nd=!1)):(b=new Wc(b,this.src,f,!!d,e),b.Nd=c,a.push(b));return b};Yc.prototype.remove=function(a,b,c,d){a=a.toString();if(!(a in this.a))return!1;var e=this.a[a];b=Zc(e,b,c,d);return-1<b?(Xc(e[b]),Za.splice.call(e,b,1),0==e.length&&(delete this.a[a],this.b--),!0):!1};
function $c(a,b){var c=b.type;if(!(c in a.a))return!1;var d=lb(a.a[c],b);d&&(Xc(b),0==a.a[c].length&&(delete a.a[c],a.b--));return d}Yc.prototype.removeAll=function(a){a=a&&a.toString();var b=0,c;for(c in this.a)if(!a||c==a){for(var d=this.a[c],e=0;e<d.length;e++)++b,Xc(d[e]);delete this.a[c];this.b--}return b};function ad(a,b,c,d,e){a=a.a[b.toString()];b=-1;a&&(b=Zc(a,c,d,e));return-1<b?a[b]:null}
function Zc(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.removed&&f.wc==b&&f.Od==!!c&&f.P==d)return e}return-1};var bd="closure_lm_"+(1E6*Math.random()|0),cd={},dd=0;function ed(a,b,c,d,e){if(u(b)){for(var f=0;f<b.length;f++)ed(a,b[f],c,d,e);return null}c=fd(c);return Uc(a)?a.listen(b,c,d,e):gd(a,b,c,!1,d,e)}function gd(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=!!e,k=hd(a);k||(a[bd]=k=new Yc(a));c=k.add(b,c,d,e,f);if(c.proxy)return c;d=id();c.proxy=d;d.src=a;d.wc=c;a.addEventListener?a.addEventListener(b.toString(),d,g):a.attachEvent(jd(b.toString()),d);dd++;return c}
function id(){var a=ld,b=Nc?function(c){return a.call(b.src,b.wc,c)}:function(c){c=a.call(b.src,b.wc,c);if(!c)return c};return b}function md(a,b,c,d,e){if(u(b)){for(var f=0;f<b.length;f++)md(a,b[f],c,d,e);return null}c=fd(c);return Uc(a)?a.vb.add(String(b),c,!0,d,e):gd(a,b,c,!0,d,e)}function nd(a,b,c,d,e){if(u(b))for(var f=0;f<b.length;f++)nd(a,b[f],c,d,e);else c=fd(c),Uc(a)?a.X(b,c,d,e):a&&(a=hd(a))&&(b=ad(a,b,c,!!d,e))&&od(b)}
function od(a){if(ha(a)||!a||a.removed)return!1;var b=a.src;if(Uc(b))return $c(b.vb,a);var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.Od):b.detachEvent&&b.detachEvent(jd(c),d);dd--;(c=hd(b))?($c(c,a),0==c.b&&(c.src=null,b[bd]=null)):Xc(a);return!0}function jd(a){return a in cd?cd[a]:cd[a]="on"+a}function pd(a,b,c,d){var e=1;if(a=hd(a))if(b=a.a[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.Od==c&&!f.removed&&(e&=!1!==qd(f,d))}return Boolean(e)}
function qd(a,b){var c=a.wc,d=a.P||a.src;a.Nd&&od(a);return c.call(d,b)}
function ld(a,b){if(a.removed)return!0;if(!Nc){var c=b||ba("window.event"),d=new Qc(c,this),e=!0;if(!(0>c.keyCode||void 0!=c.returnValue)){a:{var f=!1;if(0==c.keyCode)try{c.keyCode=-1;break a}catch(g){f=!0}if(f||void 0==c.returnValue)c.returnValue=!0}c=[];for(f=d.b;f;f=f.parentNode)c.push(f);for(var f=a.type,k=c.length-1;!d.d&&0<=k;k--)d.b=c[k],e&=pd(c[k],f,!0,d);for(k=0;!d.d&&k<c.length;k++)d.b=c[k],e&=pd(c[k],f,!1,d)}return e}return qd(a,new Qc(b,this))}
function hd(a){a=a[bd];return a instanceof Yc?a:null}var rd="__closure_events_fn_"+(1E9*Math.random()>>>0);function fd(a){if(ia(a))return a;a[rd]||(a[rd]=function(b){return a.handleEvent(b)});return a[rd]};function F(){tc.call(this);this.vb=new Yc(this);this.vg=this;this.gb=null}A(F,tc);F.prototype[Tc]=!0;h=F.prototype;h.Oc=function(){return this.gb};h.Ce=function(a){this.gb=a};h.addEventListener=function(a,b,c,d){ed(this,a,b,c,d)};h.removeEventListener=function(a,b,c,d){nd(this,a,b,c,d)};
h.dispatchEvent=function(a){var b,c=this.Oc();if(c)for(b=[];c;c=c.Oc())b.push(c);var c=this.vg,d=a.type||a;if(v(a))a=new E(a,c);else if(a instanceof E)a.target=a.target||c;else{var e=a;a=new E(d,c);Hb(a,e)}var e=!0,f;if(b)for(var g=b.length-1;!a.d&&0<=g;g--)f=a.b=b[g],e=sd(f,d,!0,a)&&e;a.d||(f=a.b=c,e=sd(f,d,!0,a)&&e,a.d||(e=sd(f,d,!1,a)&&e));if(b)for(g=0;!a.d&&g<b.length;g++)f=a.b=b[g],e=sd(f,d,!1,a)&&e;return e};h.u=function(){F.f.u.call(this);this.vb&&this.vb.removeAll(void 0);this.gb=null};
h.listen=function(a,b,c,d){return this.vb.add(String(a),b,!1,c,d)};h.X=function(a,b,c,d){return this.vb.remove(String(a),b,c,d)};function sd(a,b,c,d){b=a.vb.a[String(b)];if(!b)return!0;b=b.concat();for(var e=!0,f=0;f<b.length;++f){var g=b[f];if(g&&!g.removed&&g.Od==c){var k=g.wc,l=g.P||g.src;g.Nd&&$c(a.vb,g);e=!1!==k.call(l,d)&&e}}return e&&0!=d.zh};function td(a,b,c){this.c=a;this.b=b;this.a=c;this.id=this.b+(this.a?"-"+this.a:"")}td.prototype.send=function(a,b){var c=new ud(a),d=this.a;c.h=this.b;c.i=d;b&&(c.b=b);var d=c.d,e=this.c,f=c.toJSON();vd(e).postMessage(f);e.a.push(c);50<e.a.length&&(e.a.length-=1);return d};function wd(a){E.call(this,a.req||"event");this.c=a}A(wd,E);wd.prototype.getMessage=function(){return this.c};wd.prototype.getData=function(){return this.c.data};function I(a){ta.call(this,a);this.name="ydn.error.ArgumentException"}A(I,ta);function xd(a){ta.call(this,a);this.name="ydn.error.NotSupportedException"}A(xd,ta);function yd(a){ta.call(this,a);this.name="ydn.error.NotImplementedException"}A(yd,ta);function zd(a){ta.call(this,a);this.name="ydn.error.InvalidOperationException"}A(zd,ta);
function Ad(a){Error.captureStackTrace?Error.captureStackTrace(this,Ad):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}A(Ad,Error);Ad.prototype.name="ydn.error.InternalError";function Bd(a){if("function"==typeof a.xa)return a.xa();if(v(a))return a.split("");if(fa(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return Bb(a)}
function Cd(a,b){if("function"==typeof a.forEach)a.forEach(b,void 0);else if(fa(a)||v(a))bb(a,b,void 0);else{var c;if("function"==typeof a.Ca)c=a.Ca();else if("function"!=typeof a.xa)if(fa(a)||v(a)){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else c=Cb(a);else c=void 0;for(var d=Bd(a),e=d.length,f=0;f<e;f++)b.call(void 0,d[f],c&&c[f],a)}};var Dd="StopIteration"in r?r.StopIteration:Error("StopIteration");function Ed(){}Ed.prototype.next=function(){throw Dd;};Ed.prototype.Lb=function(){return this};function Fd(a){if(a instanceof Ed)return a;if("function"==typeof a.Lb)return a.Lb(!1);if(fa(a)){var b=0,c=new Ed;c.next=function(){for(;;){if(b>=a.length)throw Dd;if(b in a)return a[b++];b++}};return c}throw Error("Not implemented");}
function Gd(a,b){if(fa(a))try{bb(a,b,void 0)}catch(c){if(c!==Dd)throw c;}else{a=Fd(a);try{for(;;)b.call(void 0,a.next(),void 0,a)}catch(d){if(d!==Dd)throw d;}}}function Hd(a){if(fa(a))return nb(a);a=Fd(a);var b=[];Gd(a,function(a){b.push(a)});return b}function Id(a){try{return Fd(a).next()}catch(b){if(b!=Dd)throw b;return null}};function Jd(a,b){this.b={};this.a=[];this.d=this.c=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){a instanceof Jd?(c=a.Ca(),d=a.xa()):(c=Cb(a),d=Bb(a));for(var e=0;e<c.length;e++)this.set(c[e],d[e])}}h=Jd.prototype;h.da=function(){return this.c};h.xa=function(){Kd(this);for(var a=[],b=0;b<this.a.length;b++)a.push(this.b[this.a[b]]);return a};h.Ca=function(){Kd(this);return this.a.concat()};
h.Ma=function(){return 0==this.c};h.clear=function(){this.b={};this.d=this.c=this.a.length=0};h.remove=function(a){return Ld(this.b,a)?(delete this.b[a],this.c--,this.d++,this.a.length>2*this.c&&Kd(this),!0):!1};function Kd(a){if(a.c!=a.a.length){for(var b=0,c=0;b<a.a.length;){var d=a.a[b];Ld(a.b,d)&&(a.a[c++]=d);b++}a.a.length=c}if(a.c!=a.a.length){for(var e={},c=b=0;b<a.a.length;)d=a.a[b],Ld(e,d)||(a.a[c++]=d,e[d]=1),b++;a.a.length=c}}h.get=function(a,b){return Ld(this.b,a)?this.b[a]:b};
h.set=function(a,b){Ld(this.b,a)||(this.c++,this.a.push(a),this.d++);this.b[a]=b};h.forEach=function(a,b){for(var c=this.Ca(),d=0;d<c.length;d++){var e=c[d],f=this.get(e);a.call(b,f,e,this)}};h.clone=function(){return new Jd(this)};h.Lb=function(a){Kd(this);var b=0,c=this.a,d=this.b,e=this.d,f=this,g=new Ed;g.next=function(){for(;;){if(e!=f.d)throw Error("The map has changed since the iterator was created");if(b>=c.length)throw Dd;var g=c[b++];return a?g:d[g]}};return g};
function Ld(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Md(a){this.a=new Jd;if(a){a=Bd(a);for(var b=a.length,c=0;c<b;c++)this.add(a[c])}}function Nd(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+ja(a):b.substr(0,1)+a}h=Md.prototype;h.da=function(){return this.a.da()};h.add=function(a){this.a.set(Nd(a),a)};h.removeAll=function(a){a=Bd(a);for(var b=a.length,c=0;c<b;c++)this.remove(a[c])};h.remove=function(a){return this.a.remove(Nd(a))};h.clear=function(){this.a.clear()};h.Ma=function(){return this.a.Ma()};
h.contains=function(a){a=Nd(a);return Ld(this.a.b,a)};h.xa=function(){return this.a.xa()};h.clone=function(){return new Md(this)};h.Lb=function(){return this.a.Lb(!1)};function Od(a){var b;b||(b=Pd(a||arguments.callee.caller,[]));return b}
function Pd(a,b){var c=[];if(jb(b,a))c.push("[...circular reference...]");else if(a&&50>b.length){c.push(Qd(a)+"(");for(var d=a.arguments,e=0;d&&e<d.length;e++){0<e&&c.push(", ");var f;f=d[e];switch(typeof f){case "object":f=f?"object":"null";break;case "string":break;case "number":f=String(f);break;case "boolean":f=f?"true":"false";break;case "function":f=(f=Qd(f))?f:"[fn]";break;default:f=typeof f}40<f.length&&(f=f.substr(0,40)+"...");c.push(f)}b.push(a);c.push(")\n");try{c.push(Pd(a.caller,b))}catch(g){c.push("[exception trying to get caller]\n")}}else a?
c.push("[...long stack...]"):c.push("[end]");return c.join("")}function Qd(a){if(Sd[a])return Sd[a];a=String(a);if(!Sd[a]){var b=/function ([^\(]+)/.exec(a);Sd[a]=b?b[1]:"[Anonymous]"}return Sd[a]}var Sd={};function Td(a,b,c,d,e){this.h="number"==typeof e?e:Ud++;this.e=d||z();this.d=a;this.i=b;this.b=c;delete this.c;delete this.a}Td.prototype.h=0;Td.prototype.c=null;Td.prototype.a=null;var Ud=0;Td.prototype.getMessage=function(){return this.i};function Vd(a){this.e=a;this.a=this.d=this.b=this.c=null}function Wd(a,b){this.name=a;this.value=b}Wd.prototype.toString=function(){return this.name};var Xd=new Wd("SHOUT",1200),Yd=new Wd("SEVERE",1E3),Zd=new Wd("WARNING",900),$d=new Wd("INFO",800),ae=new Wd("CONFIG",700),be=new Wd("FINE",500),ce=new Wd("FINER",400),de=new Wd("FINEST",300),ee=[new Wd("OFF",Infinity),Xd,Yd,Zd,$d,ae,be,ce,de,new Wd("ALL",0)],fe=null;h=Vd.prototype;h.getName=function(){return this.e};
function ge(a,b){a.a||(a.a=[]);a.a.push(b)}h.getChildren=function(){this.d||(this.d={});return this.d};function he(a){if(a.b)return a.b;if(a.c)return he(a.c);Ya("Root logger has no level set.");return null}
h.log=function(a,b,c){if(a.value>=he(this).value)for(ia(b)&&(b=b()),a=this.Xg(a,b,c,Vd.prototype.log),b="log:"+a.getMessage(),r.console&&(r.console.timeStamp?r.console.timeStamp(b):r.console.markTimeline&&r.console.markTimeline(b)),r.msWriteProfilerMark&&r.msWriteProfilerMark(b),b=this;b;){c=b;var d=a;if(c.a)for(var e=0,f=void 0;f=c.a[e];e++)f(d);b=b.c}};
h.Xg=function(a,b,c,d){a=new Td(a,String(b),this.e);if(c){a.c=c;var e;d=d||Vd.prototype.Xg;try{var f;var g=ba("window.location.href");if(v(c))f={message:c,name:"Unknown error",lineNumber:"Not available",fileName:g,stack:"Not available"};else{var k,l;b=!1;try{k=c.lineNumber||c.ek||"Not available"}catch(m){k="Not available",b=!0}try{l=c.fileName||c.filename||c.sourceURL||r.$googDebugFname||g}catch(n){l="Not available",b=!0}f=!b&&c.lineNumber&&c.fileName&&c.stack&&c.message&&c.name?c:{message:c.message||
"Not available",name:c.name||"UnknownError",lineNumber:k,fileName:l,stack:c.stack||"Not available"}}e="Message: "+Ca(f.message)+'\nUrl: <a href="view-source:'+f.fileName+'" target="_new">'+f.fileName+"</a>\nLine: "+f.lineNumber+"\n\nBrowser stack:\n"+Ca(f.stack+"-> ")+"[end]\n\nJS stack traversal:\n"+Ca(Od(d)+"-> ")}catch(p){e="Exception trying to expose exception! You win, we lose. "+p}a.a=e}return a};function ie(a,b,c){a.log(Zd,b,c)}h.info=function(a,b){this.log($d,a,b)};
h.config=function(a,b){this.log(ae,a,b)};function je(a,b,c){a.log(be,b,c)}function K(a,b){a.log(ce,b,void 0)}function ke(a,b){a.log(de,b,void 0)}var le={},me=null;function ne(){me||(me=new Vd(""),le[""]=me,me.b=ae)}function oe(){ne();return me}function L(a){ne();var b;if(!(b=le[a])){b=new Vd(a);var c=a.lastIndexOf("."),d=a.substr(c+1),c=L(a.substr(0,c));c.getChildren()[d]=b;b.c=c;le[a]=b}return b};function pe(a,b,c){a&&a.log(b,c,void 0)}function qe(a,b){a&&a.log(Yd,b,void 0)}function M(a,b,c){a&&ie(a,b,c)}function re(a,b){a&&je(a,b,void 0)};function O(a,b){a&&a.log(de,b,void 0)}function Q(a,b){a&&a.log(ce,b,void 0)};function se(a,b){B.call(this,a,b);this.h=[]}A(se,B);function te(a,b,c){a.h.push([b,c])}function ue(a,b){for(var c=0;c<a.h.length;c++)a.h[c][0].call(a.h[c][1],b)}se.prototype.callback=function(a){this.h.length=0;se.f.callback.call(this,a)};se.prototype.p=function(a){this.h.length=0;se.f.p.call(this,a)};function ud(a){this.id="i"+this.count();this.req=a;this.c=!0;this.a=this.b=null;this.d=new se;this.e=NaN}ud.prototype.s=function(){return this.id};var ve=0;h=ud.prototype;h.count=function(){ve++;return ve};
h.listen=function(a){if(a&&a.id==this.id){this.b=a.data;var b=a.error;b&&(b instanceof Error?this.a=b:x(b)?(this.a=Error(b.message),this.a.name=b.name,this.a.source=b,this.a.result=this.b):(this.a=Error(b),this.a.name="UnknownError"));a.done?(this.c=!1,this.a?this.d.p(this.a):this.d.callback(this.b),window.clearTimeout(this.e)):ue(this.d,a.data);return!0}return!1};h.toString=function(){return"Message:"+this.id+(this.c?"*":"")};h.getData=function(){return this.b};h.getError=function(){return this.a};
h.toJSON=function(){var a=this;this.e=window.setTimeout(function(){if(a.c){var b=Error("message timeout");b.name="TimeOutError";a.listen({id:a.id,req:a.req,error:b})}},1E4);return{id:this.id,req:this.req,group:this.h,name:this.i,data:this.b}};function we(a){F.call(this);var b=v(a)?null:a;this.name=v(a)?a:a.name;this.a=[];this.h=b;this.b=null;this.d={}}A(we,F);we.prototype.u=function(){if(this.b){var a=this;this.b.disconnect(function(){a.b=null;a.a.length=0})}else this.a.length=0};
we.prototype.e=function(a){if(a)if(a.id)for(var b=this.a.length-1;0<=b;b--){if(this.a[b].s()==a.id){if(this.a[b].listen(a)){this.a[b].c?25<b&&(a=this.a.splice(b,1),this.a.unshift(a[0])):this.a.splice(b,1);break}break}}else"info"==a.req?(a.data=this.h,this.b.postMessage(a)):"html-body-inner"==a.req?(window.console.log("html",a),a.req="",a.done=!0,a.data=document&&document.body?document.body.innerHTML:"",this.b.postMessage(a)):this.dispatchEvent(new wd(a))};
we.prototype.toString=function(){return"Pipe:"+this.name};we.prototype.c=function(a,b){var c=a||xe,d=c+(b?"-"+b:"");this.d[d]||(this.d[d]=new td(this,c,b||""));return this.d[d]};function vd(a){if(!a.b){a.b=chrome.runtime.connect({name:a.name});var b=oa(a.e,a);a.b.onMessage.addListener(b);a.b.onDisconnect.addListener(function(){a.b.onMessage.removeListener(b);a.b=null;a.a.length=0})}return a.b}var ye=null;function ze(){if(!ye){var a=xe+"-"+z();ye=new we(a)}return ye}
function Ae(a){var b=a;v(a)&&(b={group:a,name:a+"-"+z()});return ye=new we(b)}var xe="default",Be="dev gmail hostper popup options setup".split(" ");function Ce(a,b){return ze().c(a,b)};var De=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function Ee(a){if(Fe){Fe=!1;var b=r.location;if(b){var c=b.href;if(c&&(c=(c=Ee(c)[3]||null)?decodeURI(c):c)&&c!=b.hostname)throw Fe=!0,Error();}}return a.match(De)}var Fe=Cc;function Ge(a,b){var c;a instanceof Ge?(this.jc=t(b)?b:a.jc,He(this,a.Xc),this.Fe=a.Fe,Ie(this,a.Mb),Je(this,a.ee),Ke(this,a.yc),Le(this,a.a.clone()),this.Kc=a.Kc):a&&(c=Ee(String(a)))?(this.jc=!!b,He(this,c[1]||"",!0),this.Fe=Me(c[2]||""),Ie(this,c[3]||"",!0),Je(this,c[4]),Ke(this,c[5]||"",!0),Le(this,c[6]||"",!0),this.Kc=Me(c[7]||"")):(this.jc=!!b,this.a=new Ne(null,0,this.jc))}h=Ge.prototype;h.Xc="";h.Fe="";h.Mb="";h.ee=null;h.yc="";h.Kc="";h.jc=!1;
h.toString=function(){var a=[],b=this.Xc;b&&a.push(Oe(b,Re,!0),":");if(b=this.Mb){a.push("//");var c=this.Fe;c&&a.push(Oe(c,Re,!0),"@");a.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));b=this.ee;null!=b&&a.push(":",String(b))}if(b=this.yc)this.Mb&&"/"!=b.charAt(0)&&a.push("/"),a.push(Oe(b,"/"==b.charAt(0)?Se:Te,!0));(b=this.a.toString())&&a.push("?",b);(b=this.Kc)&&a.push("#",Oe(b,Ue));return a.join("")};h.clone=function(){return new Ge(this)};
function He(a,b,c){a.Xc=c?Me(b,!0):b;a.Xc&&(a.Xc=a.Xc.replace(/:$/,""));return a}function Ve(a){return a.Mb}function Ie(a,b,c){a.Mb=c?Me(b,!0):b;return a}function Je(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.ee=b}else a.ee=null}function We(a){return a.yc}function Ke(a,b,c){a.yc=c?Me(b,!0):b}function Le(a,b,c){b instanceof Ne?(a.a=b,Xe(a.a,a.jc)):(c||(b=Oe(b,Ye)),a.a=new Ne(b,0,a.jc))}function Me(a,b){return a?b?decodeURI(a):decodeURIComponent(a):""}
function Oe(a,b,c){return v(a)?(a=encodeURI(a).replace(b,Ze),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Ze(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Re=/[#\/\?@]/g,Te=/[\#\?:]/g,Se=/[\#\?]/g,Ye=/[\#\?@]/g,Ue=/#/g;function Ne(a,b,c){this.a=a||null;this.b=!!c}
function $e(a){if(!a.ha&&(a.ha=new Jd,a.Ea=0,a.a))for(var b=a.a.split("&"),c=0;c<b.length;c++){var d=b[c].indexOf("="),e=null,f=null;0<=d?(e=b[c].substring(0,d),f=b[c].substring(d+1)):e=b[c];e=decodeURIComponent(e.replace(/\+/g," "));e=af(a,e);a.add(e,f?decodeURIComponent(f.replace(/\+/g," ")):"")}}h=Ne.prototype;h.ha=null;h.Ea=null;h.da=function(){$e(this);return this.Ea};h.add=function(a,b){$e(this);this.a=null;a=af(this,a);var c=this.ha.get(a);c||this.ha.set(a,c=[]);c.push(b);this.Ea++;return this};
h.remove=function(a){$e(this);a=af(this,a);return Ld(this.ha.b,a)?(this.a=null,this.Ea-=this.ha.get(a).length,this.ha.remove(a)):!1};h.clear=function(){this.ha=this.a=null;this.Ea=0};h.Ma=function(){$e(this);return 0==this.Ea};function bf(a,b){$e(a);b=af(a,b);return Ld(a.ha.b,b)}h.Ca=function(){$e(this);for(var a=this.ha.xa(),b=this.ha.Ca(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c};
h.xa=function(a){$e(this);var b=[];if(v(a))bf(this,a)&&(b=mb(b,this.ha.get(af(this,a))));else{a=this.ha.xa();for(var c=0;c<a.length;c++)b=mb(b,a[c])}return b};h.set=function(a,b){$e(this);this.a=null;a=af(this,a);bf(this,a)&&(this.Ea-=this.ha.get(a).length);this.ha.set(a,[b]);this.Ea++;return this};h.get=function(a,b){var c=a?this.xa(a):[];return 0<c.length?String(c[0]):b};
h.toString=function(){if(this.a)return this.a;if(!this.ha)return"";for(var a=[],b=this.ha.Ca(),c=0;c<b.length;c++)for(var d=b[c],e=encodeURIComponent(String(d)),d=this.xa(d),f=0;f<d.length;f++){var g=e;""!==d[f]&&(g+="="+encodeURIComponent(String(d[f])));a.push(g)}return this.a=a.join("&")};h.clone=function(){var a=new Ne;a.a=this.a;this.ha&&(a.ha=this.ha.clone(),a.Ea=this.Ea);return a};function af(a,b){var c=String(b);a.b&&(c=c.toLowerCase());return c}
function Xe(a,b){b&&!a.b&&($e(a),a.a=null,a.ha.forEach(function(a,b){var e=b.toLowerCase();b!=e&&(this.remove(b),this.remove(e),0<a.length&&(this.a=null,this.ha.set(af(this,e),nb(a)),this.Ea+=a.length))},a));a.b=b};var cf;
cf={e:["BC","AD"],d:["Before Christ","Anno Domini"],r:"JFMAMJJASOND".split(""),gb:"JFMAMJJASOND".split(""),l:"January February March April May June July August September October November December".split(" "),ta:"January February March April May June July August September October November December".split(" "),G:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),Zb:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),Ag:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),wg:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),
Y:"Sun Mon Tue Wed Thu Fri Sat".split(" "),vg:"Sun Mon Tue Wed Thu Fri Sat".split(" "),Q:"SMTWTFS".split(""),Yb:"SMTWTFS".split(""),T:["Q1","Q2","Q3","Q4"],F:["1st quarter","2nd quarter","3rd quarter","4th quarter"],a:["AM","PM"],b:["EEEE, MMMM d, y","MMMM d, y","MMM d, y","M/d/yy"],Gc:["h:mm:ss a zzzz","h:mm:ss a z","h:mm:ss a","h:mm a"],c:["{1} 'at' {0}","{1} 'at' {0}","{1}, {0}","{1}, {0}"],h:6,Tj:[5,6],i:5};function df(a){a=String(a);if(void 0===cf.ei)return a;for(var b=[],c=0;c<a.length;c++){var d=a.charCodeAt(c);b.push(48<=d&&57>=d?String.fromCharCode(cf.ei+d-48):a.charAt(c))}return b.join("")};var ef={Wh:{1E3:{other:"0K"},1E4:{other:"00K"},1E5:{other:"000K"},1E6:{other:"0M"},1E7:{other:"00M"},1E8:{other:"000M"},1E9:{other:"0B"},1E10:{other:"00B"},1E11:{other:"000B"},1E12:{other:"0T"},1E13:{other:"00T"},1E14:{other:"000T"}},Vh:{1E3:{other:"0 thousand"},1E4:{other:"00 thousand"},1E5:{other:"000 thousand"},1E6:{other:"0 million"},1E7:{other:"00 million"},1E8:{other:"000 million"},1E9:{other:"0 billion"},1E10:{other:"00 billion"},1E11:{other:"000 billion"},1E12:{other:"0 trillion"},1E13:{other:"00 trillion"},
1E14:{other:"000 trillion"}}},ff=ef,ff=ef;var gf={yg:".",Bg:",",Cg:"%",We:"0",bi:"+",Zh:"-",zg:"E",Dg:"\u2030",Ve:"\u221e",$h:"NaN",xg:"#,##0.###",ci:"#E0",ai:"#,##0%",Xh:"\u00a4#,##0.00",Yh:"USD"},hf=gf,hf=gf;var jf={AED:[2,"dh","\u062f.\u0625.","DH"],ALL:[0,"Lek","Lek"],AUD:[2,"$","AU$"],BDT:[2,"\u09f3","Tk"],BGN:[2,"lev","lev"],BRL:[2,"R$","R$"],CAD:[2,"$","C$"],CDF:[2,"FrCD","CDF"],CHF:[2,"CHF","CHF"],CLP:[0,"$","CL$"],CNY:[2,"\u00a5","RMB\u00a5"],COP:[0,"$","COL$"],CRC:[0,"\u20a1","CR\u20a1"],CZK:[50,"K\u010d","K\u010d"],DKK:[18,"kr","kr"],DOP:[2,"$","RD$"],EGP:[2,"\u00a3","LE"],ETB:[2,"Birr","Birr"],EUR:[2,"\u20ac","\u20ac"],GBP:[2,"\u00a3","GB\u00a3"],HKD:[2,"$","HK$"],HRK:[2,"kn","kn"],HUF:[0,"Ft",
"Ft"],IDR:[0,"Rp","Rp"],ILS:[2,"\u20aa","IL\u20aa"],INR:[2,"\u20b9","Rs"],IRR:[0,"Rial","IRR"],ISK:[0,"kr","kr"],JMD:[2,"$","JA$"],JPY:[0,"\u00a5","JP\u00a5"],KRW:[0,"\u20a9","KR\u20a9"],LKR:[2,"Rs","SLRs"],LTL:[2,"Lt","Lt"],LVL:[2,"Ls","Ls"],MNT:[0,"\u20ae","MN\u20ae"],MXN:[2,"$","Mex$"],MYR:[2,"RM","RM"],NOK:[50,"kr","NOkr"],PAB:[2,"B/.","B/."],PEN:[2,"S/.","S/."],PHP:[2,"\u20b1","Php"],PKR:[0,"Rs","PKRs."],PLN:[50,"z\u0142","z\u0142"],RON:[2,"RON","RON"],RSD:[0,"din","RSD"],RUB:[50,"\u0440\u0443\u0431.",
"\u0440\u0443\u0431."],SAR:[2,"Rial","Rial"],SEK:[2,"kr","kr"],SGD:[2,"$","S$"],THB:[2,"\u0e3f","THB"],TRY:[2,"TL","YTL"],TWD:[2,"NT$","NT$"],TZS:[0,"TSh","TSh"],UAH:[2,"\u20b4","UAH"],USD:[2,"$","US$"],UYU:[2,"$","$U"],VND:[0,"\u20ab","VN\u20ab"],YER:[0,"Rial","Rial"],ZAR:[2,"R","ZAR"]};function kf(a,b,c){this.t=b||hf.Yh;this.ta=c||lf;this.Q=40;this.a=1;this.T=0;this.d=3;this.C=this.b=0;this.ja=!1;this.r=this.e="";this.c="-";this.h="";this.l=1;this.G=3;this.F=this.Y=!1;this.i=mf;if("number"==typeof a)switch(a){case 1:nf(this,hf.xg);break;case 2:nf(this,hf.ci);break;case 3:nf(this,hf.ai);break;case 4:a=hf.Xh;b=["0"];c=jf[this.t][0]&7;if(0<c){b.push(".");for(var d=0;d<c;d++)b.push("0")}a=a.replace(/0.00/g,b.join(""));nf(this,a);break;case 5:of(this,1);break;case 6:of(this,2);break;
default:throw Error("Unsupported pattern type.");}else nf(this,a)}var lf=0,mf=0;
function nf(a,b){b.replace(/ /g,"\u00a0");var c=[0];a.e=pf(a,b,c);for(var d=c[0],e=-1,f=0,g=0,k=0,l=-1,m=b.length,n=!0;c[0]<m&&n;c[0]++)switch(b.charAt(c[0])){case "#":0<g?k++:f++;0<=l&&0>e&&l++;break;case "0":if(0<k)throw Error('Unexpected "0" in pattern "'+b+'"');g++;0<=l&&0>e&&l++;break;case ",":l=0;break;case ".":if(0<=e)throw Error('Multiple decimal separators in pattern "'+b+'"');e=f+g+k;break;case "E":if(a.F)throw Error('Multiple exponential symbols in pattern "'+b+'"');a.F=!0;a.C=0;c[0]+1<
m&&"+"==b.charAt(c[0]+1)&&(c[0]++,a.ja=!0);for(;c[0]+1<m&&"0"==b.charAt(c[0]+1);)c[0]++,a.C++;if(1>f+g||1>a.C)throw Error('Malformed exponential pattern "'+b+'"');n=!1;break;default:c[0]--,n=!1}0==g&&0<f&&0<=e&&(g=e,0==g&&g++,k=f-g,f=g-1,g=1);if(0>e&&0<k||0<=e&&(e<f||e>f+g)||0==l)throw Error('Malformed pattern "'+b+'"');k=f+g+k;a.d=0<=e?k-e:0;0<=e&&(a.b=f+g-e,0>a.b&&(a.b=0));a.a=(0<=e?e:k)-f;a.F&&(a.Q=f+a.a,0==a.d&&0==a.a&&(a.a=1));a.G=Math.max(0,l);a.Y=0==e||e==k;d=c[0]-d;a.r=pf(a,b,c);c[0]<b.length&&
b.charAt(c[0])==qf?(c[0]++,a.c=pf(a,b,c),c[0]+=d,a.h=pf(a,b,c)):(a.c=a.e+a.c,a.h+=a.r)}function of(a,b){a.i=b;nf(a,hf.xg);a.b=0;a.d=2;if(0<a.b)throw Error("Can't combine significant digits and minimum fraction digits");a.T=2}
kf.prototype.parse=function(a,b){var c=b||[0];if(this.i!=mf)throw Error("Parsing of compact numbers is unimplemented");var d=NaN;a=a.replace(/ /g,"\u00a0");var e=a.indexOf(this.e,c[0])==c[0],f=a.indexOf(this.c,c[0])==c[0];e&&f&&(this.e.length>this.c.length?f=!1:this.e.length<this.c.length&&(e=!1));e?c[0]+=this.e.length:f&&(c[0]+=this.c.length);if(a.indexOf(hf.Ve,c[0])==c[0])c[0]+=hf.Ve.length,d=Infinity;else{var d=a,g=!1,k=!1,l=!1,m=1,n=hf.yg,p=hf.Bg,q=hf.zg;if(this.i!=mf)throw Error("Parsing of compact style numbers is not implemented");
for(var s="";c[0]<d.length;c[0]++){var w=d.charAt(c[0]),y=rf(w);if(0<=y&&9>=y)s+=y,l=!0;else if(w==n.charAt(0)){if(g||k)break;s+=".";g=!0}else if(w==p.charAt(0)&&("\u00a0"!=p.charAt(0)||c[0]+1<d.length&&0<=rf(d.charAt(c[0]+1)))){if(g||k)break}else if(w==q.charAt(0)){if(k)break;s+="E";k=!0}else if("+"==w||"-"==w)s+=w;else if(w==hf.Cg.charAt(0)){if(1!=m)break;m=100;if(l){c[0]++;break}}else if(w==hf.Dg.charAt(0)){if(1!=m)break;m=1E3;if(l){c[0]++;break}}else break}d=parseFloat(s)/m}if(e){if(a.indexOf(this.r,
c[0])!=c[0])return NaN;c[0]+=this.r.length}else if(f){if(a.indexOf(this.h,c[0])!=c[0])return NaN;c[0]+=this.h.length}return f?-d:d};function sf(a,b){var c=Math.pow(10,a.d),d=0>=a.T?Math.round(b*c):Math.round(tf(b*c,a.T,a.d)),e;isFinite(d)?(e=Math.floor(d/c),c=Math.floor(d-e*c)):(e=b,c=0);return{kh:e,ki:c}}
function uf(a,b,c,d){if(a.b>a.d)throw Error("Min value must be less than max value");b=sf(a,b);var e=Math.pow(10,a.d),f=b.kh,g=b.ki,k=0<a.b||0<g||!1;b=a.b;k&&(b=a.b);for(var l="",m=f;1E20<m;)l="0"+l,m=Math.round(m/10);var l=m+l,n=hf.yg,p=hf.Bg,m=hf.We.charCodeAt(0),q=l.length;if(0<f||0<c){for(f=q;f<c;f++)d.push(String.fromCharCode(m));for(f=0;f<q;f++)d.push(String.fromCharCode(m+1*l.charAt(f))),1<q-f&&0<a.G&&1==(q-f)%a.G&&d.push(p)}else k||d.push(String.fromCharCode(m));(a.Y||k)&&d.push(n);a=""+(g+
e);for(c=a.length;"0"==a.charAt(c-1)&&c>b+1;)c--;for(f=1;f<c;f++)d.push(String.fromCharCode(m+1*a.charAt(f)))}function vf(a,b,c){c.push(hf.zg);0>b?(b=-b,c.push(hf.Zh)):a.ja&&c.push(hf.bi);b=""+b;for(var d=hf.We,e=b.length;e<a.C;e++)c.push(d);c.push(b)}function rf(a){a=a.charCodeAt(0);if(48<=a&&58>a)return a-48;var b=hf.We.charCodeAt(0);return b<=a&&a<b+10?a-b:-1}var qf=";";
function pf(a,b,c){for(var d="",e=!1,f=b.length;c[0]<f;c[0]++){var g=b.charAt(c[0]);if("'"==g)c[0]+1<f&&"'"==b.charAt(c[0]+1)?(c[0]++,d+="'"):e=!e;else if(e)d+=g;else switch(g){case "#":case "0":case ",":case ".":case qf:return d;case "\u00a4":if(c[0]+1<f&&"\u00a4"==b.charAt(c[0]+1))c[0]++,d+=a.t;else switch(a.ta){case lf:d+=jf[a.t][1];break;case 2:var g=a.t,k=jf[g],d=d+(g==k[1]?g:g+" "+k[1]);break;case 1:d+=jf[a.t][2]}break;case "%":if(1!=a.l)throw Error("Too many percent/permill");a.l=100;d+=hf.Cg;
break;case "\u2030":if(1!=a.l)throw Error("Too many percent/permill");a.l=1E3;d+=hf.Dg;break;default:d+=g}}return d}var wf={prefix:"",Gh:"",lf:0};function xf(a,b){var c=1==a.i?ff.Wh:ff.Vh;if(3>b)return wf;b=Math.min(14,b);c=c[Math.pow(10,b)];if(!c)return wf;c=c.other;return c&&"0"!=c?(c=/([^0]*)(0+)(.*)/.exec(c))?{prefix:c[1],Gh:c[3],lf:b-(c[2].length-1)}:wf:wf}function yf(a){for(var b=0;1<=(a/=10);)b++;return b}
function tf(a,b,c){if(!a)return a;b=b-yf(a)-1;if(b<-c)return c=Math.pow(10,c),Math.round(a/c)*c;c=Math.pow(10,b);return Math.round(a*c)/c};function zf(a){return 1==a%10&&11!=a%100?"one":2==a%10&&12!=a%100?"two":3==a%10&&13!=a%100?"few":"other"}var Af=zf,Af=zf;function Bf(a){a=a+"";var b=a.indexOf(".");return-1==b?0:a.length-b-1}function Cf(a,b){var c,d=a|0;c=void 0===b?Math.min(Bf(a),3):b;return 1==d&&0==c?"one":"other"}var Df=Cf,Df=Cf;function Ef(a){this.a=[];this.d=[];this.c=new kf(1);a&&(a=Ff(this,a),this.d=Gf(this,a))}var Hf=RegExp("'([{}#].*?)'","g"),If=RegExp("''","g");
function Jf(a,b,c,d,e){for(var f=0;f<b.length;f++)switch(b[f].type){case 4:e.push(b[f].value);break;case 3:var g=b[f].value,k=a,l=e,m=c[g];t(m)?(k.a.push(m),l.push(k.b(k.a))):l.push("Undefined parameter - "+g);break;case 2:g=b[f].value;k=e;l=g.Ld;t(c[l])?(l=g[c[l]],t(l)||(l=g.other),Jf(a,l,c,d,k)):k.push("Undefined parameter - "+l);break;case 0:g=b[f].value;Kf(a,g,c,Df,d,e);break;case 1:g=b[f].value;Kf(a,g,c,Af,d,e);break;default:Ya("Unrecognized block type: "+b[f].type)}}
function Kf(a,b,c,d,e,f){var g=b.Ld,k=b.Hg,l=+c[g];if(isNaN(l))f.push("Undefined or invalid parameter - "+g);else if(k=l-k,g=b[c[g]],t(g)||(d=a.c.gb?d(k,a.c.gb()):d(k),g=b[d],t(g)||(g=b.other)),b=[],Jf(a,g,c,e,b),c=b.join(""),e)f.push(c);else{a=a.c;if(isNaN(k))a=hf.$h;else{e=[];g=d=k;a.i==mf?b=wf:(d=Math.abs(d),g=Math.abs(g),b=xf(a,1>=d?0:yf(d)).lf,sf(a,g/Math.pow(10,b)),d=sf(a,d/Math.pow(10,b)),b=xf(a,b+yf(d.kh)));k/=Math.pow(10,b.lf);e.push(b.prefix);d=0>k||0==k&&0>1/k;e.push(d?a.c:a.e);if(isFinite(k))if(k=
k*(d?-1:1)*a.l,a.F)if(0==k)uf(a,k,a.a,e),vf(a,0,e);else{g=Math.log(k)/Math.log(10);g=Math.floor(g+2E-15);k/=Math.pow(10,g);l=a.a;if(1<a.Q&&a.Q>a.a){for(;0!=g%a.Q;)k*=10,g--;l=1}else 1>a.a?(g++,k/=10):(g-=a.a-1,k*=Math.pow(10,a.a-1));uf(a,k,l,e);vf(a,g,e)}else uf(a,k,a.a,e);else e.push(hf.Ve);e.push(d?a.h:a.r);e.push(b.Gh);a=e.join("")}f.push(c.replace(/#/g,a))}}
function Ff(a,b){var c=a.a,d=oa(a.b,a);b=b.replace(If,function(){c.push("'");return d(c)});return b=b.replace(Hf,function(a,b){c.push(b);return d(c)})}function Lf(a){var b=0,c=[],d=[],e=/[{}]/g;e.lastIndex=0;for(var f;f=e.exec(a);){var g=f.index;"}"==f[0]?(c.pop(),0==c.length&&(f={type:1},f.value=a.substring(b,g),d.push(f),b=g+1)):(0==c.length&&(b=a.substring(b,g),""!=b&&d.push({type:0,value:b}),b=g+1),c.push("{"))}b=a.substring(b);""!=b&&d.push({type:0,value:b});return d}
var Mf=/^\s*(\w+)\s*,\s*plural\s*,(?:\s*offset:(\d+))?/,Nf=/^\s*(\w+)\s*,\s*selectordinal\s*,/,Of=/^\s*(\w+)\s*,\s*select\s*,/;
function Gf(a,b){for(var c=[],d=Lf(b),e=0;e<d.length;e++){var f={};if(0==d[e].type)f.type=4,f.value=d[e].value;else if(1==d[e].type){var g=d[e].value;switch(Mf.test(g)?0:Nf.test(g)?1:Of.test(g)?2:/^\s*\w+\s*/.test(g)?3:5){case 2:f.type=2;f.value=Pf(a,d[e].value);break;case 0:f.type=0;f.value=Qf(a,d[e].value);break;case 1:f.type=1;f.value=Rf(a,d[e].value);break;case 3:f.type=3;f.value=d[e].value;break;default:Ya("Unknown block type for pattern: "+d[e].value)}}else Ya("Unknown part of the pattern.");
c.push(f)}return c}function Pf(a,b){var c="";b=b.replace(Of,function(a,b){c=b;return""});var d={};d.Ld=c;for(var e=Lf(b),f=0;f<e.length;){var g=e[f].value;f++;if(1==e[f].type)var k=Gf(a,e[f].value);else Ya("Expected block type.");d[g.replace(/\s/g,"")]=k;f++}return d}
function Qf(a,b){var c="",d=0;b=b.replace(Mf,function(a,b,e){c=b;e&&(d=parseInt(e,10));return""});var e={};e.Ld=c;e.Hg=d;for(var f=Lf(b),g=0;g<f.length;){var k=f[g].value;g++;if(1==f[g].type)var l=Gf(a,f[g].value);else Ya("Expected block type.");e[k.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=l;g++}return e}
function Rf(a,b){var c="";b=b.replace(Nf,function(a,b){c=b;return""});var d={};d.Ld=c;d.Hg=0;for(var e=Lf(b),f=0;f<e.length;){var g=e[f].value;f++;if(1==e[f].type)var k=Gf(a,e[f].value);else Ya("Expected block type.");d[g.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=k;f++}return d}Ef.prototype.b=function(a){return"\ufddf_"+(a.length-1).toString(10)+"_"};function Sf(a,b,c){a=new Ef(a);b={COUNT:b,TEXT:c};if(0==a.d.length)a="";else{c=[];Jf(a,a.d,b,!1,c);for(b=c.join("");0<a.a.length;)b=b.replace(a.b(a.a),a.a.pop());a=b}return a};function Tf(a){tc.call(this);this.a=a;this.b={}}A(Tf,tc);var Uf=[];h=Tf.prototype;h.listen=function(a,b,c,d){u(b)||(b&&(Uf[0]=b.toString()),b=Uf);for(var e=0;e<b.length;e++){var f=ed(a,b[e],c||this.handleEvent,d||!1,this.a||this);if(!f)break;this.b[f.key]=f}return this};function Vf(a,b,c){Wf(a,b,"hide",c,!1)}function Wf(a,b,c,d,e,f){if(u(c))for(var g=0;g<c.length;g++)Wf(a,b,c[g],d,e,f);else(b=md(b,c,d||a.handleEvent,e,f||a.a||a))&&(a.b[b.key]=b)}
h.X=function(a,b,c,d,e){if(u(b))for(var f=0;f<b.length;f++)this.X(a,b[f],c,d,e);else c=c||this.handleEvent,e=e||this.a||this,c=fd(c),d=!!d,b=Uc(a)?ad(a.vb,String(b),c,d,e):a?(a=hd(a))?ad(a,b,c,d,e):null:null,b&&(od(b),delete this.b[b.key]);return this};h.removeAll=function(){Ab(this.b,od);this.b={}};h.u=function(){Tf.f.u.call(this);this.removeAll()};h.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented");};function Xf(a,b){F.call(this);this.b=a||1;this.a=b||r;this.c=oa(this.tj,this);this.d=z()}A(Xf,F);h=Xf.prototype;h.ld=!1;h.ba=null;h.setInterval=function(a){this.b=a;this.ba&&this.ld?(this.stop(),Yf(this)):this.ba&&this.stop()};h.tj=function(){if(this.ld){var a=z()-this.d;0<a&&a<.8*this.b?this.ba=this.a.setTimeout(this.c,this.b-a):(this.ba&&(this.a.clearTimeout(this.ba),this.ba=null),this.dispatchEvent(Zf),this.ld&&(this.ba=this.a.setTimeout(this.c,this.b),this.d=z()))}};
function Yf(a){a.ld=!0;a.ba||(a.ba=a.a.setTimeout(a.c,a.b),a.d=z())}h.stop=function(){this.ld=!1;this.ba&&(this.a.clearTimeout(this.ba),this.ba=null)};h.u=function(){Xf.f.u.call(this);this.stop();delete this.a};var Zf="tick";function $f(a,b,c){if(ia(a))c&&(a=oa(a,c));else if(a&&"function"==typeof a.handleEvent)a=oa(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<b?-1:r.setTimeout(a,b||0)};var ag=r.JSON.parse,bg=r.JSON.stringify;function cg(){}
function dg(a,b,c){switch(typeof b){case "string":eg(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(null==b){c.push("null");break}if(u(b)){var d=b.length;c.push("[");for(var e="",f=0;f<d;f++)c.push(e),dg(a,b[f],c),e=",";c.push("]");break}c.push("{");d="";for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(f=b[e],"function"!=typeof f&&(c.push(d),eg(e,c),c.push(":"),dg(a,f,c),d=","));c.push("}");
break;case "function":break;default:throw Error("Unknown type: "+typeof b);}}var fg={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},gg=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;function eg(a,b){b.push('"',a.replace(gg,function(a){if(a in fg)return fg[a];var b=a.charCodeAt(0),e="\\u";16>b?e+="000":256>b?e+="00":4096>b&&(e+="0");return fg[a]=e+b.toString(16)}),'"')};function hg(){}hg.prototype.a=null;function ig(a){var b;(b=a.a)||(b={},jg(a)&&(b[0]=!0,b[1]=!0),b=a.a=b);return b};var kg;function lg(){}A(lg,hg);function mg(a){return(a=jg(a))?new ActiveXObject(a):new XMLHttpRequest}function jg(a){if(!a.b&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.b=d}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed");}return a.b}kg=new lg;function ng(a){F.call(this);this.headers=new Jd;this.T=a||null;this.b=!1;this.G=this.O=null;this.ta=this.l="";this.h=0;this.i="";this.c=this.ja=this.r=this.Y=!1;this.e=0;this.C=null;this.d=og;this.F=this.Ie=!1}A(ng,F);var og="";ng.prototype.a=L("goog.net.XhrIo");var pg=/^https?$/i,qg=["POST","PUT"];h=ng.prototype;h.Zg=function(){return this.d};
h.send=function(a,b,c,d){if(this.O)throw Error("[goog.net.XhrIo] Object is active with another request="+this.l+"; newUri="+a);b=b?b.toUpperCase():"GET";this.l=a;this.i="";this.h=0;this.ta=b;this.Y=!1;this.b=!0;this.O=this.T?mg(this.T):mg(kg);this.G=this.T?ig(this.T):ig(kg);this.O.onreadystatechange=oa(this.th,this);try{re(this.a,rg(this,"Opening Xhr")),this.ja=!0,this.O.open(b,String(a),!0),this.ja=!1}catch(e){re(this.a,rg(this,"Error opening Xhr: "+e.message));sg(this,e);return}a=c||"";var f=this.headers.clone();
d&&Cd(d,function(a,b){f.set(b,a)});d=hb(f.Ca(),tg);c=r.FormData&&a instanceof r.FormData;!jb(qg,b)||d||c||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");f.forEach(function(a,b){this.O.setRequestHeader(b,a)},this);this.d&&(this.O.responseType=this.d);"withCredentials"in this.O&&(this.O.withCredentials=this.Ie);try{ug(this),0<this.e&&(this.F=vg(this.O),re(this.a,rg(this,"Will abort after "+this.e+"ms if incomplete, xhr2 "+this.F)),this.F?(this.O.timeout=this.e,this.O.ontimeout=
oa(this.Hh,this)):this.C=$f(this.Hh,this.e,this)),re(this.a,rg(this,"Sending request")),this.r=!0,this.O.send(a),this.r=!1}catch(g){re(this.a,rg(this,"Send error: "+g.message)),sg(this,g)}};function vg(a){return D&&Jc(9)&&ha(a.timeout)&&t(a.ontimeout)}function tg(a){return"content-type"==a.toLowerCase()}h.Hh=function(){"undefined"!=typeof aa&&this.O&&(this.i="Timed out after "+this.e+"ms, aborting",this.h=8,re(this.a,rg(this,this.i)),this.dispatchEvent("timeout"),this.abort(8))};
function sg(a,b){a.b=!1;a.O&&(a.c=!0,a.O.abort(),a.c=!1);a.i=b;a.h=5;wg(a);xg(a)}function wg(a){a.Y||(a.Y=!0,a.dispatchEvent("complete"),a.dispatchEvent("error"))}h.abort=function(a){this.O&&this.b&&(re(this.a,rg(this,"Aborting")),this.b=!1,this.c=!0,this.O.abort(),this.c=!1,this.h=a||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),xg(this))};h.u=function(){this.O&&(this.b&&(this.b=!1,this.c=!0,this.O.abort(),this.c=!1),xg(this,!0));ng.f.u.call(this)};
h.th=function(){this.t||(this.ja||this.r||this.c?yg(this):this.kj())};h.kj=function(){yg(this)};function yg(a){if(a.b&&"undefined"!=typeof aa)if(a.G[1]&&4==zg(a)&&2==a.H())re(a.a,rg(a,"Local request error detected and ignored"));else if(a.r&&4==zg(a))$f(a.th,0,a);else if(a.dispatchEvent("readystatechange"),4==zg(a)){re(a.a,rg(a,"Request complete"));a.b=!1;try{Ag(a)?(a.dispatchEvent("complete"),a.dispatchEvent("success")):(a.h=6,a.i=a.Da()+" ["+a.H()+"]",wg(a))}finally{xg(a)}}}
function xg(a,b){if(a.O){ug(a);var c=a.O,d=a.G[0]?ca:null;a.O=null;a.G=null;b||a.dispatchEvent("ready");try{c.onreadystatechange=d}catch(e){qe(a.a,"Problem encountered resetting onreadystatechange: "+e.message)}}}function ug(a){a.O&&a.F&&(a.O.ontimeout=null);ha(a.C)&&(r.clearTimeout(a.C),a.C=null)}
function Ag(a){var b=a.H(),c;a:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:c=!0;break a;default:c=!1}if(!c){if(b=0===b)a=Ee(String(a.l))[1]||null,!a&&self.location&&(a=self.location.protocol,a=a.substr(0,a.length-1)),b=!pg.test(a?a.toLowerCase():"");c=b}return c}function zg(a){return a.O?a.O.readyState:0}h.H=function(){try{return 2<zg(this)?this.O.status:-1}catch(a){return-1}};
h.Da=function(){try{return 2<zg(this)?this.O.statusText:""}catch(a){return re(this.a,"Can not get status: "+a.message),""}};function Bg(a){try{if(!a.O)return null;if("response"in a.O)return a.O.response;switch(a.d){case og:case "text":return a.O.responseText;case "arraybuffer":if("mozResponseArrayBuffer"in a.O)return a.O.mozResponseArrayBuffer}qe(a.a,"Response type "+a.d+" is not supported on this browser");return null}catch(b){return re(a.a,"Can not get response: "+b.message),null}}
function rg(a,b){return b+" ["+a.ta+" "+a.l+" "+a.H()+"]"};function Cg(){this.a=[];this.b=[]}function Dg(a){0==a.a.length&&(a.a=a.b,a.a.reverse(),a.b=[]);return a.a.pop()}h=Cg.prototype;h.da=function(){return this.a.length+this.b.length};h.Ma=function(){return 0==this.a.length&&0==this.b.length};h.clear=function(){this.a=[];this.b=[]};h.contains=function(a){return jb(this.a,a)||jb(this.b,a)};h.remove=function(a){var b=ab(this.a,a);if(0>b)return lb(this.b,a);Za.splice.call(this.a,b,1);return!0};
h.xa=function(){for(var a=[],b=this.a.length-1;0<=b;--b)a.push(this.a[b]);for(var c=this.b.length,b=0;b<c;++b)a.push(this.b[b]);return a};function Eg(a,b){tc.call(this);this.h=a||0;this.c=b||10;if(this.h>this.c)throw Error(Fg);this.a=new Cg;this.b=new Md;this.e=null;this.Jd()}A(Eg,tc);var Fg="[goog.structs.Pool] Min can not be greater than max";h=Eg.prototype;h.ge=function(){var a=z();if(!(null!=this.e&&0>a-this.e)){for(var b;0<this.a.da()&&(b=Dg(this.a),!this.ag(b));)this.Jd();!b&&this.da()<this.c&&(b=this.Bf());b&&(this.e=a,this.b.add(b));return b}};h.dd=function(a){this.b.remove(a);this.ag(a)&&this.da()<this.c?this.a.b.push(a):Gg(a)};
h.Jd=function(){for(var a=this.a;this.da()<this.h;){var b=this.Bf();a.b.push(b)}for(;this.da()>this.c&&0<this.a.da();)Gg(Dg(a))};h.Bf=function(){return{}};function Gg(a){if("function"==typeof a.S)a.S();else for(var b in a)a[b]=null}h.ag=function(a){return"function"==typeof a.gi?a.gi():!0};h.contains=function(a){return this.a.contains(a)||this.b.contains(a)};h.da=function(){return this.a.da()+this.b.da()};h.Ma=function(){return this.a.Ma()&&this.b.Ma()};
h.u=function(){Eg.f.u.call(this);if(0<this.b.da())throw Error("[goog.structs.Pool] Objects not released");delete this.b;for(var a=this.a;!a.Ma();)Gg(Dg(a));delete this.a};function Hg(a,b){this.a=a;this.b=b}Hg.prototype.K=function(){return this.b};Hg.prototype.clone=function(){return new Hg(this.a,this.b)};function Ig(a){this.a=[];if(a)a:{var b,c;if(a instanceof Ig){if(b=a.Ca(),c=a.xa(),0>=a.da()){a=this.a;for(var d=0;d<b.length;d++)a.push(new Hg(b[d],c[d]));break a}}else b=Cb(a),c=Bb(a);for(d=0;d<b.length;d++)Jg(this,b[d],c[d])}}function Jg(a,b,c){var d=a.a;d.push(new Hg(b,c));b=d.length-1;a=a.a;for(c=a[b];0<b;)if(d=b-1>>1,a[d].a>c.a)a[b]=a[d],b=d;else break;a[b]=c}h=Ig.prototype;
h.remove=function(){var a=this.a,b=a.length,c=a[0];if(!(0>=b)){if(1==b)kb(a);else{a[0]=a.pop();for(var a=0,b=this.a,d=b.length,e=b[a];a<d>>1;){var f=2*a+1,g=2*a+2,f=g<d&&b[g].a<b[f].a?g:f;if(b[f].a>e.a)break;b[a]=b[f];a=f}b[a]=e}return c.K()}};h.xa=function(){for(var a=this.a,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].K());return b};h.Ca=function(){for(var a=this.a,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].a);return b};h.clone=function(){return new Ig(this)};h.da=function(){return this.a.length};
h.Ma=function(){return 0==this.a.length};h.clear=function(){kb(this.a)};function Kg(){Ig.call(this)}A(Kg,Ig);function Lg(a,b){this.d=new Kg;Eg.call(this,a,b)}A(Lg,Eg);h=Lg.prototype;h.ge=function(a,b){if(!a)return Lg.f.ge.call(this);Jg(this.d,t(b)?b:100,a);this.Lf()};h.Lf=function(){for(var a=this.d;0<a.da();){var b=this.ge();if(b)a.remove().apply(this,[b]);else break}};h.dd=function(a){Lg.f.dd.call(this,a);this.Lf()};h.Jd=function(){Lg.f.Jd.call(this);this.Lf()};h.u=function(){Lg.f.u.call(this);r.clearTimeout(void 0);this.d.clear();this.d=null};function Mg(a,b,c){Lg.call(this,b,c);this.i=a}A(Mg,Lg);Mg.prototype.Bf=function(){var a=new ng,b=this.i;b&&b.forEach(function(b,d){a.headers.set(d,b)});return a};Mg.prototype.ag=function(a){return!a.t&&!a.O};function Ng(a,b,c,d,e){F.call(this);this.d=t(a)?a:1;this.e=t(e)?Math.max(0,e):0;this.c=new Mg(b,c,d);this.b=new Jd;this.a=new Tf(this)}A(Ng,F);var Og="ready complete success error abort timeout".split(" ");h=Ng.prototype;h.send=function(a,b,c,d,e,f,g,k,l,m){if(this.b.get(a))throw Error("[goog.net.XhrManager] ID in use");b=new Pg(b,oa(this.Gi,this,a),c,d,e,g,t(k)?k:this.d,l,m);this.b.set(a,b);a=oa(this.Bi,this,a);this.c.ge(a,f);return b};
h.abort=function(a,b){var c=this.b.get(a);if(c){var d=c.Bd;c.Eg=!0;b&&(d&&(this.a.X(d,Og,c.mg),md(d,"ready",function(){var a=this.c;a.b.remove(d)&&a.dd(d)},!1,this)),this.b.remove(a));d&&d.abort()}};h.Bi=function(a,b){var c=this.b.get(a);c&&!c.Bd?(this.a.listen(b,Og,c.mg),b.e=Math.max(0,this.e),b.d=c.Zg(),c.Bd=b,c.Bd.Ie=c.Ie,this.dispatchEvent(new Qg("ready",this,a,b)),Rg(this,a,b),c.Eg&&b.abort()):(c=this.c,c.b.remove(b)&&c.dd(b))};
h.Gi=function(a,b){var c=b.target;switch(b.type){case "ready":Rg(this,a,c);break;case "complete":a:{var d=this.b.get(a);if(7==c.h||Ag(c)||d.Md>d.zf)if(this.dispatchEvent(new Qg("complete",this,a,c)),d&&(d.Pg=!0,d.Og)){c=d.Og.call(c,b);break a}c=null}return c;case "success":this.dispatchEvent(new Qg("success",this,a,c));break;case "timeout":case "error":d=this.b.get(a);d.Md>d.zf&&this.dispatchEvent(new Qg("error",this,a,c));break;case "abort":this.dispatchEvent(new Qg("abort",this,a,c))}return null};
function Rg(a,b,c){var d=a.b.get(b);!d||d.Pg||d.Md>d.zf?(d&&(a.a.X(c,Og,d.mg),a.b.remove(b)),a=a.c,a.b.remove(c)&&a.dd(c)):(d.Md++,c.send(d.wj,d.de(),d.W(),d.Nc()))}h.u=function(){Ng.f.u.call(this);this.c.S();this.c=null;this.a.S();this.a=null;this.b.clear();this.b=null};function Qg(a,b,c,d){E.call(this,a,b);this.id=c;this.Bd=d}A(Qg,E);
function Pg(a,b,c,d,e,f,g,k,l){this.Ie=!!l;this.wj=a;this.c=c||"GET";this.a=d;this.b=e||null;this.zf=t(g)?g:1;this.Md=0;this.Eg=this.Pg=!1;this.mg=b;this.Og=f;this.d=k||og;this.Bd=null}Pg.prototype.de=function(){return this.c};Pg.prototype.W=function(){return this.a};Pg.prototype.Nc=function(){return this.b};Pg.prototype.Zg=function(){return this.d};function Sg(a){for(var b=[],c=0,d=0;d<a.length;d++){for(var e=a.charCodeAt(d);255<e;)b[c++]=e&255,e>>=8;b[c++]=e}return b}function Tg(a){return db(a,function(a){a=a.toString(16);return 1<a.length?a:"0"+a}).join("")};function Ug(){this.c=[];this.b=this.a=0};function Vg(){this.b=-1};function Wg(){this.b=-1;this.b=64;this.a=[];this.i=[];this.l=[];this.h=[];this.h[0]=128;for(var a=1;a<this.b;++a)this.h[a]=0;this.e=this.c=0;this.t()}A(Wg,Vg);Wg.prototype.t=function(){this.a[0]=1732584193;this.a[1]=4023233417;this.a[2]=2562383102;this.a[3]=271733878;this.a[4]=3285377520;this.e=this.c=0};
function Xg(a,b,c){c||(c=0);var d=a.l;if(v(b))for(var e=0;16>e;e++)d[e]=b.charCodeAt(c)<<24|b.charCodeAt(c+1)<<16|b.charCodeAt(c+2)<<8|b.charCodeAt(c+3),c+=4;else for(e=0;16>e;e++)d[e]=b[c]<<24|b[c+1]<<16|b[c+2]<<8|b[c+3],c+=4;for(e=16;80>e;e++){var f=d[e-3]^d[e-8]^d[e-14]^d[e-16];d[e]=(f<<1|f>>>31)&4294967295}b=a.a[0];c=a.a[1];for(var g=a.a[2],k=a.a[3],l=a.a[4],m,e=0;80>e;e++)40>e?20>e?(f=k^c&(g^k),m=1518500249):(f=c^g^k,m=1859775393):60>e?(f=c&g|k&(c|g),m=2400959708):(f=c^g^k,m=3395469782),f=(b<<
5|b>>>27)+f+l+m+d[e]&4294967295,l=k,k=g,g=(c<<30|c>>>2)&4294967295,c=b,b=f;a.a[0]=a.a[0]+b&4294967295;a.a[1]=a.a[1]+c&4294967295;a.a[2]=a.a[2]+g&4294967295;a.a[3]=a.a[3]+k&4294967295;a.a[4]=a.a[4]+l&4294967295}
Wg.prototype.update=function(a,b){t(b)||(b=a.length);for(var c=b-this.b,d=0,e=this.i,f=this.c;d<b;){if(0==f)for(;d<=c;)Xg(this,a,d),d+=this.b;if(v(a))for(;d<b;){if(e[f]=a.charCodeAt(d),++f,++d,f==this.b){Xg(this,e);f=0;break}}else for(;d<b;)if(e[f]=a[d],++f,++d,f==this.b){Xg(this,e);f=0;break}}this.c=f;this.e+=b};
Wg.prototype.d=function(){var a=[],b=8*this.e;56>this.c?this.update(this.h,56-this.c):this.update(this.h,this.b-(this.c-56));for(var c=this.b-1;56<=c;c--)this.i[c]=b&255,b/=256;Xg(this,this.i);for(c=b=0;5>c;c++)for(var d=24;0<=d;d-=8)a[b]=this.a[c]>>d&255,++b;return a};var Yg=null,Zg=null;function $g(a){this.a=a}$g.prototype.set=function(a,b){t(b)?this.a.set(a,bg(b)):this.a.remove(a)};$g.prototype.get=function(a){var b;try{b=this.a.get(a)}catch(c){return}if(null!==b)try{return ag(b)}catch(d){throw"Storage: Invalid value was encountered";}};$g.prototype.remove=function(a){this.a.remove(a)};function ah(){};function bh(a){this.a=a}A(bh,$g);function ch(a){this.data=a}function dh(a){return!t(a)||a instanceof ch?a:new ch(a)}function eh(a){a=a.data;if(!t(a))throw"Storage: Invalid value was encountered";return a}bh.prototype.set=function(a,b){bh.f.set.call(this,a,dh(b))};bh.prototype.kd=function(a){a=bh.f.get.call(this,a);if(!t(a)||a instanceof Object)return a;throw"Storage: Invalid value was encountered";};bh.prototype.get=function(a){return(a=this.kd(a))?eh(a):void 0};function fh(a){this.a=a}A(fh,bh);fh.prototype.set=function(a,b,c){if(b=dh(b)){if(c){if(c<z()){fh.prototype.remove.call(this,a);return}b.expiration=c}b.creation=z()}fh.f.set.call(this,a,b)};fh.prototype.kd=function(a,b){var c=fh.f.kd.call(this,a);if(c){var d;if(d=!b){d=c.creation;var e=c.expiration;d=!!e&&e<z()||!!d&&d>z()}if(d)fh.prototype.remove.call(this,a);else return c}};function gh(a){this.a=a}A(gh,fh);function hh(){}A(hh,ah);hh.prototype.da=function(){var a=0;Gd(this.Lb(!0),function(){a++});return a};hh.prototype.clear=function(){var a=Hd(this.Lb(!0)),b=this;bb(a,function(a){b.remove(a)})};function ih(a,b){this.a=a;this.Af=Sg(b);this.Lg=new cg}A(ih,gh);h=ih.prototype;h.Af=null;h.Lg=null;
function jh(a,b){var c=new Wg;c.update(Sg(b));c.update(a.Af);c=c.d();if(!fa(c))throw Error("encodeByteArray takes an array as a parameter");if(!Yg){Yg={};Zg={};for(var d=0;65>d;d++)Yg[d]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d),Zg[d]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(d)}for(var d=Zg,e=[],f=0;f<c.length;f+=3){var g=c[f],k=f+1<c.length,l=k?c[f+1]:0,m=f+2<c.length,n=m?c[f+2]:0,p=g>>2,g=(g&3)<<4|l>>4,l=(l&15)<<2|n>>6,n=n&63;
m||(n=64,k||(l=64));e.push(d[p],d[g],d[l],d[n])}return e.join("")}
function kh(a,b,c,d){if(!(0<b.length))throw Error("Non-empty salt must be provided");var e=new Wg;e.update(Sg(c));e.update(b);e.update(a.Af);a=new Ug;var e=e.d(),f;f||(f=e.length);b=a.c;for(c=0;256>c;++c)b[c]=c;var g=0;for(c=0;256>c;++c){var g=g+b[c]+e[c%f]&255,k=b[c];b[c]=b[g];b[g]=k}a.a=0;a.b=0;f=a.a;e=a.b;b=a.c;for(c=0;1536>c;++c)f=f+1&255,e=e+b[f]&255,g=b[f],b[f]=b[e],b[e]=g;a.a=f;a.b=e;d=Sg(d);var l;l||(l=d.length);f=a.a;e=a.b;b=a.c;for(c=0;c<l;++c)f=f+1&255,e=e+b[f]&255,g=b[f],b[f]=b[e],b[e]=
g,d[c]^=b[b[f]+b[e]&255];a.a=f;a.b=e;if(8192>d.length)l=String.fromCharCode.apply(null,d);else for(l="",a=0;a<d.length;a+=8192)l+=String.fromCharCode.apply(null,qb(d,a,a+8192));return l}h.set=function(a,b,c){if(t(b)){for(var d=[],e=0;8>e;++e)d[e]=Math.floor(256*Math.random());e=[];dg(this.Lg,b,e);b=new ch(kh(this,d,a,e.join("")));b.salt=d;ih.f.set.call(this,jh(this,a),b,c)}else ih.prototype.remove.call(this,a)};
h.kd=function(a,b){var c=ih.f.kd.call(this,jh(this,a),b);if(c){var d=eh(c),e=c.salt;if(!v(d)||!u(e)||!e.length)throw"Storage: Invalid value was encountered";d=kh(this,e,a,d);try{c.data=ag(d)}catch(f){throw"Storage: The value could not be decrypted";}return c}};h.remove=function(a){ih.f.remove.call(this,jh(this,a))};function lh(a){this.a=a}A(lh,hh);h=lh.prototype;h.set=function(a,b){try{this.a.setItem(a,b)}catch(c){if(0==this.a.length)throw"Storage mechanism: Storage disabled";throw"Storage mechanism: Quota exceeded";}};h.get=function(a){a=this.a.getItem(a);if(!v(a)&&null!==a)throw"Storage mechanism: Invalid value was encountered";return a};h.remove=function(a){this.a.removeItem(a)};h.da=function(){return this.a.length};
h.Lb=function(a){var b=0,c=this.a,d=new Ed;d.next=function(){if(b>=c.length)throw Dd;var d=c.key(b++);if(a)return d;d=c.getItem(d);if(!v(d))throw"Storage mechanism: Invalid value was encountered";return d};return d};h.clear=function(){this.a.clear()};h.key=function(a){return this.a.key(a)};function mh(){var a=null;try{a=window.localStorage||null}catch(b){}this.a=a}A(mh,lh);function nh(){this.b=-1;this.b=64;this.a=Array(4);this.h=Array(this.b);this.e=this.c=0;this.t()}A(nh,Vg);nh.prototype.t=function(){this.a[0]=1732584193;this.a[1]=4023233417;this.a[2]=2562383102;this.a[3]=271733878;this.e=this.c=0};
function oh(a,b,c){c||(c=0);var d=Array(16);if(v(b))for(var e=0;16>e;++e)d[e]=b.charCodeAt(c++)|b.charCodeAt(c++)<<8|b.charCodeAt(c++)<<16|b.charCodeAt(c++)<<24;else for(e=0;16>e;++e)d[e]=b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24;b=a.a[0];c=a.a[1];var e=a.a[2],f=a.a[3],g=0,g=b+(f^c&(e^f))+d[0]+3614090360&4294967295;b=c+(g<<7&4294967295|g>>>25);g=f+(e^b&(c^e))+d[1]+3905402710&4294967295;f=b+(g<<12&4294967295|g>>>20);g=e+(c^f&(b^c))+d[2]+606105819&4294967295;e=f+(g<<17&4294967295|g>>>15);g=c+(b^e&(f^b))+
d[3]+3250441966&4294967295;c=e+(g<<22&4294967295|g>>>10);g=b+(f^c&(e^f))+d[4]+4118548399&4294967295;b=c+(g<<7&4294967295|g>>>25);g=f+(e^b&(c^e))+d[5]+1200080426&4294967295;f=b+(g<<12&4294967295|g>>>20);g=e+(c^f&(b^c))+d[6]+2821735955&4294967295;e=f+(g<<17&4294967295|g>>>15);g=c+(b^e&(f^b))+d[7]+4249261313&4294967295;c=e+(g<<22&4294967295|g>>>10);g=b+(f^c&(e^f))+d[8]+1770035416&4294967295;b=c+(g<<7&4294967295|g>>>25);g=f+(e^b&(c^e))+d[9]+2336552879&4294967295;f=b+(g<<12&4294967295|g>>>20);g=e+(c^f&
(b^c))+d[10]+4294925233&4294967295;e=f+(g<<17&4294967295|g>>>15);g=c+(b^e&(f^b))+d[11]+2304563134&4294967295;c=e+(g<<22&4294967295|g>>>10);g=b+(f^c&(e^f))+d[12]+1804603682&4294967295;b=c+(g<<7&4294967295|g>>>25);g=f+(e^b&(c^e))+d[13]+4254626195&4294967295;f=b+(g<<12&4294967295|g>>>20);g=e+(c^f&(b^c))+d[14]+2792965006&4294967295;e=f+(g<<17&4294967295|g>>>15);g=c+(b^e&(f^b))+d[15]+1236535329&4294967295;c=e+(g<<22&4294967295|g>>>10);g=b+(e^f&(c^e))+d[1]+4129170786&4294967295;b=c+(g<<5&4294967295|g>>>
27);g=f+(c^e&(b^c))+d[6]+3225465664&4294967295;f=b+(g<<9&4294967295|g>>>23);g=e+(b^c&(f^b))+d[11]+643717713&4294967295;e=f+(g<<14&4294967295|g>>>18);g=c+(f^b&(e^f))+d[0]+3921069994&4294967295;c=e+(g<<20&4294967295|g>>>12);g=b+(e^f&(c^e))+d[5]+3593408605&4294967295;b=c+(g<<5&4294967295|g>>>27);g=f+(c^e&(b^c))+d[10]+38016083&4294967295;f=b+(g<<9&4294967295|g>>>23);g=e+(b^c&(f^b))+d[15]+3634488961&4294967295;e=f+(g<<14&4294967295|g>>>18);g=c+(f^b&(e^f))+d[4]+3889429448&4294967295;c=e+(g<<20&4294967295|
g>>>12);g=b+(e^f&(c^e))+d[9]+568446438&4294967295;b=c+(g<<5&4294967295|g>>>27);g=f+(c^e&(b^c))+d[14]+3275163606&4294967295;f=b+(g<<9&4294967295|g>>>23);g=e+(b^c&(f^b))+d[3]+4107603335&4294967295;e=f+(g<<14&4294967295|g>>>18);g=c+(f^b&(e^f))+d[8]+1163531501&4294967295;c=e+(g<<20&4294967295|g>>>12);g=b+(e^f&(c^e))+d[13]+2850285829&4294967295;b=c+(g<<5&4294967295|g>>>27);g=f+(c^e&(b^c))+d[2]+4243563512&4294967295;f=b+(g<<9&4294967295|g>>>23);g=e+(b^c&(f^b))+d[7]+1735328473&4294967295;e=f+(g<<14&4294967295|
g>>>18);g=c+(f^b&(e^f))+d[12]+2368359562&4294967295;c=e+(g<<20&4294967295|g>>>12);g=b+(c^e^f)+d[5]+4294588738&4294967295;b=c+(g<<4&4294967295|g>>>28);g=f+(b^c^e)+d[8]+2272392833&4294967295;f=b+(g<<11&4294967295|g>>>21);g=e+(f^b^c)+d[11]+1839030562&4294967295;e=f+(g<<16&4294967295|g>>>16);g=c+(e^f^b)+d[14]+4259657740&4294967295;c=e+(g<<23&4294967295|g>>>9);g=b+(c^e^f)+d[1]+2763975236&4294967295;b=c+(g<<4&4294967295|g>>>28);g=f+(b^c^e)+d[4]+1272893353&4294967295;f=b+(g<<11&4294967295|g>>>21);g=e+(f^
b^c)+d[7]+4139469664&4294967295;e=f+(g<<16&4294967295|g>>>16);g=c+(e^f^b)+d[10]+3200236656&4294967295;c=e+(g<<23&4294967295|g>>>9);g=b+(c^e^f)+d[13]+681279174&4294967295;b=c+(g<<4&4294967295|g>>>28);g=f+(b^c^e)+d[0]+3936430074&4294967295;f=b+(g<<11&4294967295|g>>>21);g=e+(f^b^c)+d[3]+3572445317&4294967295;e=f+(g<<16&4294967295|g>>>16);g=c+(e^f^b)+d[6]+76029189&4294967295;c=e+(g<<23&4294967295|g>>>9);g=b+(c^e^f)+d[9]+3654602809&4294967295;b=c+(g<<4&4294967295|g>>>28);g=f+(b^c^e)+d[12]+3873151461&4294967295;
f=b+(g<<11&4294967295|g>>>21);g=e+(f^b^c)+d[15]+530742520&4294967295;e=f+(g<<16&4294967295|g>>>16);g=c+(e^f^b)+d[2]+3299628645&4294967295;c=e+(g<<23&4294967295|g>>>9);g=b+(e^(c|~f))+d[0]+4096336452&4294967295;b=c+(g<<6&4294967295|g>>>26);g=f+(c^(b|~e))+d[7]+1126891415&4294967295;f=b+(g<<10&4294967295|g>>>22);g=e+(b^(f|~c))+d[14]+2878612391&4294967295;e=f+(g<<15&4294967295|g>>>17);g=c+(f^(e|~b))+d[5]+4237533241&4294967295;c=e+(g<<21&4294967295|g>>>11);g=b+(e^(c|~f))+d[12]+1700485571&4294967295;b=c+
(g<<6&4294967295|g>>>26);g=f+(c^(b|~e))+d[3]+2399980690&4294967295;f=b+(g<<10&4294967295|g>>>22);g=e+(b^(f|~c))+d[10]+4293915773&4294967295;e=f+(g<<15&4294967295|g>>>17);g=c+(f^(e|~b))+d[1]+2240044497&4294967295;c=e+(g<<21&4294967295|g>>>11);g=b+(e^(c|~f))+d[8]+1873313359&4294967295;b=c+(g<<6&4294967295|g>>>26);g=f+(c^(b|~e))+d[15]+4264355552&4294967295;f=b+(g<<10&4294967295|g>>>22);g=e+(b^(f|~c))+d[6]+2734768916&4294967295;e=f+(g<<15&4294967295|g>>>17);g=c+(f^(e|~b))+d[13]+1309151649&4294967295;
c=e+(g<<21&4294967295|g>>>11);g=b+(e^(c|~f))+d[4]+4149444226&4294967295;b=c+(g<<6&4294967295|g>>>26);g=f+(c^(b|~e))+d[11]+3174756917&4294967295;f=b+(g<<10&4294967295|g>>>22);g=e+(b^(f|~c))+d[2]+718787259&4294967295;e=f+(g<<15&4294967295|g>>>17);g=c+(f^(e|~b))+d[9]+3951481745&4294967295;a.a[0]=a.a[0]+b&4294967295;a.a[1]=a.a[1]+(e+(g<<21&4294967295|g>>>11))&4294967295;a.a[2]=a.a[2]+e&4294967295;a.a[3]=a.a[3]+f&4294967295}
nh.prototype.update=function(a,b){t(b)||(b=a.length);for(var c=b-this.b,d=this.h,e=this.c,f=0;f<b;){if(0==e)for(;f<=c;)oh(this,a,f),f+=this.b;if(v(a))for(;f<b;){if(d[e++]=a.charCodeAt(f++),e==this.b){oh(this,d);e=0;break}}else for(;f<b;)if(d[e++]=a[f++],e==this.b){oh(this,d);e=0;break}}this.c=e;this.e+=b};
nh.prototype.d=function(){var a=Array((56>this.c?this.b:2*this.b)-this.c);a[0]=128;for(var b=1;b<a.length-8;++b)a[b]=0;for(var c=8*this.e,b=a.length-8;b<a.length;++b)a[b]=c&255,c/=256;this.update(a);a=Array(16);for(b=c=0;4>b;++b)for(var d=0;32>d;d+=8)a[c++]=this.a[b]>>>d&255;return a};function ph(a,b,c){tc.call(this);this.c=a;this.h=b||0;this.a=c;this.e=oa(this.d,this)}A(ph,tc);ph.prototype.b=0;ph.prototype.u=function(){ph.f.u.call(this);this.stop();delete this.c;delete this.a};function qh(a){a.stop();a.b=$f(a.e,t(void 0)?void 0:a.h)}ph.prototype.stop=function(){0!=this.b&&r.clearTimeout(this.b);this.b=0};function rh(a){a.stop();a.d()}ph.prototype.d=function(){this.b=0;this.c&&this.c.call(this.a)};function sh(a,b,c){tc.call(this);this.d=a;this.c=b;this.a=c;this.b=oa(this.pj,this)}A(sh,tc);h=sh.prototype;h.De=!1;h.ba=null;function th(a){a.ba?a.De=!0:uh(a)}h.stop=function(){this.ba&&(r.clearTimeout(this.ba),this.ba=null,this.De=!1)};h.u=function(){sh.f.u.call(this);this.stop()};h.pj=function(){this.ba=null;this.De&&(this.De=!1,uh(this))};function uh(a){a.ba=$f(a.b,a.c);a.d.call(a.a)};L("ydn");var vh=Math.pow(2,3),wh=Math.pow(2,6);function xh(){F.call(this);this.key=this.a=void 0}A(xh,F);function yh(a,b,c){if("boolean"!=typeof c)throw Error("Invalid value");if("number"!=typeof b||0>b)throw Error("Invalid state");"undefined"==typeof a.a&&(a.a=0);a.a=c?a.a|b:a.a&~b}function zh(a){yh(a,vh,!0);$f(function(){this.dispatchEvent(Ah)},0,a)}var Ah="a";function Bh(a,b,c){E.call(this,a,b);this.url=c}A(Bh,E);L("ydn");function Ch(a){return!v(a)||ya(a)?{}:JSON.parse(a)}function Dh(a){var b;try{b=Eh(a)}catch(c){b=""}return b?b.substr(0,70)+(70<b.length?"...":""):""}function Eh(a){return JSON.stringify(a,void 0,void 0)};var Fh=!D||D&&9<=Lc,Gh=!Bc&&!D||D&&D&&9<=Lc||Bc&&Jc("1.9.1"),Hh=D&&!Jc("9");function Ih(a,b){this.x=t(a)?a:0;this.y=t(b)?b:0}h=Ih.prototype;h.clone=function(){return new Ih(this.x,this.y)};h.toString=function(){return"("+this.x+", "+this.y+")"};function Jh(a,b){return new Ih(a.x-b.x,a.y-b.y)}h.ceil=function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this};h.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};h.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};function Kh(a,b){this.width=a;this.height=b}h=Kh.prototype;h.clone=function(){return new Kh(this.width,this.height)};h.toString=function(){return"("+this.width+" x "+this.height+")"};h.Ma=function(){return!(this.width*this.height)};h.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};h.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};
h.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function Lh(a){return a?new Mh(Nh(a)):ua||(ua=new Mh)}function Oh(a,b){var c=b||document,d=null;c.querySelectorAll&&c.querySelector?d=c.querySelector("."+a):d=Ph(document,"*",a,b)[0];return d||null}
function Ph(a,b,c,d){a=d||a;b=b&&"*"!=b?b.toUpperCase():"";if(a.querySelectorAll&&a.querySelector&&(b||c))return a.querySelectorAll(b+(c?"."+c:""));if(c&&a.getElementsByClassName){a=a.getElementsByClassName(c);if(b){d={};for(var e=0,f=0,g;g=a[f];f++)b==g.nodeName&&(d[e++]=g);d.length=e;return d}return a}a=a.getElementsByTagName(b||"*");if(c){d={};for(f=e=0;g=a[f];f++)b=g.className,"function"==typeof b.split&&jb(b.split(/\s+/),c)&&(d[e++]=g);d.length=e;return d}return a}
function Qh(a,b){Ab(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in Rh?a.setAttribute(Rh[d],b):va(d,"aria-")||va(d,"data-")?a.setAttribute(d,b):a[d]=b})}var Rh={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};
function Sh(a){a=(a||window).document;a="CSS1Compat"==a.compatMode?a.documentElement:a.body;return new Kh(a.clientWidth,a.clientHeight)}function Th(a){return Cc||"CSS1Compat"!=a.compatMode?a.body||a.documentElement:a.documentElement}function Uh(a){return a?Vh(a):window}function Vh(a){return a.parentWindow||a.defaultView}function Wh(a,b,c,d){function e(c){c&&b.appendChild(v(c)?a.createTextNode(c):c)}for(;d<c.length;d++){var f=c[d];!fa(f)||x(f)&&0<f.nodeType?e(f):bb(Xh(f)?nb(f):f,e)}}
function Yh(a,b){Wh(Nh(a),a,arguments,1)}function Zh(a){for(var b;b=a.firstChild;)a.removeChild(b)}function $h(a,b){b.parentNode&&b.parentNode.insertBefore(a,b)}function ai(a){return a&&a.parentNode?a.parentNode.removeChild(a):null}function bi(a){return x(a)&&1==a.nodeType}function ci(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}
function Nh(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function ei(a,b){if("textContent"in a)a.textContent=b;else if(3==a.nodeType)a.data=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else Zh(a),a.appendChild(Nh(a).createTextNode(String(b)))}var fi={SCRIPT:1,STYLE:1,HEAD:1,IFRAME:1,OBJECT:1},gi={IMG:" ",BR:"\n"};function hi(a,b){b?a.tabIndex=0:(a.tabIndex=-1,a.removeAttribute("tabIndex"))}
function ii(a){a=a.getAttributeNode("tabindex");return null!=a&&a.specified}function ji(a){a=a.tabIndex;return ha(a)&&0<=a&&32768>a}function ki(a){if(Hh&&"innerText"in a)a=a.innerText.replace(/(\r\n|\r|\n)/g,"\n");else{var b=[];li(a,b,!0);a=b.join("")}a=a.replace(/ \xAD /g," ").replace(/\xAD/g,"");a=a.replace(/\u200B/g,"");Hh||(a=a.replace(/ +/g," "));" "!=a&&(a=a.replace(/^\s*/,""));return a}function mi(a){var b=[];li(a,b,!1);return b.join("")}
function li(a,b,c){if(!(a.nodeName in fi))if(3==a.nodeType)c?b.push(String(a.nodeValue).replace(/(\r\n|\r|\n)/g,"")):b.push(a.nodeValue);else if(a.nodeName in gi)b.push(gi[a.nodeName]);else for(a=a.firstChild;a;)li(a,b,c),a=a.nextSibling}function Xh(a){if(a&&"number"==typeof a.length){if(x(a))return"function"==typeof a.item||"string"==typeof a.item;if(ia(a))return"function"==typeof a.item}return!1}
function ni(a,b,c){if(!b&&!c)return null;var d=b?b.toUpperCase():null;return oi(a,function(a){return(!d||a.nodeName==d)&&(!c||v(a.className)&&jb(a.className.split(/\s+/),c))})}function oi(a,b){for(var c=0;a;){if(b(a))return a;a=a.parentNode;c++}return null}function Mh(a){this.a=a||r.document||document}h=Mh.prototype;h.g=function(a){return v(a)?this.a.getElementById(a):a};h.setProperties=Qh;
h.j=function(a,b,c){var d=this.a,e=arguments,f=e[0],g=e[1];if(!Fh&&g&&(g.name||g.type)){f=["<",f];g.name&&f.push(' name="',Ca(g.name),'"');if(g.type){f.push(' type="',Ca(g.type),'"');var k={};Hb(k,g);delete k.type;g=k}f.push(">");f=f.join("")}f=d.createElement(f);g&&(v(g)?f.className=g:u(g)?f.className=g.join(" "):Qh(f,g));2<e.length&&Wh(d,f,e,2);return f};h.createElement=function(a){return this.a.createElement(a)};function pi(a,b){return a.a.createTextNode(String(b))}
function qi(a){return"CSS1Compat"==a.a.compatMode}function ri(a){var b=a.a;a=Th(b);b=Vh(b);return D&&Jc("10")&&b.pageYOffset!=a.scrollTop?new Ih(a.scrollLeft,a.scrollTop):new Ih(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}h.appendChild=function(a,b){a.appendChild(b)};h.ih=$h;h.$g=ai;h.getChildren=function(a){return Gh&&void 0!=a.children?a.children:cb(a.childNodes,function(a){return 1==a.nodeType})};h.cj=bi;h.contains=ci;function si(a,b){if(b&&!a)throw Error("Can't create document with namespace and no root tag");if(document.implementation&&document.implementation.createDocument)return document.implementation.createDocument(b||"",a||"",null);if("undefined"!=typeof ActiveXObject){var c=ti();if(c)return a&&c.appendChild(c.createNode(1,a,b||"")),c}throw Error("Your browser does not support creating new documents");}
function ui(a){if("undefined"!=typeof DOMParser)return(new DOMParser).parseFromString(a,"application/xml");if("undefined"!=typeof ActiveXObject){var b=ti();b.loadXML(a);return b}throw Error("Your browser does not support loading xml documents");}function vi(a){if("undefined"!=typeof XMLSerializer)return(new XMLSerializer).serializeToString(a);if(a=a.xml)return a;throw Error("Your browser does not support serializing XML documents");}
function ti(){var a=new ActiveXObject("MSXML2.DOMDocument");if(a){a.resolveExternals=!1;a.validateOnParse=!1;try{a.setProperty("ProhibitDTD",!0),a.setProperty("MaxXMLSize",2048),a.setProperty("MaxElementDepth",256)}catch(b){}}return a};function wi(a){Error.captureStackTrace?Error.captureStackTrace(this,wi):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ArgumentException"}A(wi,Error);function xi(a){Error.captureStackTrace?Error.captureStackTrace(this,xi):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotSupportedException"}A(wi,Error);xi.prototype.name="ydn.error.NotSupportedException";
function yi(a){Error.captureStackTrace?Error.captureStackTrace(this,yi):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotImplementedException"}A(yi,Error);function zi(a){Error.captureStackTrace?Error.captureStackTrace(this,zi):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}A(zi,Error);zi.prototype.name="ydn.InternalError";
function Ai(a){Error.captureStackTrace?Error.captureStackTrace(this,Ai):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ConstraintError"}A(Ai,Error);Ai.prototype.name="ydn.error.ConstraintError";function Bi(a){Error.captureStackTrace?Error.captureStackTrace(this,Bi):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationException"}A(wi,Error);
function Ci(a){Error.captureStackTrace?Error.captureStackTrace(this,Ci):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationError"}A(Ci,Error);var Di,Ei,Fi,Gi;Gi=Fi=Ei=Di=!1;var Hi=xb;Hi&&(-1!=Hi.indexOf("Firefox")?Di=!0:-1!=Hi.indexOf("Camino")||(-1!=Hi.indexOf("iPhone")||-1!=Hi.indexOf("iPod")?Ei=!0:-1!=Hi.indexOf("iPad")?Fi=!0:-1!=Hi.indexOf("Chrome")?Gi=!0:-1!=Hi.indexOf("Android")||Hi.indexOf("Safari")));var Ii=Di,Ji=Ei,Ki=Fi,Li=Gi;function Mi(a){if(!u(a))throw new wi("Array required.");if(t(void 0))return a=db(a,function(a){return a[void 0]}),Mi(a);for(var b=Number.NaN,c=-1,d=0;d<a.length;d++)!isNaN(a[d])&&(isNaN(b)||a[d]>b)&&(b=a[d],c=d);return{value:b,index:c}};function Ni(){xh.call(this);this.b=null;ed(this,"user-login",this.xh,!1,this);ed(this,"user-logout",this.xh,!1,this);this.i=window.top.location.href.replace(/[?#]\S+/,"")}A(Ni,xh);h=Ni.prototype;h.logger=L("ydn.api.AbstractUser");h.xh=function(){this.display?(this.display.c(this.email||""),this.isLogin()?this.e&&this.display.b(this.e):this.d&&this.display.a(this.d),ke(this.logger,"Refreshed.")):ke(this.logger,"No UI refreshed.")};
h.toJSON=function(){return{nickname:this.h,email:this.email,is_login:this.b,login_url:this.d,logout_url:this.e,user_id:this.user_id}};h.isLogin=function(){return!0===this.b};h.toString=function(){return"User:"+(!0===this.b?this.email:!1===this.b?"logout":"?")};h.vd=0;
h.hi=function(){if(this.isLogin())this.c.stop();else if(1<this.vd)ie(this.logger,"Cannot login to the API server, tried "+this.vd+" times."),this.c.stop(),this.vd=0;else{this.vd++;je(this.logger,"Sending login request.");var a=Oi(Pi),b=window.top.location.href.replace(/[?#]\S+/,"");a.request(new Qi("/rpc_login","GET",{url:b})).execute(oa(this.l,this))}};h.refresh=function(a){!a&&this.isLogin()?ke(this.logger,"Already login"):(this.c||(this.c=new sh(this.hi,5E3,this)),this.vd=0,th(this.c))};
function Ri(a,b,c){Bh.call(this,a,b,c)}A(Ri,Bh);function Si(){Ni.call(this)}A(Si,Ni);da(Si);Si.prototype.logger=L("ydn.api.User");
Si.prototype.load=function(a){je(this.logger,"getting user info");if(a.logout_url)return this.h=a.nickname,this.email=a.email,this.user_id=a.user_id,this.b=a.is_login,this.e=a.logout_url,this.d=a.login_url,je(this.logger,a.email+" login"),this.e=a.logout_url,this.user_id=a.Id?a.Id.$t:void 0,this.b=!0,this.d=void 0,yh(this,wh,!0),zh(this),!0;a.login_url&&(je(this.logger,"NO user"),this.d=a.login_url,this.b=!1,this.email=this.user_id=this.e=this.h=void 0,yh(this,wh,!0),zh(this));return!1};
Si.prototype.l=function(a,b){ke(this.logger,"Receiving "+(Ti(b)?"":"fail")+" login info from server.");if(Ti(b)){var c=a.User;if(c){var d;d=this.load(c)?new Ri("user-login",this,this.e):new Ri("user-logout",this,this.d);$f(function(){this.dispatchEvent(d)},0,this)}}else ie(this.logger,"Server return error with: "+b.Da());this.c&&this.c.stop()};
function Ui(a,b){var c=new B,d=Oi(Pi);if(!d)return C("login server not available.");var e={pm:a.i,state:Math.random().toString().substr(2,6)};if(b)for(var f in b)e[f]=b[f];d.request(new Qi("/rpc_login","GET",e)).execute(function(a,b){if(a){var d=a.User;this.load(d);c.callback(d)}else c.p(b)},a);return c};function Vi(){this.a=z()}var Wi=new Vi;Vi.prototype.set=function(a){this.a=a};Vi.prototype.get=function(){return this.a};function Xi(a){this.e=a||"";this.h=Wi}Xi.prototype.c=!0;Xi.prototype.a=!0;Xi.prototype.b=!1;function Yi(a){a=new Date(a.e);return Zi(a.getFullYear()-2E3)+Zi(a.getMonth()+1)+Zi(a.getDate())+" "+Zi(a.getHours())+":"+Zi(a.getMinutes())+":"+Zi(a.getSeconds())+"."+Zi(Math.floor(a.getMilliseconds()/10))}function Zi(a){return 10>a?"0"+a:String(a)}function $i(a,b){var c=(a.e-b)/1E3,d=c.toFixed(3),e=0;if(1>c)e=2;else for(;100>c;)e++,c*=10;for(;0<e--;)d=" "+d;return d}function aj(a){Xi.call(this,a)}A(aj,Xi);
aj.prototype.b=!0;aj.prototype.d=function(a){var b;switch(a.d.value){case Xd.value:b="dbg-sh";break;case Yd.value:b="dbg-sev";break;case Zd.value:b="dbg-w";break;case $d.value:b="dbg-i";break;default:b="dbg-f"}var c=[];c.push(this.e," ");this.a&&c.push("[",Yi(a),"] ");c.push("[",Ma($i(a,this.h.get())),"s] ");c.push("[",Ca(a.b),"] ");c.push('<span class="',b,'">',Ba(Ma(Ca(a.getMessage()))));this.b&&a.c&&c.push("<br>",Ba(Ma(a.a||"")));c.push("</span>");this.c&&c.push("<br>");return c.join("")};
function bj(a){Xi.call(this,a)}A(bj,Xi);bj.prototype.d=function(a){var b=[];b.push(this.e," ");this.a&&b.push("[",Yi(a),"] ");b.push("[",$i(a,this.h.get()),"s] ");b.push("[",a.b,"] ");b.push(a.getMessage());this.b&&a.c&&b.push("\n",a.a);this.c&&b.push("\n");return b.join("")};function cj(){this.d=oa(this.h,this);this.a=new bj;this.a.a=!1;this.a.b=!1;this.b=this.a.c=!1;this.c="";this.e={}}function dj(a){var b=ej;if(a!=b.b){var c=oe();a?ge(c,b.d):(c=c.a)&&lb(c,b.d);b.b=a}}cj.prototype.h=function(a){if(!this.e[a.b]){var b=this.a.d(a),c=fj;if(c)switch(a.d){case Xd:gj(c,"info",b);break;case Yd:gj(c,"error",b);break;case Zd:gj(c,"warn",b);break;default:gj(c,"debug",b)}else this.c+=b}};var fj=r.console;function gj(a,b,c){if(a[b])a[b](c);else a.log(c)};function hj(){return Cc?"Webkit":Bc?"Moz":D?"ms":Ac?"O":null};function ij(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}h=ij.prototype;h.getHeight=function(){return this.bottom-this.top};h.clone=function(){return new ij(this.top,this.right,this.bottom,this.left)};h.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"};
h.contains=function(a){return this&&a?a instanceof ij?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom:!1};h.ceil=function(){this.top=Math.ceil(this.top);this.right=Math.ceil(this.right);this.bottom=Math.ceil(this.bottom);this.left=Math.ceil(this.left);return this};
h.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};h.round=function(){this.top=Math.round(this.top);this.right=Math.round(this.right);this.bottom=Math.round(this.bottom);this.left=Math.round(this.left);return this};function jj(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}h=jj.prototype;h.clone=function(){return new jj(this.left,this.top,this.width,this.height)};h.toString=function(){return"("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+"h)"};h.contains=function(a){return a instanceof jj?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};
h.ceil=function(){this.left=Math.ceil(this.left);this.top=Math.ceil(this.top);this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};h.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};h.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function kj(a,b){var c=Nh(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,null))?c[b]||c.getPropertyValue(b)||"":""}function lj(a,b){return kj(a,b)||(a.currentStyle?a.currentStyle[b]:null)||a.style&&a.style[b]}function mj(a){return lj(a,"position")}function nj(a,b,c){var d,e=Bc&&(xc||yc)&&Jc("1.9");b instanceof Ih?(d=b.x,b=b.y):(d=b,b=c);a.style.left=oj(d,e);a.style.top=oj(b,e)}
function pj(a){var b;try{b=a.getBoundingClientRect()}catch(c){return{left:0,top:0,right:0,bottom:0}}D&&a.ownerDocument.body&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function qj(a){if(D&&!(D&&8<=Lc))return a.offsetParent;var b=Nh(a),c=lj(a,"position"),d="fixed"==c||"absolute"==c;for(a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=lj(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return null}
function rj(a){for(var b=new ij(0,Infinity,Infinity,0),c=Lh(a),d=c.a.body,e=c.a.documentElement,f=Th(c.a);a=qj(a);)if(!(D&&0==a.clientWidth||Cc&&0==a.clientHeight&&a==d)&&a!=d&&a!=e&&"visible"!=lj(a,"overflow")){var g=sj(a),k;k=a;if(Bc&&!Jc("1.9")){var l=parseFloat(kj(k,"borderLeftWidth"));if(tj(k))var m=k.offsetWidth-k.clientWidth-l-parseFloat(kj(k,"borderRightWidth")),l=l+m;k=new Ih(l,parseFloat(kj(k,"borderTopWidth")))}else k=new Ih(k.clientLeft,k.clientTop);g.x+=k.x;g.y+=k.y;b.top=Math.max(b.top,
g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=Sh(Vh(c.a));b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:null}
function sj(a){var b,c=Nh(a),d=lj(a,"position"),e=Bc&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new Ih(0,0),g;b=c?Nh(c):document;g=!D||D&&9<=Lc||qi(Lh(b))?b.documentElement:b.body;if(a==g)return f;if(a.getBoundingClientRect)b=pj(a),a=ri(Lh(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=
b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);if(Cc&&"fixed"==mj(b)){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(Ac||Cc&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=qj(b))&&b!=c.body&&b!=g;)f.x-=b.scrollLeft,Ac&&"TR"==b.tagName||(f.y-=b.scrollTop)}return f}function uj(a,b,c){if(b instanceof Kh)c=b.height,b=b.width;else if(void 0==c)throw Error("missing height argument");a.style.width=oj(b,!0);a.style.height=oj(c,!0)}
function oj(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}function vj(a){var b=wj;if("none"!=lj(a,"display"))return b(a);var c=a.style,d=c.display,e=c.visibility,f=c.position;c.visibility="hidden";c.position="absolute";c.display="inline";a=b(a);c.display=d;c.position=f;c.visibility=e;return a}function wj(a){var b=a.offsetWidth,c=a.offsetHeight,d=Cc&&!b&&!c;return t(b)&&!d||!a.getBoundingClientRect?new Kh(b,c):(a=pj(a),new Kh(a.right-a.left,a.bottom-a.top))}
function xj(a){var b=sj(a);a=vj(a);return new jj(b.x,b.y,a.width,a.height)}function yj(a,b){var c=a.style;"opacity"in c?c.opacity=b:"MozOpacity"in c?c.MozOpacity=b:"filter"in c&&(c.filter=""===b?"":"alpha(opacity="+100*b+")")}function R(a,b){a.style.display=b?"":"none"}function tj(a){return"rtl"==lj(a,"direction")}var zj=Bc?"MozUserSelect":Cc?"WebkitUserSelect":null;
function Aj(a,b,c){c=c?null:a.getElementsByTagName("*");if(zj){if(b=b?"none":"",a.style[zj]=b,c){a=0;for(var d;d=c[a];a++)d.style[zj]=b}}else if(D||Ac)if(b=b?"on":"",a.setAttribute("unselectable",b),c)for(a=0;d=c[a];a++)d.setAttribute("unselectable",b)}function Bj(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}
function Cj(a,b){var c=a.currentStyle?a.currentStyle[b]:null;return c?Bj(a,c):0}var Dj={thin:2,medium:4,thick:6};function Ej(a,b){if("none"==(a.currentStyle?a.currentStyle[b+"Style"]:null))return 0;var c=a.currentStyle?a.currentStyle[b+"Width"]:null;return c in Dj?Dj[c]:Bj(a,c)}
function Fj(a){if(D&&!(D&&9<=Lc)){var b=Ej(a,"borderLeft"),c=Ej(a,"borderRight"),d=Ej(a,"borderTop");a=Ej(a,"borderBottom");return new ij(d,c,a,b)}b=kj(a,"borderLeftWidth");c=kj(a,"borderRightWidth");d=kj(a,"borderTopWidth");a=kj(a,"borderBottomWidth");return new ij(parseFloat(d),parseFloat(c),parseFloat(a),parseFloat(b))}var Gj=/matrix\([0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, ([0-9\.\-]+)p?x?, ([0-9\.\-]+)p?x?\)/;function Hj(a){this.d=oa(this.e,this);this.a=new aj;this.b=this.a.a=!1;this.w=a;this.c=this.w.ownerDocument||this.w.document;a=Lh(this.w);var b=null,c=a.a;if(D&&c.createStyleSheet)a=b=c.createStyleSheet(),D&&t(a.cssText)?a.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":
a.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}";else{c=Ph(a.a,"head",void 0,void 0)[0];c||(b=Ph(a.a,"body",void 0,void 0)[0],c=a.j("head"),b.parentNode.insertBefore(c,b));var d=b=a.j("style");D&&t(d.cssText)?d.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":
d.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}";a.appendChild(c,b)}this.w.className+=" logdiv"}
Hj.prototype.e=function(a){var b=100>=this.w.scrollHeight-this.w.scrollTop-this.w.clientHeight,c=this.c.createElement("div");c.className="logmsg";c.innerHTML=this.a.d(a);this.w.appendChild(c);b&&(this.w.scrollTop=this.w.scrollHeight)};Hj.prototype.clear=function(){this.w.innerHTML=""};var ej=null,Ij=null;L("ydn.debug");function Jj(a,b,c){if(ha(b))b=new Wd("log",b);else if(v(b)){b=b.toUpperCase();if(!fe){fe={};for(var d=0,e;e=ee[d];d++)fe[e.value]=e,fe[e.name]=e}b=fe[b]||null}else b=be;L(a||"ydn").b=b;t(c)?Ij||(a=Ij=new Hj(c),1!=a.b&&(c=oe(),ge(c,a.d),a.b=!0),oe().b=Zd):ej||Ij||(ej=new cj,dj(!0),oe().b=Zd)}var Kj=null;function Lj(a){Kj&&setTimeout(function(){Kj.log(a)},10)};var Pi="login",Mj=L("ydn.http"),Nj={},Oj=[];var Pj,Qj={},Rj=[];function Sj(a,b){Qj[b||"default"]=a}function Oi(a){if(!t(a))return Qj["default"];for(var b=a,c=0;c<Rj.length;c++){var d=(0,Rj[c])(a);if(d){b=d;break}}return Qj[b]||null}function Tj(){Pj||(Pj=new Ng);return Pj}function Uj(a,b,c,d){v(a)?this.raw=a:(this.raw=null,this.status=a,this.body=b,this.headers=c||{},this.a=d)}function Vj(a){if(a.raw){var b=Ch(a.raw);b.gapiRequest&&(b=b.gapiRequest.data);a.status=b.status;a.a=b.statusText;a.headers=b.headers;a.body=b.body;a.raw=null}}
Uj.prototype.H=function(){Vj(this);return this.status};function Ti(a){Vj(a);return 200<=a.status&&400>a.status}Uj.prototype.Da=function(){Vj(this);return this.a||""};function Wj(a){Vj(a);return a.body}function Xj(a,b){Vj(a);return a.headers[b]}Uj.prototype.Nc=function(){Vj(this);return this.headers};
function Yj(a){var b;Vj(a);"application/json"==Xj(a,"content-type")?b=!0:(b=a.body,b=v(b)&&!ya(b)?/^[\],:{}\s]*$/.test(b.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")):!1);return b&&v(a.body)?JSON.parse(a.body):a.body}function Zj(a){return a instanceof Uj?a:v(a)?new Uj(a):new Uj(a.status,a.body,a.headers,a.statusText)}
function Qi(a,b,c,d,e){this.path=a;this.method=b?b.toUpperCase():"GET";this.params=c||{};this.headers=d||{};this.body=e}var ak=null;function bk(a,b){var c,d;2==arguments.length&&v(arguments[1])?(c=!0,d=arguments[1].split(".")):d=(c=fa(b))?b:arguments;for(c=c?0:1;c<d.length&&(a=a[d[c]],t(a));c++);return a}function ck(a,b,c){if(a)if(-1==b.indexOf("."))a[b]=c;else{b=b.split(".");for(var d=b.pop(),e;e=b.shift();)x(a[e])||(a[e]={}),a=a[e];a[d]=c}}var dk={};
function ek(a){a=[a];for(var b=new fk,c=0,d,e;void 0!==(e=a.pop());){0===c%4&&12<c+4&&(b.write(c),c=0);d=typeof e;if(e instanceof Array)if(c+=4,0<e.length){a.push(dk);for(d=e.length;d--;)a.push(e[d]);continue}else b.write(c);else if("number"===d)c+=1,b.write(c),gk(b,e);else if(e instanceof Date)c+=2,b.write(c),gk(b,e.valueOf());else if("string"===d){c+=3;b.write(c);c=b;for(d=0;d<e.length;d++){var f=e.charCodeAt(d);126>=f?c.write(f+1):16510>=f?(f-=127,c.write(128|f>>8,f&255)):c.write(192|f>>10,f>>
2|255,(f|3)<<6)}c.write(0)}else if(e===dk)b.write(0);else return"";c=0}return b.trim().toString()}function hk(a){for(var b=[],c=b,d=[],e,f,g=new ik(a);null!=g.read();)if(0===g.current)c=d.pop();else{if(null===g.current)break;do{e=g.current/4|0;a=g.current%4;for(var k=0;k<e;k++)f=[],c.push(f),d.push(c),c=f;if(0===a&&12<g.current+4)g.read();else break}while(1);1===a?c.push(jk(g)):2===a?c.push(new Date(jk(g))):3===a?c.push(kk(g)):0===a&&(c=d.pop())}return b[0]}
function gk(a,b){var c,d,e;c=b;var f=e=d=0;if(0!==c)if(isFinite(c)){0>c&&(d=1,c=-c);f=0;if(2.2250738585072014E-308<=c){for(e=c;1>e;)f--,e*=2;for(;2<=e;)f++,e/=2;e=f+1023}f=e?Math.floor(4503599627370496*(c/Math.pow(2,f)-1)):Math.floor(c/4.9E-324)}else e=2047,isNaN(c)?f=0x8000000000000:-Infinity===c&&(d=1);c=d;d=e;e=f;c&&(e=0xfffffffffffff-e,d=2047-d);a.write((c?0:128)|d>>4);a.write((d&15)<<4|0|e/281474976710656);e%=281474976710656;c=0|e/4294967296;a.write(c>>8,c&255);e%=4294967296;c=0|e/65536;a.write(c>>
8,c&255);c=e%65536;a.write(c>>8,c&255)}function jk(a){var b=a.read()|0,c=b>>7?!1:!0,d=c?-1:1,e=(b&127)<<4,b=a.read()|0,e=e+(b>>4);c&&(e=2047-e);for(var b=[c?15-(b&15):b&15],f=6;f--;)b.push(c?255-(a.read()|0):a.read()|0);a=0;for(f=7;f--;)a=a/256+b[f];a/=16;return 0===a&&0===e?0:(a+1)*Math.pow(2,e-1023)*d}
function kk(a){for(var b=[],c=0,d=0,e=0,f,g;;){f=a.read();if(0===f||null==f)break;0===c?(g=f>>6,2>g&&!isNaN(f)?b.push(String.fromCharCode(f-1)):(c=g,d=f<<10,e++)):2===c?(b.push(String.fromCharCode(d+f+127)),c=d=e=0):2===e?(d+=f<<2,e++):(b.push(String.fromCharCode(d|f>>6)),c=d=e=0)}return b.join("")}function ik(a){this.current=null;this.a=a;this.b=this.a.length-1;this.index=-1}
ik.prototype.read=function(){return this.current=this.index<this.b?parseInt(this.a[++this.index]+this.a[++this.index],16):null};function fk(){this.a=[];this.b=void 0}fk.prototype.write=function(a){for(var b=0;b<arguments.length;b++)this.b=arguments[b].toString(16),this.a.push(2===this.b.length?this.b:this.b="0"+this.b)};fk.prototype.trim=function(){for(var a=this.a.length;"00"===this.a[--a];);this.a.length=++a;return this};fk.prototype.toString=function(){return this.a.length?this.a.join(""):""};
function lk(a,b){var c=ek(a),d=ek(b);return c>d?1:c==d?0:-1};var mk={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange"},nk=r.IDBRequest&&"LOADING"in r.IDBRequest?r.IDBTransaction:r.webkitIDBRequest&&"LOADING"in r.webkitIDBRequest&&1===r.webkitIDBTransaction.READ_WRITE?r.webkitIDBTransaction:mk,ok=nk.READ_ONLY,pk=nk.READ_WRITE,qk=nk.VERSION_CHANGE,rk=r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.moz_indexedDB||r.msIndexedDB;function sk(a,b,c){se.call(this,b,c);this.Q=a;this.h=[];this.r=[];this.ta=[];this.a=null;this.$c="";this.Y=0}A(sk,se);h=sk.prototype;h.$c="";h.logger=L("ydn.db.Request");function tk(a,b,c){a.a=b;a.$c=c;Q(a.logger,a+" BEGIN");if(b){for(c=0;c<a.r.length;c++)a.r[c][0].call(a.r[c][1],b);a.r.length=0}}function uk(a){var b=new sk(a.Q);a.Y++;tk(b,a.a,a.$c+"C"+a.Y);return b}function vk(a){Q(a.logger,a+" END");a.a=null}h.de=function(){return this.Q};
h.abort=function(){Q(this.logger,this+" aborting "+this.a);if(this.a)if(ia(this.a.abort))this.a.abort();else if(ia(this.a.executeSql))this.a.executeSql("ABORT",[],function(){},function(){return!0});else throw new xd;else throw new wk(this+" No active transaction");};function S(a,b,c){var d=a.ta.shift();c=!!c;d?d[0].call(d[1],b,c,function(b,c){S(a,b,c)}):c?a.p(b):a.callback(b)}function xk(a,b,c){a.ta.push([b,c])}function T(a,b,c){a.a?b.call(c,a.a):a.r.push([b,c])}
h.callback=function(a){Q(this.logger,this+" SUCCESS");sk.f.callback.call(this,a)};h.p=function(a){Q(this.logger,this+" ERROR");sk.f.p.call(this,a)};h.state=function(){return this.b?this.e?"rejected":"resolved":"pending"};function yk(a){var b="";a.$c&&(b=a.a?"*":"",b="["+a.$c+b+"]");return a.Q+b}function zk(a,b){var c=new sk(a);S(c,b);return c}h.toString=function(){return"Request:"+yk(this)};
h.mf=function(){this.i&&this.b&&oc(this)&&(pc(this.i),this.i=0);this.c&&(this.c.C--,delete this.c);for(var a=this.d,b=!1;this.t.length&&!this.l;){var c=this.t.shift(),d=c[0],e=c[1],c=c[2];if(d=this.e?e:d)d=d.call(c||this.F,a),t(d)&&(this.e=this.e&&(d==a||d instanceof Error),this.d=a=d),sa(a)&&(this.l=b=!0)}this.d=a;b&&(b=oa(this.Sd,this,!0),d=oa(this.Sd,this,!1),a instanceof B?(a.m(b,d),a.T=!0):a.then(b,d))};
h.toJSON=function(){var a=(this.$c||"").match(/B(\d+)T(\d+)(?:Q(\d+?))?(?:R(\d+))?/)||[];return{method:this.Q?this.Q.split(":"):[],branchNo:parseFloat(a[1]),transactionNo:parseFloat(a[2]),queueNo:parseFloat(a[3]),requestNo:parseFloat(a[4])}};var Ak=rk&&rk.cmp?oa(rk.cmp,rk):lk,Bk=[];function Ck(a,b,c){var d;if(x(a))d=a.store,b=a.id,null!=a.parent&&(c=new Ck(a.parent));else if(t(b))d=a;else if(d=a.lastIndexOf("^|"),b=a,0<d&&(b=a.substr(d),c=new Ck(a.substring(0,d))),b=b.split("^:"),d=b[0],b=b[1],!t(b))throw Error("Invalid key value: "+a);this.N=d;this.id=b;this.parent=c||null}h=Ck.prototype;h.toJSON=function(){var a={store:this.N,id:this.id};this.parent&&(a.parent=this.parent.toJSON());return a};
h.valueOf=function(){return(this.parent?this.parent.valueOf()+"^|":"")+this.N+"^:"+this.id};h.toString=function(){return this.valueOf().replace("^|","|").replace("^:",":")};h.D=function(){return this.N};h.s=function(){return this.id};function Dk(a){return u(a.id)?a.id.join("^|"):a.id instanceof Date?+a.id:a.id}function Ek(a){return null!=a?ha(a)||v(a)||a instanceof Date||u(a)&&fb(a,Ek):!1}function Fk(a){if(fa(a)){for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}return a};function U(a,b,c,d){this.lower=a;this.upper=b;this.lowerOpen=!!c;this.upperOpen=!!d;ia(Object.freeze)&&Object.freeze(this)}U.prototype.lower=void 0;U.prototype.upper=void 0;U.prototype.toJSON=function(){return Gk(this)};function Hk(a){return Ik(a)}U.only=function(a){return new U(a,a,!1,!1)};U.bound=function(a,b,c,d){return new U(a,b,c,d)};U.upperBound=function(a,b){return new U(void 0,a,void 0,!!b)};U.lowerBound=function(a,b){return new U(a,void 0,!!b,void 0)};
function Lk(a){var b;if(u(a))b=nb(a),b.push("\uffff");else if(v(a))b=a+"\uffff";else if(ha(a))b=a+2.220460492503131E-16,a-=2.220460492503131E-16;else return U.only(a);return U.bound(a,b,!1,!0)}function Gk(a){a=a||{};return{lower:a.lower,upper:a.upper,lowerOpen:a.lowerOpen,upperOpen:a.upperOpen}}function Mk(a){if(null==a)return null;if(a instanceof U)return a;if(x(a))return new U(a.lower,a.upper,a.lowerOpen,a.upperOpen);throw new I("Invalid key range: "+a+" of type "+typeof a);}
function Ik(a){return null!=a?null!=a.upper&&null!=a.lower?Nk.bound(a.lower,a.upper,!!a.lowerOpen,!!a.upperOpen):null!=a.upper?Nk.upperBound(a.upper,a.upperOpen):null!=a.lower?Nk.lowerBound(a.lower,a.lowerOpen):null:null}function Ok(a){if(a instanceof U)return"";if(null!=a){if(x(a)){for(var b in a)if(a.hasOwnProperty(b)&&!jb(["lower","upper","lowerOpen","upperOpen"],b))return'invalid attribute "'+b+'" in key range object';return""}return"key range must be an object"}return""}
U.prototype.$e=function(a){var b=this.lower,c=this.upper,d=this.lowerOpen,e=this.upperOpen;null!=a.lower&&(null==this.lower||a.lower>=this.lower)&&(b=a.lower,d=a.lowerOpen||this.lowerOpen);null!=a.upper&&(null==this.upper||a.upper<=this.upper)&&(c=a.upper,e=a.upperOpen||this.upperOpen);return U.bound(b,c,d,e)};function Pk(a){if(!a)return"";var b=a.lowerOpen?"(":"[";null!=a.lower&&(b+=a.lower+", ");null!=a.upper&&(b+=a.upper);return b+=a.upperOpen?")":"]"}
function Qk(a,b,c,d,e){if(c)if(c.lowerOpen||c.upperOpen||null==c.lower||null==c.upper||0!==Ak(c.lower,c.upper)){if(null!=c.lower){var f=c.lowerOpen?" > ":" >= ";d.push(a+f+"?");e.push(Rk(c.lower,b))}null!=c.upper&&(f=c.upperOpen?" < ":" <= ",d.push(a+f+"?"),e.push(Rk(c.upper,b)))}else d.push(a+" = ?"),e.push(Rk(c.lower,b))}
function Sk(a,b,c,d){var e,f,g,k;if("starts"==a||"^"==a)return Lk(b);if("<"==a||"<="==a)e=b,g="<"==a;else if(">"==a||">="==a)f=b,k=">"==a;else if("="==a||"=="==a)e=f=b;else throw new I("invalid op: "+a);if("<"==c||"<="==c)e=d,g="<"==c;else if(">"==c||">="==c)f=d,k=">"==c;else if(t(c))throw new I("invalid op2: "+c);return U.bound(f,e,k,g)}var Nk=r.IDBKeyRange||r.webkitIDBKeyRange||U;function Tk(a){Error.captureStackTrace?Error.captureStackTrace(this,Tk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ConstraintError"}A(Tk,Error);Tk.prototype.name="ConstraintError";Tk.prototype.toString=function(){return this.name+": "+this.message};function Uk(a){Error.captureStackTrace?Error.captureStackTrace(this,Uk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.InvalidKeyException"}A(Uk,Error);
Uk.prototype.toString=function(){return this.name+": "+this.message};function Vk(a){Error.captureStackTrace?Error.captureStackTrace(this,Vk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.VersionError"}A(Vk,Error);Vk.prototype.name="ydn.db.VersionError";Vk.prototype.toString=function(){return this.name+": "+this.message};function Wk(a){Error.captureStackTrace?Error.captureStackTrace(this,Wk):this.stack=Error().stack||"";a&&(this.message=String(a))}A(Wk,Error);
Wk.prototype.name="ydn.db.InternalError";function wk(a){Error.captureStackTrace?Error.captureStackTrace(this,wk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidStateError"}A(wk,Error);function Xk(a){Error.captureStackTrace?Error.captureStackTrace(this,Xk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidAccessError"}A(Xk,Error);
function Yk(a){Error.captureStackTrace?Error.captureStackTrace(this,Yk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="NotFoundError"}A(Yk,Error);Yk.prototype.name="NotFoundError";Yk.prototype.toString=function(){return this.name+": "+this.message};function Zk(a,b){Error.captureStackTrace?Error.captureStackTrace(this,Zk):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message+" ["+a.code+"]";this.name="SQLError"}A(Zk,Error);
Zk.prototype.toString=function(){return this.name+": "+this.message};function $k(a,b){Error.captureStackTrace?Error.captureStackTrace(this,$k):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message;this.name="SecurityError"}A($k,Error);$k.prototype.toString=function(){return this.name+": "+this.message};function al(a){Error.captureStackTrace?Error.captureStackTrace(this,al):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.SqlParseError"}
A(al,Error);function bl(a){Error.captureStackTrace?Error.captureStackTrace(this,bl):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.TimeoutError"}A(bl,Error);function cl(a,b){this.a=b}cl.prototype.logger=L("ydn.db.crud.req.RequestExecuto");cl.prototype.toString=function(){return"RequestExecutor"};function dl(a){this.c=a;this.a=null;this.b=0}dl.prototype.logger=L("ydn.db.tr.Mutex");dl.prototype.cb=null;function el(a){return!!a.a&&!a.d}dl.prototype.Sa=null;dl.prototype.toString=function(){return"Mutex:"+("B"+this.c+"T"+this.b)+(this.a?"*":"")};function fl(a,b,c,d,e,f){this.F=a;this.G=b;this.a=this.e=0;this.C=d;this.Q=e;this.d=c||gl;this.t=f||0}fl.prototype.logger=L("ydn.db.tr.Thread");fl.prototype.type=function(){return hl(this.F)};fl.prototype.I=function(){return this.F};fl.prototype.Ja=function(){return"B"+this.G+"T"+this.e};var gl="single";function il(a){if(a)if(ia(a.abort))a.abort();else if(ia(a.executeSql))a.executeSql("ABORT",[],null,function(){return!0});else throw new xd;else throw new wk("No active transaction");};function jl(a,b,c,d,e,f){fl.call(this,a,b,c,d,e,f);this.c=[];this.h=[];this.i=null;this.b=new dl(b);this.l=f||0;this.r=!1}A(jl,fl);h=jl.prototype;h.logger=L("ydn.db.tr.Serial");
function kl(a,b,c){if("multi"==a.d)a:if(a=a.b,!a.cb||!a.mode||c!=a.mode&&(a.mode!=pk||c!=ok)||b.length>a.cb.length)b=!1;else{for(c=0;c<b.length;c++)if(-1==a.cb.indexOf(b[c])){b=!1;break a}b=!0}else if("repeat"==a.d)a:if(a=a.b,a.cb&&a.mode&&c==a.mode&&a.cb.length==b.length){for(c=0;c<b.length;c++)if(-1==a.cb.indexOf(b[c])){b=!1;break a}b=!0}else b=!1;else b="all"==a.d?!0:!1;return b}
function ll(a){var b=0<a.c.length?a.c[0].cb:null,c=0<a.c.length?a.c[0].mode:null;return null!=b&&null!=c?kl(a,b,c):!1}function ml(a,b,c,d,e){O(a.logger,"push tx queue["+a.c.length+"]");a.c.push({$d:b,cb:c,mode:d,Sa:e})}h.abort=function(){Q(this.logger,this+": aborting");il(this.i)};
h.zc=function(a,b,c,d){var e=v(b)?[b]:b;if(fa(e)){if(0==e.length)throw new I("number of store names must more than 0");for(var f=0;f<e.length;f++){if(!v(e[f]))throw new I("store name at "+f+" must be string but found "+e[f]+" of type "+typeof e[f]);if(this.T&&!jb(this.T,e[f]))throw new I('store name "'+f+e[f]+'" in scope of '+this);}}else throw new I("store names must be an array");var g=t(c)?c:ok,k=this;if(this.b.a||!nl(this.I())&&this.r)ml(this,a,b,g,d);else{var l=this.Ja();d&&this.h.push(d);if(this.l&&
this.e>=this.l)throw new zd("Exceed maximum number of transactions of "+this.l);this.r=!0;this.I().transaction(function(c){var d=k.b;d.a=c;d.d=!1;d.cb=b;d.mode=g;d.b++;d.Sa=null;l=k.Ja();re(k.logger,l+" BEGIN "+Eh(b)+" "+g);a(k);for(a=null;ll(k);)c=k.c.shift(),c.Sa&&k.h.push(c.Sa),O(k.logger,"pop tx queue"+(k.c.length+1)+" reusing T"+k.e),c.$d()},e,g,function(a,b){re(k.logger,l+" "+a);var c=k.b;c.a?(c.a=null,c.cb=null,c.mode=null,ia(c.Sa)&&c.Sa(a,b),c.Sa=null):M(c.logger,c+" has no TX to be unlocked for "+
a);for(c=0;c<k.h.length;c++)(0,k.h[c])(a,b);k.h.length=0;(c=k.c.shift())&&k.zc(c.$d,c.cb,c.mode,c.Sa);k.a=0})}};h.Ja=function(){var a=this.b;return"B"+a.c+"T"+a.b};h.request=function(a,b,c,d){function e(a,b){vk(f);d&&d(a,b)}var f=new sk(a);a=c||ok;var g=this;el(this.b)&&kl(this,b,a)?(b=this.b.a,this.a++,tk(f,b,this.Ja()+"R"+this.a),this.h.push(e)):g.zc(function(){var a=g.b.a;g.a++;tk(f,a,g.Ja()+"R"+g.a)},b,a,e);return f};
h.Kb=function(a,b,c,d,e){d=d||ok;var f=this,g;if(el(f.b)&&kl(this,c,d)){var k=f.b.a;f.a++;g=f.Ja()+"R"+f.a;Q(f.logger,g+" BEGIN");b(k,g,function(b,c){f.i=k;c?(Q(f.logger,g+" ERROR"),a.p(b)):(Q(f.logger,g+" SUCCESS"),a.callback(b));f.i=null});Q(f.logger,g+" END");b=null}else f.zc(function(){var c=f.b.a;f.a++;g=f.Ja()+"R"+f.a;Q(f.logger,g+" BEGIN");b(c,g,function(b,d){f.i=c;d?(Q(f.logger,g+" ERROR"),a.p(b)):(Q(f.logger,g+" SUCCESS"),a.callback(b));f.i=null});Q(f.logger,g+" END");b=null},c,d,e)};
h.getName=function(){return this.I().getName()};h.toString=function(){return"Serial:"+this.Ja()+(this.i?"*":"")};function ol(a,b){jl.call(this,a,b)}A(ol,jl);ol.prototype.logger=L("ydn.db.tr.AtomicSerial");ol.prototype.request=function(a,b,c){var d,e,f,g=ol.f.request.call(this,a,b,c,function(a,b){vk(g);if(d)"complete"!=a&&(f=!0,e=b),d(e,f);else{var c=new bl;S(g,c,!0)}});xk(g,function(a,b,c){f=b;e=a;d=c});return g};
ol.prototype.Kb=function(a,b,c,d,e){var f,g,k=new B;k.m(function(a){g=!1;f=a},function(a){g=!0;f=a});ol.f.Kb.call(this,k,b,c,d,function(b,c){if("complete"!=b)a.p(c);else if(!0===g)a.p(f);else if(!1===g)a.callback(f);else{var d=new bl;a.p(d)}e&&(e(b,c),e=void 0)})};ol.prototype.toString=function(){return"Atomic"+ol.f.toString.call(this)};function pl(a,b,c,d){this.d=a;this.b=b;this.a=c;this.Na=d;this.c=null}pl.prototype.logger=L("ydn.db.tr.DbOperator");pl.prototype.abort=function(){this.a.abort()};function V(a){a.c||(a.c=a.d.C());return a.c}pl.prototype.I=function(){return this.d};
function ql(a,b){var c=a.I(),d=b instanceof rl?b:sl(b),e=b.name,f=W(c.b,e);if(0==tl(d,f).length)sc(!1);else if(f=f?"update":"add",c.b instanceof ul)vl(c.b,d),c.c?(c.c.close(),c.c=null,wl(c)):sc(!1);else throw new Ai("Cannot "+f+" store: "+e+". Not auto schema generation mode.");}pl.prototype.toString=function(){return"TxStorage:"+this.I().getName()};function xl(a,b,c,d){pl.call(this,a,b,c,d)}A(xl,pl);h=xl.prototype;h.logger=L("ydn.db.crud.DbOperator");
h.count=function(a,b,c,d){var e,f,g,k;if(null!=a)if(u(a)){if(t(c)||t(b))throw new I("too many arguments.");f=a;for(var l=0;l<f.length;l++)if(!yl(this.b,f[l]))throw new I('store name "'+f[l]+'" at '+l+" not found.");Q(this.logger,"countStores: "+Eh(f));e=this.a.request("count",f);T(e,function(){V(this).Td(e,f)},this)}else if(v(a)){l=W(this.b,a);if(!l)throw new I('store name "'+a+'" not found.');if(t(d)&&!ga(d))throw new I('unique value "'+d+'" must be boolean, but found '+typeof d+".");f=[a];if(v(b))if(g=
b,x(c)){var m=Ok(c);if(m)throw new I("invalid key range: "+Dh(c)+" "+m);k=Ik(c)}else{if(null!=c)throw new I("invalid key range: "+Dh(c)+" of type "+typeof c);k=null}else if(x(b)||null==b)if(x(b)){if(m=Ok(b))throw new I("invalid key range: "+Dh(b)+" "+m);k=Ik(b)}else{if(null!=b)throw new I("key range must be  an object but found "+Dh(b)+" of type "+typeof b);k=null}else throw new I('invalid second argument for count "'+Dh(c)+'" of type '+typeof b);Q(this.logger,"countKeyRange: "+a+" "+(g?g:"")+Eh(k));
e=this.a.request("count",f);zl(l,e,arguments);T(e,function(){V(this).fd(e,f[0],k,g,!!d)},this)}else throw new I("Invalid store name or store names.");else M(this.logger,"count method requires store name(s)"),l=Al(this.b),e=this.a.request("count",l),xk(e,function(a,b,c){if(b)c(a,!0);else{for(var d=b=0;d<a.length;d++)b+=a[d];c(b,!1)}},this),T(e,function(){V(this).Td(e,f)},this);return e};
h.get=function(a,b){var c=this,d;if(a instanceof Ck){var e=a,f=e.D(),g=W(this.b,f);if(!g){if(this.b.Wa()){if(nl(this.I()))return zk("get",void 0);d=new sk("get");this.I().$a(function(){c.get(a,b).m(function(a){d.callback(a)},function(a){d.p(a)})});return d}throw new I("Store: "+f+" not found.");}var k=e.s();Q(this.logger,"getByKey: "+f+":"+k);d=this.a.request("get:key",[f]);zl(g,d,arguments,void 0,this);T(d,function(){V(this).be(d,f,k)},this)}else if(v(a)&&t(b)){var l=a,g=W(this.b,l);if(!g){if(this.b.Wa()){if(nl(this.I()))return zk("get",
void 0);d=new sk("get");this.I().$a(function(){c.get(a,b).m(function(a){d.callback(a)},function(a){d.p(a)})});return d}throw new I('Store name "'+l+'" not found.');}var m=b;Q(this.logger,"getById: "+l+":"+m);d=this.a.request("get",[l]);zl(g,d,arguments,void 0,this);T(d,function(){V(this).be(d,l,m)},this)}else throw new I("get require valid input arguments.");return d};
h.keys=function(a,b,c,d,e,f,g){var k,l,m=null,n=!1,p=!1,q=a,s=W(this.b,q);if(!v(q))throw new I("store name must be a string, but "+q+" of type "+typeof q+" is not.");if(!this.b.Wa()){if(!s)throw new I('store name "'+q+'" not found.');if(v(b)&&!Bl(s,b))throw new I('index "'+b+'" not found in store "'+q+'".');}if(this.b.Wa()&&!s)return zk("keys",[]);var w;if(v(b)){var y=b,G=Ok(c);if(G)throw new I("invalid key range: "+c+" "+G);m=Ik(c);if(ha(d))k=d;else{if(t(d))throw new I("limit must be a number");
k=100}if(ha(e))l=e;else{if(t(e))throw new I("offset must be a number");l=0}if(t(f))if(ga(f))n=f;else throw new I("reverse must be a boolean");if(t(g))if(ga(g))p=g;else throw new I("unique must be a boolean");Q(this.logger,"keysByIndexKeyRange: "+q);w=this.a.request("keys:iter:index",[q]);zl(s,w,arguments);T(w,function(){V(this).list(w,2,q,y,m,k,l,n,p)},this)}else{if(x(b)){if(G=Ok(b))throw new I("invalid key range: "+Dh(b)+" "+G);m=Ik(b)}else{if(null!=b)throw new I("invalid key range: "+Dh(b)+" of type "+
typeof b);m=null}if(ha(c))k=c;else{if(t(c))throw new I("limit must be a number");k=100}if(ha(d))l=d;else{if(t(d))throw new I("offset must be a number");l=0}if(t(e))if(ga(e))n=e;else throw new I("reverse must be a boolean");Q(this.logger,"keysByKeyRange: "+q);w=this.a.request("keys",[q]);zl(s,w,arguments);T(w,function(){V(this).list(w,2,q,null,m,k,l,n,!1)},this)}return w};
h.$=function(a,b,c,d,e,f,g){var k=this,l;if(v(a)){var m=a,n=W(this.b,m);if(!n){if(this.b.Wa()){if(nl(this.I()))return zk("values",[]);l=new sk("values");this.I().$a(function(){k.$(a,b,c,d,e,f).m(function(a){l.callback(a)},function(a){l.p(a)})});return l}throw new Yk(m);}if(u(b)){if(t(c)||t(d))throw new I("too many input arguments");var p=b;Q(this.logger,"listByIds: "+m+" "+p.length+" ids");l=this.a.request("values:array",[m]);zl(n,l,arguments,void 0,this);T(l,function(){V(this).Sf(l,m,p)},this)}else l=
v(b)?this.He(m,b,c,d,e,f,g):this.lg(m,b,c,d,e)}else if(u(a))if(a[0]instanceof Ck){for(var n=[],q=a,s=0;s<q.length;s++){var w=q[s].D();if(!yl(this.b,w)){if(this.b.Wa())return n=[],n[q.length-1]=void 0,zk("get",n);throw new I("Store: "+w+" not found.");}jb(n,w)||n.push(w)}Q(this.logger,"listByKeys: "+Eh(n)+" "+q.length+" keys");l=this.a.request("values:keys",n);T(l,function(){V(this).re(l,q)},this)}else throw new I("first argumentmust be array of ydn.db.Key, but "+a[0]+" of "+typeof a[0]+" found.");
else throw new I("first argument "+a+" is invalid.");return l};
h.lg=function(a,b,c,d,e){var f=W(this.b,a),g,k,l,m=null;if(x(b)){var n=Ok(b);if(n)throw new I("invalid key range: "+b+" "+n);m=Ik(b)}else if(null!=b)throw new I('expect key range object, but found "'+Dh(b)+'" of type '+typeof b);if(t(c))if(ha(c))g=c;else throw new I("limit must be a number, but "+c+" is "+typeof c);else g=100;if(t(d))if(ha(d))k=d;else throw new I("offset must be a number, but "+d+" is "+typeof d);else k=0;if(t(e))if(ga(e))l=e;else throw new I("reverse must be a boolean, but "+e+" is "+
typeof e);Q(this.logger,(m?"listByKeyRange: ":"listByStore: ")+a);var p=this.a.request("values",[a]);zl(f,p,arguments);T(p,function(){V(this).list(p,4,a,null,m,g,k,l,!1)},this);return p};
h.He=function(a,b,c,d,e,f,g){var k=W(this.b,a),l,m,n,p;if(!Cl(k,b))throw new I('index "'+b+'" not found in store "'+a+'"');var q=Ok(c);if(q)throw new I("invalid key range: "+c+" "+q);var s=Ik(c);if(t(d))if(ha(d))l=d;else throw new I("limit must be a number.");else l=100;if(t(e))if(ha(e))m=e;else throw new I("offset must be a number.");else m=0;if(ga(f))n=f;else if(t(f))throw new I("reverse must be a boolean, but "+f);if(t(g))if(ga(g))p=g;else throw new I("unique must be a boolean");Q(this.logger,
"listByIndexKeyRange: "+a+":"+b);var w=this.a.request("values:iter:index",[a]);zl(k,w,arguments);T(w,function(){V(this).list(w,4,a,b,s,l,m,n,p)},this);return w};
h.list=function(a,b,c,d,e,f,g,k,l){var m=W(this.b,b);if(!m){if(this.b.Wa())return zk("get",[]);throw new Yk(b);}var n;if(c&&!Cl(m,c))throw new I('index "'+c+'" not found in store "'+b+'"');if(m=Ok(d))throw new I("invalid key range: "+d+" "+m);var p=Ik(d),q=100;if(ha(e))q=e;else if(null!=e)throw new I('limit must be a number but "'+e+'" of type '+typeof e+" found.");var s=0;if(ha(f))s=f;else if(null!=f)throw new I('offset must be a number but "'+f+'" of type '+typeof f+" found.");var w=!1;if(ga(g))w=
g;else if(null!=g)throw new I('reverse must be a boolean but "'+g+'" of type '+typeof g+" found.");var y=!1;if(ga(k))y=k;else if(null!=k)throw new I('unique must be a boolean but "'+k+'" of type '+typeof k+" found.");if(s&&l&&t(l[0]))throw new I("offset must not given when initial cursor position is defined");Q(this.logger,a+": "+b+":"+c);n=this.a.request("values:iter:index",[b]);T(n,function(){V(this).list(n,a,b,c||null,p,q,s,w,y,l)},this);return n};
h.add=function(a,b,c){var d=v(a)?a:x(a)?a.name:void 0;if(!v(d))throw new I("store name "+d+" must be a string, but "+typeof d);var e=W(this.b,d);if(!e){if(!this.b.Wa())throw new I('store name "'+d+'" not found.');e=sl(x(a)?a:{name:d});Q(this.logger,"Adding object store: "+d);ql(this,e)}else if(this.b.Wa()&&x(a)&&(a=sl(a),a=tl(e,a)))throw new xd(a);var f;if(!e)throw new I('store name "'+d+'" not found.');if(v(e.keyPath)&&t(c))throw new I("key must not be provided while the store uses in-line key.");
if(!e.keyPath&&!e.autoIncrement&&!t(c))throw new I("out-of-line key must be provided.");if(u(b)){Q(this.logger,"addObjects: "+d+" "+b.length+" objects");for(a=0;a<b.length;a++)Dl(e,b[a]);f=this.a.request("add:array",[d],pk);T(f,function(){V(this).lb(f,!1,!1,d,b,c)},this);e.ec&&f.n(function(a){a=new El(Fl,this.I(),e.getName(),a,b);this.I().Oa(a)},this)}else if(x(b))a="store: "+d+" key: "+Gl(e,b,c),Q(this.logger,"addObject: "+a),Dl(e,b),f=this.a.request("add",[d],pk),T(f,function(){V(this).lb(f,!1,
!0,d,[b],[c])},this),e.ec&&f.n(function(a){a=new Hl(Fl,this.I(),e.getName(),a,b);this.I().Oa(a)},this);else throw new I("record must be an object or array list of objects, but "+b+" of type "+typeof b+" found.");return f};
function Il(a,b){var c=v(b)?b:x(b)?b.name:void 0;if(!v(c))throw new I("store name must be a string");var d=W(a.b,c);if(!d){if(!a.b.Wa())throw new Yk(c);d=sl(x(b)?b:{name:c});Q(a.logger,"Adding object store: "+c);ql(a,d)}else if(a.b.Wa()&&x(b)){var e=sl(b);if(e=tl(d,e))throw new xd(e);}if(!d)throw new Yk(c);return d}h.load=function(a,b,c){var d=c||",",e=Il(this,a).getName();a=this.a.request("load",[e]);var f=this;this.a.Kb(a,function(a,c,l){V(f).cg(a,c,l,e,b,d)},[e],pk);return a};
h.search=function(a){var b=Jl(a);O(this.logger,"query "+a);var c=this.a.request("search",b,ok);T(c,function(){var b=V(this);Kl(a,function(e,f,g,k){var l=uk(c);b.list(l,4,e,f,Ik(g),100,0,!1,!1);l.V(function(b){var d=null;b instanceof Array||(d=b,b=[]);for(var e=0;e<b.length;e++){var f;f=b[e];var g=f.id,g=v(g)?hk(g):g,k=g[3];(f=1==this.type&&k!=this.value?null:new Ll(this,g[0],g[2],g[1],k,f.k,f.loc))&&a.d.push(f)}a.c--;b=0==a.c?!1:a.b[a.b.length-1].e===this.e?!0:null;!0===b?ue(c,a):!1===b&&c.callback(Ml(a));
if(d)throw d;},k)})},this);return c};
h.put=function(a,b,c){var d,e=this;if(a instanceof Ck){var f=a,g=f.D(),k=W(this.b,g);if(!k)throw new I('store "'+g+'" not found.');if(k.keyPath){var l=Gl(k,b);if(null!=l){if(0!=Ak(l,f.s()))throw new I("Inline key must be "+f+" but "+l+" found.");}else Nl(k,b,f.s());return this.put(g,b)}return this.put(g,b,f.s())}if(u(a)){if(t(c))throw new I("too many arguments");var m=a;if(!t(b))throw new I("record values required");for(var n=b,f=[],g=0,k=m.length;g<k;g++){l=m[g].D();-1==$a(f,l)&&f.push(l);var p=
W(this.b,l);if(!p)throw new I('store "'+l+'" not found.');p.keyPath&&Nl(p,n[g],m[g].s())}Q(this.logger,"putByKeys: to "+Eh(f)+" "+n.length+" objects");for(g=0;g<n.length;g++)Dl(p,n[g]);d=this.a.request("put:keys",f,pk);zl(p,d,arguments);T(d,function(){V(e).ze(d,n,m)},this)}else if(v(a)||x(a)){var p=Il(this,a),q=p.getName();if(p.keyPath&&t(c))throw new I("key must not be provided while the store uses in-line key.");if(!p.keyPath&&!p.autoIncrement&&!t(c))throw new I("out-of-line key must be provided.");
if(u(b)){var s=b,w=c;Q(this.logger,"putObjects: "+q+" "+s.length+" objects");for(g=0;g<s.length;g++)Dl(p,s[g]);d=this.a.request("put:array",[q],pk);zl(p,d,arguments);T(d,function(){V(this).lb(d,!0,!1,q,s,w)},this);p.ec&&d.n(function(a){a=new El(Ol,this.I(),q,a,s);this.I().Oa(a)},this)}else if(x(b)){var y=b,G=c;Q(this.logger,"putObject: "+q+" "+(t(G)?G:"(without-key)"));if(t(r.Blob)&&y instanceof Blob&&p.Fc&&!p.keyPath&&0==p.indexes.length&&Cc)d=new sk("put"),f=new FileReader,f.onload=function(a){var b=
a.target.result,c=e.a.request("put",[q],pk);zl(p,c,[q,y,G]);T(c,function(){V(e).lb(c,!0,!0,q,[b],[G])},this);c.m(function(a){d.callback(a)},function(a){d.p(a)})},f.onerror=function(a){d.p(a)},f.onabort=function(a){d.p(a)},f.readAsDataURL(y);else{Dl(p,y);d=this.a.request("put",[q],pk);var H=[q,y,G];zl(p,d,H);T(d,function(){var a=t(G)?[H[2]]:void 0;V(e).lb(d,!0,!0,q,[H[1]],a)},this)}p.ec&&d.n(function(a){a=new Hl(Ol,this.I(),q,a,y);this.I().Oa(a)},this)}else throw new I("put record value must be Object or array of Objects");
}else throw new I("the first argument of put must be store name, store schema or array of keys.");return d};
function Pl(a,b,c,d){var e=a.Na,f,g;if(v(b)){var k=W(a.b,b);if(k){if(!k.keyPath&&!k.autoIncrement&&null==d)throw new I('key required for store "'+b+'"');}else throw new Yk(b);for(var l=0;l<c.length;l++)Dl(k,c[l]);f=[b]}else{g=b;f=[];for(var l=0,m=g.length;l<m;l++){var n=g[l].D(),k=W(a.b,n);-1==$a(f,n)&&f.push(n);if(!k)throw new Yk(n);Dl(k,c[l])}}var p;v(b)?(k=W(a.b,b),p=e.request("put:array",f,pk),T(p,function(){V(this).lb(p,!0,!1,b,c,d)},a)):(p=e.request("put:keys",f,pk),T(p,function(){V(this).ze(p,
c,g)},a));return p}function Ql(a,b){for(var c=[],d=0,e=b.length;d<e;d++){var f=b[d].D();-1==$a(c,f)&&c.push(f);if(!yl(a.b,f))throw new Yk(f);}var g=a.Na.request("rm:keys",c,pk);T(g,function(){V(this).Be(g,b)},a);return g}function Rl(a,b,c){var d=a.Na.request("rm:iter",[b],pk);T(d,function(){V(this).wd(d,b,c||null)},a);return d}
function Sl(a,b,c,d,e,f,g){f=f||100;var k,l=g||0;if(g=W(a.b,b)){if(c&&!Cl(g,c))throw new Yk('index "'+c+'" in store "'+b+'"');}else throw new Yk(b);var m=Ik(d);v(c)?(k=a.Na.request("values:iter:index",[b]),T(k,function(){V(this).list(k,4,b,c,m,f,l,e,!1)},a)):(k=a.Na.request("values",[b]),T(k,function(){V(this).list(k,4,b,null,m,f,l,e,!1)},a));return k}
function Tl(a,b){var c=[],d=b.length;if(0==d)return zk("keys",[]);for(var e=0;e<d;e++){var f=b[e].D();-1==$a(c,f)&&c.push(f);if(!yl(a.b,f))throw new Yk(f);}var g=a.Na.request("keys",c);T(g,function(){V(a).re(g,b)},a);return g}
function Ul(a,b,c,d,e,f,g,k){var l;e=e||100;var m=W(a.b,b);if(m){if(c&&!Cl(m,c))throw new Yk('index "'+c+'" in store "'+b+'"');}else throw new Yk(b);v(c)?(l=a.Na.request("keys:iter:index",[b]),T(l,function(){V(this).list(l,2,b,c,d,e,f,g,k)},a)):(l=a.Na.request("keys",[b]),T(l,function(){V(this).list(l,2,b,null,d,e,f,g,k)},a));return l}
h.clear=function(a,b,c){if(t(c))throw new I("too many input arguments");var d;if(v(a)){c=W(this.b,a);if(!c)throw new I('store name "'+a+'" not found.');if(x(b)){var e=Ik(b);if(null===e)throw new I("clear method requires a valid non-null KeyRange object.");Q(this.logger,"clearByKeyRange: "+a+":"+Eh(e));d=this.a.request("clear",[a],pk);zl(c,d,[a,e]);T(d,function(){V(this).ef(d,a,e)},this)}else{if(t(b))throw new I("clear method requires a valid KeyRange object as second argument, but found "+b+" of type "+
typeof b);Q(this.logger,"clearByStore: "+a);d=this.a.request("clear",[a],pk);T(d,function(){V(this).Qd(d,[a])},this)}}else if(!t(a)||u(a)&&v(a[0])){var f=a||Al(this.b);Q(this.logger,"clearByStores: "+Eh(f));d=this.a.request("clear",f,pk);T(d,function(){V(this).Qd(d,f)},this)}else throw new I('first argument "'+a+'" is invalid.');return d};
h.remove=function(a,b,c){var d;if(v(a)){var e=W(this.b,a);if(!e)throw new I('store name "'+a+'" not found.');if(t(c))if(v(b)){var f=Bl(e,b);if(!f)throw new I("index: "+b+" not found in "+a);if(x(c)||null===c){var g=Ik(c);Q(this.logger,"removeByIndexKeyRange: "+a+":"+f.getName()+" "+a);d=this.a.request("rm:iter:index",[a],pk);T(d,function(){V(this).dg(d,a,f.getName(),g)},this)}else throw new I("key range "+c+' is invalid type "'+typeof c+'".');}else throw new I('index name "'+b+'" must be a string, but '+
typeof b+" found.");else if(v(b)||ha(b)||fa(b)||b instanceof Date){Q(this.logger,"removeById: "+a+":"+b);d=this.a.request("rm",[a],pk);var k=[a,b];zl(e,d,k);T(d,function(){V(this).Ae(d,a,k[1])},this);e.ec&&d.n(function(c){c=1==c?b:void 0;c=new Hl(Vl,this.I(),a,c,void 0);this.I().Oa(c)},this)}else if(x(b))g=Ik(b),Q(this.logger,"removeByKeyRange: "+a+":"+Eh(g)),d=this.a.request("rm:iter",[a],pk),zl(e,d,[a,g]),T(d,function(){V(this).wd(d,a,g)},this),e.ec&&d.n(function(b){var c=[];c.length=b;b=new El(Vl,
this.I(),a,c,void 0);this.I().Oa(b)},this);else throw new I('Invalid key or key range "'+b+'" of type '+typeof b);}else if(a instanceof Ck){var l=a.D(),e=W(this.b,l);d=this.a.request("rm",[l],pk);var m=[l,a.s()];zl(e,d,m);T(d,function(){V(this).Ae(d,l,m[1])},this)}else if(u(a)){c=[];for(var e=0,n=a.length;e<n;e++){if(!(a[e]instanceof Ck))throw new I("key list element at "+e+" of "+n+' must be yn.db.Key, but "'+Dh(a[e])+'" ('+ea(a[e])+") is not ydn.db.Key.");var p=a[e].D();-1==$a(c,p)&&c.push(p)}if(1>
c.length)throw new I('at least one valid key required in key list "'+Dh(a)+'"');d=this.a.request("rm:keys",c,pk);T(d,function(){V(this).Be(d,a)},this)}else throw new I('first argument requires store name, key (ydn.db.Key) or list of keys (array) , but "'+Dh(a)+'" ('+ea(a)+") found.");return d};h.toString=function(){return"DbOperator:"+this.I().getName()};var Fl="created",Vl="deleted",Ol="updated";function Wl(a,b){E.call(this,a,b)}A(Wl,E);Wl.prototype.D=function(){return this.N};function Xl(a,b,c){E.call(this,a,b);this.version=c}A(Xl,Wl);Xl.prototype.name="ReadyEvent";Xl.prototype.version=NaN;function Yl(a,b,c){E.call(this,c||"error",a);this.error=b}A(Yl,Wl);Yl.prototype.toString=function(){return this.name+":"+(this.error?this.error:"")};Yl.prototype.name="ErrorEvent";Yl.prototype.error=null;Yl.prototype.getError=function(){return this.error};
function Zl(a,b){Yl.call(this,a,b,"fail")}A(Zl,Yl);Zl.prototype.name="FailEvent";function Hl(a,b,c,d,e){E.call(this,a,b);this.N=c;this.key=d;this.value=e}A(Hl,Wl);Hl.prototype.name="RecordEvent";Hl.prototype.K=function(){return this.value};function El(a,b,c,d,e){E.call(this,a,b);this.N=c;this.keys=d;this.$=e}A(El,Wl);El.prototype.name="StoreEvent";El.prototype.Ca=function(){return this.keys};El.prototype.xa=function(){return this.$};function $l(a,b,c,d,e,f){t(e)||(e=u(a)?a.join(", "):a);if(null!=a&&!v(a)&&!fa(a))throw new I("index keyPath for "+e+" must be a string or array, but "+a+" is "+typeof a);u(a)&&Object.freeze&&Object.freeze(a);!t(a)&&t(e)&&(a=e);this.keyPath=a;this.h=fa(this.keyPath);this.b=e;this.type=am(b);if(t(b)){if(!t(this.type))throw new I("type invalid in index: "+this.b);if(u(this.keyPath))throw new I('composite key for store "'+this.b+'" must not specified type');}this.unique=!!c;this.multiEntry=!!d;this.i=
v(this.type)?this.type:bm;this.d=v(e)?e:u(a)?this.keyPath.join(","):a;this.c=Qa(this.d);this.a=this.h?null:this.keyPath.split(".");this.e=f||null}function cm(a,b){if(null!=b){if(fa(a.keyPath)){for(var c=[],d=0,e=a.keyPath.length;d<e;d++){var f=bk(b,a.keyPath[d]);c[d]=f}return c}return bk(b,a.keyPath)}}function dm(a,b,c){for(var d=0;d<a.a.length;d++)d==a.a.length-1?b[a.a[d]]=c:x(b[a.a[d]])||(b[a.a[d]]={})}var bm="TEXT";
function Rk(a,b){if("DATE"==b){if(a instanceof Date)return+a}else return null!=b?a:ek(a)}function em(a,b){return"DATE"==b?new Date(a):t(b)?a:hk(a)}var fm=["BLOB","DATE","INTEGER","NUMERIC",bm];function am(a){if(v(a))return a=$a(fm,a),fm[a]}h=$l.prototype;h.getName=function(){return this.b};h.toJSON=function(){return{name:this.b,keyPath:this.keyPath,type:this.type,unique:this.unique,multiEntry:this.multiEntry}};
h.clone=function(){var a=u(this.keyPath)?nb(this.keyPath):this.keyPath;return new $l(a,this.type,this.unique,this.multiEntry,this.b,this.e)};function gm(a,b){return null!=a||null!=b?null!=a?null!=b?fa(a)&&fa(b)?sb(a,b)?null:"expect: "+a+", but: "+b:hm(a,b)?null:"expect: "+a+", but: "+b:"keyPath: "+a+" no longer defined":"newly define "+b:null}
h.hint=function(a){if(!a)return this;var b=u(this.keyPath)?nb(this.keyPath):this.keyPath,c=this.type;t(a.type)||"TEXT"!=c||(c=void 0);return new $l(b,c,this.unique,this.multiEntry,a.b)};function im(a,b){a.e=b}h.toString=function(){var a=this.multiEntry?"MultiEntry":"";this.a&&1<this.a.length&&(a+="Compound");return a+"Index:"+this.b};function rl(a,b,c,d,e,f,g,k){if(!v(a))throw new I("store name must be a string");this.b=a;this.keyPath=t(b)?b:null;this.i=fa(this.keyPath);if(null!==this.keyPath&&!v(this.keyPath)&&!this.i)throw new I("keyPath must be a string or array");if(null!=c&&!ga(c))throw new I('invalid autoIncrement value in store "'+a+'"');this.autoIncrement=!!c;var l;if(null!=d){l=am(d);if(!t(l))throw new I('type "'+d+'" for primary key in store "'+this.b+'" is invalid.');if(this.i)throw new I('composite key for store "'+
this.b+'" must not specified type');}this.type=null!=l?l:this.autoIncrement?"INTEGER":void 0;this.e=v(this.keyPath)?this.keyPath.split("."):[];this.indexes=e||[];this.ec=!!f;this.Fc=!!g;this.l=v(this.type)?this.type:bm;this.d=u(this.keyPath)?this.keyPath.join(","):v(this.keyPath)?this.keyPath:"_ROWID_";this.c=Qa(this.d);if(this.t=!!k){if(this.keyPath)throw new I('encrypted store "'+this.b+'" must not use inline key');if(this.autoIncrement)throw new I('encrypted store "'+this.b+'" must not use key generator');
}this.h=[]}h=rl.prototype;h.ec=!1;h.Fc=!1;h.toJSON=function(){for(var a=[],b=0;b<this.indexes.length;b++)a.push(this.indexes[b].toJSON());return{name:this.b,keyPath:this.keyPath,autoIncrement:this.autoIncrement,type:this.type,indexes:a}};
function sl(a){var b="name keyPath autoIncrement type indexes dispatchEvents fixed Sync encrypted".split(" "),c;for(c in a)if(a.hasOwnProperty(c)&&-1==$a(b,c))throw new I('Unknown attribute "'+c+'"');b=[];c=a.indexes||[];if(u(c))for(var d=0;d<c.length;d++){var e;e=c[d];var f="name unique type keyPath multiEntry generator".split(" "),g=void 0;for(g in e)if(e.hasOwnProperty(g)&&-1==$a(f,g))throw new I("Unknown field: "+g+" in "+Eh(e));e=new $l(e.keyPath,e.type,e.unique,e.multiEntry,e.name,e.generator);
t(e.keyPath)&&e.keyPath===a.keyPath||b.push(e)}return new rl(a.name,a.keyPath,a.autoIncrement,"undefined"===a.type||"null"===a.type?void 0:a.type,b,a.dispatchEvents,a.fixed,a.encrypted)}function jm(a,b,c,d,e,f,g){a=km(a,b,c,d,e,f,g);b="";0!=c&&(b+="SELECT "+a.select);b+=" FROM "+a.Lc;a.ca&&(b+=" WHERE "+a.ca);a.group&&(b+=" GROUP BY "+a.group);a.Ub&&(b+=" ORDER BY "+a.Ub);return b}
function km(a,b,c,d,e,f,g){var k={select:"",Lc:"",ca:"",group:"",Ub:""},l=a.d,m=a.c,n=null;d!==l&&v(d)&&(n=Bl(a,d));var p=!!n,q=d||l,s=Qa(q),w=p?n.type:a.type,y=p&&n.multiEntry;k.Lc=lm(a);6===c?k.select="COUNT("+m+")":3===c||1===c||2===c?(k.select=m,null!=d&&d!=l&&(k.select+=", "+s)):k.select="*";d=g?"DISTINCT ":"";l=[];y?(y=Qa("ydn.db.me:"+a.getName()+":"+n.getName()),k.select=6===c?"COUNT("+d+y+"."+s+")":3===c||1===c||2===c?"DISTINCT "+lm(a)+"."+m+", "+y+"."+s+" AS "+q:"DISTINCT "+lm(a)+".*, "+
y+"."+s+" AS "+q,k.Lc=y+" INNER JOIN "+lm(a)+" USING ("+m+")",null!=e&&(Qk(y+"."+s,w,e,l,b),0<l.length&&(k.ca=k.ca?k.ca+(" AND "+l.join(" AND ")):l.join(" AND ")))):null!=e&&(Qk(s,w,e,l,b),0<l.length&&(k.ca=k.ca?k.ca+(" AND "+l.join(" AND ")):l.join(" AND ")));p&&!n.unique&&g&&(k.group=s);a=f?"DESC":"ASC";k.Ub=s+" "+a;p&&(k.Ub+=", "+m+" "+a);return k}
function mm(a,b,c,d,e,f,g,k,l){var m,n,p,q;null!=e?(m=e.lower,n=e.upper,p=e.lowerOpen,q=e.upperOpen,f?null!=n?(e=Ak(k,n),-1==e?(n=k,q=l):0==e&&(q=l||q)):(n=k,q=l):null!=m?(e=Ak(k,m),1==e?(m=k,p=l):0==e&&(p=l||p)):(m=k,p=l)):f?(n=k,q=l):(m=k,p=l);e=new U(m,n,!!p,!!q);d=d?Bl(a,d):null;b=km(a,c,b,d?d.d:a.d,e,f,g);b="SELECT "+b.select+" FROM "+b.Lc+(b.ca?" WHERE "+b.ca:"")+(b.group?" GROUP BY "+b.group:"")+" ORDER BY "+b.Ub;d&&(b+=", "+a.c+(f?"DESC":"ASC"));return b}
function nm(a,b,c,d,e,f,g,k,l,m){var n=Bl(a,d),p=n.d;d=n.c;var q=a.c,s=l?" <":" >",s=g?s+" ":s+"= ";g=Rk(f,n.type);k=Rk(k,a.type);n="";e?(a=km(a,c,b,p,e,l,m),a.ca+=" AND ",n=d+s+"?",c.push(g)):(e=l?U.upperBound(f,!0):U.lowerBound(f,!0),a=km(a,c,b,p,e,l,m),n=a.ca,a.ca="");a.ca+="("+n+" OR ("+d+" = ? AND "+q+s+"?))";c.push(g);c.push(k);return"SELECT "+a.select+" FROM "+a.Lc+" WHERE "+a.ca+(a.group?" GROUP BY "+a.group:"")+" ORDER BY "+a.Ub}h.clone=function(){return sl(this.toJSON())};
h.index=function(a){return this.indexes[a]||null};function Bl(a,b){return hb(a.indexes,function(a){return a.getName()==b})}function om(a,b){for(var c=0;c<a.indexes.length;c++)if(!gm(a.indexes[c].keyPath,b))return a.indexes[c];return null}function Cl(a,b){return b===a.keyPath?!0:eb(a.indexes,function(a){return a.getName()==b})}function lm(a){return Qa(a.b)}
function pm(a,b){if(!b)return a;var c=a.autoIncrement,d=u(a.keyPath)?nb(a.keyPath):a.keyPath,e=a.type,f=db(a.indexes,function(a){return a.clone()});t(b.type)||"TEXT"!=e||(e=void 0);u(b.keyPath)&&v(d)&&d==b.keyPath.join(",")&&(d=nb(b.keyPath));for(var g=0,k=b.indexes.length;g<k;g++)if(b.indexes[g].h)for(var l=b.indexes[g].getName(),m=f.length-1;0<=m;m--)if(0<=l.indexOf(f[m].getName())){f[m]=b.indexes[g].clone();break}for(g=0;g<f.length;g++)(k=Bl(b,f[g].getName()))&&(f[g]=f[g].hint(k));return new rl(b.b,
d,c,e,f)}h.getName=function(){return this.b};function qm(a){return!!a.keyPath}function Gl(a,b,c){if(b){if(!a.keyPath&&null!=c)return c;if(a.i){c=[];for(var d=0;d<a.keyPath.length;d++)c.push(bk(b,a.keyPath[d]));return c}if(a.keyPath)return Db(b,a.e)}}function Nl(a,b,c){for(var d=0;d<a.e.length;d++){var e=a.e[d];if(d==a.e.length-1){b[e]=c;break}t(b[e])||(b[e]={});b=b[e]}}
function rm(a,b,c){var d=[],e=[];c=t(c)?c:Gl(a,b);t(c)&&(e.push(a.c),d.push(Rk(c,a.type)));for(var f=0;f<a.indexes.length;f++){var g=a.indexes[f];if(!g.multiEntry&&g.getName()!==a.keyPath&&"_default_"!=g.getName()){var k=cm(g,b);null!=k&&(d.push(Rk(k,g.type)),e.push(g.c))}}a.Fc?a.Fc&&!a.keyPath&&0==a.indexes.length&&(v(b)&&-1==b.indexOf(";base64,")?d.push(b):d.push(Eh(b)),e.push("_default_")):(d.push(Eh(b)),e.push("_default_"));a=[];for(f=d.length-1;0<=f;f--)a[f]="?";return{Mg:e,Bh:a,$:d,key:c}}
function tl(a,b){if(!b)return"missing store: "+a.b;if(a.b!=b.b)return"store name, expect: "+a.b+", but: "+b.b;var c=gm(a.keyPath,b.keyPath);if(c)return"keyPath, "+c;if(t(a.autoIncrement)&&t(b.autoIncrement)&&a.autoIncrement!=b.autoIncrement)return"autoIncrement, expect:  "+a.autoIncrement+", but: "+b.autoIncrement;if(a.indexes.length!=b.indexes.length)return"indexes length, expect:  "+a.indexes.length+", but: "+b.indexes.length;if(t(a.type)&&t(b.type)&&(fa(a.type)?!sb(a.type,b.type):a.type!=b.type))return"data type, expect:  "+
a.type+", but: "+b.type;for(c=0;c<a.indexes.length;c++){var d=Bl(b,a.indexes[c].getName()),e;e=a.indexes[c];if(d)if(e.b!=d.b)e="name, expect: "+e.b+", but: "+d.b;else{var f=gm(e.keyPath,d.keyPath);e=f?"keyPath, "+f:null!=e.unique&&null!=d.unique&&e.unique!=d.unique?"unique, expect: "+e.unique+", but: "+d.unique:null!=e.multiEntry&&null!=d.multiEntry&&e.multiEntry!=d.multiEntry?"multiEntry, expect: "+e.multiEntry+", but: "+d.multiEntry:t(e.type)&&t(d.type)&&(fa(e.type)?!sb(e.type,d.type):e.type!=d.type)?
"data type, expect: "+e.type+", but: "+d.type:""}else e="no index for "+e.b;if(0<e.length)return'index "'+a.indexes[c].getName()+'" '+e}return""}function Dl(a,b){if(b)for(var c=0;c<a.indexes.length;c++){var d=a.indexes[c],e=b;if(d.e){var f=d.e(e),g=typeof f;if("string"==g||"number"==g||f instanceof Date||u(f)){for(g=0;g<d.a.length-1;g++)x(e[d.a[g]])||(e[d.a[g]]={});e[d.a[d.a.length-1]]=f}}}}function sm(a,b){a.h.push(b)}
function zl(a,b,c,d,e){for(var f=0;f<a.h.length;f++)d!==f&&a.h[f].call(e,b,c)}h.toString=function(){return"Store:"+this.b+"["+this.indexes.length+"index]"};function tm(a,b,c){if(!a||ya(a))throw new I("store_name must be provided for primary full text index");if(!b||ya(b))throw new I("index_name must be provided for primary full text index");this.N=a;this.a=b;this.b=c||1}tm.prototype.D=function(){return this.N};function um(a,b,c,d){this.name=a;this.indexes=b;this.lang=c||"";if(-1==["","en","fr"].indexOf(this.lang))throw new I('Unsupported lang "'+c+" for full text search index "+a);this.b=d||null;this.a=null}um.prototype.getName=function(){return this.name};um.prototype.count=function(){return this.indexes.length};um.prototype.index=function(a){return this.indexes[a]};function vm(a,b,c){return hb(a.indexes,function(a){return a.D()==b&&a.a==c})}
function wm(a){var b=["name","sources","lang"],c;for(c in a)if(a.hasOwnProperty(c)&&-1==$a(b,c))throw new I("Unknown field: "+c+" in "+Eh(a));if(!u(a.sources))throw new I("indexes require for full text search index "+a.name+", but "+a.sources+" of type "+typeof a.sources+" found.");b=a.sources.map(function(a){var b=["storeName","keyPath","weight"],c;for(c in a)if(a.hasOwnProperty(c)&&-1==$a(b,c))throw new I("Unknown field: "+c+" in "+Dh(a));return new tm(a.storeName,a.keyPath,a.weight)});return new um(a.name,
b,a.lang)};function xm(a,b){var c,d,e=b;if(x(a)){d=a;c=["version","stores","fullTextCatalogs"];for(var f in d)if(d.hasOwnProperty(f)&&-1==$a(c,f))throw new I("Unknown field: "+f+" in schema.");c=d.version;var e=[],g=d.stores||[];if(!u(g))throw new I("stores must be array");for(f=0;f<g.length;f++){var k=sl(g[f]);if(-1!=ib(e,function(a){return a.name==k.getName()}))throw new I('duplicate store name "'+k.getName()+'".');e.push(k)}}else v(a)?c=0==a.length?void 0:parseFloat(a):ha(a)&&(c=a);if(t(c)){if(!ha(c)||0>
c)throw new I("Invalid version: "+c+" ("+a+")");isNaN(c)&&(c=void 0)}if(t(b)&&(!u(b)||0<b.length&&!(b[0]instanceof rl)))throw new I("stores");this.version=c;this.vc=!t(this.version);this.stores=e||[];c=[];if(d&&d.fullTextCatalogs)for(f=0;f<d.fullTextCatalogs.length;f++)e=wm(d.fullTextCatalogs[f]),c[f]=e,W(this,e.getName())||(g=[new $l("k",bm),new $l("v",bm)],e=new rl(e.getName(),"id",!1,void 0,g,!1,!1,!1),this.stores.push(e));this.a=c}h=xm.prototype;
h.toJSON=function(){var a=db(this.stores,function(a){return a.toJSON()}),b={};b.stores=a;t(this.version)&&(b.version=this.version);return b};h.vc=!1;h.Wa=function(){return!1};function Al(a){return db(a.stores,function(a){return a.getName()})}h.store=function(a){return this.stores[a]||null};h.count=function(){return this.stores.length};function W(a,b){return hb(a.stores,function(a){return a.getName()==b})}function yl(a,b){return eb(a.stores,function(a){return a.getName()==b})}
function ym(a,b,c,d){if(!b||a.stores.length!=b.stores.length)return"Number of store: "+a.stores.length+" vs "+b.stores.length;for(var e=0;e<a.stores.length;e++){var f=W(b,a.stores[e].getName());if(f){c&&(f=pm(f,a.stores[e]));if(d)for(var g=f,k=a.stores[e],l=0;l<k.indexes.length;l++){var m=k.indexes[l];Cl(g,m.getName())||"BLOB"!=m.type||(m=new $l(m.keyPath,m.type,m.unique,m.multiEntry,m.getName()),g.indexes.push(m))}f=tl(a.stores[e],f);if(0<f.length)return'store: "'+a.stores[e].getName()+'" '+f}else return'missing object store "'+
a.stores[e].getName()+'"'}return""}function zm(a,b){return hb(a.a,function(a){return a.getName()==b})};function ul(a,b){xm.call(this,a,b)}A(ul,xm);ul.prototype.Wa=function(){return!0};function vl(a,b){a.stores.push(b)};function Am(a){return Ch(Eh(a))}function hm(a,b){var c;c=c||{};if(null!=a&&null!=b){if(fa(a)&&fa(b)){if(a.length!=b.length)return!1;for(var d=0;d<a.length;d++)if(-1==hb(b,function(b){return hm(b,a[d])}))return!1;return!0}if(fa(a))return 1==a.length&&hm(a[0],b);if(fa(b))return 1==b.length&&hm(b[0],a);if(x(a)&&x(a)){for(var e in a)if(a.hasOwnProperty(e)&&!c[e]){var f=hm(a[e],b[e]);if(!f)return!1}for(e in b)if(b.hasOwnProperty(e)&&!c[e]&&(f=hm(a[e],b[e]),!f))return!1;return!0}return a===b}return!1}
function Bm(a){if(a)for(var b in a)if(a.hasOwnProperty(b))return a[b]};/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
function Cm(a,b,c){c=c||{};var d="autoSchema connectionTimeout size mechanisms policy isSerial Encryption".split(" "),e;for(e in c)if(c.hasOwnProperty(e)&&-1==$a(d,e))throw new I('Unknown attribute "'+e+'" in options.');if(c.mechanisms){if(!u(c.mechanisms))throw new I("mechanisms attribute must be an array but "+ea(c.mechanisms)+" found.");for(e=0;e<c.mechanisms.length;e++)if(!jb(Dm,c.mechanisms[e]))throw new I('Invalid mechanism "'+c.mechanisms[e]+'"');}this.F=c.mechanisms||Dm;this.r=c.size;this.G=
t(c.connectionTimeout)?c.connectionTimeout:3E3;this.c=null;this.d=[];this.me=!1;var f;if(b instanceof xm)f=b;else if(x(b))for(c.autoSchema||!t(b.stores)?f=new ul(b):f=new xm(b),c=b.stores?b.stores.length:0,e=0;e<c;e++)d=W(f,b.stores[e].name),b.stores[e].Sync&&this.Gg(d,b.stores[e].Sync);else f=new ul;this.b=f;for(e=0;e<this.b.count();e++)if(this.b.store(e).t)throw Error("encryption option must be defined");if(t(a)){if(this.c)throw new zd("Already connected with "+this.l);this.l=a;wl(this)}this.t=
null;this.i=new B}Cm.prototype.logger=L("ydn.db.con.Storage");function Em(a,b,c){return(a=W(a.b,b))?Cl(a,c):!1}function Fm(a){var b;if(t(b)){var c=function(a){b(a.toJSON());b=void 0};a.c?a.c.hb(c):a.transaction(function(b){a.c.hb(c,b)},null,ok)}return a.b?a.b.toJSON():null}Cm.prototype.getName=function(){return this.l};var Dm="indexeddb sqlite websql localstorage sessionstorage userdata memory".split(" ");h=Cm.prototype;h.jf=function(){return null};
function wl(a){function b(b,e){b?(O(a.logger,a+": ready."),a.lh=NaN,d.Fd=function(b){a.Oa(new Yl(a,b))},d.Pe=function(b){a.Oa(new Zl(a,b));a.c=null},d.ye=function(b){a.Oa(b)},setTimeout(function(){Gm(a,e);Hm(a)},10),c.callback(e)):(M(a.logger,a+": database connection fail "+e.name),setTimeout(function(){Gm(a,new Zl(a,e));if(a.d){var b=a.logger;for(b&&b.info("Purging "+a.d.length+" transactions request.",void 0);b=a.d.shift();)b.Sa&&b.Sa("error",e)}},10),c.p(e))}for(var c=new B,d=null,e=a.F,f=0;f<
e.length;f++){var g=e[f].toLowerCase();if(d=a.jf(g)){d=a.jf(g);break}}null===d?(e=new Ai("No storage mechanism found."),b(!1,new Zl(a,e))):(a.init(),d.connect(a.l,a.b).m(function(){this.c=d;b(!0,new Xl("ready",this,parseFloat(d.Ne())))},function(a){M(this.logger,this+": opening fail");b(!1,a)},a))}function hl(a){if(a.c)return a.c.cd()}h.$a=function(a,b){this.i.V(a,b)};function Gm(a,b){setTimeout(function(){a.b.vc&&a.i.b||(b instanceof Yl?a.i.p(b.error):a.i.callback(),a.Oa(b))},4)}
function nl(a){return!!a.c&&a.c.Oe()}h.init=function(){};h.close=function(){this.c&&(this.c.close(),this.c=null,O(this.logger,this+" closed"))};h.lh=NaN;function Hm(a){var b=a.d.shift();b&&(O(a.logger,"pop tx queue["+(a.d.length+1)+"]"),a.transaction(b.$d,b.scopes,b.mode,b.Sa));a.lh=z()}
function Im(a,b,c,d,e){O(a.logger,"push tx queue["+a.d.length+"]");a.d.push({$d:b,scopes:c,mode:d,Sa:e});100<a.d.length&&0==a.d.length%100&&M(a.logger,"Transaction queue stack size is "+a.d.length+". It is too large, possibility due to incorrect usage.")}h.me=!1;
h.transaction=function(a,b,c,d){var e=b;if(v(b))e=[b];else if(null!=b)if(fa(b)){if(0==b.length)throw new I("number of store names must more than 0");for(var f=0;f<b.length;f++)if(!v(b[f]))throw new I("store name at "+f+" must be string but found "+typeof b[f]);}else throw new I("store names must be an array");else e=null;if(this.c&&this.c.Oe()&&!this.me){var g=this,k=t(c)?c:ok;k==qk&&(this.me=!0);this.c.Wd(function(b){a(b);a=null},e,k,function(a,b){ia(d)&&(d(a,b),d=void 0);k==qk&&(g.me=!1);Hm(g)})}else Im(this,
a,e,c,d)};h.Gg=function(a){M(this.logger,"Synchronization option for "+a.getName()+" ignored.")};h.Fg=function(a){M(this.logger,"Full text indexer option for "+a.getName()+" ignored.")};h.Oa=function(){};h.toString=function(){return"Storage:"+this.c};function Jm(a,b,c,d){this.d=a;this.e=b;this.a=nb(c);this.b=d;this.c=[]}Jm.prototype.d=null;Jm.prototype.onCompleted=function(a,b){for(var c=0;c<this.c.length;c++)this.c[c](a,b);this.c.length=0;this.c=this.a=this.d=null};function Km(a,b,c){if(a.d)c&&a.c.push(c),b(a.d);else throw new Ad("tx committed on ParallelTxExecutor");}Jm.prototype.toString=function(){return"ParallelTxExecutor: txNo:"+this.e+" mode:"+this.b+" scopes:"+Eh(this.a)};function Lm(a,b,c,d,e,f){fl.call(this,a,b,c,d,e,f);this.c=this.b=null}A(Lm,fl);h=Lm.prototype;h.logger=L("ydn.db.tr.Parallel");h.abort=function(){Q(this.logger,this+": aborting");il(this.c)};
h.Sh=function(a,b){var c;if("multi"==this.d)a:if(c=this.b,!c.a||!c.b||b!=c.b&&(c.b!=pk||b!=ok)||a.length>c.a.length)c=!1;else{for(var d=0;d<a.length;d++)if(-1==c.a.indexOf(a[d])){c=!1;break a}c=!0}else if("repeat"==this.d)a:if(c=this.b,c.a&&c.b&&b==c.b&&c.a.length==a.length){for(d=0;d<a.length;d++)if(-1==c.a.indexOf(a[d])){c=!1;break a}c=!0}else c=!1;else c="all"==this.d?!0:!1;return c};
h.zc=function(a,b,c,d){function e(c){l.e++;m=new Jm(c,l.e,b,k);g=l.Ja();re(l.logger,g+" BEGIN "+Eh(b)+" "+k);l.b=m;Km(l.b,a,d)}function f(a,b){re(l.logger,g+" "+a);if(m)m.onCompleted(a,b);l.a=0}var g;this.C&&(b=this.C);this.Q&&(c=this.Q);var k=t(c)?c:ok,l=this,m;if(this.b&&this.b.d&&this.Sh(b,k))Km(this.b,a,d);else{if(this.t&&this.e>=this.t)throw new zd("Exceed maximum number of transactions of "+this.t);this.I().transaction(e,b,k,f)}};
h.request=function(a,b,c,d){var e=new sk(a),f=this;this.zc(function(a){f.a++;tk(e,a,f.Ja()+"R"+f.a)},b,c||ok,function(a,b){vk(e);d&&d(a,b)});return e};h.Kb=function(a,b,c,d,e){var f=this,g;this.zc(function(c){f.a++;g=f.Ja()+"R"+f.a;Q(f.logger,g+" BEGIN");b(c,g,function(b,d){f.c=c;g=f.Ja()+"R"+f.a;d?(Q(f.logger,g+" ERROR"),a.p(b)):(Q(f.logger,g+" SUCCESS"),a.callback(b));f.c=null});b=null;Q(f.logger,g+" END")},c,d,e)};h.toString=function(){return"Parallel:"+this.d+":"+this.Ja()+(this.c?"*":"")};function Mm(a,b){Lm.call(this,a,b,gl)}A(Mm,Lm);h=Mm.prototype;h.logger=L("ydn.db.tr.AtomicParallel");h.Sh=function(){return!1};h.request=function(a,b,c){var d,e,f,g=this,k=Mm.f.request.call(this,a,b,c,function(a,b){vk(k);Q(g.logger,"transaction "+a);if(d)"complete"!=a&&(f=!0,e=b),d(e,f);else{var c=new bl;S(k,c,!0)}});xk(k,function(a,b,c){f=b;e=a;d=c});return k};
h.Kb=function(a,b,c,d,e){var f,g,k=new B;k.m(function(a){g=!1;f=a},function(a){g=!0;f=a});Mm.f.Kb.call(this,k,b,c,d,function(b,c){if("complete"!=b)a.p(c);else if(!0===g)a.p(f);else if(!1===g)a.callback(f);else{var d=new bl;a.p(d)}e&&(e(b,c),e=void 0)})};h.toString=function(){return"Atomic"+Mm.f.toString.call(this)};function Nm(a,b,c){Cm.call(this,a,b,c);this.h=0;a=!0;b=gl;c&&(t(c.isSerial)&&(a=!!c.isSerial),c.policy&&(b=c.policy));c=Om(this,b,a);this.Na=Om(this,"atomic",!1);this.a=this.Vc(c,this.Na)}A(Nm,Cm);Nm.prototype.h=0;function Pm(a,b,c){b=b||gl;b=Om(a,b,c,void 0,void 0,void 0);return a.Vc(b,a.Na)}Nm.prototype.Vc=function(a,b){return new pl(this,this.b,a,b)};
function Om(a,b,c,d,e,f){if(c){if("multi"==b||"repeat"==b||"all"==b||b==gl)return new jl(a,a.h++,b,d,e,f);if("atomic"==b)return new ol(a,a.h++);throw new I('Invalid requestType "'+b+'"');}if("multi"==b||"repeat"==b||"all"==b||b==gl)return new Lm(a,a.h++,b,d,e,f);if("atomic"==b)return new Mm(a,a.h++);throw new I('Invalid requestType "'+b+'"');}
Nm.prototype.e=function(a,b,c){if(3<arguments.length)throw new I("too many input arguments, run accept not more than 3 input arguments, but "+arguments.length+" found.");this.h++;var d=b||Al(this.b),e=ok;if(c)if("readwrite"==c)e=pk;else if("readonly"!=c)throw new I('Invalid transaction mode "'+c+'"');var f=Om(this,"all",!1,d,e,1),g=this.Vc(f,this.Na),k=new sk("run"),l=this;f.zc(function(b){O(l.logger,"executing run in transaction on "+f);tk(k,b,f.Ja()+"R0");a(g)},d,e,function(a){vk(k);S(k,f.e,"complete"!==
a)});return k};function Qm(a,b,c){Nm.call(this,a,b,c);a=this.b;for(b=0;b<a.a.length;b++){c=a.a[b];var d=W(a,c.getName());if(d){if(!Cl(d,"k"))throw new I('full text index store "'+d.getName()+'" must have "keyword" index');if(!Cl(d,"v"))throw new I('full text index store "'+d.getName()+'" must have "keyword" index');if("id"!=d.keyPath)throw new I('full text index store "'+d.getName()+'" must use "id" as key path.');}else throw new I('full text index store "'+c.getName()+'" required.');for(d=0;d<c.count();d++){var e=
c.index(d),f=W(a,e.D());if(f)this.Fg(f,c);else throw new I('full text source store "'+e.D()+'" does not exist for full text index "'+c.getName()+'"');}}}A(Qm,Nm);h=Qm.prototype;h.init=function(){Qm.f.init.call(this)};h.Vc=function(a,b){return new xl(this,this.b,a,b)};h.add=function(a,b,c){return this.a.add(a,b,c)};h.count=function(a,b,c,d){return this.a.count(a,b,c,d)};h.get=function(a,b){return this.a.get(a,b)};h.keys=function(a,b,c,d,e,f,g){return this.a.keys(a,b,c,d,e,f,g)};
h.$=function(a,b,c,d,e,f){return this.a.$(a,b,c,d,e,f)};h.list=function(a,b,c,d,e,f,g,k,l){return this.a.list(a,b,c,d,e,f,g,k,l)};h.load=function(a,b,c){return this.a.load(a,b,c)};h.put=function(a,b,c){return this.a.put(a,b,c)};h.clear=function(a,b,c){return this.a.clear(a,b,c)};h.remove=function(a,b,c){return this.a.remove(a,b,c)};h.toString=function(){var a="Storage:"+this.getName();nl(this)&&(a+=" ["+hl(this)+"]");return a};function Rm(a,b,c,d,e){this.a=b instanceof U?b:v(b)&&t(c)?Sk(b,c,d,e):Mk(b);this.b=a}Rm.prototype.b="";Rm.prototype.jd=function(){return this.b};Rm.prototype.$e=function(a){if(this.b!=a.b)return null;a=null!=this.a&&null!=a.a?this.a.$e(a.a):this.a||a.a;return new Rm(this.b,a)};function Sm(a,b,c,d){tc.call(this);this.b=c;this.N=c.getName();this.Ya=void 0;this.d=!1;this.Z=null;this.h=a;this.Yb=b;this.ta=0;this.Y=this.G=!1;this.T=d||4;this.r=this.c=this.a=void 0;this.l=function(){throw new Ad;};this.C=function(){throw new Ad;};this.gb=function(){}}A(Sm,tc);h=Sm.prototype;
h.init=function(a,b,c,d,e){if(t(b)){a=this.b;var f,g=b;u(b)?(f=om(a,b),g=b.join(", ")):f=Bl(a,b);if(!f)throw new I('require index "'+g+'" not found in store "'+a.getName()+'"');this.Ya=f.getName()}this.d=v(this.Ya);this.Z=c||null;this.ta=0;this.Y=this.G=!1;this.reverse="prev"==d||"prevunique"==d;this.unique="nextunique"==d||"prevunique"==d;this.pb=d;this.td=e;this.r=this.c=this.a=void 0};h.pb="";h.Z=null;h.unique=!1;h.reverse=!1;h.td=!0;h.logger=L("ydn.db.core.req.AbstractCursor");
function Tm(a,b){a.C(b);Um(a);a.G=!0}h.mb=function(a,b,c){null==a&&(Q(this.logger,this+" finished."),this.G=!0);this.a=a;this.c=b;this.r=c;this.ta++;this.G?(O(this.logger,this+" DONE."),this.l(),Um(this)):(O(this.logger,this+" new cursor position {"+(this.d?this.a+", "+this.c:this.a)+"}"),this.l(this.a))};h.u=function(){this.h=null};h.toString=function(){return"Cursor:"+this.N+(t(this.Ya)?":"+this.Ya:"")+"["+(this.h?"":"~")+this.Yb+"]"};
function Um(a){null!=a.c?a.c=Fk(a.c):a.c=void 0;null!=a.a?a.a=Fk(a.a):a.a=void 0;a.gb(a.Y,a.a,a.c)}h.open=function(a,b,c,d){this.h=a;this.Yb=b;this.G=this.Y=!1;this.a=c;this.c=d;this.openCursor(this.a,this.c)};function Vm(a){a.Y=!0;O(a.logger,a+": exit");Um(a)}h.da=function(){return this.ta};h.aa=function(){return this.d?this.c:this.a};h.K=function(){return this.td?this.aa():this.r};h.ed=function(){};h.cc=function(){};
h.restart=function(a,b){O(this.logger,this+" restarting");this.Y=this.G=!1;this.openCursor(b,a)};function Wm(){};function Xm(a,b,c,d,e,f,g){if(!v(a))throw new TypeError("store name must be a string, but "+a+" found.");this.c=a;this.b=b;this.h=g;this.i=!!this.b;if(t(d)&&!ga(d))throw new I("reverse value must be a boolean, but "+typeof d+" found");if(t(e)&&!ga(e))throw new I("unique value must be a boolean, but "+typeof e+" found");if(t(f)&&!ga(f))throw new I("key_only value must be a boolean, but "+typeof f+" found");this.a=t(f)?f:!!v(this.b);a="next";d&&e?a="prevunique":d?a="prev":e&&(a="nextunique");this.e=
a;if(d=Ok(c))throw new I("Invalid key range: "+d);this.d=Ik(c);this.t=Ym;this.Q=NaN}A(Xm,Wm);Xm.prototype.a=!0;function Zm(a,b,c,d,e){if(!v(b))throw new I("index name must be string");Xm.call(this,a,b,c,d,e,!0)}A(Zm,Xm);function $m(a,b,c){if(3<arguments.length)throw new I("too many argument");Xm.call(this,a,void 0,b,c,void 0,!1)}A($m,Xm);function an(a,b){return new $m(a,Sk("starts",b,void 0,void 0))}
function bn(a,b,c,d,e){if(!v(b))throw new I("index name must be string");Xm.call(this,a,b,c,d,e,!1)}A(bn,Xm);var Ym="init";h=Xm.prototype;h.logger=L("ydn.db.Iterator");h.D=function(){return this.c};h.clone=function(){var a=new Xm(this.c,this.b,this.d,cn(this),dn(this),this.a,this.h);a.Q=this.Q;return a};h.unique=function(a){return new Xm(this.c,this.b,this.d,cn(this),a,this.a,this.h)};h.toJSON=function(){return{store:this.c,index:this.b,keyRange:this.d?Gk(this.d):null,direction:this.e}};
h.toString=function(){var a=t(this.h)?":"+this.h.join(","):t(this.b)?":"+this.b:"",a=a+Pk(this.d);this.t!=Ym&&(a+=this.t+"{"+this.r,this.i&&(a+=", "+this.l),a+="}");var b=this.i?"Index":"",b=b+(this.a?"Key":"Value");return b+"Iterator:"+this.c+a};h.reverse=function(){return new Xm(this.c,this.b,this.d,!cn(this),dn(this),this.a,this.h)};function cn(a){return"prev"===a.e||"prevunique"===a.e}function dn(a){return"nextunique"===a.e||"prevunique"===a.e}h.getState=function(){return this.t};
h.load=function(a){a=a[0];a.init(this.c,this.h||this.b,this.d,this.e,this.a);this.t="busy";var b=this;a.gb=function(a,d,e){b.r=d;b.l=e;b.t=a?"rest":"done"};a.openCursor(this.r,this.l);return a};h.aa=function(){return this.l};h.stores=function(){return[this.c]};function en(a,b,c,d){pl.call(this,a,b,c,d)}A(en,xl);h=en.prototype;h.logger=L("ydn.db.core.DbOperator");h.get=function(a,b){if(a instanceof Xm){var c=a.D(),d=W(this.b,c);if(!d)throw new I('store "'+c+'" not found.');var e=a.b;if(t(e)&&!Cl(d,e))throw new I('index "'+e+'" not found in store "'+c+'".');Q(this.logger,"getByIterator:"+a);var f=this.a.request("get:iter",[c]);T(f,function(){fn(this,5,f,a,1)},this);return f}return en.f.get.call(this,a,b)};
h.keys=function(a,b,c,d,e,f,g){if(a instanceof Xm){var k=100;if(ha(b)){if(k=b,1>k)throw new I("limit must be a positive value, but "+b);}else if(t(b))throw new I("limit must be a number,  but "+b);if(t(c))throw new I("offset must not be specified");Q(this.logger,"keysByIterator:"+a);var l=this.a.request("keys:iter",[a.D()]);T(l,function(){a.i?fn(this,1,l,a,k):fn(this,2,l,a,k)},this);return l}return en.f.keys.call(this,a,b,c,d,e,f,g)};
h.count=function(a,b,c,d){if(a instanceof Xm){if(t(b)||t(c))throw new I("too many arguments.");Q(this.logger,"countIterator:"+a);var e=this.a.request("count",[a.D()]);T(e,function(){fn(this,6,e,a)},this);return e}return en.f.count.call(this,a,b,c,d)};
h.$=function(a,b,c,d,e,f){if(a instanceof Xm){var g;if(ha(b)){if(g=b,1>g)throw new I("limit must be a positive value, but "+g);}else if(t(b))throw new I("limit must be a number, but "+b);if(t(c))throw new I("offset must not be specified");Q(this.logger,"listByIterator:"+a);var k=this.a.request("values:iter",[a.D()]);T(k,function(){a.a?fn(this,2,k,a,g):fn(this,4,k,a,g)},this);return k}return en.f.$.call(this,a,b,c,d,e,f)};
function gn(a,b,c){if(!u(c))throw new I("iterators argument must be an array, but "+c+" of type "+typeof c+" found");for(var d=0;d<c.length;d++)if(!(c[d]instanceof Xm))throw new I("Iterator at "+d+" must be cursor range iterator.");for(var e=[],d=0;d<c.length;d++)for(var f=c[d].stores(),g=0;g<f.length;g++)jb(e,f[g])||e.push(f[g]);Q(a.logger,a+": scan for "+c.length+" iterators on "+e);d=a.a.request("scan",e);a.a.Kb(d,function(d,e,f){function g(b){for(var c=0;c<J.length;c++)Vm(J[c]);kb(J);Q(a.logger,
q+" error");f(b,!0)}function p(d,e){if(s)throw new zi;Z++;var g=Z===w,k=y[d],l=c[k],n=J[k],k=n.aa(),n=n.K();G[d]=e;H[d]=l.i?l.a?k:n:l.a?e:n;if(g){var p;p=b(G,H);g=[];l=[];k=[];n=[];if(u(p))for(var N=0;N<p.length;N++)!0===p[N]?k[N]=1:!1===p[N]?n[N]=!0:l[N]=p[N];else if(null===p)g=[];else if(t(p))if(x(p)){g=["advance","continue","continuePrimary","restart"];for(N in p)if(!jb(g,N))throw new zd('Unknown attribute "'+N+'" in cursor advancement object');g=p.continuePrimary||[];l=p["continue"]||[];k=p.advance||
[];n=p.restart||[]}else throw new zd("scan callback output");else for(g=[],N=0;N<c.length;N++)t(y[N])&&(k[N]=1);for(N=Z=p=0;N<c.length;N++)null!=g[N]||t(l[N])||null!=n[N]||null!=k[N]||Z++;for(N=0;N<c.length;N++)if(null!=g[N]||t(l[N])||null!=n[N]||null!=k[N]){var Kk=y[N];if(!t(Kk))throw new Bi(N+" is not an iterator.");var Kk=c[Kk],Qe=J[N];if(null==G[N]){var Ho=N+"/"+c.length;if(null!=k[N])throw new Ci(Qe+" "+Ho+" must not advance "+k[N]+" steps");if(t(l[N]))throw new Ci(Qe+" "+Ho+" must not continue to key "+
l[N]);if(null!=g[N])throw new Ci(Qe+" "+Ho+" must not continue to primary key "+g[N]);}G[N]=void 0;H[N]=void 0;if(null!=n[N])Qe.restart();else if(t(l[N]))Qe.cc(l[N]);else if(null!=g[N])Qe.ed(g[N]);else if(null!=k[N])Qe.advance(1);else throw new zi(Kk+": has no action");p++}if(0==p){for(N=0;N<J.length;N++)Vm(J[N]);s=!0;kb(J);Q(a.logger,"success "+q);f(void 0)}}}var q=e+" "+a+" scanning";O(a.logger,q);var s=!1,w,y=[],G=[],H=[],J=[],Z=0;(function(){for(var b=0,f=0;f<c.length;f++){var m=c[f],q=[V(a).b(d,
e,m.D())],m=m.load(q);m.C=g;m.l=pa(p,b);J[f]=m;y[b]=f;b++}w=c.length})()},e,ok);return d}
h.open=function(a,b,c,d){if(!(b instanceof Xm))throw new I("Second argument must be cursor range iterator.");for(var e=b.stores(),f=0;f<e.length;f++)if(!W(this.b,e[f]))throw new I('Store "'+e[f]+'" not found.');c=c||ok;var g=this,k=this.a.request("open",b.stores(),c);Q(this.logger,"open:"+c+" "+b);T(k,function(c){var e=yk(k);Q(g.logger,e+" iterating "+b);for(var f=b.stores(),p=[],q=0;q<f.length;q++)p[q]=V(g).b(c,e,f[q]);var s=b.load(p);s.C=function(a){S(k,a,!0)};s.l=function(b){null!=b?(b=a.call(d,
s),!0===b?s.restart():x(b)?!0===b.restart?s.restart(b["continue"],b.continuePrimary):null!=b["continue"]?s.cc(b["continue"]):null!=b.continuePrimary?s.ed(b.continuePrimary):(Vm(s),S(k,void 0)):null===b?(Vm(s),S(k,void 0)):null!=b?s.cc(b):s.advance(1)):(Vm(s),S(k,void 0))}},this);return k};
h.map=function(a,b){for(var c=this,d=a.stores(),e,f=0;e=d[f];f++)if(!e)throw new I('Store "'+e+'" not found.');e=this.a.request("map",d);O(this.logger,"map:"+a);this.a.Kb(e,function(d,e,f){O(c.logger,e+" iterating "+a);for(var m=a.stores(),n=[],p=0;p<m.length;p++)n[p]=V(c).b(d,e,m[p]);var q=a.load(n);q.C=function(a){f(a,!1)};q.l=function(c){if(null!=c){var d;a.i?a.a?d=c:d=q.aa():a.a?d=c:d=q.K();b(d);q.advance(1)}else f(void 0),b=null}},d,ok);return e};
h.reduce=function(a,b,c){for(var d=this,e=a.stores(),f,g=0;f=e[g];g++)if(!f)throw new I('Store "'+f+'" not found.');f=this.a.request("reduce",e);var k=x(c)?Am(c):c;Q(this.logger,"reduce:"+a);this.a.Kb(f,function(c,e,f){for(var g=a.stores(),q=[],s=0;s<g.length;s++)q[s]=V(d).b(c,e,g[s]);var w=a.load(q);w.C=function(a){f(a,!0)};var y=0;w.l=function(c){if(null!=c){var d;a.i?a.a?d=c:d=w.aa():a.a?d=c:d=w.K();k=b(k,d,y++);w.advance(1)}else f(k)}},e,ok);return f};
function fn(a,b,c,d,e){var f=[],g=c.a,k=yk(c),l=k+" "+b+"ByIterator "+d;0<e&&(l+=" limit "+e);Q(a.logger,l);for(var m=V(a),n=[],p=d.stores(),q=0;q<p.length;q++)n[q]=m.b(g,k,p[q]);var s=d.load(n);s.C=function(a){Vm(s);S(c,a,!0)};var w=0,y=!1;s.l=function(d){y||(O(a.logger,l+" starting"),y=!0);null!=d?(s.aa(),w++,1==b?f.push(d):2==b?f.push(s.aa()):3==b?f.push([d,s.aa()]):6!=b&&f.push(s.K()),5==b?(Vm(s),S(c,f[0])):6==b||!t(e)||w<e?s.cc():(Q(a.logger,"success:"+l+" yields "+f.length+" records"),Vm(s),
S(c,f))):(Q(a.logger,"success:"+l+" yields "+f.length+" records"),Vm(s),S(c,5==b?f[0]:6==b?w:f))}};function hn(a,b,c){Qm.call(this,a,b,c)}A(hn,Qm);hn.prototype.Vc=function(a,b){return new en(this,this.b,a,b)};hn.prototype.open=function(a,b,c,d){return this.a.open(a,b,c,d)};hn.prototype.map=function(a,b){return this.a.map(a,b)};hn.prototype.reduce=function(a,b,c){return this.a.reduce(a,b,c)};function jn(a,b,c){F.call(this);this.b=a;this.name=b;this.db=c;this.c=Pm(this.db,"atomic",!1);this.a=null}A(jn,F);h=jn.prototype;h.logger=L("ydn.db.sync.Entity");
function kn(a,b,c,d){var e={op:b,entity:a.name,id:c,"new":d,timestamp:(new Date).getTime()};if("add"==b)return a.db.put("_ydn_sync_history",e).n(function(a){e.sequence=a;return e});var f=new B;ln(a,c).n(function(a){e.old=a[0];e.key=[c];null!=a[1]&&e.key.push(a[1]);nc(this.db.put("_ydn_sync_history",e).n(function(a){e.sequence=a;return e}),f)},a);return f}
function mn(a,b,c,d){a.b.list(function(d,f,g,k,l){200==d?(d=f.length,0<d?(a.db.e(function(b){for(var c=[],d=0;d<g.length;d++){if(!Ek(g[d]))throw Error('Invalid key "'+g[d]+'" at '+d+" of "+g.length+" keys");b.clear(a.name,Lk([g[d]]));c[d]=[g[d]];null!=k[d]&&c[d].push(k[d])}b.put(a.name,f,c)},[a.name],"readwrite"),c+=d,l?(ue(b,c),mn(a,b,c,l)):b.callback(c)):b.callback(c)):b.p(d)},a.name,d)}
h.update=function(){this.a||(this.a=new se,te(this.a,function(){this.dispatchEvent(new E("change",this))},this),this.a.n(function(a){0<a&&this.dispatchEvent(new E("updated",this));var b=this;setTimeout(function(){b.a=null},200)},this),mn(this,this.a,0,null));return this.a};function ln(a,b){var c=an(a.name,[b]),d,e;return a.c.open(function(a){e=a.a[1];d=a.K();return null},c,ok,a).n(function(){return[d,e]})}
h.get=function(a){var b=new se,c=this.db,d=this.name;ln(this,a).n(function(e){var f=e[0];e=e[1];f&&ue(b,f);this.b.get(function(e,k,l){200==e?(e=[a],null!=l&&e.push(l),c.put(d,k,e),b.callback(k)):404==e?(f&&c.clear(d,Lk([a])),b.callback(void 0)):304==e?b.callback(f):b.p(Error("Unknown "+e))},this.name,a,e)},this);return b};
h.add=function(a){var b=this;Q(this.logger,this+" adding a record");return this.c.add(this.name,a).n(function(c){O(b.logger,b+" add new record as "+c);return kn(b,"add",c,a).n(function(d){O(b.logger,b+" log as "+c);var e=new B;b.b.add(function(f,g,k,l){if(200==f||201==f){if(!Ek(k))throw Error('Invalid key "'+k+'" on adding to '+b);O(b.logger,b+" backend persist as "+k+" ["+l+"] "+f);b.db.e(function(d){d.remove(b.name,c);var f=[k];null!=l&&f.push(l);d.add(b.name,g||a,f).m(function(a){Q(b.logger,b+
" add "+a+" succeeded.");e.callback(a)},function(a){Q(b.logger,b+' adding "'+f+'" failed '+a.message);window.console.error(a.stack||a);e.p(a)})},[b.name,"_ydn_sync_history"],"readwrite")}else O(b.logger,b+" backend persist fail, rolling back"+f),b.db.e(function(a){d.old?a.put(b.name,d.old,d.key):a.remove(b.name,d.key);a.remove("_ydn_sync_history",d.sequence);O(b.logger,b+" removed log and temp record.")},[b.name,"_ydn_sync_history"],"readwrite").V(function(){e.p(f)})},b.name,a);return e})})};
h.put=function(a,b){var c=this;return kn(this,"put",a,b).n(function(d){return c.c.put(c.name,b,d.key).n(function(){var e=new B;c.b.put(function(a,g,k,l){200==a||201==a?c.db.e(function(a){a.remove("_ydn_sync_history",d.sequence);a.remove(c.name,d.key).n(function(){var d=[k];null!=l&&d.push(l);a.put(c.name,g||b,d)})},[c.name,"_ydn_sync_history"],"readwrite").V(function(){e.callback(g)}):c.db.e(function(a){d.old?a.put(c.name,d.old,d.key):a.remove(c.name,d.key);a.remove("_ydn_sync_history",d.sequence)},
[c.name,"_ydn_sync_history"],"readwrite").V(function(){e.p(a)})},c.name,b,a,d.key[1]);return e})})};
h.remove=function(a){return kn(this,"del",a,null).n(function(b){return this.db.remove(this.name,b.key).n(function(c){var d=new B,e=this;this.b.remove(function(a){200==a||404==a?(e.db.remove("_ydn_sync_history",b.sequence),d.callback(c)):e.db.e(function(a){b.old?a.put(e.name,b.old,b.key):a.remove(e.name,b.key);a.remove("_ydn_sync_history",b.sequence)},[e.name,"_ydn_sync_history"],"readwrite").V(function(){d.p(a)})},e.name,a,b.key[1]);return d},this)},this)};h.getName=function(){return this.name};
hn.prototype.Q=function(a,b){return new jn(a,b,this)};jn.prototype.toString=function(){return"Entity:"+this.name};function nn(a,b){this.b=a;this.c=b;this.a=""}h=nn.prototype;h.logger=L("ydn.crm.tracking.Service");h.remove=function(){};h.get=function(){};
h.list=function(a,b,c){function d(b){k.b.request(new Qi(e,"GET",b)).execute(function(b,c){if(200==c.H()){for(var d=[],e=[],k=0;k<b.length;k++)d[k]=b[k][f],e[k]=b[k][g];k=Xj(c,"after");a(c.H(),b,d,e,k)}else a(c.H(),[],[],[],null)},k)}var e=on[b],f=pn[b],g=qn[b],k=this,l={};if("AccessTokenRecord"==b){var m=Si.B();if(!m.isLogin()){M(this.logger,"User not login");a(999,[],[],[],null);return}if(!this.a){var n=new nh;n.update(m.user_id);this.a=Tg(n.d())}l.prefix="/t/"+this.a+"/"}else if("BeaconTrack"!=
b)throw Error(b);c?(l.after=c,d(l)):(b=new Zm(b,g,null,!0),this.c.keys(b,1).m(function(a){a[0]&&(l.after=a[0]);d(l)},function(b){M(this.logger,b.message);a(400,[],[],[],null)},this))};h.add=function(a,b,c){this.b.request(new Qi(on[b],"POST",null,null,JSON.stringify(c))).execute(function(b,c){var f=c.H();if(201==f||200==f){var f=b.path,g=Xj(c,"etag");delete b.created;a(c.H(),b,f,g)}else a(c.H(),null,NaN,void 0)},this)};h.put=function(){};
var on={BeaconTrack:"/track/",AccessTokenRecord:"/track-access/"},pn={BeaconTrack:"path",AccessTokenRecord:"ID"},qn={BeaconTrack:"created",AccessTokenRecord:"Created"};function rn(a,b,c,d){this.h=t(b)?b:Tj();this.e="sr"+sn++;this.i=c||0;this.d=!!d;this.a=a}var sn=0;rn.prototype.s=function(){return this.e};
rn.prototype.execute=function(a,b){var c=this.a,d=new Ge(c.path),e;for(e in c.params)d.a.set(e,c.params[e]);this.h.send(this.e,d.toString(),c.method,c.body,c.headers,void 0,function(d){d=d.target;for(var e=(d.O&&4==zg(d)?d.O.getAllResponseHeaders():"").split("\n"),k={},l=0;l<e.length;l++){var m=e[l].indexOf(":");0<m&&(k[e[l].substr(0,m).toLowerCase()]=e[l].substr(m+1).trim())}e=l=Bg(d);if(k["content-type"]&&/json/.test(k["content-type"]))if(x(l))e=l;else if(v(l))try{e=Ch(l)}catch(n){e=l}k=new Uj(d.H(),
l,k,d.Da());ak&&!Ti(k)&&ak.log({"class":"ydn.gdata.Entry",method:"commit",context:"HTTP request",HttpRequestData:{path:c.path,uri:String(d.l),method:c.method,params:c.params,headers:c.headers,body:c.body},HttpRespondData:{status:k.H(),statusText:k.Da(),body:Wj(k),headers:k.Nc()}});a&&(a.call(b,e,k),a=null)},this.i,void 0,this.d);this.h=null};rn.prototype.toString=function(){return"HTTPRequest:"+this.e};function tn(a,b,c){this.b=a;this.c=b;this.a=null;this.xj=t(c)?c:!0}tn.prototype.request=function(a){return new un(a,this)};function un(a,b){rn.call(this,a,b.c);this.parent=b}A(un,rn);var vn=new Uj(0,null,null,"No access token");
un.prototype.execute=function(a,b){function c(){this.xj?d.a.headers.Authorization="Bearer "+d.parent.a.access_token:d.a.params.access_token=d.parent.a.access_token}var d=this;d.parent.a&&d.parent.a.expires>z()?(c(),un.f.execute.call(this,function(e,f){401==f.H()?wn(d.parent.b).m(function(e){d.parent.a=e;c();un.f.execute.call(d,a,b)},function(){d.parent.a=null;a.call(b,null,vn)},d):a.call(b,e,f)},this)):wn(this.parent.b).m(function(e){d.parent.a=e;c();un.f.execute.call(this,a,b)},function(){d.parent.a=
null;a.call(b,null,vn)},this)};function xn(a,b,c,d){Sm.call(this,a,b,c,d);this.e=null}A(xn,Sm);h=xn.prototype;h.logger=L("ydn.db.core.req.IDBCursor");h.Ud=function(a){(a=a.target.result)?this.mb(a.key,a.primaryKey,a.value):this.mb()};
h.openCursor=function(a,b){function c(a,b,c){p.e=n;p.e.onsuccess=oa(p.Ud,p);p.mb(a,p.d?b:void 0,c);n=null}var d=this+" opening ";null!=a&&(d+="{"+a,d=null!=b?d+(";"+b+"}"):d+"}");O(this.logger,d);var e=this.Z,d=this.h.objectStore(this.N),f=v(this.Ya)?d.index(this.Ya):null;if(t(a))var g=f?!t(b):!0,k=e?e.lower:void 0,l=e?e.upper:void 0,m=e?!!e.lowerOpen:!1,e=e?!!e.upperOpen:!1,e=Hk(this.reverse?new U(k,a,m,g):new U(a,l,g,e));var n;this.td?f?n=null!=this.pb?f.openKeyCursor(e,this.pb):null!=e?f.openKeyCursor(e):
f.openKeyCursor():n=null!=this.pb?d.openCursor(e,this.pb):null!=e?d.openCursor(e):d.openCursor():f?n=null!=this.pb?f.openCursor(e,this.pb):null!=e?f.openCursor(e):f.openCursor():n=null!=this.pb?d.openCursor(e,this.pb):null!=e?d.openCursor(e):d.openCursor();var p=this;n.onerror=function(a){var b=n.error;a.preventDefault();Tm(p,b)};null!=a?n.onsuccess=function(d){if(d=d.target.result){var e=rk.cmp(d.key,a),f=p.reverse?-1:1;if(e==f)c(d.key,d.primaryKey,d.value);else if(e==-f)d["continue"](a);else if(null!=
b)if(rk.cmp(d.primaryKey,b)==f)c(d.key,d.primaryKey,d.value);else d["continue"]();else d["continue"]()}else c()}:(p.e=n,p.e.onsuccess=oa(p.Ud,p))};h.je=function(){return!!this.e};h.update=function(a){var b=this.e.result;if(b){var c=new B;a=b.update(a);a.onsuccess=function(a){c.callback(a.target.result)};a.onerror=function(a){a.preventDefault();c.p(a)};return c}throw new Xk("cursor gone");};
h.clear=function(){var a=this.e.result;if(a){var b=new B,a=a["delete"]();a.onsuccess=function(){b.callback(1)};a.onerror=function(a){a.preventDefault();b.p(a)};return b}throw new Xk("cursor gone");};h.advance=function(a){var b=this.e.result;if(1==a)b["continue"]();else b.advance(a)};
h.ed=function(a){var b=this.e.result,c=rk.cmp(a,b.primaryKey);if(c!=(this.reverse?-1:1))throw new Ad('continuing primary key "'+a+'" must '+(this.reverse?"lower":"higher")+' than current primary key "'+b.primaryKey+'"');var d=this;this.e.onsuccess=function(e){if(b=e.target.result)if(c=rk.cmp(b.primaryKey,a),0==c||1==c&&!d.reverse||-1==c&&d.reverse)d.e.onsuccess=oa(d.Ud,d),d.mb(b.key,d.d?b.primaryKey:void 0,b.value);else b["continue"]();else d.e.onsuccess=oa(d.Ud,d),d.mb()};b["continue"]()};
h.cc=function(a){var b=this.e.result;if(null!=a)b["continue"](a);else b["continue"]()};h.u=function(){xn.f.u.call(this);this.e=null};h.toString=function(){return"IDB"+xn.f.toString.call(this)};function yn(a,b,c,d,e,f){B.call(this,e,f);this.h=a;this.a=[];this.r=!!b;this.gb=!!c;this.ta=!!d;for(b=this.Y=0;b<a.length;b++)a[b].m(oa(this.Q,this,b,!0),oa(this.Q,this,b,!1));0!=a.length||this.r||this.callback(this.a)}A(yn,B);yn.prototype.Q=function(a,b,c){this.Y++;this.a[a]=[b,c];this.b||(this.r&&b?this.callback([a,c]):this.gb&&!b?this.p(c):this.Y==this.h.length&&this.callback(this.a));this.ta&&!b&&(c=null);return c};yn.prototype.p=function(a){yn.f.p.call(this,a);for(a=0;a<this.h.length;a++)ic(this.h[a])};
function zn(a){return(new yn(a,!1,!0)).n(function(a){for(var c=[],d=0;d<a.length;d++)c[d]=a[d][1];return c})};function An(a,b){this.a=b}A(An,cl);h=An.prototype;h.logger=L("ydn.db.crud.req.IndexedDb");h.Td=function(a,b){function c(e){var f=a.a.objectStore(b[e]).count();f.onsuccess=function(f){d[e]=f.target.result;e++;e==b.length?S(a,d):c(e)};f.onerror=function(b){b.preventDefault();S(a,f.error,!0)}}var d=[];0==b.length?S(a,[]):c(0)};
h.lb=function(a,b,c,d,e,f){function g(s){if(null==e[s])if(O(n.logger,"empty object at "+s+" of "+e.length),l++,l==e.length)S(a,k,m);else{var y=s+10;y<e.length&&g(y)}var G,y=e[s];G=f&&null!=f[s]?b?q.put(y,f[s]):q.add(y,f[s]):b?q.put(y):q.add(y);G.onsuccess=function(b){l++;k[s]=b.target.result;l==e.length?S(a,c?k[0]:k,m):(b=s+10,b<e.length&&g(b))};G.onerror=function(b){l++;var f=G.error;O(n.logger,yk(a)+p+' request to "'+d+'" cause '+f.name+' for object "'+Dh(e[s])+'" at index '+s+" of "+e.length+" objects.");
k[s]=f;m=!0;b.preventDefault();l==e.length?S(a,c?k[0]:k,m):(b=s+10,b<e.length&&g(b))}}var k=[],l=0,m=!1,n=this,p=b?"put":"add",q=a.a.objectStore(d);O(this.logger,yk(a)+" "+p+" "+e.length+' objects to store "'+d+'"');if(0<e.length)for(var s=0;10>s&&s<e.length;s++)g(s);else S(a,[])};
h.ze=function(a,b,c){function d(l){var n=c[l],p=n.D(),q=a.a.objectStore(p),s;s=null===q.keyPath?q.put(b[l],n.s()):q.put(b[l]);s.onsuccess=function(c){f++;e[l]=c.target.result;f==b.length?S(a,e,g):(c=l+10,c<b.length&&d(c))};s.onerror=function(c){f++;M(k.logger,"request result "+c.name+' error when put keys to "'+p+'" for object "'+Dh(b[l])+'" at index '+l+" of "+b.length+" objects.");e[l]=s.error;g=!0;c.preventDefault();f==b.length?S(a,e,g):(c=l+10,c<b.length&&d(c))}}var e=[],f=0,g=!1,k=this;O(this.logger,
yk(a)+" putByKeys: of "+b.length+" objects");if(0<b.length)for(var l=0;10>l&&l<b.length;l++)d(l);else S(a,e,g)};
h.cg=function(a,b,c,d,e,f){function g(){var a={},b=e.indexOf("\n",n),d=!1,s;-1==b?(d=!0,s=e.substring(n)):(s=e.substring(n,b),n=b+1);for(var b=s.split(f),J=0;J<p.length;J++){var Z=b[J];q[J]&&(q[J]==bm?Z=Na(Z,'"'):"INTEGER"==q[J]?Z=parseInt(Z,10):"NUMERIC"==q[J]&&(Z=parseFloat(Z)));a[p[J]]=Z}var Ua=l.put(a);Ua.onsuccess=function(a){m.push(a.target.result);d?c(m):g()};Ua.onerror=function(a){"DataError"==a.name&&(a=new Uk(k+": "+s.substring(0,70)));a.preventDefault();c(Ua.error,!0)}}var k=W(this.a,d),
l=a.objectStore(d),m=[],n=e.indexOf("\n"),p=e.substr(0,n).split(f),q=[];for(a=0;a<p.length;a++){var s=Bl(k,p[a]);s?q[a]=s.type:p[a]==k.keyPath&&(q[a]=k.type)}n++;O(this.logger,b+" Loading data  of "+p.length+"-fields record to "+d);g()};
h.Ae=function(a,b,c){var d=a.a.objectStore(b);O(this.logger,yk(a)+" clearById: "+b+" "+c);var e=d.openCursor(Nk.only(c));e.onsuccess=function(b){if(b=b.target.result){var c=b["delete"]();c.onsuccess=function(){S(a,1)};c.onerror=function(){S(a,c.error,!0)}}else S(a,0)};e.onerror=function(b){b.preventDefault();S(a,e.error,!0)}};
h.Be=function(a,b){function c(k){k++;if(k>=b.length)0<g.length?S(a,g,!0):S(a,d);else{b[k].D()!=e&&(e=b[k].D(),f=a.a.objectStore(e));var l=f["delete"](b[k].s());l.onsuccess=function(){d++;c(k)};l.onerror=function(a){a.preventDefault();g[k]=l.error;c(k)}}}var d=0,e,f;O(this.logger,yk(a)+" removeByKeys: "+b.length+" keys");var g=[];c(-1)};
h.wd=function(a,b,c){var d=a.a.objectStore(b),e=d.count(c);O(this.logger,yk(a)+" clearByKeyRange: "+b+" "+c);e.onsuccess=function(b){var e=b.target.result,k=d["delete"](c);k.onsuccess=function(){S(a,e)};k.onerror=function(){S(a,k.error,!0)}};e.onerror=function(b){b.preventDefault();S(a,e.error,!0)}};h.ef=function(a,b,c){var d=a.a.objectStore(b);O(this.logger,yk(a)+" "+b+" "+c);var e=d["delete"](c);e.onsuccess=function(){S(a,void 0)};e.onerror=function(b){b.preventDefault();S(a,e.error,!0)}};
h.dg=function(a,b,c,d){var e=a.a.objectStore(b).index(c);O(this.logger,yk(a)+" clearByIndexKeyRange: "+b+":"+c+" "+d);var f=[],g=e.openCursor(d),k=0;g.onsuccess=function(b){var c=b.target.result;if(c){var d=c["delete"]();d.onsuccess=function(){k++;c["continue"]()};d.onerror=function(a){f.push(d.error);a.preventDefault();c["continue"]()}}else 0<f.length?S(a,f,!0):S(a,k)};g.onerror=function(b){b.preventDefault();S(a,g.error,!0)}};
h.Qd=function(a,b){var c=b.length,d=0;O(this.logger,yk(a)+" clearByStores: "+b);for(var e=0;e<c;e++){var f=a.a.objectStore(b[e]).clear();f.onsuccess=function(){d++;d==c&&S(a,d)};f.onerror=function(b){d++;b.preventDefault();d==c&&S(a,f.error,!0)}}};
h.be=function(a,b,c){var d=this;O(this.logger,yk(a)+b+":"+c);var e=a.a.objectStore(b),f=e.get(c);f.onsuccess=function(b){O(d.logger,yk(a)+" record "+c+(null!=b.target.result?" ":" not ")+" exists.");var f=b.target.result;if(!e.keyPath&&0==e.indexNames.length&&Cc&&v(f)&&0<=f.indexOf(";base64,")){'"'==f.charAt(0)&&'"'==f.charAt(f.length-1)&&(f=f.substr(1,f.length-2));f=f.split(";base64,");b=f[0].split(":")[1];for(var f=window.atob(f[1]),l=f.length,m=new Uint8Array(l),n=0;n<l;++n)m[n]=f.charCodeAt(n);
S(a,new Blob([m.buffer],{type:b}))}else S(a,b.target.result)};f.onerror=function(b){b.preventDefault();S(a,f.error,!0)}};
h.Sf=function(a,b,c){function d(b){if(null==c[b])if(f++,e[b]=void 0,f==k)S(a,e);else{var m=b+10;m<k&&d(m)}var n;n=g.get(c[b]);n.onsuccess=function(c){f++;e[b]=c.target.result;f==k?S(a,e):(c=b+10,c<k&&d(c))};n.onerror=function(b){f++;b.preventDefault();S(a,n.error,!0)}}var e=[];e.length=c.length;var f=0,g=a.a.objectStore(b),k=c.length;O(this.logger,yk(a)+" "+b+":"+k+" ids");if(0<k)for(b=0;10>b&&b<k;b++)d(b);else S(a,[])};
h.re=function(a,b){function c(f){var k=b[f],l=a.a.objectStore(k.D()).get(k.s());l.onsuccess=function(k){e++;d[f]=k.target.result;e==b.length?S(a,d):(k=f+10,k<b.length&&c(k))};l.onerror=function(b){e++;b.preventDefault();S(a,l.error,!0)}}var d=[];d.length=b.length;var e=0;O(this.logger,yk(a)+" "+b.length+" ids");if(0<b.length)for(var f=0;10>f&&f<b.length;f++)c(f);else S(a,[])};
h.fd=function(a,b,c,d,e){if(d&&e)throw new zd("unique count not available in IndexedDB");e=a.a.objectStore(b);b=yk(a)+" "+b+(d?":"+d:"")+(c?":"+Eh(c):"");O(this.logger,b);var f;null!=d?(d=e.index(d),f=null!=c?d.count(c):d.count()):f=null!=c?e.count(c):e.count();f.onsuccess=function(b){S(a,b.target.result)};f.onerror=function(b){b.preventDefault();S(a,f.error,!0)}};
h.list=function(a,b,c,d,e,f,g,k,l,m){var n=[],p=a.a.objectStore(c),q=k?l?"prevunique":"prev":l?"nextunique":"next";c=yk(a)+" "+b+" "+c+(d?":"+d:"")+(e?Eh(e):"");k&&(c+=" reverse");l&&(c+=" unique");if(m&&t(m[0])){l=d?!t(m[1]):!0;var s=m[0],w=e?e.lower:void 0,y=e?e.upper:void 0,G=e?!!e.lowerOpen:!1;e=e?!!e.upperOpen:!1;e=Hk(k?new U(w,s,G,l):new U(s,y,l,e));c+=" starting from "+Eh(m[0]);t(m[1])&&(c+=", "+Eh(m[1]))}O(this.logger,c);var H;H=1==b||2==b||3==b?d?p.index(d).openKeyCursor(e,q):p.openCursor(e,
q):d?p.index(d).openCursor(e,q):p.openCursor(e,q);var J=!1;H.onsuccess=function(c){if(c=c.target.result){if(!J){if(0<g){J=!0;c.advance(g);return}if(m&&d&&t(m[0]))if(t(m[1])){var e=rk.cmp(c.key,m[0]),l=k?-1:1;if(0==e){e=rk.cmp(c.primaryKey,m[1]);if(0==e){J=!0;c["continue"]();return}if(e==l)J=!0;else{c["continue"]();return}}else J=!0}else J=!0;else J=!0}1==b?n.push(c.key):2==b?n.push(c.primaryKey):3==b?(l={},d&&(l[d]=c.key),p.keyPath?l[p.keyPath]=c.primaryKey:l._ROWID_=c.primaryKey,n.push(l)):4==b?
n.push(c.value):n.push([c.key,c.primaryKey,c.value]);if(n.length<f)c["continue"]();else m&&(m[0]=Fk(c.key),m[1]=Fk(c.primaryKey)),S(a,n)}else m&&(m[0]=void 0,m[1]=void 0),S(a,n)};H.onerror=function(b){b.preventDefault();S(a,H.error,!0)}};function Bn(a,b){this.a=b}A(Bn,An);Bn.prototype.logger=L("ydn.db.core.req.IndexedDb");Bn.prototype.b=function(a,b,c,d){c=W(this.a,c);return new xn(a,b,c,d)};function Cn(){this.a=!1}Cn.prototype.a=!1;Cn.prototype.state=function(){return this.a};function Dn(a,b,c,d){Sm.call(this,a,b,c,d);this.r=this.c=this.a=void 0;this.i=this.e=null;this.F=new Cn;this.Ee=this.ac=null}A(Dn,Sm);h=Dn.prototype;h.logger=L("ydn.db.core.req.SimpleCursor");h.je=function(){return!!this.h};h.update=function(a){En(this.Ee,this.aa(),a);return sc()};h.advance=function(a){function b(b){d++;if(!b||d>=a)return Fn(c,b)}var c=this,d=this.e?-1:0;this.reverse?Gn(this.ac,b,this.e):Hn(this.ac,b,this.e)};
h.cc=function(a){if(null!=a){var b=this,c=new In(a),d=function(c){b.e=c;if(!c)return Fn(b,c);var d=Ak(c.value.key,a);if(b.reverse){if(1!=d)return Fn(b,c)}else if(-1!=d)return Fn(b,c)};this.reverse?Gn(this.ac,d,c):Hn(this.ac,d,c)}else this.advance(1)};function Jn(a){setTimeout(function(){a.F.state()?(a.F.a=!1,a.mb(a.a,a.c,a.r),Jn(a)):(a.i(),a.i=null)},4)}
function Fn(a,b){if(a.e=b){var c=b.value;if(a.Z)if(a.reverse||null==a.Z.upper)a.reverse&&null!=a.Z.lower&&(d=Ak(c.key,a.Z.lower),-1==d||0==d&&a.Z.lowerOpen)&&(a.e=null);else{var d=Ak(c.key,a.Z.upper);if(1==d||0==d&&a.Z.upperOpen)a.e=null}if(a.e){if(a.unique&&null!=a.a&&null!=c.key&&0==Ak(a.a,c.key))return;a.a=c.key;a.c=a.d?c.aa():a.a;4==a.T&&(a.td?a.r=a.c:a.r=a.Ee.yb(null,a.c))}}a.e||(a.a=void 0,a.c=void 0,a.r=void 0);return a.F.a=!0}
h.openCursor=function(a,b){var c=null;if(this.Z)if(this.reverse){var d=this.d?"\uffff":void 0;null!=this.Z.upper&&(c=new In(this.Z.upper,d))}else null!=this.Z.lower&&(c=new In(this.Z.lower));null!=a&&(c=this.d?new In(a,b):new In(a));this.i=this.h.I(function(b){function d(b){var e=b.value,f=e.key;if(b&&null!=f)if(null!=a){if(0==Kn(c,e))return}else if(this.Z&&(!this.reverse&&this.Z.lowerOpen&&null!=this.Z.lower&&(e=Ak(f,this.Z.lower),0==e)||this.reverse&&this.Z.upperOpen&&null!=this.Z.upper&&(e=Ak(f,
this.Z.upper),0==e)))return;return Fn(this,b)}this.Ee=Ln(b,this.N);this.ac=Mn(this.Ee,this.Ya);this.reverse?Gn(this.ac,oa(d,this),c):Hn(this.ac,oa(d,this),c);Jn(this)},this)};h.clear=function(){throw new yd;};h.ed=function(){throw new yd;};h.toString=function(){return"Simple"+Dn.f.toString.call(this)};function Nn(a,b,c){a=["ydn.db",a];t(b)&&(a.push(b),t(c)&&(a.push(c),t(void 0)&&a.push(ek(void 0))));return a.join("^|")};function In(a,b){this.key=a;this.a=b}In.prototype.aa=function(){return this.a};In.prototype.toString=function(){return"ydn.db.con.simple.Node("+this.key+(null!=this.a?", "+this.a+")":")")};function Kn(a,b){var c=Ak(a.key,b.key);return 0===c?null!=a.a?null!=b.a?Ak(a.a,b.a):1:null!=b.a?-1:0:c};function On(a){this.jb=a||Pn}function Pn(a,b){return String(a)<String(b)?-1:String(a)>String(b)?1:0}h=On.prototype;h.qa=null;h.jb=null;h.Eb=null;h.Cb=null;
h.add=function(a){if(null==this.qa)return this.Cb=this.Eb=this.qa=new Qn(a),!0;var b=null;Rn(this,function(c){var d=null,e=this.jb(c.value,a);0<e?(d=c.left,null==c.left&&(b=new Qn(a,c),c.left=b,c==this.Eb&&(this.Eb=b))):0>e&&(d=c.right,null==c.right&&(b=new Qn(a,c),c.right=b,c==this.Cb&&(this.Cb=b)));return d});b&&(Rn(this,function(a){a.count++;return a.parent},b.parent),Sn(this,b.parent));return!!b};
h.remove=function(a){var b=null;Rn(this,function(c){var d=null,e=this.jb(c.value,a);0<e?d=c.left:0>e?d=c.right:(b=c.value,Tn(this,c));return d});return b};h.clear=function(){this.Cb=this.Eb=this.qa=null};h.contains=function(a){var b=!1;Rn(this,function(c){var d=null,e=this.jb(c.value,a);0<e?d=c.left:0>e?d=c.right:b=!0;return d});return b};
h.indexOf=function(a){var b=-1,c=0;Rn(this,function(d){var e=this.jb(d.value,a);if(0<e)return d.left;d.left&&(c+=d.left.count);if(0>e)return c++,d.right;b=c;return null});return b};h.da=function(){return this.qa?this.qa.count:0};h.getHeight=function(){return this.qa?this.qa.height:0};h.xa=function(){var a=[];Un(this,function(b){a.push(b)});return a};
function Un(a,b){if(a.qa){var c,d=c=Vn(a);for(c=c.left?c.left:c;null!=d;)if(null!=d.left&&d.left!=c&&d.right!=c)d=d.left;else{if(d.right!=c&&b(d.value))break;var e=d,d=null!=d.right&&d.right!=c?d.right:d.parent;c=e}}}function Rn(a,b,c){for(c=c?c:a.qa;c&&null!=c;)c=b.call(a,c)}
function Sn(a,b){Rn(a,function(a){var b=a.left?a.left.height:0,e=a.right?a.right.height:0;1<b-e?(a.left.right&&(!a.left.left||a.left.left.height<a.left.right.height)&&Wn(this,a.left),Xn(this,a)):1<e-b&&(a.right.left&&(!a.right.right||a.right.right.height<a.right.left.height)&&Xn(this,a.right),Wn(this,a));b=a.left?a.left.height:0;e=a.right?a.right.height:0;a.height=Math.max(b,e)+1;return a.parent},b)}
function Wn(a,b){Yn(b)?(b.parent.left=b.right,b.right.parent=b.parent):Zn(b)?(b.parent.right=b.right,b.right.parent=b.parent):(a.qa=b.right,a.qa.parent=null);var c=b.right;b.right=b.right.left;null!=b.right&&(b.right.parent=b);c.left=b;b.parent=c;c.count=b.count;b.count-=(c.right?c.right.count:0)+1}
function Xn(a,b){Yn(b)?(b.parent.left=b.left,b.left.parent=b.parent):Zn(b)?(b.parent.right=b.left,b.left.parent=b.parent):(a.qa=b.left,a.qa.parent=null);var c=b.left;b.left=b.left.right;null!=b.left&&(b.left.parent=b);c.right=b;b.parent=c;c.count=b.count;b.count-=(c.left?c.left.count:0)+1}
function Tn(a,b){if(null!=b.left||null!=b.right){var c=null,d;if(null!=b.left){d=$n(a,b.left);Rn(a,function(a){a.count--;return a.parent},d);if(d!=b.left){if(d.parent.right=d.left)d.left.parent=d.parent;d.left=b.left;d.left.parent=d;c=d.parent}d.parent=b.parent;d.right=b.right;d.right&&(d.right.parent=d);b==a.Cb&&(a.Cb=d)}else{d=Vn(a,b.right);Rn(a,function(a){a.count--;return a.parent},d);if(d!=b.right){if(d.parent.left=d.right)d.right.parent=d.parent;d.right=b.right;d.right.parent=d;c=d.parent}d.parent=
b.parent;d.left=b.left;d.left&&(d.left.parent=d);b==a.Eb&&(a.Eb=d)}d.count=b.count;Yn(b)?b.parent.left=d:Zn(b)?b.parent.right=d:a.qa=d;Sn(a,c?c:d)}else Rn(a,function(a){a.count--;return a.parent},b.parent),Yn(b)?(b.parent.left=null,b==a.Eb&&(a.Eb=b.parent),Sn(a,b.parent)):Zn(b)?(b.parent.right=null,b==a.Cb&&(a.Cb=b.parent),Sn(a,b.parent)):a.clear()}function Vn(a,b){if(!b)return a.Eb;var c=b;Rn(a,function(a){var b=null;a.left&&(b=c=a.left);return b},b);return c}
function $n(a,b){if(!b)return a.Cb;var c=b;Rn(a,function(a){var b=null;a.right&&(b=c=a.right);return b},b);return c}function Qn(a,b){this.value=a;this.parent=b?b:null;this.count=1}Qn.prototype.left=null;Qn.prototype.right=null;Qn.prototype.height=1;function Zn(a){return!!a.parent&&a.parent.right==a}function Yn(a){return!!a.parent&&a.parent.left==a};function ao(a){this.jb=a||Pn}A(ao,On);function Hn(a,b,c){if(a.qa){var d;if(c instanceof Qn)d=c;else if(c){if(Rn(a,function(a){var b=null;0<this.jb(a.value,c)?(b=a.left,d=a):0>this.jb(a.value,c)?b=a.right:d=a;return b}),!d)return}else d=Vn(a);a=d;for(var e=d.left?d.left:d;null!=a;)if(null!=a.left&&a.left!=e&&a.right!=e)a=a.left;else{if(a.right!=e&&b(a))return;var f=a;a=null!=a.right&&a.right!=e?a.right:a.parent;e=f}b(null)}}
function Gn(a,b,c){if(a.qa){var d;if(c instanceof Qn)d=c;else if(c){if(Rn(a,oa(function(a){var b=null;0<this.jb(a.value,c)?b=a.left:(0>this.jb(a.value,c)&&(b=a.right),d=a);return b},a)),!d)return}else d=$n(a);a=d;for(var e=d.right?d.right:d;null!=a;)if(null!=a.right&&a.right!=e&&a.left!=e)a=a.right;else{if(a.left!=e&&b(a))return;var f=a;a=null!=a.left&&a.left!=e?a.left:a.parent;e=f}b(null)}};function bo(a,b,c){this.e=a;this.storage=b;this.b=c;this.a={};a=this.b.keyPath;this.c=u(a)?a.join(","):a||"_ROWID_";this.a[this.c]=null;this.d=Nn(this.e,this.b.getName(),this.c)+"^|"}
function Mn(a,b){var c=b||a.c;if(!a.a[c]){a.a[c]=new ao(Kn);for(var d=a.storage.length,e=0;e<d;e++){var f=a.storage.key(e);if(null!==f&&va(f,a.d)){var g=hk(f.substr(a.d.length));if(c==a.c)a.a[c].add(new In(g));else{var k=a.storage.getItem(f);if(null!==k)if(f=Bl(a.b,c),k=Ch(k),k=cm(f,k),f.multiEntry){if(u(k))for(f=0;f<k.length;f++)a.a[c].add(new In(k[f],g))}else a.a[c].add(new In(k,g))}}}}return a.a[c]}
function co(a,b,c){for(var d in a.a){var e=a.a[d];if(e)if(d==a.c)e.remove(new In(b));else{var f=Bl(a.b,d),f=bk(c,f.keyPath);e.remove(new In(b,f))}}}function eo(a){for(var b in a.a){var c=a.a[b];c&&c.clear()}a.a={}}
function En(a,b,c,d){if(null==b&&(a.b.keyPath&&(b=Gl(a.b,c)),a.b.autoIncrement&&null==b)){b=a.d+ek(void 0);var e=Ch(a.storage.getItem(b));e.key_count||(e.key_count=0);e.key_count++;a.storage.setItem(b,Eh(e));b=e.key_count}d&&(d=null!==a.storage.getItem(a.d+ek(b)));if(d)return null;a.storage.setItem(a.d+ek(b),Eh(c));d=b;for(var f in a.a)if(e=a.a[f])if(f==a.c)e.add(new In(d));else{var g=Bl(a.b,f),g=bk(c,g.keyPath);null!=g&&e.add(new In(d,g))}return b}
function fo(a,b){var c=a.d+ek(b),d=a.storage.getItem(c);if(null===d)return 0;a.storage.removeItem(c);c=Ch(d);co(a,b,c);return 1}h=bo.prototype;h.clear=function(){eo(this);go(this)};h.yb=function(a,b){if(a&&a!=this.c)throw"impl";var c=this.storage.getItem(this.d+ek(b)),d=void 0;if(null!==c)for(var d=Ch(c),c=0,e=this.b.indexes.length;c<e;c++){var f=this.b.index(c);if("DATE"==f.type){var g=cm(f,d);g&&dm(f,d,new Date(g))}}return d};h.getName=function(){return this.b.getName()};
function ho(a,b,c){b=b||a.c;a=Mn(a,b);var d=null,e=null,f=0,g=!1,k=!1;null!=c&&(null!=c.lower&&(d=new In(c.lower)),null!=c.upper&&(e=new In(c.upper)),g=c.lowerOpen,k=c.upperOpen);Hn(a,function(a){if(null!=a&&(a=a.value,!g||null==d||0!=Ak(a.key,d.key))){if(null!=e&&(a=Ak(a.key,e.key),1===a||0===a&&k))return!0;f++}},d);return f}
function go(a,b){var c=Mn(a,a.c),d=null,e=null,f=0,g=[],k=[],l=!1,m=!1;null!=b&&(null!=b.lower&&(d=new In(b.lower)),null!=b.upper&&(e=new In(b.upper)),l=b.lowerOpen,m=b.upperOpen);Hn(c,function(b){if(null!=b&&(b=b.value,!l||null==d||0!=Kn(b,d))){if(null!=e){var c=Kn(b,e);if(1===c||0===c&&m)return!0}var c=a.d+ek(b.key),q=a.storage.getItem(c);null!==q&&(a.storage.removeItem(c),f++,10>g.length&&(g.push(b.key),k.push(Ch(q))))}},d);if(10>g.length)for(c=0;c<g.length;c++)co(a,g[c],k[c]);else eo(a);return f}
h.ic=function(a,b,c,d,e,f,g,k){function l(b){if(b&&(y++,!(y<f))){var c=b.value;if(d){if(H&&null!=w&&(b=p?Kn(c,w):Ak(c.key,w.key),0==b))return;if(null!=s&&(b=p?Kn(c,s):Ak(c.key,s.key),-1==b||0==b&&G))return k&&(k[0]=void 0,k[1]=void 0),!0}else{if(G&&null!=s&&(b=p?Kn(c,s):Ak(c.key,s.key),0==b))return;if(null!=w&&(b=p?Kn(c,w):Ak(c.key,w.key),1==b||0==b&&H))return k&&(k[0]=void 0,k[1]=void 0),!0}b=c.key;if(!g||!q||null==n||0!=Ak(n,b)){c=q?c.aa():b;if(2==a)m.push(c);else if(1==a)m.push(b);else if(3==a)m.push([b,
c]);else if(4==a){var l=Z.yb(null,c);m.push(l)}else m.push([b,c,Z.yb(null,c)]);k&&(k[0]=b,k[1]=c)}n=b;if(t(e)&&m.length>=e)return!0}}var m=[],n,p=!!k&&null!=k[0];b=b||this.c;var q=b!=this.c;b=Mn(this,b);var s=null,w=null;t(f)||(f=0);var y=-1,G=!1,H=!1;null!=c&&(null!=c.lower&&(s=q&&d?new In(c.lower,"\uffff"):new In(c.lower)),null!=c.upper&&(w=q&&!d?new In(c.upper,"\uffff"):new In(c.upper)),G=!!c.lowerOpen,H=!!c.upperOpen);if(p){d?H=!0:G=!0;c=k[0];var J=t(k[1])?k[1]:"\uffff";d?w=q?new In(c,J):new In(c):
s=q?new In(c,J):new In(c)}var Z=this;d?Gn(b,l,w):Hn(b,l,s);return m};h.Ca=function(a,b,c,d,e){return this.ic(2,a,b,c,d,e)};h.toString=function(){return"ydn.db.con.simple.Store:"+this.e+":"+this.b.getName()};function jo(){this.clear()}h=jo.prototype;h.ff=function(){return this};h.setItem=function(a,b){t(this.a[a])||(this.keys.push(a.toString()),this.length=this.keys.length);this.a[a]=b};h.getItem=function(a){return t(this.a[a])?this.a[a]:null};h.removeItem=function(a){delete this.a[a];lb(this.keys,a.toString());this.length=this.keys.length};h.length=0;h.key=function(a){a=this.keys[a];return t(a)?this.a[a]:null};h.clear=function(){this.a={};this.keys=[];this.length=0};function ko(a){this.h=a||new jo;this.e={}}function Ln(a,b){var c=W(a.a,b);if(c)a.e[b]||(a.e[b]=new bo(a.c,a.d,c));else throw new Ad('store name "'+b+'" not found.');return a.e[b]}ko.prototype.hb=function(a){var b=this;setTimeout(function(){var c=Nn(b.c),c=b.d.getItem(c),c=new xm(c);a(c)},10)};function lo(a,b){this.b=a;this.a=b}lo.prototype.I=function(a,b){var c=this.b;setTimeout(function(){a.call(b,c)},4);var d=this;return function(){d.a("complete",null);d.a=null;d.b=null}};function mo(a,b){this.a=b}A(mo,cl);h=mo.prototype;h.logger=L("ydn.db.crud.req.SimpleStore");h.ze=function(a,b,c){this.lb(a,!0,!1,null,b,c)};
h.lb=function(a,b,c,d,e,f){O(this.logger,yk(a)+" "+(b?"put":"add")+"Object"+(c?"":"s "+e.length+" objects"));var g=a.a.I(function(k){var l;if(c)l=Ln(k,d),k=f?f[0]:void 0,k=En(l,k,e[0],!b),null!=k?S(a,k):(l=Dh(k),l=new Tk(l),S(a,l,!0));else{for(var m=d,n=[],p=!1,q=f||{},s=0;s<e.length;s++){var w;d?w=q[s]:(m=f[s],w=m.s(),m=m.D());l&&l.getName()==m||(l=Ln(k,m));w=En(l,w,e[s],!b);null!=w?n.push(w):(p=!0,n.push(new Tk))}S(a,n,p)}g();g=null},this)};h.cg=function(){throw new yd("putData");};
h.be=function(a,b,c){var d=a.a.I(function(e){e=Ln(e,b).yb(null,c);S(a,e);d();d=null},this)};function no(a,b,c,d){var e=b.a.I(function(a){for(var g=[],k=c,l,m=0;m<d.length;m++){var n=d[m];n instanceof Ck&&(k=n,n=k.s(),k=k.D());l&&l.getName()==k||(l=Ln(a,k));n=l.yb(null,n);g[m]=n}S(b,g,!1);e();e=null},a)}h.Sf=function(a,b,c){no(this,a,b,c)};h.re=function(a,b){no(this,a,null,b)};
h.Ae=function(a,b,c){var d=yk(a)+" removeById "+b+" "+c;O(this.logger,d);var e=this,f=a.a.I(function(g){g=fo(Ln(g,b),c);Q(e.logger,"success "+d+(0==g?" [not found]":""));S(a,g);f();f=null},this)};h.Be=function(a,b){O(this.logger,yk(a)+" removeByKeys "+b.length+" keys");var c,d=0,e=a.a.I(function(f){for(var g=0;g<b.length;g++){var k=b[g].D(),l=b[g].s();c&&c.getName()==k||(c=Ln(f,k));d+=fo(c,l)}S(a,d);e();e=null},this)};h.ef=function(a,b,c){this.wd(a,b,c)};
h.wd=function(a,b,c){var d=yk(a)+" removeByKeyRange "+(c?Eh(c):"");O(this.logger,d);var e=this,f=a.a.I(function(g){g=go(Ln(g,b),c);Q(e.logger,d+" deleted "+g+" records.");S(a,g);f();f=null},this)};h.dg=function(a,b,c,d){var e=yk(a)+" removeByIndexKeyRange "+(d?Eh(d):"");O(this.logger,e);var f=a.a.I(function(e){e=Ln(e,b);for(var k=e.Ca(c,d),l=k.length,m=0;m<l;m++)fo(e,k[m]);S(a,l);f();f=null},this)};
h.Qd=function(a,b){var c=yk(a)+" clearByStores";O(this.logger,c);var d=a.a.I(function(e){for(var f=0;f<b.length;f++)Ln(e,b[f]).clear();Q(this.logger,"success "+c);S(a,b.length);d();d=null},this)};h.Td=function(a,b){var c=a.a.I(function(d){for(var e=[],f=0;f<b.length;f++){var g=Ln(d,b[f]);e.push(ho(g))}S(a,e);c();c=null},this)};
h.fd=function(a,b,c,d){var e=yk(a)+" count"+(null!=d?"Index":"")+(null!=c?"KeyRange":"Store");O(this.logger,e);var f=a.a.I(function(g){g=ho(Ln(g,b),d,c);Q(this.logger,"success "+e);S(a,g);f();f=null},this)};h.list=function(a,b,c,d,e,f,g,k,l,m){var n=yk(a)+" "+c+" "+(e?Dh(e):"");O(this.logger,n);var p=a.a.I(function(q){q=Ln(q,c).ic(b,d,e,k,f,g,l,m);Q(this.logger,n+" "+q.length+" records found.");S(a,q);p();p=null},this)};function oo(a,b){this.a=b}A(oo,mo);oo.prototype.b=function(a,b,c,d){c=W(this.a,c);return new Dn(a,b,c,d)};function po(a,b,c,d){Sm.call(this,a,b,c,d);this.ja=null;this.e=this.i=void 0}A(po,Sm);h=po.prototype;h.logger=L("ydn.db.core.req.WebsqlCursor");h.aa=function(){return this.e};h.init=function(a,b,c,d,e){po.f.init.call(this,a,b,c,d,e);this.ja=v(b)?Bl(this.b,b):null};h.K=function(){return this.F};function qo(a,b){a.i=void 0;a.e=void 0;a.F=void 0;if(t(b))if(x(b)){var c=em(b[a.b.d],a.b.type);a.e=c;if(a.d){var d=Bl(a.b,a.Ya);a.i=em(b[a.Ya],d.type)}else a.i=c;a.F=a.td?c:ro(b,a.b)}else a.F=b}
function so(a,b,c){Bl(a.b,a.Ya);var d=[],e=a.Ya,f=a.Z,g=a.i;if(null!=f){var k=f.lower,l=f.upper,m=f.lowerOpen,n=f.upperOpen;a.reverse?l=null!=l&&-1==Ak(l,g)?l:g:k=null!=k&&1==Ak(k,g)?k:g;null!=k&&null!=l?f=U.bound(k,l,!!m,!!n):f=null!=k?Nk.lowerBound(k,!!m):Nk.upperBound(l,!!n)}else f=a.reverse?Nk.upperBound(g):Nk.lowerBound(g);e=km(a.b,d,a.T,e,f,a.reverse,a.unique);c=a.reverse?Nk.upperBound(c,!1):Nk.lowerBound(c,!1);c=km(a.b,d,a.T,a.b.d,c,a.reverse,a.unique);e.ca=e.ca?e.ca+(" AND "+c.ca):c.ca;c=
"SELECT "+e.select+" FROM "+e.Lc+(e.ca?" WHERE "+e.ca:"")+(e.group?" GROUP BY "+e.group:"")+" ORDER BY "+e.Ub;c+=" LIMIT 1";O(a.logger,a+": continuePrimary:  SQL: "+c+" : "+Eh(d));a.h.executeSql(c,d,function(c,d){0<d.rows.length?qo(a,d.rows.item(0)):qo(a);b.call(a,a.i,a.e,a.F);b=null},function(c,d){M(a.logger,"get error: "+d.message);Tm(a,d);qo(a);b.call(a,a.e,a.i,a.F);b=null;return!1})}
function to(a,b,c,d,e,f){var g=!d;d=[];a.d&&null!=f&&null!=c?c=nm(a.b,a.T,d,a.ja.getName(),a.Z,c,g,f,a.reverse,a.unique):null!=c?(f=a.ja?a.ja.getName():null,c=mm(a.b,a.T,d,f,a.Z,a.reverse,a.unique,c,g)):(c=jm(a.b,d,a.T,a.d?a.ja.d:a.b.d,a.Z,a.reverse,a.unique),a.d&&(c+=", "+a.b.c+" ASC"));c+=" LIMIT 1";0<e&&(c+=" OFFSET "+e);O(a.logger,a+": continue:  SQL: "+c+" : "+Eh(d));a.h.executeSql(c,d,function(c,d){0<d.rows.length?qo(a,d.rows.item(0)):qo(a);b.call(a,a.i,a.e,a.F);b=null},function(c,d){M(a.logger,
"get error: "+d.message);Tm(a,d);qo(a);b.call(a,a.e,a.i,a.F);b=null;return!1})}h.je=function(){return!!this.h};h.update=function(a){if(!this.je())throw new Xk;var b=new B,c=this.aa();a=rm(this.b,a,c);var d="REPLACE INTO "+lm(this.b)+" ("+a.Mg.join(", ")+") VALUES ("+a.Bh.join(", ")+")";O(this.logger,this+': update "'+d+'" : '+Eh(a.$));this.h.executeSql(d,a.$,function(){b.callback(c)},function(a,c){b.p(c);return!1});return b};
h.advance=function(a){var b=this.i,c=this.e,d=!0;null==this.i||this.d&&null==this.e||(a-=1,d=!1);to(this,function(a,d,g){var k=null!=b&&null!=a&&0==Ak(b,a);if(this.d){var l=null!=d&&null!=c&&0==Ak(d,c);if(k&&l)throw new Ad("current: "+b+";"+c+" next: "+a+";"+d);}else if(k)throw new Ad("current: "+b+" next: "+a);this.mb(a,d,g)},this.i,d,a,this.e)};h.cc=function(a){null!=a?to(this,this.mb,a,!0):this.advance(1)};h.openCursor=function(a,b){to(this,this.mb,a,!1,0,b)};
h.clear=function(){if(!this.je())throw new Xk;var a=new B,b=this.b.d,b="DELETE FROM "+lm(this.b)+" WHERE "+b+" = ?",c=[this.aa()];O(this.logger,this+': clear "'+b+'" : '+Eh(c));this.h.executeSql(b,c,function(b,c){a.callback(c.rowsAffected)},function(b,c){a.p(c);return!1});return a};h.ed=function(a){var b=Ak(a,this.e);if(0==b||1==b&&this.reverse||-1==b&&!this.reverse)throw new Ci(this+" to continuePrimaryKey  from "+this.e+" to "+a+" on "+this.pb+" direction is wrong");so(this,this.mb,a)};
h.toString=function(){return"WebSql"+po.f.toString.call(this)};function uo(a,b){this.a=b}A(uo,cl);h=uo.prototype;h.logger=L("ydn.db.crud.req.WebSql");
function ro(a,b){if(b.Fc&&!b.keyPath&&0==b.indexes.length&&a._default_){var c=a._default_;if(-1==c.indexOf(";base64,"))return Ch(c);'"'==c.charAt(0)&&'"'==c.charAt(c.length-1)&&(c=c.substr(1,c.length-2));for(var d=c.split(";base64,"),c=d[0].split(":")[1],d=window.atob(d[1]),e=d.length,f=new Uint8Array(e),g=0;g<e;++g)f[g]=d.charCodeAt(g);return new Blob([f.buffer],{type:c})}c=a._default_?Ch(a._default_):{};null!=b.keyPath&&(d=em(a[b.keyPath],b.type),null!=d&&Nl(b,c,d));for(d=0;d<b.indexes.length;d++)e=
b.index(d),f=e.d,"_default_"==f||e.h||e.multiEntry||"DATE"!=e.type&&!b.Fc||(f=em(a[f],e.type),t(f)&&dm(e,c,f));return c}h.cg=function(){throw new yd("putData");};
h.lb=function(a,b,c,d,e,f){function g(b,d){if(null==e[b])if(O(m.logger,"empty object at "+b+" of "+e.length),p++,p==e.length)Q(m.logger,q+" success "+q),S(a,n,s);else{var G=b+2;G<e.length&&g(G,d)}var H;H=t(f)?rm(k,e[b],f[b]):rm(k,e[b]);G=l+lm(k)+" ("+H.Mg.join(", ")+") VALUES ("+H.Bh.join(", ")+");";O(m.logger,yk(a)+" SQL: "+G+" PARAMS: "+H.$+" REQ: "+b+" of "+e.length);d.executeSql(G,H.$,function(f,q){function G(b,c){var e="ydn.db.me:"+k.getName()+":"+b.getName(),e=l+Qa(e)+" ("+k.c+", "+b.c+") VALUES (?, ?)",
f=[Rk(P,k.type),Rk(c,b.type)];O(m.logger,yk(a)+" multiEntry "+e+" "+f);d.executeSql(e,f,function(){},function(a,b){M(m.logger,"multiEntry index insert error: "+b.message);return!1})}p++;var P=t(H.key)?H.key:q.insertId;1>q.rowsAffected&&(s=!0,P=new Tk(P+" no-op"));for(var kd=0,Jk=k.indexes.length;kd<Jk;kd++){var Rd=k.index(kd);if(Rd.multiEntry)for(var Pe=bk(e[b],Rd.keyPath),sA=(Pe?Pe.length:0)||0,N=0;N<sA;N++)G(Rd,Pe[N])}c?S(a,P):(n[b]=P,p==e.length?S(a,n,s):(kd=b+2,kd<e.length&&g(kd,f)))},function(d,
f){p++;s=!0;6==f.code?f.name="ConstraintError":M(m.logger,"error: "+f.message+" "+q);if(c)S(a,f,!0);else if(n[b]=f,p==e.length)O(m.logger,"success "+q),S(a,n,s);else{var k=b+2;k<e.length&&g(k,d)}return!1})}b=!b;var k=W(this.a,d),l=b?"INSERT INTO ":"INSERT OR REPLACE INTO ";d=a.a;var m=this,n=[],p=0,q=yk(a)+" inserting "+e.length+" objects.",s=!1;if(0<e.length)for(b=0;2>b&&b<e.length;b++)g(b,d);else Q(this.logger,"success"),S(a,[])};
h.ze=function(a,b,c){if(0==c.length)S(a,[]);else{for(var d=[],e=0,f=0,g=this,k=function(k,l){var m=[];O(g.logger,"put "+l.length+" objects to "+k);for(var n=qm(W(g.a,k)),p=n?void 0:[],q=0;q<l.length;q++)m.push(b[l[q]]),n||p.push(c[l[q]].s());n=uk(a);n.m(function(b){for(var c=0;c<l.length;c++)d[l[c]]=b[c];e++;e==f&&S(a,d)},function(){e++;e==f&&S(a,d,!0)});g.lb(n,!1,!1,k,m,p)},l="",m=[],n=[],p=0;p<c.length;p++){var q=c[p].D(),s=c[p].s();q!=l?(f++,0<m.length&&k(l,m),m=[p],n=[s],l=q):(m.push(p),n.push(s))}0<
m.length&&k(l,m)}};h.be=function(a,b,c){var d=a.a,e=W(this.a,b),f=this;b=e.c;c=[Rk(c,e.type)];b="SELECT * FROM "+lm(e)+" WHERE "+b+" = ?";var g=yk(a)+" SQL: "+b+" PARAMS: "+c;O(this.logger,g);d.executeSql(b,c,function(b,c){if(0<c.rows.length){var d=c.rows.item(0);null!=d?(d=ro(d,e),S(a,d)):(Q(f.logger,"success no result: "+g),S(a,void 0))}else Q(f.logger,"success no result: "+g),S(a,void 0)},function(b,c){M(f.logger,"error: "+g+" "+c.message);S(a,c,!0);return!1})};
h.Sf=function(a,b,c){function d(b,e){var p=l.c,q=[Rk(c[b],l.type)],s="SELECT * FROM "+lm(l)+" WHERE "+p+" = ?";O(f.logger,"SQL: "+s+" PARAMS: "+q);e.executeSql(s,q,function(e,f){k++;if(0<f.rows.length){var n=f.rows.item(0);null!=n&&(g[b]=ro(n,l))}else g[b]=void 0;k==c.length?S(a,g):(n=b+10,n<c.length&&d(n,e))},function(e,l){k++;M(f.logger,"error: "+s+" "+l.message);if(k==c.length)S(a,g);else{var n=b+10;n<c.length&&d(n,e)}return!1})}var e=a.a,f=this,g=[],k=0,l=W(this.a,b);if(0<c.length)for(b=0;10>
b&&b<c.length;b++)d(b,e);else Q(f.logger,"success"),S(a,[])};
h.re=function(a,b){function c(d,k){var n=b[d],p=W(e.a,n.D()),q=Dk(n),n=p.c,q=[Rk(q,p.type)],s="SELECT * FROM "+lm(p)+" WHERE "+n+" = ?";O(e.logger,"SQL: "+s+" PARAMS: "+q);k.executeSql(s,q,function(k,m){g++;if(0<m.rows.length){var n=m.rows.item(0);null!=n&&(f[d]=ro(n,p))}else f[d]=void 0;g==b.length?(O(e.logger,"success "+s),S(a,f)):(n=d+10,n<b.length&&c(n,k))},function(b,c){S(a,c,!0);return!1})}var d=a.a,e=this,f=[],g=0;if(0<b.length)for(var k=0;10>k&&k<b.length;k++)c(k,d);else O(this.logger,"success"),
S(a,[])};
h.Qd=function(a,b){function c(d,g){function k(a){a="ydn.db.me:"+l.getName()+":"+a.getName();a="DELETE FROM  "+Qa(a);O(e.logger,"SQL: "+a);g.executeSql(a,[])}var l=W(e.a,b[d]),m="DELETE FROM  "+lm(l);O(e.logger,"SQL: "+m+" PARAMS: []");g.executeSql(m,[],function(g){d==b.length-1?(O(e.logger,"success "+m),S(a,b.length)):c(d+1,g)},function(b,c){S(a,c,!0);return!1});for(var n=0,p=l.indexes.length;n<p;n++){var q=l.index(n);q.multiEntry&&k(q)}}var d=a.a,e=this;0<b.length?c(0,d):(O(this.logger,"success"),
S(a,0))};
h.Be=function(a,b){function c(k){if(k>=b.length)S(a,f,g);else{var l=W(e.a,b[k].D()),m=Rk(b[k].s(),l.type),n=" WHERE "+l.c+" = ?",p="DELETE FROM "+lm(l)+n,q=yk(a)+" SQL: "+p+" PARAMS: "+[m];d.executeSql(p,[m],function(){f++;c(k)},function(a,b){M(e.logger,"error: "+q+b.message);g=!0;c(k);return!1});k++;for(var p=function(b){b="ydn.db.me:"+l.getName()+":"+b.getName();b="DELETE FROM  "+Qa(b)+n;O(e.logger,yk(a)+NaN+b);d.executeSql(b,[m])},s=0,w=l.indexes.length;s<w;s++){var y=l.index(s);y.multiEntry&&p(y)}}}
var d=a.a,e=this,f=0,g=!1;O(this.logger,yk(a)+" removeByKeys: "+b.length+" keys");c(0)};
h.Ae=function(a,b,c){function d(b){b="ydn.db.me:"+f.getName()+":"+b.getName();b="DELETE FROM  "+Qa(b)+l;O(k.logger,yk(a)+NaN+b);e.executeSql(b,[g])}var e=a.a,f=W(this.a,b),g=Rk(c,f.type),k=this,l=" WHERE "+f.c+" = ?";b="DELETE FROM "+lm(f)+l;O(this.logger,yk(a)+" SQL: "+b+" PARAMS: "+[g]);e.executeSql(b,[g],function(b,c){S(a,c.rowsAffected)},function(b,c){S(a,c,!0);return!1});b=0;for(c=f.indexes.length;b<c;b++){var m=f.index(b);m.multiEntry&&d(m)}};h.ef=function(a,b,c){vo(this,a,b,void 0,c)};
h.wd=function(a,b,c){vo(this,a,b,void 0,c)};h.dg=function(a,b,c,d){vo(this,a,b,c,d)};
function vo(a,b,c,d,e){function f(c){c="ydn.db.me:"+k.getName()+":"+c.getName();c="DELETE FROM  "+Qa(c)+n;O(a.logger,yk(b)+NaN+c);g.executeSql(c,m)}var g=b.a,k=W(a.a,c);c="DELETE FROM "+lm(k);var l=[],m=[],n="";null!=e&&(t(d)?(d=Bl(k,d),Qk(d.c,d.type,e,m,l)):Qk(k.c,k.type,e,m,l),n=" WHERE "+m.join(" AND "));c+=n;var p=yk(b)+" SQL: "+c+" PARAMS: "+l;O(a.logger,p);g.executeSql(c,l,function(c,d){O(a.logger,"success "+p);S(b,d.rowsAffected)},function(c,d){M(a.logger,"error: "+p+d.message);S(b,d,!0);return!1});
e=0;for(d=k.indexes.length;e<d;e++)c=k.index(e),c.multiEntry&&f(c)}h.Td=function(a,b){function c(g){var k="SELECT COUNT(*) FROM "+Qa(b[g]);O(e.logger,"SQL: "+k+" PARAMS: []");d.executeSql(k,[],function(d,e){var k=e.rows.item(0);f[g]=parseInt(k["COUNT(*)"],10);g++;g==b.length?S(a,f):c(g)},function(b,c){S(a,c,!0);return!1})}var d=a.a,e=this,f=[];0==b.length?(O(this.logger,"success"),S(a,0)):c(0)};
h.fd=function(a,b,c,d,e){var f=[];b=jm(W(this.a,b),f,6,d,c,!1,e);O(this.logger,yk(a)+" SQL: "+b+" PARAMS: "+f);a.a.executeSql(b,f,function(b,c){var d=c.rows.item(0);S(a,Bm(d))},function(b,c){S(a,c,!0);return!1})};
h.list=function(a,b,c,d,e,f,g,k,l,m){var n=this,p=[],q=W(this.a,c),s=q.d,w=q.type,y=w,G=null!=d&&d!==s?Bl(q,d):null,H=d||s;G&&(y=G.type);c=[];if(m&&t(m[0])){var J=m[0];G&&t(m[1])?(d=m[1],e=nm(q,b,c,G.getName(),e,J,!0,d,k,l)):e=mm(q,b,c,d,e,k,l,J,!0)}else e=jm(q,c,b,H,e,k,l);ha(f)&&(e+=" LIMIT "+f);ha(g)&&(e+=" OFFSET "+g);var Z=a+" SQL: "+e+" ;params= "+Eh(c);O(this.logger,Z);a.a.executeSql(e,c,function(c,d){for(var e=d.rows.length,f,g=0;g<e;g++)f=d.rows.item(g),2==b?p[g]=em(f[s],w):1==b?p[g]=em(f[H],
y):3==b?p[g]=[em(f[H],y),em(f[s],w)]:null!=f&&(p[g]=ro(f,q));Q(n.logger,"success "+a);m&&f&&(m[0]=em(f[H],y),m[1]=em(f[s],w));S(a,p)},function(b,c){M(n.logger,"error: "+Z+c.message);S(a,c,!0);return!1})};function wo(a,b){this.a=b}A(wo,uo);wo.prototype.logger=L("ydn.db.core.req.WebSql");wo.prototype.b=function(a,b,c,d){c=W(this.a,c);return new po(a,b,c,d)};hn.prototype.C=function(){var a=hl(this);if("indexeddb"==a)return new Bn(0,this.b);if("websql"==a||"sqlite"==a)return new wo(0,this.b);if("memory"==a||"localstorage"==a||"userdata"==a||"sessionstorage"==a)return new oo(0,this.b);throw new Ad("No executor for "+a);};function xo(a){return v(a)?a.replace(/\D/g,"").replace(/^0+/,""):null}function yo(a){if(!v(a)||!/[\w\+]+@\w+\.\w+/.test(a))return null;a=a.replace(/.*</,"").replace(/>.*/,"");a=a.toLowerCase();a=a.replace(/\+\w*?@/,"@");for(var b=a.indexOf("@");0<=b;b--);return a};function zo(a){if(!v(a))throw new wi;this.Va=a;this.d=pk;this.a=[];Ao(this,a);this.Ed=""}h=zo.prototype;h.Va="";h.mh=NaN;h.nh=NaN;h.qg=!1;h.Ed="";
function Ao(a,b){var c=b.split(/\sFROM\s/i);if(2==c.length){var d=c[1],c=c[0].match(/\s*?(SELECT|INSERT|UPDATE|DELETE)\s+(.*)/i);if(3==c.length){a.e=c[1].toUpperCase();if("SELECT"==a.e)a.d=ok;else if("INSERT"==a.e)a.d=pk;else if("UPDATE"==a.e)a.d=pk;else if("DELETE"==a.e)a.d=pk;else return;var c=c[2].trim(),e=c.match(/^(MIN|MAX|COUNT|AVG|SUM)/i);e?(a.c=e[0].toUpperCase(),c=c.replace(/^(MIN|MAX|COUNT|AVG|SUM)/i,"").trim()):a.c=void 0;"("==c.charAt(0)&&(")"==c.charAt(c.length-1)?c=c.substring(1,c.length-
1):new al("missing closing parentheses"));a.l=c;c=d.search(/(ORDER BY|LIMIT|OFFSET)/i);0<c?(a.b=d.substring(c),d=d.substring(0,c)):a.b="";c=d.search(/WHERE/i);0<c?(a.h=d.substring(c+6).trim(),d=d.substring(0,c)):a.h="";a.a=d.trim().split(",").map(function(a){a=Na(a,'"');a=Na(a,"'");return a.trim()})}}}
h.parse=function(a){if(a){for(var b=0;b<a.length;b++)this.Va=this.Va.replace("?",a[b]);Ao(this,this.Va)}this.i=Bo(this);if(!this.i)return this.Ed;a=this.b.length;if(b=/OFFSET\s+(\d+)/i.exec(this.b))this.nh=parseInt(b[1],10),a=this.b.search(/OFFSET/i);if(b=/LIMIT\s+(\d+)/i.exec(this.b))this.mh=parseInt(b[1],10),b=this.b.search(/LIMIT/i),b<a&&(a=b);(a=/ORDER BY\s+(.+)/i.exec(this.b.substr(0,a)))?(a=a[1].trim(),(b=a.match(/(ASC|DESC)/i))?(this.qg="DESC"==b[0].toUpperCase(),a=a.replace(/\s+(ASC|DESC)/i,
"")):this.qg=!1,this.t=Na(Na(a,'"'),"'")):this.t=void 0;return""};function Co(a){if("*"==a.l)return null;a=a.l.split(",");return a=a.map(function(a){return Na(a.trim(),'"')})}h.toJSON=function(){return{sql:this.Va}};
function Bo(a){function b(a){return ib(c,function(b){return b.jd()==a})}var c=[],d=/(.+?)(<=|>=|=|>|<)(.+)/i;if(0<a.h.length)for(var e=a.h.split("AND"),f=0;f<e.length;f++){var g=e[f],k=d.exec(g);if(k){var l=k[1].trim(),l=Na(l,'"'),l=Na(l,"'");if(0<l.length){var m=k[3].trim();va(m,'"')?m=Na(m,'"'):va(m,"'")?m=Na(m,"'"):m=parseFloat(m);k=new Rm(l,k[2],m);l=b(l);if(0<=l){if(c[l]=c[l].$e(k),!c[l])return a.Ed='where clause "'+g+'" conflict',null}else c.push(k)}else return a.Ed='Invalid clause "'+g+'"',
null}else return a.Ed='Invalid clause "'+g+'"',null}return c}h.toString=function(){return"query:"+this.Va};function Do(a,b){this.a=b;this.b=a}Do.prototype.logger=L("ydn.db.sql.req.nosql.Node");Do.prototype.toJSON=function(){return{sql:this.a}};Do.prototype.toString=function(){return"idb.Node:"};
Do.prototype.execute=function(a,b){var c=nb(this.a.a)[0],d=this.a.i,e=this.a.mh,e=isNaN(e)?100:e,f=this.a.nh,f=isNaN(f)?0:f,g=this.a.t,k=Co(this.a),l=null,m=this.a.qg;if(0==d.length)l=null;else if(1==d.length)l=Ik(d[0].a);else throw new xd("too many conditions.");null===k||xk(a,function(a,b,c){var d=a;b||(d=a.map(function(a){var b=k.length;if(1==b)return bk(a,k[0]);for(var c={},d=0;d<b;d++)c[k[d]]=bk(a,k[d]);return c}));c(d,b)});var d=0<d.length?d[0].jd():void 0,n=yk(a)+" executing on"+c;d&&(n+=":"+
d);n+=" "+Pk(l);Q(this.logger,n);g&&g!=this.b.keyPath?b.list(a,4,c,g,l,e,f,m,!1):t(d)&&d!=this.b.keyPath?b.list(a,4,c,d,l,e,f,m,!1):b.list(a,4,c,null,l,e,f,m,!1)};function Eo(a,b){Do.call(this,a,b)}A(Eo,Do);
Eo.prototype.execute=function(a,b){var c,d=nb(this.a.a)[0],e=this.a.i,f=null;if(0==e.length)f=null;else if(1==e.length)f=Ik(e[0].a);else throw new xd("too many conditions.");var g=this.a.c,e=0<e.length?e[0].jd():void 0,k=yk(a)+" executing "+g+" on "+d;e&&(k+=":"+e);k+=" "+Pk(f);Q(this.logger,k);if("COUNT"==g)f?b.fd(a,d,f,e,!1):b.fd(a,d,null,void 0,!1);else{var l,k=Co(this.a);if(!k||0==k.length)throw new Ci("field name require for reduce operation: "+g);k=k[0];if("MIN"==g)l=Fo(k);else if("MAX"==g)l=
Go(k);else if("AVG"==g)c=0,l=Io(k);else if("SUM"==g)c=0,l=Jo(k);else throw new xi(g);var m;t(e)?m=new bn(d,e,f):m=new $m(d,f);var d=b.b(a.a,yk(a),d,4),n=m.load([d]);n.C=function(b){S(a,b,!0)};var p=0;n.l=function(b){null!=b?(b=m.a?n.aa():n.K(),c=l(b,c,p),n.advance(1),p++):S(a,c)}}};function Io(a){return function(b,c,d){t(c)||(c=0);return(c*d+b[a])/(d+1)}}function Jo(a){return function(b,c){return c+b[a]}}function Fo(a){return function(b,c){var d=b[a];return t(c)?c<d?c:d:d}}
function Go(a){return function(b,c){var d=b[a];return t(c)?c>d?c:d:d}};function Ko(a,b){this.a=b}A(Ko,Bn);Ko.prototype.logger=L("ydn.db.sql.req.IndexedDb");Ko.prototype.executeSql=function(a,b,c){if(c=b.parse(c))throw new al(c);c=nb(b.a);if(1==c.length){var d=W(this.a,c[0]);if(!d)throw new Yk(c[0]);var e=Co(b);if(e)for(var f=0;f<e.length;f++)if(!Cl(d,e[f]))throw new Yk('Index "'+e[f]+'" not found in '+c[0]);var g;b.c?g=new Eo(d,b):g=new Do(d,b);g.execute(a,this)}else throw new xi(b.Va);};function Lo(a,b){this.b=b;this.c=a;this.a=Co(b)}Lo.prototype.logger=L("ydn.db.sql.req.websql.Node");Lo.prototype.toJSON=function(){return{sql:this.b.Va}};Lo.prototype.toString=function(){return"websql.Node:"};function Mo(a,b){if(a.a){if(1==a.a.length){if(x(b))return Db(b,a.a[0]);return}for(var c={},d=0;d<a.a.length;d++)c[a.a[d]]=Db(b,a.a[d]);return c}return ro(b,a.c)}
Lo.prototype.execute=function(a,b,c){var d=this,e=[];b.executeSql(this.b.Va,c,function(b,c){for(var k=c.rows.length,l=0;l<k;l++){var m=c.rows.item(l);if(x(m))var n=Mo(d,m);e.push(n)}a(e)},function(b,c){M(d.logger,"Sqlite error: "+c.message);a(c,!0);return!0})};function No(a,b){Lo.call(this,a,b)}A(No,Lo);No.prototype.execute=function(a,b,c){var d=this;b.executeSql(this.b.Va,c,function(b,c){var d=c.rows.length;if(1==d)d=Bm(c.rows.item(0)),a(d);else if(0==d)a(void 0);else throw new Wk;},function(b,c){M(d.logger,"Sqlite error: "+c.message);a(c,!0);return!0})};function Oo(a,b){this.a=b}A(Oo,wo);Oo.prototype.logger=L("ydn.db.sql.req.WebSql");Oo.prototype.executeSql=function(a,b,c){var d=nb(b.a);if(1==d.length){var e=W(this.a,d[0]);if(!e)throw new Yk(d[0]);var f=Co(b);if(f)for(var g=0;g<f.length;g++)if(!Cl(e,f[g]))throw new Yk('Index "'+f[g]+'" not found in '+d[0]);var k;b.c?k=new No(e,b):k=new Lo(e,b);k.execute(function(b,c){S(a,b,c)},a.a,c)}else throw new xi(b.Va);};function Po(a,b){this.a=b}A(Po,oo);Po.prototype.logger=L("ydn.db.sql.req.SimpleStore");Po.prototype.executeSql=function(a,b,c){if(c=b.parse(c))throw new al(c);c=nb(b.a);if(1==c.length){var d=W(this.a,c[0]);if(!d)throw new Yk(c[0]);var e=Co(b);if(e)for(var f=0;f<e.length;f++)if(!Cl(d,e[f]))throw new I('Index "'+e[f]+'" not found in '+c[0]);var g;b.c?g=new Eo(d,b):g=new Do(d,b);g.execute(a,this)}else throw new xd(b.Va);};function Qo(a,b,c,d){pl.call(this,a,b,c,d)}A(Qo,en);Qo.prototype.executeSql=function(a,b){for(var c=new zo(a),d=nb(c.a),e=0;e<d.length;e++){var f=W(this.b,d[e]);if(!f)throw new I("store: "+f+" not exists.");}Q(this.logger,"executeSql: "+a+" params: "+b);var g=this.a.request("sql",nb(c.a),c.d);T(g,function(){V(this).executeSql(g,c,b||[])},this);return g};function Ro(a,b,c){Qm.call(this,a,b,c)}A(Ro,hn);Ro.prototype.Vc=function(a,b){return new Qo(this,this.b,a,b)};Ro.prototype.executeSql=function(a,b){return this.a.executeSql(a,b)};Ro.prototype.C=function(){var a=hl(this);if("indexeddb"==a)return new Ko(0,this.b);if("websql"==a||"sqlite"==a)return new Oo(0,this.b);if("memory"==a||"localstorage"==a||"sessionstorage"==a)return new Po(0,this.b);throw new Ad("No executor for "+a);};function So(a,b){t(a)&&5242880<a&&pe(this.logger,Zd,"storage size request ignored, use Quota Management API instead");this.ga=null;this.zd=b||NaN}h=So.prototype;
h.connect=function(a,b){function c(a,c,d){Q(e.logger,(d?"changing":"upgrading")+" version to "+a.version+" from "+g);for(d=0;d<b.stores.length;d++)To(e,a,c,b.stores[d]);c=a.objectStoreNames;var f=c.length;for(d=0;d<f;d++)yl(b,c[d])||(a.deleteObjectStore(c[d]),Q(e.logger,"store: "+c[d]+" deleted."))}function d(a,b){f.b?M(e.logger,"database already set."):t(b)?(M(e.logger,b?b.message:"Error received."),e.ga=null,f.p(b)):(e.ga=a,e.ga.onabort=function(a){O(e.logger,e+": abort");e.Fd(a.target.error)},
e.ga.onerror=function(a){O(e.logger,e+": error");e.Fd(a.target.error)},e.ga.onversionchange=function(a){O(e.logger,e+" closing connection for onversionchange to: "+a.version);if(e.ga&&(e.ga.onabort=null,e.ga.onblocked=null,e.ga.onerror=null,e.ga.onversionchange=null,e.ye(a),!a.defaultPrevented)){e.ga.close();e.ga=null;var b=Error();b.name=a.type;e.Pe(b)}},f.callback(parseFloat(g)))}var e=this,f=new B,g=void 0,k=b.version;pe(this.logger,ce,"Opening database: "+a+" ver: "+(b.vc?"auto":k));var l;l=t(k)?
rk.open(a,k):rk.open(a);l.onsuccess=function(f){var k=f.target.result;t(g)||(g=k.version);pe(e.logger,ce,"Database: "+k.name+", ver: "+k.version+" opened.");if(b.vc)e.hb(function(f){if(b instanceof ul)for(var g=0;g<f.stores.length;g++)yl(b,f.stores[g].getName())||vl(b,f.stores[g].clone());f=ym(b,f,!1,!0);if(0<f.length){pe(e.logger,ce,"Schema change require for difference in "+f);var l=ha(k.version)?k.version+1:1;if("IDBOpenDBRequest"in r){k.close();var m=rk.open(a,l);m.onupgradeneeded=function(a){a=
a.target.result;pe(e.logger,ce,"re-open for version "+a.version);c(a,m.transaction,!1)};m.onsuccess=function(a){d(a.target.result)};m.onerror=function(){pe(e.logger,ce,e+": fail.");d(null)}}else{var p=k.setVersion(l+"");p.a=function(a){M(e.logger,"migrating from "+k.version+" to "+l+" failed.");d(null,a)};p.onsuccess=function(){p.transaction.oncomplete=H;c(k,p.transaction,!0)};var H=function(){var b=rk.open(a);b.onsuccess=function(a){a=a.target.result;pe(e.logger,ce,e+": OK.");d(a)};b.onerror=function(){pe(e.logger,
ce,e+": fail.");d(null)}};null!=p.transaction&&(p.transaction.oncomplete=H)}}else d(k)},void 0,k);else if(b.version>k.version){var l=k.setVersion(b.version);l.a=function(a){M(e.logger,"migrating from "+k.version+" to "+b.version+" failed.");d(null,a)};l.onsuccess=function(){c(k,l.transaction,!0)}}else b.version==k.version?pe(e.logger,ce,"database version "+k.version+" ready to go"):M(e.logger,"connected database version "+k.version+" is higher than requested version."),e.hb(function(a){a=ym(b,a,!1,
!0);0<a.length?(pe(e.logger,ce,a),d(null,new Ai("different schema: "+a))):d(k)},void 0,k)};l.onupgradeneeded=function(a){a=a.target.result;g=NaN;pe(this.logger,ce,"upgrade needed for version "+a.version);c(a,l.transaction,!1)};l.onerror=function(c){qe(e.logger,'open request to database "'+a+'" '+(t(b.version)?" with version "+b.version:"")+" cause error of "+l.error.name);d(null,c)};l.onblocked=function(c){qe(e.logger,"database "+a+" "+b.version+" block, close other connections.");d(null,c)};ha(this.zd)&&
!isNaN(this.zd)&&setTimeout(function(){"done"!=l.readyState&&(qe(e.logger,e+": database state is still "+l.readyState),d(null,new bl("connection timeout after "+e.zd)))},this.zd);return f};h.zd=18E4;h.Pe=function(){};h.Fd=function(){};h.ye=function(){};h.cd=function(){return"indexeddb"};h.Oe=function(){return!!this.ga};h.logger=L("ydn.db.con.IndexedDb");h.ga=null;h.Ne=function(){return this.ga?parseFloat(this.ga.version):void 0};
h.hb=function(a,b,c){c=c||this.ga;if(t(b)){if(null===b){if(0==c.objectStoreNames.length){a(new xm(c.version));return}throw new zi;}c=b.db}else{b=[];for(var d=c.objectStoreNames.length-1;0<=d;d--)b[d]=c.objectStoreNames[d];if(0==b.length){a(new xm(c.version));return}b=c.transaction(b,ok)}for(var e=c.objectStoreNames,f=[],g=e.length,d=0;d<g;d++){for(var k=b.objectStore(e[d]),l=[],m=0,n=k.indexNames.length;m<n;m++){var p=k.index(k.indexNames[m]);l[m]=new $l(p.keyPath,void 0,p.unique,p.multiEntry,p.name)}f[d]=
new rl(k.name,k.keyPath,k.autoIncrement,void 0,l)}b=new xm(c.version,f);a(b)};
function To(a,b,c,d){function e(){var a={autoIncrement:!!d.autoIncrement};null!=d.keyPath&&(a.keyPath=d.keyPath);return b.createObjectStore(d.getName(),a)}pe(a.logger,de,"Creating Object Store for "+d.getName()+" keyPath: "+d.keyPath);if(b.objectStoreNames.contains(d.getName())){c=c.objectStore(d.getName());gm(d.keyPath||"",c.keyPath||"")?(b.deleteObjectStore(d.getName()),pe(a.logger,Zd,"store: "+d.getName()+" deleted due to keyPath change."),c=e()):ga(c.autoIncrement)&&ga(d.autoIncrement)&&c.autoIncrement!=
d.autoIncrement&&(b.deleteObjectStore(d.getName()),pe(a.logger,Zd,"store: "+d.getName()+" deleted due to autoIncrement change."),c=e());for(var f=c.indexNames,g=0;g<d.indexes.length;g++){var k=d.index(g);!f.contains(k.getName())&&k.e&&(c.clear(),pe(a.logger,Zd,"store: "+d.getName()+" cleared since generator index need re-indexing."))}for(var l=0,m=0,n=0,g=0;g<d.indexes.length;g++){var k=d.index(g),p=!1;if(f.contains(k.getName())){var q=c.index(k.getName()),s=null!=q.unique&&null!=k.unique&&q.unique!=
k.unique,w=null!=q.multiEntry&&null!=k.multiEntry&&q.multiEntry!=k.multiEntry,q=null!=q.keyPath&&null!=k.keyPath&&!!gm(q.keyPath,k.keyPath);if(s||w||q)c.deleteIndex(k.getName()),p=!0,l--,n++}else"BLOB"!=k.type&&(p=!0);p&&(k.unique||k.multiEntry?(p={unique:k.unique,multiEntry:k.multiEntry},c.createIndex(k.getName(),k.keyPath,p)):c.createIndex(k.getName(),k.keyPath),l++)}for(g=0;g<f.length;g++)Cl(d,f[g])||(c.deleteIndex(f[g]),m++);pe(a.logger,de,"Updated store: "+c.name+", "+l+" index created, "+m+
" index deleted, "+n+" modified.")}else{c=e();for(g=0;g<d.indexes.length;g++)k=d.index(g),"BLOB"==k.type?pe(a.logger,$d,"Index "+k+" of blob data type ignored."):(pe(a.logger,de,"Creating index: "+k),k.unique||k.multiEntry?(p={unique:k.unique,multiEntry:k.multiEntry},c.createIndex(k.getName(),k.keyPath,p)):c.createIndex(k.getName(),k.keyPath));pe(a.logger,de,"Created store: "+c)}}
h.Wd=function(a,b,c,d){var e=this.ga;if(!b){b=[];for(var f=e.objectStoreNames.length-1;0<=f;f--)b[f]=e.objectStoreNames[f]}0==b.length?a(null):(b=e.transaction(b,c),b.oncomplete=function(a){d("complete",a)},b.onabort=function(a){d("abort",a)},a(b),a=null)};h.close=function(){pe(this.logger,de,this+" closing connection");this.ga.close()};h.toString=function(){return"IndexedDB:"+(this.ga?this.ga.name+":"+this.ga.version:"")};
Bk.push(function(a,b){if(!rk||b&&"indexeddb"!=b)return null;var c=rk.deleteDatabase(a),d=new sk("IDBVersionChangeEvent ");c.onblocked=function(a){ue(d,a)};c.onerror=function(a){d.p(a)};c.onsuccess=function(a){d.callback(a)};return d});function Uo(a){ko.call(this,a);this.b=NaN}A(Uo,ko);h=Uo.prototype;h.logger=L("ydn.db.con.SimpleStorage");h.Ne=function(){return this.b};
h.connect=function(a,b){function c(a,b){setTimeout(function(){b?(Q(d.logger,d+" opening fail"),e.p(b)):(Q(d.logger,d+" version "+d.Ne()+" open"),e.callback(a))},10)}var d=this,e=new B;this.d=this.h.ff(a);this.c=a;this.a=b;var f=Nn(this.c);this.b=NaN;var g=Ch(this.d.getItem(f));t(g.version)&&!ha(g.version)&&(g.version=NaN);if(g)if(g=new xm(g),ym(this.a,g,!1,!1))if(!this.a.vc&&!isNaN(g.version)&&this.a.version>g.version)c(NaN,new Vk("existing version "+g.version+" is larger than "+this.a.version));
else{var k=this.a.version;this.b=t(k)?k:g.version+1;for(k=0;k<this.a.count();k++)var l=this.a.store(k);if(this.a instanceof ul)for(k=0;k<g.count();k++)l=g.store(k),vl(this.a,l);k=this.a.toJSON();k.version=this.b||NaN;this.d.setItem(f,Eh(k));c(g.version||NaN)}else{for(k=0;k<this.a.count();k++)l=this.a.store(k);this.b=g.version||NaN;c(this.b)}else g=b.toJSON(),this.b=1,g.version=this.b,this.d.setItem(f,Eh(g)),c(NaN);return e};h.Oe=function(){return!!this.c};h.Pe=function(){};h.Fd=function(){};
h.ye=function(){};h.cd=function(){return"memory"};h.close=function(){};h.Wd=function(a,b,c,d){a(new lo(this,function(a,b){d(a,b)}))};h.toString=function(){return"SimpleStorage:"+this.cd()+":"+(this.c+":"+this.b)};function Vo(){Uo.call(this,this)}A(Vo,Uo);Vo.prototype.ff=function(){return window.localStorage};Vo.prototype.cd=function(){return"localstorage"};Bk.push(function(a,b){if(!b||"localstorage"==b){var c=new Vo,d=new ul;c.connect(a,d);c.hb(function(a){for(var b=0;b<a.stores.length;b++)Ln(c,a.stores[b].getName()).clear()})}});function Wo(){Uo.call(this,this)}A(Wo,Uo);Wo.prototype.ff=function(){return window.sessionStorage};Wo.prototype.cd=function(){return"sessionstorage"};
Bk.push(function(a,b){if(!b||"sessionstorage"==b){var c=new Wo,d=new ul;c.connect(a,d);c.hb(function(a){for(var b=0;b<a.stores.length;b++)Ln(c,a.stores[b].getName()).clear()})}});function Xo(a,b){this.a=t(a)?a:4194304;this.b=b||"websql"}h=Xo.prototype;
h.connect=function(a,b){function c(b,c){var f=b.version?parseInt(b.version,10):0,g=c.vc?isNaN(f)?1:f+1:c.version;re(e.logger,a+": changing version from "+b.version+" to "+g);var k=!1,l=0;b.changeVersion(b.version,g+"",function(a){e.hb(function(b){k=!0;for(var d=0;d<c.count();d++){var f=W(b,c.store(d).getName()),f=f?pm(f,c.store(d)):null;Yo(e,a,c.store(d),function(a){a&&l++},f)}for(d=0;d<b.count();d++)f=b.store(d),yl(c,f.getName())||(c instanceof ul?vl(c,f):(f="DROP TABLE "+lm(f),Q(e.logger,f),a.executeSql(f,
[],function(){},function(a,b){throw b;})))},a,b)},function(c){qe(e.logger,"SQLError "+c+" "+c.code+"("+c.message+") while changing version from "+b.version+" to "+g+" on "+a);throw c;},function(){if(k){var f=".";l!=c.stores.length&&(f=" but unexpected stores exists.");O(e.logger,a+":"+b.version+" ready"+f);d(b)}else M(e.logger,a+": changing version voided.")})}function d(a,b){t(b)?(e.Ba=null,g.p(b)):(e.Ba=a,g.callback(parseFloat(f)))}var e=this,f=NaN,g=new B,k=null;try{"sqlite"==this.b?r.sqlitePlugin?
(k=r.sqlitePlugin.openDatabase(a,"",a,this.a),k.readTransaction||(k.readTransaction=k.transaction),k.changeVersion=function(a,b,c,d,e){k.transaction(c,d,e)}):(M(this.logger,"sqlitePlugin not found."),k=null,this.Qe=Error("sqlitePlugin not found.")):k=r.openDatabase(a,"",a,this.a)}catch(l){if("SECURITY_ERR"==l.name)M(this.logger,"SECURITY_ERR for opening "+a),k=null,this.Qe=new $k(l);else throw l;}if(k){var f=k.version||"",m="database "+a+(0==f.length?"":" version "+k.version);null!=b.version&&b.version==
k.version?(re(e.logger,"Existing "+m+" opened as requested."),d(k)):this.hb(function(a){(a=ym(b,a,!0,!1))?(0==f?re(e.logger,"New "+m+" created."):b.vc?re(e.logger,"Existing "+m+" opened and schema change for "+a):re(e.logger,"Existing "+m+" opened and  schema change to version "+b.version+" for "+a),c(k,b)):(re(e.logger,"Existing "+m+" with same schema opened."),d(k))},null,k)}else d(null,this.Qe);return g};h.cd=function(){return this.b};h.Qe=null;h.Ba=null;h.logger=L("ydn.db.con.WebSql");h.Pe=function(){};
h.Fd=function(){};
function Zo(a){var b=a.l,c="CREATE TABLE IF NOT EXISTS "+lm(a)+" (",d=a.c,c=c+(d+" "+b+" PRIMARY KEY ");a.autoIncrement&&(c+=" AUTOINCREMENT ");if(!a.Fc||!a.keyPath&&0==a.indexes.length)c+=" ,_default_ BLOB";for(var e=[],f=[d],g=0,k=a.indexes.length;g<k;g++){var l=a.index(g),m="";if(l.multiEntry){var m="ydn.db.me:"+a.getName()+":"+l.getName(),n=l.unique?" UNIQUE ":"",l="CREATE TABLE IF NOT EXISTS "+Qa(m)+" ("+d+" "+b+", "+l.c+" "+l.i+n+")";e.push(l)}else l.unique&&(m=" UNIQUE "),n=l.keyPath,"BLOB"!=
l.type&&v(n)&&(n="CREATE "+m+" INDEX IF NOT EXISTS "+Qa(a.getName()+"-"+l.getName())+" ON "+lm(a)+" ("+l.c+")",e.push(n)),n=l.c,-1==f.indexOf(n)&&(c+=", "+n+" "+l.i+m,f.push(n))}e.unshift(c+")");return e}h.Ne=function(){return this.Ba?parseFloat(this.Ba.version):void 0};
h.hb=function(a,b,c){function d(a,b){throw b;}function e(b,c){if(c&&c.rows){for(var d=0;d<c.rows.length;d++){var e=c.rows.item(d);if("__WebKitDatabaseInfoTable__"!=e.name&&"sqlite_sequence"!=e.name&&"table"==e.type){var q=Eb(e,"sql");O(f.logger,"Parsing table schema from SQL: "+q);for(var s=q.substr(q.indexOf("("),q.lastIndexOf(")")).match(/(?:"[^"]*"|[^,])+/g),w=void 0,y,q=[],G=!1,H=!1,J=0;J<s.length;J++){var Z=s[J].match(/\w+|"[^"]+"/g),Ua=db(Z,function(a){return a.toUpperCase()}),P=Na(Z[0],'"'),
Z=am(Ua[1]);if(-1!=Ua.indexOf("PRIMARY")&&-1!=Ua.indexOf("KEY")){y=Z;if(v(P)&&!ya(P)&&"_ROWID_"!=P){var kd=P.split(","),w=P;1<kd.length&&(w=kd,y=void 0)}-1!=Ua.indexOf("AUTOINCREMENT")&&(G=!0)}else if("_ROWID_"!=P)if("_default_"==P)H=!0;else{var Jk="UNIQUE"==Ua[2];va(P,e.tbl_name+"-")&&(P=P.substr(e.tbl_name.length+1));Ua=new $l(P,Z,Jk);q.push(Ua)}}if(va(e.name,"ydn.db.me:")){var Rd=e.name.split(":");if(3<=Rd.length){var Pe=Rd[1],w=new $l(Rd[2],Z,Jk,!0),s=ib(q,function(a){return a.getName()==Rd[2]});
0<=s?q[s]=w:q.push(w);s=ib(k,function(a){return a.getName()===Pe});0<=s?(J=k[s],k[s]=new rl(J.getName(),J.keyPath,G,y,q,void 0,!H)):k.push(new rl(Pe,void 0,!1,void 0,[w]));O(f.logger,'multi entry index "'+w.getName()+'" found in '+Pe+(-1==s?"*":""))}else M(f.logger,'Invalid multiEntry store name "'+e.name+'"')}else J=ib(k,function(a){return a.getName()===e.name}),0<=J?(s=k[J].index(0),q.push(s),k[J]=new rl(e.name,w,G,y,q,void 0,!H)):(q=new rl(e.name,w,G,y,q,void 0,!H),k.push(q))}}d=new xm(g,k);a(d)}}
var f=this,g=(c=c||this.Ba)&&c.version?parseFloat(c.version):void 0,g=isNaN(g)?void 0:g,k=[];b?b.executeSql("SELECT * FROM sqlite_master",[],e,d):c.readTransaction(function(b){f.hb(a,b,c)},function(a){qe(f.logger,"opening tx: "+a.message);throw a;},e)};
function Yo(a,b,c,d,e){function f(a){b.executeSql(a,[],function(){g++;g==k.length&&(d(!0),d=null)},function(b,e){g++;g==k.length&&(d(!1),d=null);var f="SQLError creating table: "+c.getName()+" "+e.message+' for executing "'+a;throw new Zk(e,f);})}var g=0,k=Zo(c),l="Create";if(e){e=tl(c,e);if(0==e.length){O(a.logger,"same table "+c.getName()+" exists.");d(!0);d=null;return}l="Modify";M(a.logger,"table: "+c.getName()+" has changed by "+e+" ALTER TABLE cannot run in WebSql, dropping old table.");k.unshift("DROP TABLE IF EXISTS "+
Qa(c.getName()))}O(a.logger,l+" table: "+c.getName()+": "+k.join(";"));for(a=0;a<k.length;a++)f(k[a])}h.Oe=function(){return!!this.Ba};h.close=function(){this.Ba=null};
h.Wd=function(a,b,c,d){function e(a){O(k.logger,k+": Tx "+c+" request cause error.");d("abort",a)}function f(){d("complete",{type:"complete"})}function g(b){a(b)}var k=this;null===this.Ba&&(a(null),d("abort",this.Qe));c==ok?this.Ba.readTransaction(g,e,f):c==qk?this.Ba.changeVersion(this.Ba.version,this.Ba.version+1+"",g,e,f):this.Ba.transaction(g,e,f)};
Bk.push(function(a,b){if(ia(r.openDatabase)&&(!b||"websql"==b)){var c=new Xo,d=new ul;Q(c.logger,"deleting websql database: "+a);var d=c.connect(a,d),e=function(){var b=c.logger;b&&b.info("all tables in "+a+" deleted.",void 0)};d.n(function(){c.Wd(function(b){b.executeSql('SELECT * FROM sqlite_master WHERE type = "table"',[],function(d,e){if(e&&e.rows){for(var l=e.rows.length,m=0,n=0;n<l;n++){var p=e.rows.item(n);"__WebKitDatabaseInfoTable__"!=p.name&&"sqlite_sequence"!=p.name&&(m++,O(c.logger,"deleting table: "+
p.name),b.executeSql("DROP TABLE "+p.name))}Q(c.logger,m+' tables deleted from "'+a+'"')}},function(a,b){throw b;})},[],pk,e)});d.Hc(function(){M(c.logger,"Connecting "+a+" failed.")})}});Xo.prototype.ye=function(){};Xo.prototype.toString=function(){return"WebSql:"+(this.Ba?":"+this.Ba.version:"")};Nm.prototype.jf=function(a){return"indexeddb"==a&&rk?new So(this.r,this.G):"sqlite"==a&&r.sqlitePlugin?new Xo(this.r,"sqlite"):"websql"==a&&ia(r.openDatabase)?new Xo(this.r):"localstorage"==a&&window.localStorage?new Vo:"sessionstorage"==a&&window.sessionStorage?new Wo:"memory"==a?new Uo:null};function $o(a,b){tc.call(this);this.d=b;this.b=[];if(a>this.d)throw Error("[goog.structs.SimplePool] Initial cannot be greater than max");for(var c=0;c<a;c++)this.b.push(this.a())}A($o,tc);$o.prototype.a=function(){return{}};$o.prototype.c=function(a){if(x(a))if(ia(a.S))a.S();else for(var b in a)delete a[b]};$o.prototype.u=function(){$o.f.u.call(this);for(var a=this.b;a.length;)this.c(a.pop());delete this.b};function ap(){this.a=[];this.c=new Jd;this.d=new Jd;this.h=1;this.e=new $o(0,4E3);this.e.a=function(){return new bp};this.i=new $o(0,50);this.i.a=function(){return new cp};var a=this;this.b=new $o(0,2E3);this.b.a=function(){return String(a.h++)};this.b.c=function(){}}L("goog.debug.Trace");function cp(){this.time=this.count=0}cp.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");return a.join("")};function bp(){}
function dp(a,b,c){var d=[];-1==b?d.push("    "):d.push(ep(a.eventTime-b));d.push(" ",fp(a.eventTime-0));0==a.a?d.push(" Start        "):1==a.a?(d.push(" Done "),d.push(ep(a.c-a.startTime)," ms ")):d.push(" Comment      ");d.push(c,a);0<a.b&&d.push("[VarAlloc ",a.b,"] ");return d.join("")}bp.prototype.toString=function(){return null==this.type?this.comment:"["+this.type+"] "+this.comment};
ap.prototype.toString=function(){for(var a=[],b=-1,c=[],d=0;d<this.a.length;d++){var e=this.a[d];1==e.a&&c.pop();a.push(" ",dp(e,b,c.join("")));b=e.eventTime;a.push("\n");0==e.a&&c.push("|  ")}if(0!=this.c.da()){var f=z();a.push(" Unstopped timers:\n");Gd(this.c,function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",fp(b.startTime),")\n")})}b=this.d.Ca();for(d=0;d<b.length;d++)c=this.d.get(b[d]),1<c.count&&a.push(" TOTAL ",c,"\n");a.push("Total tracers created ",0,"\n","Total comments created ",
0,"\n","Overhead start: ",0," ms\n","Overhead end: ",0," ms\n","Overhead comment: ",0," ms\n");return a.join("")};function ep(a){a=Math.round(a);var b="";1E3>a&&(b=" ");100>a&&(b="  ");10>a&&(b="   ");return b+a}function fp(a){a=Math.round(a);return String(100+a/1E3%60).substring(1,3)+"."+String(1E3+a%1E3).substring(1,4)}new ap;/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
function gp(a){a.t||(a.t=new F);return a.t}Nm.prototype.addEventListener=function(a,b,c,d){if("ready"==a)md(gp(this),a,b,c,d);else{var e="created error fail ready deleted updated versionchange".split(" "),f=function(a){if(!jb(e,a))throw new I('Invalid event type "'+a+'"');};if(fa(a))for(var g=0;g<a.length;g++)f(a[g]);else f(a);ed(gp(this),a,b,c,d)}};Nm.prototype.removeEventListener=function(a,b,c,d){nd(gp(this),a,b,c,d)};Nm.prototype.Oa=function(a){gp(this).dispatchEvent(a)};function hp(a,b,c){Qm.call(this,a,b,c)}A(hp,Ro);L("ydn.gdata.base");function ip(a){this.c=a||null;this.a=this.b=null;a&&jp(this,a)}var kp;ip.prototype.logger=L("ydn.crm.UserSetting");
var lp={stores:[{name:"general"},{name:"sugar"},{name:"_ydn_sync_history",keyPath:"sequence",autoIncrement:!0,indexes:[{name:"key",keyPath:["entity","id"]}]},{name:"BeaconTrack",autoIncrement:!0,indexes:[{name:"path"},{name:"created"}]},{name:"AccessTokenRecord",autoIncrement:!0,indexes:[{name:"Path"},{name:"Created"}]}]},mp={stores:[{name:"contact",keyPath:"id.$t",type:"TEXT",indexes:[{name:"updated.$t",type:"TEXT"},{name:"ydn$emails",multiEntry:!0,generator:function(a){var b=[];a=u(a.gd$email)?
a.gd$email:x(a.gd$email)?[a.gd$email]:[];for(var c=0;c<a.length;c++){var d=yo(a[c].address);d&&b.push(d)}return b}},{name:"ydn$externalIds",multiEntry:!0,generator:function(a){return(u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:[]).map(function(a){return a.value})}}]}]};
function jp(a,b){if(!a.c||a.c!=b){r.sessionStorage.setItem("last-user-id",b);var c="setting-"+b,d="gdata-"+b;a.b&&a.b.getName()!=c&&(a.b.close(),a.b=null);a.a&&a.a.getName()!=d&&(a.a.close(),a.a=null);a.b||(a.b=new hp(c,lp));a.a||(a.a=new hp(d,mp))}}function np(a){return a.c?a.c+"-sd":r.sessionStorage.getItem("last-user-id")+"-sd"}function op(a){var b=np(a),c=new B;chrome.storage.local.get(b,function(a){c.callback(a[b])});return c}
function pp(a,b){var c=np(a),d=new B,e={};e[c]=b;chrome.storage.local.set(e,function(){d.callback(!0)})}function qp(){if(!kp){var a=chrome.runtime.getManifest();kp=a.short_name==rp?rp:a.short_name==sp?sp:a.short_name==tp?tp:up}return kp};var sp="Email Tracker for Gmail",rp="Email Tracker",tp="SugarCRM",up="";function vp(){F.call(this)}A(vp,F);vp.prototype.logger=L("ydn.crm.Client");function wp(a,b,c){this.b=a;this.c=b;this.a=c}wp.prototype.request=function(a){return this.b(a)?this.c.request(a):this.a.request(a)};function xp(a,b,c){this.client=a;this.c=b;this.b=NaN;this.d=[];this.a=!1;this.e=!!c}xp.prototype.request=function(a){return new yp(a,this)};function yp(a,b){a.path=b.c+a.path;this.req=b.client.request(a);this.parent=b;b.e&&(this.req instanceof rn&&(this.req.d=!0),this.d=!0);this.c=null;this.b=void 0}A(yp,rn);
yp.prototype.execute=function(a,b){if(this.parent.a)this.c=a,this.b=b,this.parent.d.push(this);else{this.parent.a=!0;var c=function(c,d){var g=Xj(d,"retry-after");this.parent.b=g?/[^0-9|\.]/.test(g)?(new Date(g)).getTime():1E3*parseFloat(g)+z():NaN;a&&a.call(b,c,d);this.parent.a=!1;if(g=this.parent.d.pop())g.execute(g.c,g.b),g.c=null,g.b=null},d=this.parent.b-z();0<d?$f(function(){this.parent.b=NaN;this.req.execute(c,this)},d,this):this.req.execute(c,this)}};function zp(a,b,c,d,e){this.e=t(a)?a:Tj();this.a=b;this.b=c;this.c=d||0;this.d=!!e}zp.prototype.request=function(a){if(this.a){a.headers||(a.headers={});for(var b in this.a)a.headers[b]=this.a[b]}this.b&&(a.path=this.b+a.path);return new rn(a,this.e,this.c,this.d)};function Ap(a,b,c){this.c=t(a)?a:Tj();this.a=b;this.b=c}Ap.prototype.request=function(a){if(this.a){a.headers||(a.headers={});for(var b in this.a)a.headers[b]=this.a[b]}this.b&&(a.path=this.b+a.path);return new rn(a,this.c)};function Bp(a){for(var b=Fm(a),c=0;c<b.stores.length;c++);this.a=Pm(a,gl,!1);this.d=!1;a.$a(this.l,this);this.b=1E4;this.e=de.value;this.c=0;this.t=oa(this.r,this);this.i=!1;this.h={}}function Cp(a){if(a.b&&a.c>=a.b){var b=a.b/100;100<b&&(b=100);a.a.keys("db-logger",null,b).n(function(a){a=a.map(function(a){return new Ck("db-logger",a)});this.a.remove(a).n(function(){this.a.count("db-logger").n(function(a){this.c=a},this)},this)},a)}}function Dp(){var a=Ep;a.b=1E4;Cp(a)}
Bp.prototype.l=function(){this.b&&(this.d=!0,this.a.count("db-logger").n(function(a){this.c=a;Cp(this)},this))};function Fp(a){var b=Ep;if(a!=b.i){var c=oe();a?ge(c,b.t):(c=c.a)&&lb(c,b.t);b.i=a}}Bp.prototype.r=function(a){if(this.d){var b=a.b;va(b,"ydn.db.")||this.h[b]||!(b=a.d)||b.value<=this.e||(a={exception:a.a,level:b.value,logger:a.b,name:b.name,time:a.e,message:a.getMessage(),seq:a.h},this.a.put("db-logger",a),this.c++,Cp(this))}};
function Gp(a,b){var c=Ep,d=a||100,e=b||0,f=Lk(["INFO"]);return c.a.$("db-logger","name, time",f,d,e,!0)}var Ep=null;function Hp(a,b){this.a=a;this.filter=b||null;this.prefix=""}Hp.prototype.count=function(){return this.a.count("log")};Hp.prototype.log=function(){};var Ip,Jp,Kp=L("ydn.crm");function Lp(){Ip||(Ip=new Ng(0));return Ip}var Mp=null,Np={};function Op(a,b){"sync"==b&&(x(a["lg-cc"])&&dj(!!a["lg-cc"].newValue),x(a["lg-br"])&&Fp(!!a["lg-br"].newValue),x(a["cp-po"])&&(Np["cp-po"]=a["cp-po"].newValue||Pp))}
function Qp(a,b,c,d){if(r._gaq){if(!(100<r._gaq.length)){for(var e=["_trackEvent"],f=0;f<arguments.length;f++)e.push(arguments[f]);r._gaq.push(e)}}else r.googleAnalytic?r.googleAnalytic("send",a,b,b,d):Kj.log({category:a,label:b||"",value:d||"",action:b||""})}var Rp=!1,Sp="";z();
function Tp(){var a=new B,b=r.CRMinInbox.sugarcrm.Version;chrome.storage.local.get("ydn-crm-track",function(c){var d=c["ydn-crm-track"];c="jsc/crmininbox-"+b.release+".js";navigator.onLine&&"Edge"==d?c="https://ydn-src-1.storage.googleapis.com/jsc/crmininbox-edge.js":"Beta"==d&&b.beta?c="jsc/crmininbox-"+b.beta+".js":"RC"==d&&b.rc&&(c="jsc/crmininbox-"+b.rc+".js");a.callback(c);d={};d["front-end-src"]=c;chrome.storage.local.set(d)});return a}
function Up(){var a;chrome&&chrome.runtime&&chrome.runtime.id?(a="9","ldikiokclnbceabnlbkabmcacpiednop"==chrome.runtime.id?a="8":"iccdnijlhdogaccaiafdpjmbakdcdakk"==chrome.runtime.id&&(a="6"),a="UA-33861582-"+a):a=null;if(a&&!r._gaq){r._gaq=[];r._gaq.push(["_setAccount",a]);r._gaq.push(["_gat._forceSSL"]);r._gaq.push(["_trackPageview"]);a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src="https://ssl.google-analytics.com/ga.js";var b=document.getElementsByTagName("script")[0];
b.parentNode.insertBefore(a,b)}}
function Vp(){if(!Rp){Rp=!0;Up();var a;a="Yathit CRMinInbox ydn.crm.version 1.3.3 (dev)";Jj("ydn.crm","fine");Jj("ydn.ds","fine");r.console.info(a);r.console.info("API documentation: http://crm.yathit.com/\nFeedback and suggestion: https://yathit.uservoice.com/\nBug report: https://github.com/yathit/sugarcrm-gmail-chrome-extension");dj(!1);Tp();Wp();Mp=new hp("ydn.crm",{stores:[{name:"log",keyPath:"key"},{name:"db-logger",autoIncrement:!0,indexes:[{name:"level"},{name:"time"},{name:"name"},{name:"name, time",
keyPath:["name","time"]}]},{name:"default",autoIncrement:!0}]});Ep=new Bp(Mp);Dp();Ep.e=300;Ep.h["ydn.db.tr.DbOperator"]=!0;Fp(!1);Mp.$a(function(){Mp.get("default","install-id").n(function(a){a?Sp=a["install-id"]:(Sp=z()+Math.random().toFixed(8).substr(2),a={},a["install-id"]=Sp,Mp.put("default",a,"install-id"))})});Kp.info("Starting ydn.crm.App:1.3.3");var b=["lg-cc","cp-po","lg-br"];chrome.storage.sync.get(b,function(a){for(var d={},e=0;e<b.length;e++)t(a[b[e]])&&(d[b[e]]={newValue:a[b[e]]});Op(d,
"sync")});chrome.storage.onChanged.addListener(Op);ak=Kj=new Hp(Mp,function(a){return!a||a.HttpRequestData&&"https://mail.google.com/mail/feed/atom/bazinga"==a.HttpRequestData.path?null:a});window.onerror=function(a,b,e,f){var g="";f&&f instanceof Error&&(g=f.stack+"");Lj({message:a,url:b,lineNumber:e,stack:g})}}}function Wp(){Jp||(Jp=new Ap(Lp()),Sj(Jp,"default"))}
function Xp(a){Yp();Zp();$p();a=new tn(a,Ip,!1);Sj(a,"gc");Sj(new wp(function(a){return"GET"==a.method},a,new xp(a,"https://www.yathit.com/proxy/",!0)),"gse")}function Yp(){var a=Oi(Pi);a||(Wp(),a=new zp(Lp(),void 0,"https://www.yathit.com",0,!0),Sj(a,Pi));return a}function Zp(){var a=Oi("proxy");a||(a=new xp(Yp(),"/proxy/"),Sj(a,"proxy"))}function $p(){var a=Oi("auth");a||(a=new zp(Lp(),void 0,"https://www.yathit.com/a/cm",0,!0),Sj(a,"auth"));return a}
function aq(a){x(a)||C("Invalid request data");a=a.email;v(a)&&/\S+@\S+\.\S+/.test(a)||C("Invalid request data for email "+a);return bq(a).n(function(a){return{fc:a}})}function cq(a){aq({email:a}).V(function(a){window.console.log(a)})}function bq(a){var b=new B;a=a.trim().toLowerCase();a=new Qi("/so/info","POST",{email:a});Yp().request(a).execute(function(a,d){a?b.callback(a):b.p(d)});return b};function dq(a,b){this.timestamp=b||z();this.type=a;this.c=this.a=this.b=void 0}function eq(a,b){x(b)?a.b=Am(b):a.b=b}dq.prototype.toJSON=function(){return{type:this.type,timestamp:this.timestamp,newValue:this.a,oldValue:this.b,meta:this.c}};function fq(a){this.a=a}fq.prototype.add=function(a){this.a.add("history",a.toJSON())};function gq(a,b){if(a.link){if(u(a.link)){for(var c=0;c<a.link.length;c++)if(a.link[c].rel==b)return a.link[c];return null}return a.link.rel==b?a.link:null}return null};function hq(a,b){this.entry=a;this.data=b;this.a=!1}hq.prototype.data=null;hq.prototype.preventDefault=function(){this.a=!0};function iq(a,b,c,d){E.call(this,a,b);this.status=c;this.entry=d}A(iq,E);iq.prototype.status=NaN;iq.prototype.H=function(){return this.status};iq.prototype.Ab=function(){return this.entry.Ab()};function jq(a,b,c){iq.call(this,"conflict",a,b,c.entry)}A(jq,iq);function kq(a,b){this.a=a;if(b)throw new xd("optional key paths");}var lq={Uj:"key",Pj:"date",Vj:"modified",Sj:"expires",Rj:"etag",Zj:"updated",$j:"uri",NEXT:"next"};kq.prototype.K=function(a,b){return b&&this.a[a]?bk(b,this.a[a]):void 0};function mq(a,b,c,d){a.a[b]&&ck(c,a.a[b],d)};function nq(a,b,c,d){this.key=a;this.b=(this.b=d?b[d]:b)||{};this.a=c}function oq(a){return null!=a.key?a.key:a.a.K("key",a.b)}nq.prototype.getDate=function(){return this.a.K("date",this.b)};function pq(a){return a.a.K("updated",a.b)}function qq(a){return a.a.K("etag",a.b)}function rq(a){var b={},c=qq(a);c&&1<c.length?b["if-none-match"]=c:(a=pq(a))&&(b["if-modified-since"]=a);return b}
nq.prototype.toJSON=function(){var a={};mq(this.a,"key",a,oq(this));var b=this.getDate();b&&mq(this.a,"date",a,b);(b=this.a.K("expires",this.b))&&mq(this.a,"expires",a,b);(b=pq(this))&&mq(this.a,"updated",a,b);(b=qq(this))&&mq(this.a,"etag",a,b);return a};function sq(a,b,c){b.expires&&mq(c,"expires",b,(new Date(b.expires)).getTime());b["last-updated"]&&mq(c,"updated",b,(new Date(b["last-updated"])).getTime());b.etag&&mq(c,"etag",b,(new Date(b.etag)).getTime());mq(c,"date",b,NaN);nq.call(this,a,b,c)}A(sq,nq);function tq(a,b,c){this.a=a;this.h=c||null;this.c=this.b=null;this.key=b}h=tq.prototype;h.logger=L("ydn.db.sync.entry.Rest");h.Ab=function(){if(this.c&&this.a.i&&this.d){var a=this.a.t;this.a.C||delete this.c[a]}return this.c||null};h.K=function(){return this.h};h.s=function(){return this.key};h.Re=function(){return this.a.Nf(this.s())};function uq(a,b){var c=a.s();return new sq(c,b.Nc(),a.a.h)}
h.sf=function(a,b){if(a)return a;if(Ti(b))return Yj(b);try{return Yj(b)}catch(c){var d=Wj(b);return x(d)?d:{body:d}}};h.save=function(a){var b=this.s();if(a&&!this.a.i)return z(),vq(this.a,[this.d.toJSON()]);var c=this.c;if(a&&!c)return sc();a=void 0;null!=this.d&&(z(),a=[this.d.toJSON()]);return wq(this.a,[c],a,[b])};
h.Ac=function(a,b){if(this.a.r&&x(this.b))a.call(b,304),a=null;else{var c=this;xq(this,function(d){if(d){var e=d.a.K("expires",d.b);if(e&&e>z()){O(this.logger,this+" not expired");a.call(b,304);a=null;return}}e=c.Re();d=c.xc(e,"GET",d);this.a.pa().request(d).execute(function(d,e){c.d=uq(c,e);c.c=c.sf(d,e);a.call(b,e.H());a=null})},this)}};
h.xc=function(a,b,c,d){a=new Qi(a,b);if(c){var e;"POST"==a.method||"PUT"==a.method||"DELETE"==a.method?(e={},(b=pq(c))&&(e["if-unmodified-since"]=b),(c=qq(c))&&1<c.length&&(e["if-match"]=c),c=e):c=rq(c);e=c;a.headers?Hb(a.headers,e):a.headers=e}a.body=x(d)?JSON.stringify(d):d;O(this.logger,this+" "+a.method+" "+a.path+" "+Dh(e));return a};
function yq(a,b,c){xq(a,function(a){var e=this.K();a=this.xc(this.Re(),"PUT",a,e);this.a.pa().request(a).execute(function(a,d){this.d=uq(this,d);this.c=a;b&&(b.call(c,d.H()),b=null)},this)},a)}function xq(a,b,c){a.e?b.call(c,a.e):zq(a.a,a.s(),function(d){a.e=d;b.call(c,d)})}
h.load=function(a,b){if(this.b&&this.e)a&&(a.call(b,this.b,this.e),a=void 0);else{var c=this.s();this.a.load(c,function(c,e){this.b=c;var f=this.a.t;this.b&&f&&this.b[f]&&(this.e=new nq(this.key,this.b,this.a.h,f),this.a.C||delete this.b[f]);this.b=c;this.e=e;a&&(a.call(b,c),a=void 0)},this)}};function Aq(a,b){var c=a.Re(),d=a.a.pa();xq(a,function(a){a=this.xc(c,"DELETE",a);d.request(a).execute(function(a,d){O(this.logger,"deleted "+c+" "+d.H());b.call(this,d.H())},this)},a)}
h.toString=function(){return"sync.entry{"+this.a.D()+":"+this.key+"}"};function Bq(a,b,c){this.storage=a;this.store=b;this.N=b.getName();a="format readRequestTimeout writeRequestTimeout transport Options fetchStrategies baseUri immutable keepMeta metaStoreName metaDataName prefetch prefetchRefractoryPeriod".split(" ");for(var d in c)if(-1==$a(a,d))throw new I('Unknown Sync attribute "'+d+'"  in Sync.');this.r=!!c.immutable;this.b=c.baseUri;this.Db=c.metaStoreName||this.N;this.t=c.metaDataName;this.i=this.Db==this.N;a=c.Options||{};if(!this.Db)throw new I("metadata store name required.");
b=this.xb();for(d in a)if(-1==$a(b,d))throw new I('Unknown Sync.Options attribute "'+d+'" in Sync.Options');this.T=a.delimiter||"";this.d=a.prefix||"";this.C=!!c.keepMeta;this.Q=c.prefetch||ha(c.prefetchRefractoryPeriod)?"full":null;this.G=ha(c.prefetchRefractoryPeriod)?c.prefetchRefractoryPeriod:5E3;this.a=Cq(c.transport);this.h=new kq(this.wb(),c.metaData);this.e=null;this.l=NaN}h=Bq.prototype;h.wb=function(){var a={},b;for(b in lq)a[b]=b;return a};h.xb=function(){return[]};h.D=function(){return this.N};
h.logger=L("ydn.db.sync.Rest");h.Jb=function(){return this.b};h.pa=function(){this.a||(this.a=new Ap);return this.a};h.toString=function(){return"sync:"+this.N};function vq(a,b){return Pl(a.storage.a,a.Db,b).Hc(function(a){throw a;})}function Dq(a,b,c){a.store.keyPath&&null==Gl(a.store,b)&&null!=c&&ck(b,a.store.keyPath,c)}
function wq(a,b,c,d){d=a.store.keyPath?void 0:d;if(c){if(a.i){for(g=0;g<b.length;g++)null!=c[g]&&Hb(b[g],c[g]);return Pl(a.storage.a,a.N,b,d)}if(b){for(var e=[],f=b.concat(c),g=0;g<b.length;g++){var k=a.store.keyPath?NaN:d[g];e.push(new Ck(a.N,k))}for(g=0;g<c.length;g++)e.push(new Ck(a.Db,NaN));return Pl(a.storage.a,e,f)}return Pl(a.storage.a,a.Db,c)}for(g=0;g<b.length;g++)k=d?d[g]:void 0,Dq(a,b[g],k);return Pl(a.storage.a,a.N,b,d)}
function Eq(a,b){var c=[new Ck(a.N,b)];a.i||c.push(new Ck(a.Db,b));return Ql(a.storage.a,c)}h.Nf=function(a){return this.Jb()+a};h.add=function(a,b,c){null!=c?Dq(this,b,c):this.store.keyPath&&(c=Gl(this.store,b));var d=this.va(c,b),e=this;yq(d,function(a){201==a||200==a?(O(e.logger,d+" created"),d.save(!0)):M(e.logger,"Unexpected respond "+a+" for add "+d)})};
function zq(a,b,c){var d=new Ck(a.Db,b);Fq(a,[d]).m(function(a){c.call(void 0,new nq(b,a[0],this.h,this.t))},function(a){M(this.logger,this+" error loading meta data "+a);c.call(void 0,null)},a)}h.te=function(a,b){var c=a.map(function(a){return new Ck(this.Db,a)});Fq(this,c).m(function(c){for(var e=[],f=0;f<a.length;f++)e[f]=new nq(a[f],c[f],this.h,this.t);b(e)},function(a){M(this.logger,this+" error loading meta data "+a);b([])},this)};
h.load=function(a,b,c){var d=this.Db,e=[new Ck(this.D(),a)];this.i||e.push(new Ck(d,a));Fq(this,e).m(function(d){var e=d[0];b.call(c,e,new nq(a,this.i?e:d[1],this.h,this.t))},function(a){M(this.logger,this+" error loading meta data "+a);b.call(c,null,null)},this)};function Fq(a,b){return Tl(a.storage.a,b)}
h.get=function(a,b){this.l||this.gc();xk(a,function(c,d,e){if(d)e(c,d);else{ue(a,c);var f=t(c);if(f&&this.r)e(c);else{var g=this.va(b,c);g.Ac(function(a){if(304==a){if(e(c),!f)throw new Ad(g+" not modified, but not exist in server");}else if(200==a)g.save().V(function(){e(g.Ab())});else if(404==a)Eq(g.a,g.s()).V(function(){e(g.Ab())});else throw e(g.Ab()),new zd("Invalid HTTP respond "+a+" for GET "+b);},this)}}},this)};
function Gq(a,b,c,d,e,f){var g=[],k=a.logger;Q(a.logger,d.length+", "+e.length+", "+f.length+", "+g.length+" records to fetch, update, delete, save");var l=d.length+e.length+f.length+g.length;if(0==l)b(c);else{for(var m=!1,n=function(){l--;0==l&&(b(c,m),b=null)},g=0;g<d.length;g++){var p=a.va(d[g]);p.index=g;p.Ac(function(a){200==a?(ke(k,"A new "+this+" received from server"),this.save().m(function(){c[this.index]=this.Ab();n()},function(){m=!0;n()},this)):304==a?this.save(!0).m(function(){ke(k,this+
" expires date updated");n()},function(){m=!0;n()},this):(ie(k,"Invalid status "+a+" for fetching "+this),n())},p)}for(g=0;g<e.length;g++)p=a.va(e[g]),p.index=g,p.load(function(){this.Ac(function(a){200==a?(ke(k,this+" updated from server"),this.save().m(function(){c[this.index]=this.Ab();n()},function(){m=!0;n()},this)):(ie(k,"Invalid status "+a+" for fetching "+this),n())})});for(g=0;g<f.length;g++)p=a.va(f[g]),p.index=g,Eq(p.a,p.s()).m(function(){c[this.index]=new hq(p,null);n()},function(){m=
!0;n()},p)}}function Hq(a,b,c){xk(b,function(a,e,f){if(e)f(a,e);else if(fb(a,function(a){return t(a)})&&this.r)f(a);else{ue(b,a);var g=a.length;for(e=0;e<c.length;e++)if(this.r&&t(a[e]))g--,0==g&&f(a);else{var k=this.va(c[e],a[e]);k.index=e;k.Ac(function(b){200==b?(a[this.index]=this.Ab(),this.save()):404==b&&(a[this.index]=void 0);g--;0==g&&f(a)},k)}}},a)}h.va=function(a,b){return new tq(this,a,b)};h.count=function(a){return a};h.Uf=function(){throw new xd;};
h.$=function(a,b,c){Iq(this)?(O(this.logger,"prefetch queued"),xk(a,function(d,e,f){ue(a,d);e?f(d,e):Jq(this,function(a){a?Sl(this.storage.a,this.N,null,null,!1,b,c).m(function(a){f(a)},function(a){f(a,!0)},this):f(d)},function(){M(this.logger,this+" prefetch fail");f(d)},this)},this)):this.Uf(a,b,c)};
h.keys=function(a,b,c,d,e,f,g){xk(a,function(k,l,m){ue(a,k);l?m(k,l):Jq(this,function(a){a?Ul(this.storage.a,this.N,b,c,d,e,f,g).m(function(a){m(a)},function(a){m(a,!0)},this):m(k)},function(){M(this.logger,this+" prefetch fail");m(k)},this)},this)};h.qf=function(){};
h.put=function(a,b,c){c=t(c)?c:this.store.keyPath?Gl(this.store,b):null;var d=this.va(c,b);T(a,function(){d.load()},this);xk(a,function(c,f,g){ue(a,c);yq(d,function(c){409==c?d.Ac(function(){var c=new hq(d,b);ue(a,c);c.a?g(null,f):g(void 0,f)}):200==c||201==c?(d.save(!0),g(b,f)):(M(this.logger,"Unexpected response for PUT: "+c),g(null,f))},this)},this)};
h.remove=function(a,b){var c=this,d=this.va(b);d.load(function(){xk(a,function(e,f,g){Aq(d,function(f){if(409==f){f=new hq(d,null);ue(a,f);var l=new jq(c.storage,409,f);c.storage.Oa(l)}else 200==f?O(c.logger,"Successfully deleted object "+b):(M(c.logger,"Unexpected response for DELETE: "+f+" "+b),ue(a,l));g(e)})})})};
h.gc=function(){O(this.logger,this+" starting prefetch");var a=new B;Sl(this.storage.a,this.N,"updated.$t",null,!0,1).m(function(b){var c={};if(b=b[0])b=Db(b,"updated","$t"),b=(new Date(1+ +new Date(b))).toISOString(),c["updated-min"]=b;var d=this,c=new Qi(this.Jb(),"GET",c);d.pa().request(c).execute(function(b,c){if(200==c.H()){if(!b){var g=Wj(c);v(g)&&(b=JSON.parse(g))}g=(g=(b.feed||b).entry)?u(g)?g:[g]:[];0<g.length?wq(d,g).V(function(){a.callback(!0)}):a.callback(!1)}else 302==c.H()?a.callback():
(g=d+": Invalid response status "+c.H()+" on prefetching",M(d.logger,g),a.p(Error(g)))})},function(b){a.p(b)},this);return a};function Iq(a){return a.Q?a.l?z()-a.l>a.G:!0:!1}function Jq(a,b,c,d){Iq(a)?a.e?a.e.m(b,c,d):(a.e=a.gc(),a.l=z(),a.e.m(b,c,d),a.e.m(function(a){O(this.logger,"prefetch "+(a?"updated":"no update"));this.e=null},function(a){this.e=null;throw a;},a)):b.call(d,!1)};function Kq(a,b,c){Bq.call(this,a,b,c)}A(Kq,Bq);Kq.prototype.logger=L("ydn.db.sync.Atom");Kq.prototype.xb=function(){return Kq.f.xb.call(this)};Kq.prototype.s=function(a){return a.key};function Lq(a){this.data=a}h=Lq.prototype;h.s=function(){return this.data.id.$t};h.Cd=function(){return this.data.title?this.data.title.$t:void 0};h.Je=function(a){return gq(this.data,a)};h.zj=function(){var a=this.Je("self");return a?a.href:void 0};h.yj=function(){var a=this.Je("http://schemas.google.com/g/2005#batch");return a?a.href:""};h.W=function(){return this.data.content||null};function Mq(a,b,c){tq.call(this,a,b,c)}A(Mq,tq);Mq.prototype.logger=L("ydn.db.sync.entry.S3");Mq.prototype.getName=function(){return this.a.d+this.key};Mq.prototype.xc=function(a,b,c,d){b=Mq.f.xc.call(this,a,b,c,d);if("PUT"==b.method||"POST"==b.method){c=We(new Ge(a)).substr(1);if(1>c.length)throw new zd("invalid url "+a);b.headers.Key=c;a=b.headers["Content-Type"]||"application/json";d instanceof File?a=d.type:v(d)&&(a=/<*DOCTYPE html/i.test(d)?"text/html":"text/plain");b.headers.ContentType=a}return b};function Nq(a){this.data=a}A(Nq,Lq);var Oq={atom:"http://www.w3.org/2005/Atom",ydn:"http://www.yathit.com/2012/ydn",app:"http://www.w3.org/2007/app",openSearch:"http://a9.com/-/spec/opensearch/1.1/",gAcl:"http://schemas.google.com/acl/2007",sites:"http://schemas.google.com/sites/2008",gs:"http://schemas.google.com/spreadsheets/2006",dc:"http://purl.org/dc/terms",batch:"http://schemas.google.com/gdata/batch",gd:"http://schemas.google.com/g/2005",gContact:"http://schemas.google.com/contact/2008",thr:"http://purl.org/syndication/thread/1.0",
xhtml:"http://www.w3.org/1999/xhtml"};function Pq(a,b){for(var c=a.indexOf(" "),d=0;d<b.length;d++){var e=b[d],e=(0==d?"xmlns":"xmlns:"+e)+'="'+Oq[e]+'"';-1==a.indexOf(e)&&(a=a.substring(0,c+1)+e+" "+a.substr(c+1))}return a}L("ydn.xml");function Qq(a){return Oq[a]||Oq.xhtml};function Rq(a,b,c){c=!!c;if(a.getName()!=b.getName())return!1;var d=Sq(a),e=Sq(b);if(!c&&d.length!=e.length||c&&e.length>d.length)return!1;for(d=0;d<e.length;d++)if(a.getAttribute(e[d])!=b.getAttribute(e[d]))return!1;d=Tq(a);e=Tq(b);if(!c&&d.length!=e.length||c&&e.length>d.length)return!1;if(0==d.length||0==d.length)return a.data.$t===b.data.$t;for(d=0;d<e.length;d++){var f=Uq(a,e[d]),g=Uq(b,e[d]);if(!c&&f.length!=g.length||c&&g.length>f.length)return!1;for(var k=0;k<g.length;k++)if(-1==ib(f,function(a){return Rq(a,
g[k],c)}))return!1}return!0};function Vq(a,b,c){if(t(b))Wq(this,b),t(c)||(c=a[b]);else for(var d in a)if(a.hasOwnProperty(d)&&x(a[d])&&v(a[d].xmlns)){this.Gd=[d].xmlns;Wq(this,d);c=a[d];break}this.data=c;this.parent=a}h=Vq.prototype;h.Gd="http://www.w3.org/2005/Atom";function Wq(a,b){var c=b.split(":");1<c.length&&(a.Gd=Qq(c[0])||Vq.prototype.Gd,b=c[1]);a.tagName=b}
h.g=function(a,b){var c;c=a;var d=b,e=c;if(t(d))"atom"!=d&&(e=d+"$"+c);else{var f=c.split(":"),e=c.replace(/:/,"$");2==f.length&&(d=f[0],c=f[1])}d=t(d)?Qq(d):void 0;c=t(this.data[c])&&t(d)&&this.data[c].xmlns==d?c:e;return u(this.data[c])?new Vq(this.data,c,this.data[c][0]):x(this.data[c])?new Vq(this.data,c,this.data[c]):null};h.toString=function(){return"JsonElement:"+this.tagName};h.getName=function(){return this.tagName};
function Xq(a,b){for(var c in a.data)a.data.hasOwnProperty(c)&&x(a.data[c])&&delete a.data[c];a.data.$t=b}h.getAttribute=function(a){a=a.replace(/:/,"$");return this.data[a]};h.setAttribute=function(a,b){a=a.replace(/:/,"$");this.data[a]=b};h.removeAttribute=function(a){a=a.replace(/:/,"$");delete this.data[a]};function Sq(a){var b=[],c;for(c in a.data)a.data.hasOwnProperty(c)&&v(a.data[c])&&"$t"!=c&&b.push(c);return b}
function Uq(a,b){t(void 0)?b="undefined$"+b:t(b)&&(b=b.replace(/:/,"$"));var c=[];if(t(b)){var d=a.data[b];if(u(d))for(var e=0;e<d.length;e++)c.push(new Vq(a.data,b,d[e]));else x(d)&&c.push(new Vq(a.data,b,d))}else for(d in a.data)if(u(a.data[d]))for(e=0;e<a.data[d].length;e++)c.push(new Vq(a.data,d,a.data[d][e]));else x(a.data[d])&&c.push(new Vq(a.data,d,a.data[d]));return c}function Tq(a){var b=[],c;for(c in a.data)x(a.data[c])&&b.push(c.replace("$",":"));return b}
h.appendChild=function(a){var b=a.getName();this.data[b]?(u(this.data[b])||(this.data[b]=[this.data[b]]),this.data[b].push(Am(a.data))):this.data[b]=Am(a.data)};h.removeChild=function(a){if(a.parent!=this.data)throw Error("NOT_FOUND_ERR: JSON:DOM Exception 8: "+a+" not in "+this);var b=a.getName();u(this.data[b])?lb(this.data[b],a.data):delete this.data[b]};
h.update=function(a,b,c,d,e){var f=!1;c=c||{};var g=t(b),k=!0===b||!g,l=!1===b,m=Sq(this),n=Sq(a);if(!g)for(var p=0;p<m.length;p++)t(e)&&!e[m[p].replace("$",":")]||jb(n,m[p])||(this.removeAttribute(m[p]),f=!0);for(p=0;p<n.length;p++){var q=a.getAttribute(n[p]);if(!t(e)||e[n[p].replace("$",":")])jb(m,n[p])?l||q==this.getAttribute(n[p])||(this.setAttribute(n[p],q),f=!0):(this.setAttribute(n[p],q),f=!0)}if(0==Yq(a)&&k&&(e=this.data.$t,l=a.data.$t,t(l)&&e!=l))return Xq(this,l),!0;if(!g)for(var s in this.data)d&&
!d[s.replace("$",":")]||!x(this.data[s])||x(a.data[s])||(delete this.data[s],f=!0);s=Tq(a);for(e=0;e<s.length;e++)if(l=s[e],!d||1==d[l]){var w=Uq(a,l),m=Uq(this,l),y=l.replace(":","$");if(1==w.length)0==m.length?(this.data[y]=Am(w[0].data),f=!0):1==m.length?c[l]?k&&!Rq(m[0],w[0],!0)&&(u(this.data[y])||(this.data[y]=[this.data[y]]),this.data[y].push(Am(w[0].data)),f=!0):f=m[0].update(w[0],b)||f:g?(l=ib(m,function(a){return Rq(a,w[0],!0)}),-1==l&&k&&(this.data[y].push(Am(w[0].data)),f=!0)):(this.data[y]=
Am(w[0].data),f=!0);else if(!u(this.data[y]))if(k)this.data[y]=Am(a.data[y]),f=!0;else{if(g){var m=Am(a.data[y]),G=this,l=ib(m,function(a){return hm(G.data[y],a)});-1==l&&(m.push(this.data[y]),this.data[y]=m,f=!0)}}else if(k)for(m.length>w.length&&(this.data[y].splice(w.length,m.length-w.length),f=!0),p=0;p<w.length;p++)t(m[p])?hm(m[p].data,w[p].data)||(this.data[y][p]=Am(w[p].data),f=!0):(this.data[y][p]=Am(w[p].data),f=!0);else if(g)for(p=0;p<a.data[y].length;p++)l=ib(this.data[y],function(b){return hm(a.data[y][p],
b)}),-1==l&&(this.data[y].push(Am(a.data[y][p])),f=!0)}return f};h.Wf=function(a,b,c,d,e){t(b)||(b=!1);return this.update(a,b,c,d,e)};h.toJSON=function(){return{data:this.data,tagName:this.tagName}};
function Zq(a){function b(a,g){d(g,a);var k,l;for(l in a)if(a.hasOwnProperty(l)&&!v(a[l]))if(v(a[l].$t)&&"xhtml"==a[l].type){k=c(l);d(k,a[l]);var m=ui(a[l].$t);e.importNode(m.documentElement,!0);k.appendChild(m.documentElement);g.appendChild(k)}else if(v(a[l].$t))k=c(l),k.textContent=a[l].$t,d(k,a[l]),g.appendChild(k);else if(u(a[l])&&a[l][0]&&v(a[l][0].$t))for(m=0;m<a[l].length;m++)k=c(l),k.textContent=a[l][m].$t,d(k,a[l][m]),g.appendChild(k);else if(u(a[l]))for(m=0;m<a[l].length;m++)k=c(l),g.appendChild(k),
b(a[l][m],k);else x(a[l])&&(k=c(l),g.appendChild(k),b(a[l],k))}function c(a){return e.createElement(a.replace("$",":"))}function d(a,b){for(var c in b)b.hasOwnProperty(c)&&"$t"!=c&&v(b[c])&&a.setAttribute(c.replace("$",":"),b[c])}var e=si(a.getName(),a.Gd);b(a.data,e.documentElement);return vi(e.documentElement)}
function Yq(a){function b(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&(u(a[c])?b+=a[c].length:x(a[c])&&b++);return b}var c;t(void 0)?c="undefined$"+c:t(c)&&(c=c.replace(/:/,"$"));return t(c)?u(a.data[c])?a.data[c].length:x(a.data[c])?b(a.data[c]):0:b(a.data)}h.clone=function(a){var b={};if(t(a))for(var c in this.data){var d=c.replace("$",":");v(this.data[c])?b[c]=this.data[c]:1==a[d]&&(b[c]=Am(this.data[c]))}else b=Am(this.data);return new Vq(null,this.tagName,b)};
function $q(a,b){var c=b.ownerDocument.createElementNS(a.Gd,a.getName()),d;for(d in a.data)if(a.data.hasOwnProperty(d)){var e=d.replace("$",":");if(v(a.data[d]))"$t"==d?c.textContent=a.data[d]:(e=c.ownerDocument.createAttribute(e),e.nodeValue=a.data[d],c.setAttributeNode(e));else if(u(a.data[d]))for(var f=0;f<a.data[d].length;f++){var g=new Vq(a.data[d],e,a.data[d][f]);$q(g,c)}else x(a.data[d])&&(g=new Vq(a.data,e,a.data[d]),$q(g,c))}return b.appendChild(c)};function ar(a){var b;if(t(a.id))b=a.id.$t;else if(t(a.batch$id))b=a.batch$id.$t;else if(t(a.a))b=a.a.$t;else throw new wi("id or batch:id required.");this.id=b;this.b=void 0;this.data=a}A(ar,Nq);h=ar.prototype;h.logger=L("ydn.gdata.Entry");h.Se=function(){return this.kind};h.getData=function(){return this.data};h.Cd=Lq.prototype.Cd;h.s=function(){return this.id};function br(a){return a.id.match(/\w+$/)[0]}h.Ic=["link","category"];h.hh=["id","batch$id","link","category"];h.W=Lq.prototype.W;
function cr(a,b){if(b)a.getData().status=""==b?void 0:b;else{var c=a.getData();c.status&&(c.status=b)}}function dr(a){return t(a.gd$deleted)?"gd:deleted":(a=a.status)?a:""}function er(a){return"gd:deleted"==dr(a.getData())}h.setTitle=function(){throw new yi;};
h.Ng=function(){if(!fr(this.getData()))throw Error("nothing to commit");var a=new B;gr(this,function(b,c){if(Ti(c))a.callback(b);else{var d=Wj(c);if(v(d)&&/html/.test(Xj(c,"content-type")))try{var e=(new DOMParser).parseFromString(d,"text/html");e.body&&(d=e.body.innerHTML)}catch(f){}a.p(c.H()+" "+c.Da()+" "+d)}},this);return a};
function gr(a,b,c){var d=Oi("gse");if(fr(a.getData())){var e={"Content-Type":"application/atom+xml"};a.a&&(e["GData-Version"]=a.a);var f={},g="POST",k,l,m;m="full";t(l)||(l="base"!=m);var n=a.kind||"contact";k=k?"/"+k:"";k=(l?"https":"http")+"://www.google.com/m8/feeds/"+n+"s/"+a.user_id.replace("@","%40")+"/"+m+k;k=k.replace("%40","@");if(l=(l=a.Je("edit"))?l.href:void 0)g="delete"==dr(a.getData())?"DELETE":"PUT",k=l;try{var p=hr(a)}catch(q){Lj({"class":"ydn.gdata.Entry",method:"ydn.gdata.Entry.commit",
"entry.data":a.getData(),context:"toXmlString",error:{name:q.name,message:q.message,stack:q.stack}})}l=a.type;m=["atom","app","gd","batch","ydn"];if("sites"==l||"site"==l||"content"==l||"webpage"==l)m=m.concat("xhtml","sites");else if("m8"==l||"contact"==l)m=m.concat("gContact");p=Pq(p,m);ar.a&&(a.b=[k,f,g,e,p]);d.request(new Qi(k,g,f,e,p)).execute(b,c)}else K(a.logger,a+" commit ignore since not modified."),b&&b.call(c,null,null)}
function fr(a){if(null==a.id)return!0;a=dr(a);return"modified"===a||"delete"===a}h.rf=function(){return this.data};function hr(a){var b=new Vq(null,"entry",a.rf()),c=!1;b.xmlns||(b.xmlns="http://www.w3.org/2005/Atom",c=!0);var d=["atom"],e;for(e in a.data)if(a=e.match(/^(\w+)\$\w+/))a=a[1],a in Oq&&(jb(d,a)||d.push(a));e=Zq(b);c&&delete b.xmlns;return Pq(e,d)}
h.update=function(a){var b=["batch$status","batch$operation","status"],c;for(c in a.data)a.data.hasOwnProperty(c)&&x(a.data[c])&&!jb(b,c)&&!jb(this.hh,c)&&(this.data[c]=a.data[c])};h.Xf=function(a,b){if(hm(this.data[a],b))return!1;this.data[a]=Am(b);return!0};
h.Wf=function(a){if(a.data.updated.$t>=this.data.updated.$t&&er(a)){if(er(this)||"delete"==dr(this.getData()))return!1;cr(this,"delete");return!0}var b=!1,c;for(c in a.data)a.data.hasOwnProperty(c)&&x(a.data[c])&&!jb(this.hh,c)&&this.Xf(c,a.data[c])&&(b=!0);b&&(a=dr(this.getData()),"delete"==a?ie(this.logger,this+" marked for deletion. Cannot mark modify flag."):"committed"==a?this.logger.log(Yd,this+" already committed. All changes must wait until updated from the server.",void 0):cr(this,"modified"));
return b};function ir(a,b,c){tq.call(this,a,b,c)}A(ir,tq);ir.prototype.Re=function(){return this.key};ir.prototype.xc=function(a,b,c,d){a=ir.f.xc.call(this,a,b,c,d);this.a.Mh(a.method)&&r.gapi&&r.gapi.auth&&(b=gapi.auth.getToken())&&b.access_token&&(a.headers.Authorization=b.token_type+" "+b.access_token);if("GET"==a.method)a.params.alt="json";else if("PUT"==a.method||"POST"==a.method)d=new ar(d),a.body=hr(d),a.headers["Content-Type"]="application/atom+xml";return a};
ir.prototype.sf=function(a,b){a=ir.f.sf.call(this,a,b);a.feed&&(a=a.feed);a.entry&&(a=a.entry);return a};function jr(a,b,c){Bq.call(this,a,b,c);a=c.Options;this.kind=a.kind;this.version=a.version;this.projection=a.projection;this.c=a.maxResults}A(jr,Kq);h=jr.prototype;h.projection=null;h.version=null;h.logger=L("ydn.db.sync.GData");h.va=function(a,b){return new ir(this,a,b)};h.wb=function(){var a=jr.f.wb.call(this);a.key=["id","$t"];a.etag="gd$etag";a.updated=["updated","$t"];return a};h.xb=function(){var a=jr.f.xb.call(this);return a=a.concat(["version","projection","kind","maxResults"])};
h.Jb=function(){return"https://www.googleapis.com/"+this.kind+"/"};h.Mh=function(){return!1};h.s=function(a){return a?a.id?a.id.$t:"":""};
function kr(a,b,c){var d=c||a.Jb();c&&O(a.logger,"continuing "+c);b=new Qi(d,"GET",b);var e=new B;a.pa().request(b).execute(function(b,d){if(200==d.H()){if(!b){var k=Wj(d);v(k)&&(b=JSON.parse(k))}var k=b.feed||b,l=k.entry,l=l?u(l)?l:[l]:[];0<l.length&&wq(a,l);for(var l=null,k=k.link,k=u(k)?k:[k],m=0;m<k.length;m++)"next"==k[m].rel&&(l=k[m].href);l?nc(kr(a,{},l),e):(O(a.logger,"prefetch "+a.N+" done"),e.callback(!!c))}else 302==d.H()?e.callback():(k=a+": Invalid response status "+d.H()+" on prefetching",
M(a.logger,k),e.p(Error(k)))});return e}h.gc=function(){O(this.logger,"starting prefetch");var a=new B;Sl(this.storage.a,this.N,"updated.$t",null,!0,1).n(function(b){var c={alt:"json",kind:this.kind};this.c&&(c["max-results"]=this.c);(b=b[0])?(b=Db(b,"updated","$t"),b=(new Date(1+ +new Date(b))).toISOString(),c["updated-min"]=b,O(this.logger,this.N+" fetching entries later then "+b)):O(this.logger,this.N+" fetching entries from beginning");nc(kr(this,c),a)},this);return a};
h.count=function(a){var b=om(this.store,"updated.$t");if(!b)return a;var c=uk(a);a.m(function(a){ue(c,a);Sl(this.storage.a,this.N,b.getName(),null,!1,1).m(function(b){var f={alt:"json"};if(b=u(b)?b[0]:b)b=Db(b,"updated","$t"),b=(new Date(1+ +new Date(b))).toISOString(),f["updated-min"]=b;var g=this,f=new Qi(this.Jb(),"GET",f);this.pa().request(f).execute(function(b,e){if(200==e.H()){if(!b){var f=Wj(e);v(f)&&(b=JSON.parse(f))}f=Db(b.feed,"openSearch$totalResults");c.callback(a+parseFloat(f||0))}else M(g.logger,
g+":Unexpected respond status "+e.H())})},function(a){c.p(a)},this)},function(a){c.p(a)},this);return c};function lr(a,b,c){tq.call(this,a,b,c)}A(lr,ir);function mr(a,b,c){jr.call(this,a,b,c);this.b=this.b.substr(27);this.Wb=c.Options.prefix}A(mr,jr);mr.prototype.pa=function(){this.a||(this.a=new nr(gapi.client));return this.a};mr.prototype.va=function(a,b){return new lr(this,a,b)};mr.prototype.Jb=function(){return this.b+this.Wb};
mr.prototype.gc=function(){O(this.logger,"starting prefetch");var a=new B;Sl(this.storage.a,this.N,"updated",null,!0,1).m(function(b){var c={alt:"json"};if(b=b[0])b=Db(b,"updated"),b=(new Date(1+ +new Date(b))).toISOString(),c.updatedMin=b;var d=this,c=new Qi(this.Jb(),"GET",c);d.pa().request(c).execute(function(b,c){if(b){var g=b.items||[];0<g.length?wq(d,g).V(function(){a.callback(!0)}):a.callback(!1)}else 302==c.H()?a.callback():(g=d+": Invalid response status "+c.H()+" on prefetching",M(d.logger,
g),a.p(Error(g)))})},function(b){a.p(b)},this);return a};function or(a,b){if(!t(r.AWS))throw new zd("AWS JS SDK not loaded");this.b=a;this.region=b;this.a=null}or.prototype.request=function(a){return new pr(this,a)};function qr(a){var b={params:{Bucket:a.b,region:a.region}};if(!a.b)throw new I("bucket name required");a.a||(a.a=new AWS.S3(b));return a.a}function pr(a,b){this.parent=a;this.a=b}
function rr(a,b,c,d,e){var f=NaN,g="",k={};a=qr(a.parent)[b](c);a.on("complete",function(a){a.httpResponse&&(f=a.httpResponse.statusCode,v(f)&&(f=parseInt(f,10)),k=a.httpResponse.headers);a.error&&(g=a.error.message,f||(f=400))});a.send(function(a,b){var c=new Uj(f,b,k,g);a?d.call(e,null,c):d.call(e,b,c)})}
pr.prototype.execute=function(a,b){var c=We(new Ge(this.a.path)),c="/"==c.charAt(0)?c.substr(1):c,d=this.a.headers||{};c&&(d.Key=c);if(c)if("GET"==this.a.method)rr(this,"getObject",d,a,b);else if("PUT"==this.a.method)rr(this,"putObject",d,a,b);else throw new xd("HTTP method "+this.a.method);};function sr(a,b){this.a=a;this.prefix=tr(this,"Prefix")[0];this.b=b.type}sr.prototype.da=function(){return this.a.documentElement.getElementsByTagName("Contents").length};sr.prototype.keys=function(){var a=tr(this,"Key");if(this.prefix){var b=this.prefix.length,a=a.map(function(a){return a.substr(b)});"INTEGER"==this.b?a=a.map(function(a){return parseInt(a,10)}):"NUMERIC"==this.b&&(a=a.map(function(a){return parseFloat(a)}))}return a};
function tr(a,b){for(var c=[],d=a.a.documentElement.getElementsByTagName(b),e=d.length,f=0;f<e;f++)c[f]=d[f].textContent;return c}function ur(a){return tr(a,"LastModified").map(function(a){return(new Date(Date.parse(a))).toGMTString()})}
function vr(a){var b=a.a.documentElement.getElementsByTagName("NextMarker");return 1==b.length?b[0].textContent:"true"==a.a.documentElement.getElementsByTagName("IsTruncated")[0].textContent&&(a=a.a.documentElement.firstElementChild.lastElementChild)&&"Contents"==a.tagName?a.getElementsByTagName("Key")[0]:null};function wr(a,b,c){Bq.call(this,a,b,c);this.c=c.Options.bucket;if(!v(this.c)||ya(this.c))throw new I("bucket name required.");this.b||(this.b="https://"+this.c+".s3.amazonaws.com/");if(!0===b.autoIncrement)throw new I('S3 object store "'+b.getName()+'" must not set autoIncrement to true.');}A(wr,Bq);h=wr.prototype;h.logger=L("ydn.db.sync.S3");h.xb=function(){var a=wr.f.xb.call(this);return a=a.concat(["bucket","maxKeys","prefix","delimiter"])};h.pa=function(){this.a||(this.a=new or(this.c));return this.a};
h.Nf=function(a){return this.b+this.d+a};h.va=function(a,b){return new Mq(this,a,b)};
h.Uf=function(a,b){var c=this;xk(a,function(d,e,f){ue(a,d);c.te(d,function(a){var e={},l=a[0]?oq(a[0]):null;null!=l&&(e.marker=l);0<c.d.length&&(e.prefix=c.d);0<b&&(e["max-keys"]=b);O(c.logger,c+" querying for newer entries starting from "+l);e=new Qi(c.b,"GET",e);c.pa().request(e).execute(function(b,e){if(200==e.H()){for(var k=Wj(e),k=k instanceof Document?k:ui(k),l=new sr(k,c.store),k=l.keys(),l=ur(l),s=[],w=[],y=[],G=0,H=0;G<=a.length&&H<k.length;){var J=a[G]?oq(a[G]):null,Z=k[H];if(G==a.length)w.push(Z),
H++;else{var Ua=J?Ak(J,Z):-1;0==Ua?((Z=pq(a[G]))&&l[H]&&Z!=l[H]&&(l[H]>Z?y.push(J):M(c.logger,'record "'+J+'" in database is more recent than server '+Z+" vs "+l[H])),G++,H++):1==Ua?(s.push(J),G++):(w.push(Z),H++)}}Gq(c,f,d,w,y,s)}else M(c.logger,"Invalid response status "+e.H())})})},this)};
function xr(a,b){function c(f){null!=f&&(d.marker=f);O(a.logger,a+" querying for newer entries starting from "+f);e.request(new Qi(a.b,"GET",d)).execute(function(d,e){if(200==e.H()){var f=Wj(e),f=f instanceof Document?f:ui(f),f=new sr(f,a.store),m=vr(f),f=f.keys(),n=f.length;if(0==n)b([]),b=null;else for(var p=0,q=0;q<n;q++)a.va(f[q]).Ac(function(){p++;p==n&&(m?c(m):b&&(b([this.Ab()]),b=null))})}else M(a.logger,"Invalid response status "+e.H())})}var d={};0<a.d.length&&(d.prefix=a.d);var e=a.pa();
c();a.F=!0}function yr(a,b){a.F||xk(b,function(a,b,e){t(a[0])?e(a):xr(this,e)},a)};function zr(a,b,c){tq.call(this,a,b,c)}A(zr,Mq);zr.prototype.logger=L("ydn.db.sync.entry.Gcs");function Ar(a,b,c){wr.call(this,a,b,c);this.b="https://"+this.c+".storage.googleapis.com/"}A(Ar,wr);Ar.prototype.logger=L("ydn.db.sync.Gcs");Ar.prototype.pa=function(){this.a||(this.a=new Ap);return this.a};Ar.prototype.va=function(a,b){return new zr(this,a,b)};function nr(a,b){this.b=a;this.a=!!b}nr.prototype.request=function(a){var b={path:a.path,method:a.method,headers:a.headers,params:a.params,body:a.body};this.a&&(b.callback=function(a,e){c.callback(a,e);b.callback=null});a=this.b.request(b);var c=new Br(a);return c};function Br(a){this.b=a||null}Br.prototype.callback=function(a,b){this.c&&(this.c(a,Zj(b)),this.c=null);this.a={json:a,raw:b}};
Br.prototype.execute=function(a){this.b?(this.b.execute(function(b,c){a(b,Zj(c))}),this.b=null):this.a?(a(this.a.json,Zj(this.a.raw)),this.a=null):this.c=a};function Cq(a){if(a){if(a instanceof Ap)return a;if(ia(a))return new nr({request:function(b){a(b)}},!0);if("request"in a)return new nr(a);throw new I(a+" is not a valid HTTP Client");}return null};function Cr(a,b,c){tq.call(this,a,b,c)}A(Cr,zr);Cr.prototype.logger=L("ydn.db.sync.entry.GcsJson");Cr.prototype.Ac=function(a){var b=this.a,c=this;xq(this,function(d){var e={method:"GET",path:"storage/v1/b/"+b.c+"/o/"+encodeURIComponent(c.getName())};d&&(e.headers=rq(d));gapi.client.request(e).execute(function(d,e){var k=Zj(e);c.d=new sq(c.s(),k.Nc(),b.h);d?(O(c.logger,c+": readServer updated"),c.c=d):(O(c.logger,c+": readServer request fail "+e),c.d=null,c.c=null);a.call(c,200)},e)})};function Dr(a,b,c){Ar.call(this,a,b,c)}A(Dr,Ar);h=Dr.prototype;h.logger=L("ydn.db.sync.GcsJson");h.wb=function(){var a=Dr.f.wb.call(this);a.key="name";return a};h.pa=function(){if(!this.a)if(t(r.gapi))this.a=new nr(gapi.client);else throw new zd("gapi not loaded");return Dr.f.pa.call(this)};h.va=function(a,b){return new Cr(this,a,b)};
h.gc=function(){Q(this.logger,"starting prefetch");var a=new B;Ul(this.storage.a,this.N,null,null,1,0,!0,!1).m(function(b){var c={bucket:this.c};(b=b[0])&&(c.marker=b);var d=this;if(!r.gapi||r.gapi.client)throw Error("gapi lib not loaded");gapi.client.load("storage","v1",function(){var b=gapi.client.storage.objects.list({bucket:d.c});this.Wb&&(c.prefix=this.Wb);b.execute(function(b,c){if(b&&!b.error){var e=b.items||[];0<e.length?wq(d,null,e).V(function(){a.callback(!0)}):a.callback(!1)}else e=d+": "+
c,M(d.logger,e),a.p(Error(e))})})},function(b){a.p(b)},this);return a};function Er(a,b,c){Ar.call(this,a,b,c);this.Q="full"}A(Er,Ar);h=Er.prototype;h.logger=L("ydn.db.sync.GcsMeta");h.wb=function(){var a=Er.f.wb.call(this);a.key="name";return a};h.pa=function(){!this.a&&gapi&&(this.a=new nr(gapi.client));return Er.f.pa.call(this)};h.va=function(a,b){return new Cr(this,a,b)};
h.gc=function(){Q(this.logger,"starting prefetch");var a=new B;if(!r.gapi||!r.gapi.client)throw Error("gapi lib not loaded");var b=this;gapi.client.load("storage","v1",function(){function c(e){e&&(d.pageToken=e);gapi.client.storage.objects.list(d).execute(function(e,g){if(e&&!e.error){var k=e.items||[];if(e.nextPageToken)O(b.logger,"receiving "+k.length+" meta records, continuing next"),wq(b,k),c(e.nextPageToken);else if(0<k.length)wq(b,k).V(function(){O(b.logger,"receiving "+k.length+" meta records, prefetching dane.");
a.callback(!0)});else{var l=!!d.pageToken;O(b.logger,"prefetching done");a.callback(l)}}else l=b+": "+g,M(b.logger,l),a.p(Error(l))})}var d={bucket:b.c};this.Wb&&(d.prefix=this.Wb);c()});return a};h.te=function(a,b){if(0==a.length)b([]);else{var c=this.D(),d=db(a,function(a){return new Ck(c,a)});Fq(this,d).m(function(d){for(var f=[],g=0;g<a.length;g++)f[g]=new nq(a[g],d[g],this.h,c);b(f)},function(a){M(this.logger,this+" error loading meta data "+a);b([])},this)}};function Fr(a,b,c){Bq.call(this,a,b,c)}A(Fr,Bq);Fr.prototype.Nf=function(a){return this.b+this.d+this.N+this.T+a};Fr.prototype.logger=L("ydn.db.sync.Json");
Fr.prototype.Uf=function(a){function b(a,b){var c=new Qi(e);d.pa().request(c).execute(function(c){if(200==c.status){var e=(c.response instanceof Object?c.response:Ch(c.responseText)).items;c=db(e,function(a){return a.id});for(var e=db(e,function(a){return a.updated}),k=[],p=[],q=[],s=0,w=0;s<=a.length&&w<c.length;){var y=oq(a[s]),G=c[w];if(s==a.length)p.push(G),w++;else{var H=Ak(y,G);0==H?((G=pq(a[s]))&&e[w]&&G!=e[w]&&(new Date(e[w])>G?q.push(y):M(d.logger,'record "'+y+'" in database is more recent than server '+
G+" vs "+e[w])),s++,w++):1==H?(k.push(y),s++):(p.push(G),w++)}}Gq(d,function(){},b,p,q,k)}else M(d.logger,"Invalid response status "+c.status)})}var c=new se,d=this,e=this.b+this.d+this.N;a.n(function(a){ue(c,a);this.te(a,function(c){b(c,a)})},this)};function Gr(a,b,c){Bq.call(this,a,b,c)}A(Gr,Kq);function Hr(a,b,c){tq.call(this,a,b,c)}A(Hr,Mq);Hr.prototype.logger=L("ydn.db.sync.entry.S3Meta");function Ir(a,b,c){wr.call(this,a,b,c);this.Wb=c.Options.prefix;if("Key"!=b.keyPath)throw new I('s3-meta store "'+b.getName()+'" must use inline key with keyPath "Key"');this.Q="meta"}A(Ir,wr);h=Ir.prototype;h.logger=L("ydn.db.sync.S3Meta");h.wb=function(){var a=Ir.f.wb.call(this);a.key="Key";a.modified="LastModified";a.etag="ETag";return a};h.va=function(a,b){return new Hr(this,a,b)};
h.gc=function(){function a(f){f&&(e.marker=f);c.listObjects(e).send(function(c,f){if(c){var l=d+": "+Dh(c);M(d.logger,l);b.p(c instanceof Error?c:Error(l))}else{var m=f.Contents||[];f.IsTruncated?(O(d.logger,"receiving "+m.length+" meta records, continuing next"),wq(d,m),a(m[m.length-1].Key+"\uffff")):0<m.length?wq(d,m).V(function(){O(d.logger,"receiving "+m.length+" meta records, prefetching dane.");b.callback(!0)}):(l=!!e.marker,O(d.logger,"prefetching done"),b.callback(l))}})}Q(this.logger,"starting prefetch");
var b=new B,c=qr(this.pa()),d=this,e={};this.Wb&&(e.prefix=this.Wb);a();return b};h.te=function(){throw new zd("loading meta data should not be necessary");};function Jr(a,b,c){tq.call(this,a,b,c)}A(Jr,ir);function Kr(a,b,c){jr.call(this,a,b,c);a=c.Options;this.domain=a.domain;this.F=a.siteName;if(a=Bl(b,"sites$parent"))im(a,function(a){for(var b=a.link||[],c=0;c<b.length;c++)if("http://schemas.google.com/sites/2008#parent"==b[c].rel)return b[c].href;return a.id.$t.replace(/\w+$/,"0")}),re(this.logger,"index sites$parent in "+b.getName()+" has set a generator.");if(a=Bl(b,"alternate"))im(a,function(a){a=a.link||[];for(var b=0;b<a.length;b++)if("alternate"==a[b].rel)return a[b].href}),re(this.logger,
"index alternate in "+b.getName()+" has set a generator.")}A(Kr,jr);h=Kr.prototype;h.va=function(a,b){return new Jr(this,a,b)};h.xb=function(){var a=Kr.f.xb.call(this);return a=a.concat(["domain","siteName"])};h.Jb=function(){return"https://sites.google.com/feeds/content/"+this.domain+"/"+this.F+"/"};h.Mh=function(a){return"GET"!=a};
function Lr(a,b,c,d){var e={alt:"json",kind:a.kind};"sites$parent"==c?(c=d.match(/\w+$/)[0],e.parent=c):"alternate"==c&&(c=d.replace(/https:\/\/sites.google.com\/a\/[^\/]+\/[^\/]+/,""),e.path=c);var f={},g=a.Jb();xk(b,function(c,l,m){ue(b,c);if(l=c[0])l=Db(l,"updated","$t"),l=(new Date(1+ +new Date(l))).toISOString(),e["updated-min"]=l;l=new Qi(g,"GET",e,f);a.pa().request(l).execute(function(b,e){if(200==e.H()){if(!b){var f=Wj(e);v(f)&&(b=JSON.parse(f))}var g=(f=(b.feed||b).entry)?u(f)?f:[f]:[];0<
g.length?wq(a,g).V(function(){m(g)}):m(c)}else 302==e.H()?m(c):(f=a+": Invalid response status "+e.H()+" for querying pageName: "+d,M(a.logger,f),m(Error(f),!0))})},a)}h.qf=function(a,b,c){if(Iq(this))xk(a,function(d,e,f){ue(a,d);Jq(this,function(a){!0===a?Sl(this.storage.a,this.N,b,U.only(c),!1,0).m(function(a){f(a)},function(a){f(a,!0)},this):f(d)},function(a){f(a,!0)},this)},this);else return"alternate"==b||"alternate"==b?Lr(this,a,b,c):Kr.f.qf.call(this,a,b,c)};rl.prototype.a=null;
Qm.prototype.Gg=function(a,b){var c=b.format;if("gdata-sites"==c)a.a=new Kr(this,a,b);else if("gdata"==c)a.a=new jr(this,a,b);else if("gdata-json"==c)a.a=new mr(this,a,b);else if("odata"==c)a.a=new Gr(this,a,b);else if("s3"==c)a.a=new wr(this,a,b);else if("s3-meta"==c)a.a=new Ir(this,a,b);else if("gcs"==c)a.a=new Ar(this,a,b);else if("gcs-json"==c)a.a=new Dr(this,a,b);else if("gcs-meta"==c)a.a=new Er(this,a,b);else if("atom"==c)a.a=new Kq(this,a,b);else if("json"==c)a.a=new Fr(this,a,b);else if("rest"==
c)a.a=new Bq(this,a,b);else throw new xd("Sync format: "+c);sm(a,function(b,c){var f=b.de();if(!(this instanceof pl)||this.Na)if(!window.navigator||!t(window.navigator.onLine)||window.navigator.onLine)if("add"==f)f=c[1],a.a.add(b,f);else if("count"==f)c[1]||c[2]||a.a.count(b);else if("put"==f){var f=c[1],g=c[2];a.a.put(b,f,g)}else if("rm:iter"==f)g=c[1],a.a.remove(b,g);else if("values:iter:index"==f){var f=c[1],g=c[2],k=c[3],l=c[4],m=c[5];!k&&!m&&g&&null!=g.lower&&null!=g.upper&&0==Ak(g.lower,g.upper)&&
a.a.qf(b,f,g.lower)}else if("keys"==f)g=c[1],l=c[2],k=c[3],m=c[4],a.a.keys(b,null,g,l,k,m,!1);else if("keys:iter:index"==f)f=c[1],g=c[2],l=c[3],k=c[4],m=c[5],a.a.keys(b,f,g,l,k,m,c[6]);else if("values"==f)g=c[1],l=c[2],k=c[3],m=c[4],g||m?g&&g.lower&&v(g.lower)&&g.lower==g.upper||!g&&m&&1==l&&k&&yr(a.a,b):a.a.$(b,l,k);else if(""!=f)if("get"==f)g=c[1],a.a.get(b,g);else if("values:array"==f)Hq(a.a,b,c[1]);else throw Error(f);})};var Mr="Accounts Calls Campaigns Contacts Documents Meetings Emails EmailTemplates Employees Leads Notes Opportunities Tasks Teams TeamSets Users".split(" "),Nr="Accounts Contacts EmailTemplates Leads Notes Tasks Meetings Calls Opportunities Emails".split(" "),Or=["Accounts","Contacts","Leads"],Pr=["Contacts","Leads","Accounts"],Qr=["Meetings","Calls","Tasks","Opportunities"];function Rr(a){a=Mr.indexOf(a);return Mr[a]};function Sr(a){this.b=a||[]}Sr.prototype.a=function(a){return-1==this.b.indexOf(a)?a:null};function Tr(){}
Tr.prototype.a=function(a){var b={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},c={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""};a=a.toLowerCase();var d,e,f=a;if(3>a.length)return a;var g,k;a=a.substr(0,1);"y"==a&&(f=a.toUpperCase()+f.substr(1));g=/^(.+?)(ss|i)es$/;e=/^(.+?)([^s])s$/;
g.test(f)?f=f.replace(g,"$1$2"):e.test(f)&&(f=f.replace(e,"$1$2"));g=/^(.+?)eed$/;e=/^(.+?)(ed|ing)$/;g.test(f)?(e=g.exec(f),g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(e[1])&&(g=/.$/,f=f.replace(g,""))):e.test(f)&&(e=e.exec(f),d=e[1],e=/^([^aeiou][^aeiouy]*)?[aeiouy]/,e.test(d)&&(f=d,e=/(at|bl|iz)$/,k=/([^aeiouylsz])\1$/,d=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,e.test(f)?f+="e":k.test(f)?(g=/.$/,f=f.replace(g,"")):d.test(f)&&(f+="e")));g=/^(.+?)y$/;g.test(f)&&(e=g.exec(f),
d=e[1],g=/^([^aeiou][^aeiouy]*)?[aeiouy]/,g.test(d)&&(f=d+"i"));g=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/;g.test(f)&&(e=g.exec(f),d=e[1],e=e[2],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(d)&&(f=d+b[e]));g=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/;g.test(f)&&(e=g.exec(f),d=e[1],e=e[2],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(d)&&(f=d+c[e]));g=
/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/;e=/^(.+?)(s|t)(ion)$/;g.test(f)?(e=g.exec(f),d=e[1],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(d)&&(f=d)):e.test(f)&&(e=e.exec(f),d=e[1]+e[2],e=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,e.test(d)&&(f=d));g=/^(.+?)e$/;g.test(f)&&(e=g.exec(f),d=e[1],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,
e=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*([aeiouy][aeiou]*)?$/,k=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,g.test(d)||e.test(d)&&!k.test(d))&&(f=d);g=/ll$/;e=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/;g.test(f)&&e.test(f)&&(g=/.$/,f=f.replace(g,""));"y"==a&&(f=a.toLowerCase()+f.substr(1));return f};function Ur(a){this.b=a}
Ur.prototype.a=function(a){a=a.toLowerCase();a=a.replace(/([^c])\1/g,"$1");a=function(a){return a.match(/^(kn|gn|pn|ae|wr)/)?a.substr(1,a.length-1):a}(a);a=a.replace(/mb$/,"m");a=a.replace(/ck/g,"k");a=function(a){a=a.replace(/([^s]|^)(c)(h)/g,"$1x$3").trim();a=a.replace(/cia/g,"xia");a=a.replace(/c(i|e|y)/g,"s$1");return a=a.replace(/c/g,"k")}(a);a=function(a){a=a.replace(/d(ge|gy|gi)/g,"j$1");return a=a.replace(/d/g,"t")}(a);a=function(a){a=a.replace(/gh(^$|[^aeiou])/g,"h$1");return a=a.replace(/g(n|ned)$/g,
"$1")}(a);a=function(a){a=a.replace(/([^g]|^)(g)(i|e|y)/g,"$1j$3");a=a.replace(/gg/g,"g");return a=a.replace(/g/g,"k")}(a);a=a.replace(/([aeiou])h([^aeiou])/g,"$1$2");a=a.replace(/ph/g,"f");a=a.replace(/q/g,"k");a=a.replace(/s(h|io|ia)/g,"x$1");a=function(a){a=a.replace(/^x/,"s");return a=a.replace(/x/g,"ks")}(a);a=function(a){a=a.replace(/t(ia|io)/g,"x$1");return a=a.replace(/th/,"0")}(a);a=a.replace(/tch/g,"ch");a=a.replace(/v/g,"f");a=a.replace(/^wh/,"w");a=a.replace(/w([^aeiou]|$)/g,"$1");a=a.replace(/y([^aeiou]|$)/g,
"$1");a=a.replace(/z/,"s");a=a.charAt(0)+a.substr(1,a.length).replace(/[aeiou]/g,"");a.length>=this.b&&(a=a.substring(0,this.b));return a=a.toUpperCase()};var Vr=new Ur(32),Wr=new Tr,Xr=new Sr("a a's able about above according accordingly across actually after afterwards again against ain't all allow allows almost alone along already also although always am among amongst an and another any anybody anyhow anyone anything anyway anyways anywhere apart appear appreciate appropriate are aren't around as aside ask asking associated at available away awfully b be became because become becomes becoming been before beforehand behind being believe below beside besides best better between beyond both brief but by c c'mon c's came can can't cannot cant cause causes certain certainly changes clearly co com come comes concerning consequently consider considering contain containing contains corresponding could couldn't course currently d definitely described despite did didn't different do does doesn't doing don't done down downwards during e each edu eg eight either else elsewhere enough entirely especially et etc even ever every everybody everyone everything everywhere ex exactly example except f far few fifth first five followed following follows for former formerly forth four from further furthermore g get gets getting given gives go goes going gone got gotten greetings h had hadn't happens hardly has hasn't have haven't having he he's hello help hence her here here's hereafter hereby herein hereupon hers herself hi him himself his hither hopefully how howbeit however i i'd i'll i'm i've ie if ignored immediate in inasmuch inc indeed indicate indicated indicates inner insofar instead into inward is isn't it it'd it'll it's its itself j just k keep keeps kept know knows known l last lately later latter latterly least less lest let let's like liked likely little look looking looks ltd m mainly many may maybe me mean meanwhile merely might more moreover most mostly much must my myself n name namely nd near nearly necessary need needs neither never nevertheless new next nine no nobody non none noone nor normally not nothing novel now nowhere o obviously of off often oh ok okay old on once one ones only onto or other others otherwise ought our ours ourselves out outside over overall own p particular particularly per perhaps placed please plus possible presumably probably provides q que quite qv r rather rd re really reasonably regarding regardless regards relatively respectively right s said same saw say saying says second secondly see seeing seem seemed seeming seems seen self selves sensible sent serious seriously seven several shall she should shouldn't since six so some somebody somehow someone something sometime sometimes somewhat somewhere soon sorry specified specify specifying still sub such sup sure t t's take taken tell tends th than thank thanks thanx that that's thats the their theirs them themselves then thence there there's thereafter thereby therefore therein theres thereupon these they they'd they'll they're they've think third this thorough thoroughly those though three through throughout thru thus to together too took toward towards tried tries truly try trying twice two u un under unfortunately unless unlikely until unto up upon us use used useful uses using usually uucp v value various very via viz vs w want wants was wasn't way we we'd we'll we're we've welcome well went were weren't what what's whatever when whence whenever where where's whereafter whereas whereby wherein whereupon wherever whether which while whither who who's whoever whole whom whose why will willing wish with within without won't wonder would wouldn't x y yes yet you you'd you'll you're you've your yours yourself yourselves z zero".split(" "));function Yr(a){this.data=a;this.a=0}Yr.prototype.next=function(a){for(var b=this.a,c=this.data[b],c=1,d=0;0<=b&&b<this.data.length;){c=this.data[b];if(c instanceof Array)if(a<c[0])c=-1;else if(a>c[1])c=1;else return this.a=b,!0;else{if(c==a)return this.a=b,!0;c=a<c?-1:1}if(0==d)d=c;else if(d!=c)break;b+=c;if(b>this.data.length||0>b)break}return!1};
function Zr(a,b){for(var c=0,d=0,e=a.length,f=0;f<e;++f){a:{var d=a.charCodeAt(f),g=new Yr(categ_letters_numbers_data);if(ha(d))d=g.next(d);else{for(var k=0,l=d.length;k<l;++k)if(!1===g.next(d[k])){d=!1;break a}d=!0}}d||((d=f-c)&&b(c,d),c=f+1)}(d=e-c)&&b(c,d)};function $r(a,b){this.d=b;this.value=a}$r.prototype.K=function(){return this.value};$r.prototype.zb=function(){return 1};var as=Li||Ii;$r.prototype.s=function(){return this.value};$r.prototype.toString=function(){return"Entry:"+this.value};function bs(a,b,c,d,e,f){$r.call(this,d,e);this.N=a;this.b=b;this.c=c;this.ue=f||[]}A(bs,$r);h=bs.prototype;h.Ad=function(){return{k:this.d,v:this.value.toLowerCase(),id:this.s(),loc:this.ue}};h.s=function(){var a=[this.N,this.c,this.b,this.value];return as?a:ek(a)};h.D=function(){return this.N};h.aa=function(){return this.c};h.toString=function(){return["IndexEntry",this.N,this.c,this.value].join(":")};function cs(a,b,c,d,e){$r.call(this,b,c);this.e=d;this.a=e;this.type=a;this.Ig=1}A(cs,$r);cs.prototype.zb=function(){return this.a*this.type*this.Ig};cs.prototype.s=function(){return this.value+"|"+this.e};function ds(a,b){bs.call(this,b.D(),b.b,b.aa(),b.K(),b.d,[]);this.h=a;this.a=[b]}A(ds,bs);h=ds.prototype;h.count=function(){return this.a.length};h.entry=function(a){return this.a[a]};h.Wf=function(a){a=a.a[0];for(var b=0;b<this.a.length;b++)if(this.a[b].b==a.b&&this.a[b].value==a.value)return;this.a.push(a)};h.zb=function(){for(var a=0,b=0;b<this.a.length;b++)var c=this.a[b],d=vm(this.h,c.D(),c.b),c=c.zb(),a=a+c*d.b;return a};function wb(a,b){var c=a.zb(),d=b.zb();return c<=d?1:-1}
h.Ad=function(){for(var a={value:this.value,primaryKey:this.c,storeName:this.N,score:this.zb(),tokens:[]},b=0;b<this.a.length;b++)a.tokens[b]=this.a[b].Ad();return a};h.toString=function(){return["RankEntry",this.N,this.c,this.value].join(":")+"["+this.a.length+"]"};function es(a){var b=[],c;a=a.split(/\s+/);for(var d=0;d<a.length;d++){c=a[d];for(var e=c.length-1,f=Array(e),g=0;g<e;g++)f[g]=c.substring(g,g+2);c=f;b.push.apply(b,c)}return b};function Ll(a,b,c,d,e,f,g){bs.call(this,b,c,d,e,f,g);this.query=a}A(Ll,bs);Ll.prototype.zb=function(){var a,b=this.value;a=es(this.query.value.toLowerCase().replace(/^\s+|\s+$/g,""));var b=es(b.toLowerCase().replace(/^\s+|\s+$/g,"")),c=0,d=a.length+b.length,e,f,g,k;for(e=0;e<a.length;e++)for(g=a[e],f=0;f<b.length;f++)if(k=b[f],g==k){c++;delete b[f];break}a=2*c/d;b=Math.log(this.ue.length+1);c=this.query.zb();return b*a*c};Ll.prototype.Ad=function(){return{keyPath:this.b,value:this.value,loc:this.ue.slice()}};
Ll.prototype.toString=function(){return["ResultEntry",this.N,this.c,this.value].join(":")};function fs(a,b,c){this.a=a;this.b=b;this.d=[];this.limit=c||1E3;this.c=0}function Kl(a,b){for(var c,d,e=a.a.getName(),f=0;f<a.b.length;f++){var g=a.b[f],k=g.type;.4==k||.6==k?(d="v",c=g.K().toLowerCase(),c=Lk(c)):(d="v",c=g.K().toLowerCase(),c=U.only(c));b(e,d,c,g);a.c++;.6==k&&(d="k",c=g.d,c=U.only(c),b(e,d,c,g),a.c++)}}function Jl(a){for(var b=[a.a.getName()],c=0;c<a.a.count();c++){var d=a.a.index(c).D();-1==b.indexOf(d)&&b.push(d)}return b}
function Ml(a){for(var b=[],c=[],d=0;d<a.d.length;d++){var e=a.d[d];if(0==e.query.type)-1==ib(c,function(a){return a.aa()==e.aa()&&a.D()==e.D()})&&c.push(e);else{var f=new ds(a.a,e),g=ib(b,function(a){return a.aa()==f.aa()&&a.D()==f.D()});if(0<=g){var k=b[g];Za.splice.call(b,g,1);k.Wf(f);f=k}vb(b,f)}}for(a=0;a<c.length;a++)for(g=c[a],d=b.length-1;0<=d;--d)if(k=b[d],g.aa()==k.aa()&&g.D()==k.D()){b.splice(a,1);break}return b.map(function(a){return a.Ad()})};function gs(a){this.a=a;if("en"==a.lang){a=a.b||["stop","stemmer","metaphone"];for(var b=[],c=0;c<a.length;c++)if("metaphone"==a[c])b.push(Vr);else if("stemmer"==a[c])b.push(Wr);else if("stop"==a[c])b.push(Xr);else throw Error('Invalid normalizer "'+a[c]+'" for English lang');a=b}else a=[];this.b=a}function hs(a,b){for(var c=0;c<a.b.length;c++){var d=a.b[c].a(b);if(d)b=d;else return null}return b}gs.prototype.parse=function(a){var b=[];Zr(a,function(c,d){b.push(a.substr(c,d))});return b};
gs.prototype.query=function(a,b,c){a=is(this,b);return 0==a.length?null:new fs(this.a,a,c||10)};
function is(a,b){var c=[],d=[];Zr(b,function(a,e){c.push(b.substr(a,e));d.push(a)});for(var e=[],f=0;f<c.length;f++)e[f]=hs(a,c[f]);for(var g=[],k=0,f=0;f<c.length;f++){var l=c[f],m=e[f],n="*"==b.charAt(d[f]+l.length),p=n?d[f]+l.length+1:d[f]+l.length,p='"'==b.charAt(d[f]-1)&&'"'==b.charAt(p),q="-"==b.charAt(p?d[f]-2:d[f]-1),s=.8;n?s=.4:p?s=1:q?s=0:null!=m&&(s=.6);l=new cs(s,l,m,d[f],1/(f+2));g.push(l);k+=l.zb()}for(f=0;f<g.length;++f)g[f].Ig=1/k;return g}
function js(a,b,c,d){var e=[],f=[];Zr(b,function(a,c){e.push(b.substr(a,c));f.push(a)});for(var g=[],k=0;k<e.length;k++)g[k]=hs(a,e[k]);a=c.D();c=c.a;for(var l=[],k=0;k<e.length;k++){var m=e[k],n=g[k];if(null!=n){var p=hb(l,function(a){return a.K()==m});p||(p=new bs(a,c,d,m,n),l.push(p));p.ue.push(f[k])}}return l}function ks(a,b,c,d){for(var e=[],f=0;f<a.a.count();f++){var g=a.a.index(f);if(g.D()==b){var k=bk(d,g.a);v(k)&&(e=e.concat(js(a,k,g,c)))}}return e};Qm.prototype.Fg=function(a,b){var c=this;b.a=new gs(b);sm(a,function(d,e){function f(e){var f=a.getName();Ek(e)&&xk(d,function(a,g,k){if(g)k(a,g);else{ue(d,a);var l=Hk(U.bound([f,e],[f,e,"\uffff"])),y=b.getName();Rl(c.a,y,l).V(function(){k(a,g)})}})}function g(b){var e=a.getName();xk(d,function(a,f,g){f?g(a,f):(ue(d,a),b&&(b=Hk(U.bound([e,b.lower],[e,b.upper,"\uffff"]))),Rl(c.a,e,b).V(function(){g(a,f)}))})}function k(e,f){var g=a.getName();xk(d,function(a,k,l){ue(d,a);if(k)l(a,k);else{var y=b.getName();
u(a)||(a=[a]);for(var G=0;G<a.length;G++){var H=a[G];if(Ek(H)){if(f){var J=Hk(U.bound([g,H],[g,H,"\uffff"]));Rl(c.a,y,J)}H=ks(b.a,g,H,e[G]).map(function(a){return a.Ad()});H=Pl(c.a,y,H);G==a.length-1&&H.V(function(){l(a,k)})}}}})}var l=d.de();"put"==l?k([e[1]],!0):"put:array"==l?k(e[1],!0):"add"==l?k([e[1]],!1):"add:array"==l?k(e[1],!1):"rm:iter"==l||"clear"==l?g(e[1]):"rm"==l&&f(e[1])})};
Qm.prototype.search=function(a,b,c,d){var e=zm(this.b,a);if(!e)throw new I('full text index catalog "'+a+'" not found.');a=e.a.query(a,b,c,d);return a?this.a.search(a):(K(this.logger,'query "'+b+'" contains only noise and search is ignored'),zk("search",null))};function ls(a){this.name=a;this.info=null;this.b={};this.a=null}
var ms={Accounts:{GeneratorIndex:{ydn$emails:["email","email1","email_addresses_non_primary"],ydn$phones:["phone_office","phone_alternate","phone_fax"]}},Calls:{FullTextIndex:{name:["name","description"],content:["name","description"]},indexes:[{name:"parent",keyPath:["parent_type","parent_id","date_modified"]},{name:"assigned_user_id, date_start",keyPath:["assigned_user_id","date_start"]}]},Contacts:{FullTextIndex:{name:["name","first_name","last_name","full_name"]},GeneratorIndex:{ydn$emails:["email",
"email1","email2"],ydn$phones:["phone_home","phone_mobile","phone_work","phone_other","phone_fax"]}},Documents:{FullTextIndex:{name:["name","document_name","filename"],content:["description"]},indexes:[{name:"parent",keyPath:["doc_type","doc_id"]}]},Emails:{FullTextIndex:{name:["name"],content:["content","description"]},GeneratorIndex:{ydn$emails:["bcc_addrs","cc_addrs","from_addr","to_addrs","reply_to_addr"]},indexes:[{name:"parent",keyPath:["parent_type","parent_id","date_modified"]},{name:"message_id"}]},
Leads:{FullTextIndex:{name:["name","first_name","last_name","full_name"]},GeneratorIndex:{ydn$emails:["email","email1","email2"],ydn$phones:["phone_home","phone_mobile","phone_work","phone_other","phone_fax"]}},Meetings:{FullTextIndex:{name:["name"],content:["description"]},indexes:[{name:"date_start"},{name:"parent",keyPath:["parent_type","parent_id","date_modified"]},{name:"assigned_user_id, date_start",keyPath:["assigned_user_id","date_start"]}]},Notes:{FullTextIndex:{name:["name"],content:["description"]},
indexes:[{name:"parent",keyPath:["parent_type","parent_id","date_modified"]}]},Opportunities:{FullTextIndex:{name:["name"],content:["description"]},indexes:{name:"assigned_user_id, date_closed",keyPath:["assigned_user_id","date_closed"]}},Tasks:{FullTextIndex:{name:["name"],content:["description"]},indexes:[{name:"parent",keyPath:["parent_type","parent_id","date_modified"]},{name:"assigned_user_id, date_due",keyPath:["assigned_user_id","date_due"]}]}};
function ns(a,b){return"ydn$emails"==b?{name:b,multiEntry:!0,generator:function(b){var d=[],e;for(e in b)if(0<=a.indexOf(e))if(v(b[e]))if(/addrs$/.test(e))for(var f=b[e].split(","),g=0;g<f.length;g++){var k=yo(f[g]);k&&d.push(k)}else(k=yo(b[e]))&&d.push(k);else if(fa(b[e])&&b[e][0]&&b[e][0].email_address)for(f=b[e],g=0;g<f.length;g++)f[g]&&v(f[g].email_address)&&(k=yo(f[g].email_address))&&d.push(k);return d}}:"ydn$phones"==b?{name:b,multiEntry:!0,generator:function(b){var d=[],e;for(e in b)if(0<=
a.indexOf(e)){var f=xo(b[e]);f&&d.push(f)}return d}}:null}function os(a,b){if(a.a)for(var c=0;c<a.a.stores.length;c++)if(a.a.stores[c].name==b)return a.a.stores[c];var c=a.b[b]||ms[b]||{},d={name:b,keyPath:c.keyPath||"id",indexes:[{name:"name"},{name:"date_modified"}]},e=["ydn$emails","ydn$phones","ydn$names"];c.indexes&&(d.indexes=d.indexes.concat(c.indexes));for(var f=c.GeneratorIndex||{},c=0;c<e.length;c++){var g=e[c],k=f[g];!k||u(k)&&0==k.length||d.indexes.push(ns(k,g))}return d}
function ps(a){if(a.a)return a.a;for(var b={fullTextCatalogs:[],stores:[{name:"history",indexes:[{keyPath:"type"},{keyPath:"timestamp"}]},{name:"Meta"}]},c=0;c<Nr.length;c++){var d=Nr[c];b.stores.push(os(a,d));var e=a.b[d]||ms[d]||{};if(e.FullTextIndex)for(var f in e.FullTextIndex){var g=e.FullTextIndex[f];if(0<g.length){for(var k={name:"ft-"+d+"-"+f,lang:"en",sources:[]},l=0;l<g.length;l++)k.sources.push({storeName:d,keyPath:g[l]});b.fullTextCatalogs.push(k)}}}a.a=b;Object.freeze(a.a);return a.a}
;function qs(a,b,c){this.domain=a;this.module=b;this.a=c||{}}function rs(a){return null!=a.a.id}h=qs.prototype;h.getData=function(){return this.a};h.s=function(){return this.a.id};function ss(a){return a.a?+ts(a.a.date_modified):NaN}function us(a){return"assigned_user_id, "+vs(a)}function vs(a){return"Tasks"==a?"date_due":"Opportunities"==a?"date_closed":"date_start"}
function ws(a){if(!a.a)return"";if(a.a.name)return a.a.name;var b=a.a.full_name||a.a.name;return b?b:a.a.first_name||a.a.last_name?(b=(a.a.first_name||"").trim(),a=(a.a.last_name||"").trim(),b+" "+a):a.a.id}h.names=function(){return Object.keys(this.a)};h.value=function(a){return this.a[a]};h.toJSON=function(){return{domain:this.domain,module:this.module,obj:this.a}};h.toString=function(){return"Record:"+this.module+":"+(this.a?this.a.id:void 0)};function xs(a,b,c){var d=0;if(!b)return d;b.gd$city&&a[c+"_address_city"]!=b.gd$city.$t&&(a[c+"_address_city"]=b.gd$city.$t,d++);b.gd$country&&a[c+"_address_country"]!=b.gd$country.$t&&(a[c+"_address_country"]=b.gd$country.$t,d++);b.gd$postcode&&a[c+"_address_postalcode"]!=b.gd$postcode.$t&&(a[c+"_address_postalcode"]=b.gd$postcode.$t,d++);b.gd$region&&a[c+"_address_state"]!=b.gd$region.$t&&(a[c+"_address_state"]=b.gd$region.$t,d++);b.gd$street&&a[c+"_address_street"]!=b.gd$street.$t&&(a[c+"_address_street"]=
b.gd$street.$t,d++);b.gd$housename&&a[c+"_address_street_2"]!=b.gd$neighborhood.$t&&(a[c+"_address_street_2"]=b.gd$neighborhood.$t,d++);b.gd$neighborhood&&a[c+"_address_street_3"]!=b.gd$city.$t&&(a[c+"_address_street_3"]=b.gd$city.$t,d++);return d}
function ys(a,b,c){function d(d,g){!a[c+g]||b[d]&&b[d].$t==a[c+g]||(e++,b[d]={$t:a[c+g]})}var e=0;if(!a)return 0;b||(b={});d("gd$city","_address_city");d("gd$country","_address_country");d("gd$postcode","_address_postalcode");d("gd$region","_address_state");d("gd$street","_address_street");d("gd$neighborhood","_address_street_2");d("gd$city","_address_street_3");return e}
function zs(a,b){var c=0;!a.title||b.name&&b.name==a.title.$t||(b.name=a.title.$t,c++);for(var d=0;a.gd$email&&d<a.gd$email.length;d++){var e=a.gd$email[d];"http://schemas.google.com/g/2005#work"==e.rel?b.email1!=e.address&&(c++,b.email1=e.address):"http://schemas.google.com/g/2005#home"==e.rel?b.email2!=e.address&&(c++,b.email2=e.address):"http://schemas.google.com/g/2005#other"==e.rel&&b.email!=e.address&&(c++,b.email=e.address)}a.gd$name?(a.gd$name.gd$namePrefix&&b.salutation!=a.gd$name.gd$namePrefix.$t&&
(c++,b.salutation=a.gd$name.gd$namePrefix.$t),a.gd$name.gd$givenName&&b.first_name!=a.gd$name.gd$givenName.$t&&(b.first_name=a.gd$name.gd$givenName.$t,c++),a.gd$name.gd$familyName&&b.last_name!=a.gd$name.gd$familyName.$t&&(b.last_name=a.gd$name.gd$familyName.$t,c++),a.gd$name.gd$fullName&&b.full_name!=a.gd$name.gd$fullName.$t&&(b.full_name=a.gd$name.gd$fullName.$t,c++)):b.full_name=a.title.$t;a.gd$organization&&a.gd$organization[0]&&(d=a.gd$organization[0],d.gd$orgTitle&&d.gd$orgTitle.$t!=b.title&&
(b.title=d.gd$orgTitle.$t,c++),d.gd$orgDepartment&&d.gd$orgDepartment.$t!=b.department&&(b.department=d.gd$orgDepartment.$t,c++),d.gd$orgJobDescription&&d.gd$orgJobDescription.$t!=b.description&&(b.description=d.gd$orgJobDescription.$t,c++));if(a.gd$im)for(d=0;d<a.gd$im.length;d++)"Twitter"==a.gd$im[d].label&&b.twitter!=a.gd$im[d].address?(b.twitter=a.gd$im[d].address,c++):"Facebook"==a.gd$im[d].label&&b.facebook!=a.gd$im[d].address?(b.facebook=a.gd$im[d].address,c++):"Google Plus"==a.gd$im[d].label&&
b.googleplus!=a.gd$im[d].address?(b.googleplus=a.gd$im[d].address,c++):"Linkedin"==a.gd$im[d].label&&b.linkedin!=a.gd$im[d].address&&(b.linkedin=a.gd$im[d].address,c++);a.gContact$birthday&&b.birthdate!=a.gContact$birthday.when&&(b.birthdate=a.gContact$birthday.when,c++);for(d=0;a.gd$phoneNumber&&d<a.gd$phoneNumber.length;d++)if(e=a.gd$phoneNumber[d],e.$t)if("http://schemas.google.com/g/2005#mobile"==e.rel)b.phone_mobile!=e.$t&&(b.phone_mobile=e.$t,c++);else if("http://schemas.google.com/g/2005#work"==
e.rel)b.phone_work!=e.$t&&(b.phone_work=e.$t,c++);else if("http://schemas.google.com/g/2005#home"==e.rel)b.phone_home!=e.$t&&(b.phone_home=e.$t,c++);else if("http://schemas.google.com/g/2005#fax"==e.rel||"http://schemas.google.com/g/2005#home_fax"==e.rel||"http://schemas.google.com/g/2005#work_fax"==e.rel)b.phone_fax!=e.$t&&(b.phone_fax=e.$t,c++);else if(b.phone_other=e.$t)b.phone_other=e.$t,c++;if(a.gd$structuredPostalAddress){for(var f=e=-1,d=0;d<a.gd$structuredPostalAddress.length;d++){var g=a.gd$structuredPostalAddress[d];
"http://schemas.google.com/g/2005#work"==g.rel||g.primary?e=d:f=d}-1==e&&(f=-1);c+=xs(b,a.gd$structuredPostalAddress[e],"primary");c+=xs(b,a.gd$structuredPostalAddress[f],"alt")}return c}
function As(a,b){function c(a,c){if(g[a]){b.gd$phoneNumber||(b.gd$phoneNumber=[]);var d;a:{for(d=0;b.gd$phoneNumber&&d<b.gd$phoneNumber.length;d++)if(b.gd$phoneNumber[d].rel==c){d=b.gd$phoneNumber[d];break a}d=null}d?d.$t!=g[a]&&(d.$t=g[a],k++):(b.gd$phoneNumber.push({rel:c,$t:g[a]}),k++)}}function d(a){b.gd$im||(b.gd$im=[]);for(var c=0;c<b.gd$im.length;c++)if(b.gd$im[c].label==a)return b.gd$im[c];return null}function e(){b.gd$name||(b.gd$name={},k++)}function f(a,c){if(g[a]){b.gd$email?fa(b.gd$email)||
(b.gd$email=[b.gd$email]):b.gd$email=[];var d;a:{d=g[a];for(var e=0;b.gd$email&&e<b.gd$email.length;e++)if(!(0<=l.indexOf(e))&&b.gd$email[e].address==d){d=e;break a}d=-1}0<=d?(e=b.gd$email[d],e.rel!=c&&(k++,e.rel=c),l.push(d)):(b.gd$email.push({rel:c,address:g[a]}),l.push(b.gd$email.length-1),k++)}}var g=a.getData(),k=0;!g.name||b.title&&b.title.$t==g.name||(b.title={$t:g.name},k++);var l=[];f("email1","http://schemas.google.com/g/2005#work");f("email2","http://schemas.google.com/g/2005#home");f("email",
"http://schemas.google.com/g/2005#other");g.salutation&&(e(),b.gd$name.gd$namePrefix&&b.gd$name.gd$namePrefix.$t==g.salutation||(b.gd$name.gd$namePrefix={$t:g.salutation},k++));g.first_name&&(e(),b.gd$name.gd$givenName&&b.gd$name.gd$givenName.$t==g.first_name||(b.gd$name.gd$givenName={$t:g.first_name},k++));g.last_name&&(e(),b.gd$name.gd$familyName&&b.gd$name.gd$familyName.$t==g.last_name||(b.gd$name.gd$familyName={$t:g.last_name},k++));g.full_name&&(e(),b.gd$name.gd$fullName&&b.gd$name.gd$fullName.$t==
g.full_name||(b.gd$name.gd$fullName={$t:g.full_name},k++));if(g.twitter){var m=d("Twitter");m?m.address!=g.twitter&&(m.address=g.twitter,k++):(b.gd$im.push({label:"Twitter",address:g.twitter}),k++)}g.facebook&&((m=d("Facebook"),m)?m.address!=g.facebook&&(m.address=g.facebook,k++):(b.gd$im.push({label:"Facebook",address:g.facebook}),k++));g.googleplus&&((m=d("Google Plus"),m)?m.address!=g.googleplus&&(m.address=g.googleplus,k++):(b.gd$im.push({label:"Google Plus",address:g.googleplus}),k++));g.linkedin&&
((m=d("Linkedin"),m)?m.address!=g.linkedin&&(m.address=g.linkedin,k++):(b.gd$im.push({label:"Linkedin",address:g.linkedin}),k++));!g.birthdate||b.gContact$birthday&&b.gContact$birthday.when==g.birthdate||(b.gContact$birthday={when:g.birthdate},k++);c("phone_mobile","http://schemas.google.com/g/2005#mobile");c("phone_work","http://schemas.google.com/g/2005#work");c("phone_home","http://schemas.google.com/g/2005#home");c("phone_fax","http://schemas.google.com/g/2005#work_fax");c("phone_other","http://schemas.google.com/g/2005#other");
for(var n=-1,m=-1,p=0;b.gd$structuredPostalAddress&&p<b.gd$structuredPostalAddress.length;p++)-1==n&&"true"==b.gd$structuredPostalAddress[p].primary||"http://schemas.google.com/g/2005#work"==b.gd$structuredPostalAddress[p].rel?n=p:-1==m&&(m=p);-1==n&&0<=m&&(n=m,b.gd$structuredPostalAddress[n].primary="true",m=-1);0<=n?k+=ys(g,b.gd$structuredPostalAddress[n],"primary"):(n={primary:"true",rel:"http://schemas.google.com/g/2005#work"},p=ys(g,n,"primary"),0<p&&(b.gd$structuredPostalAddress||(b.gd$structuredPostalAddress=
[]),b.gd$structuredPostalAddress.push(n),k+=p));0<=m?k+=ys(g,b.gd$structuredPostalAddress[m],"alt"):(n={},p=ys(g,n,"alt"),0<p&&(b.gd$structuredPostalAddress||(b.gd$structuredPostalAddress=[]),b.gd$structuredPostalAddress.push(n),k+=p));return k};function Bs(a){if(u(a))return a.map(function(a){return Bs(a)});if(x(a)){var b={},c;for(c in a.name_value_list)b[c]=a.name_value_list[c].value;return b}throw Error("Invalid name_value_entries");}function ts(a){return new Date(a+" GMT")}function Cs(a){return a.toISOString().replace("T"," ").replace(/\..+/,"")};function Ds(a,b,c,d,e){F.call(this);c=va(c,"http")?new Ge(c):He(Ie(new Ge,c),"https");c.Kc="";Le(c,null);this.c=c.Mb;this.G=b;this.i=c.toString().replace(/\/$/,"");this.h=d;this.C=e;this.b=null;this.e=a;this.T=new ls(this.c);this.db=new hp("su-"+this.c,ps(this.T),{isSerial:!0,policy:"single",mechanisms:["indexeddb"]});this.a=Pm(this.db,gl,!0);this.d=null;this.l=this.r=NaN;this.F=!1;this.history=new fq(this.db)}A(Ds,vp);h=Ds.prototype;
h.request=function(a,b,c,d,e,f){function g(){m.execute(function(g,k){this.r=z();var l=g;if(v(l))try{g=JSON.parse(l)}catch(m){}f||!g||11!=g.number&&10!=g.number?d.call(e,g,k):Es(this).m(function(){this.request(a,b,c,d,e,!0)},function(){d.call(e,null,new Uj(0,null,{},"Login fail"))},this)},this)}for(var k="{",l=0;l<b.length;l++)k+=(0==l?"":",")+'"'+b[l]+'":'+JSON.stringify(c[l]);k+="}";l=new Ne;l.add("method",a);l.add("input_type","json");l.add("response_type","json");l.add("rest_data",k);var m=this.e.request(new Qi(this.i+
"/service/v4/rest.php","POST",{},{"Content-Type":"application/x-www-form-urlencoded"},l.toString())),k=z()-this.r;0<k&&100>k?(this.r=100+this.r,ke(this.logger,"request will call after "+k+" ms."),$f(g,k,this)):g.call(this)};
function Fs(a,b,c){var d=c.module_name,e=["session"];a=[a.b?a.b.id:null];var f=[!1];d&&(e.push("module_name"),a.push(d),f.push(!1));if("get_entry_list"==b)b=c.query||"",e.push("query"),a.push(b),f.push(""==b),e.push("order_by"),b=c.order_by||"",a.push(b),f.push(""==b),b=c.offset||0,e.push("offset"),a.push(b),f.push(0==b),b=c.select_fields||[],e.push("select_fields"),a.push(b),f.push(0==b.length),b=c.link_name_to_fields_array||[],e.push("link_name_to_fields_array"),a.push(b),f.push(0==b.length),b=
c.max_results||100,e.push("max_results"),a.push(b),f.push(null!=c.max_results),b=c.deleted||0,e.push("deleted"),a.push(b),f.push(0==b),c=!!c.favorites,e.push("favorites"),a.push(c),f.push(0==c);else if("get_available_modules"==b)c=c.filter||"",e.push("filter"),a.push(c),f.push(0==c.length);else if("get_module_fields"==b)c=c.fields||[],e.push("fields"),a.push(c),f.push(0==c.length);else if("get_entries"==b)b=c.ids||[],e.push("ids"),a.push(b),f.push(!1),b=c.select_fields||[],e.push("select_fields"),
a.push(b),f.push(0==b.length),b=c.link_name_to_fields_array||[],e.push("link_name_to_fields_array"),a.push(b),f.push(0==b.length);else for(var g in c)"module_name"!=g&&(e.push(g),a.push(c[g]),f.push(!1));for(c=f.length-1;0<=c;c--)if(f[c])e.pop(),a.pop();else break;return{keys:e,$:a}}
function Gs(a,b){var c=b.entry_list;if(u(c)&&0<c.length){var d=c.map(function(a){return'"'+a.id+'"'});return Hs(a,"get_entry_list",{module_name:"EmailText",max_results:b.length,query:"email_id IN ("+d.join(",")+")"}).n(function(a){a=a.entry_list;c.length!=a.length&&ie(this.logger,"number of entries retrived for EmailText exptected to have "+c.length+" but found only "+a.length);for(var d=0;d<a.length;d++){var g=a[d];if(a[d]){var k=Db(g,"name_value_list","email_id","value"),l=ib(c,function(a){return a.id==
k});if(0<=l)for(var m in g.name_value_list)c[l].name_value_list[m]=g.name_value_list[m];else je(this.logger,"key "+k+" not found in EmailText")}}return b},a)}}
function Is(a,b){var c=b.module_name;a.l=z();var d=Hs(a,"get_entry_list",b);"Emails"==c&&(d=d.n(function(a){return Gs(this,a)},a));return d.n(function(a){var d=a.result_count,g=a.offset||0,k=a.entry_list,l=parseInt(a.next_offset,10);if(t(d)&&u(k)){if(0<k.length){var m=Bs(k);return this.a.put(c,m).m(function(){var a=this.G,e=this.c,q=m;if(a.b)for(var q=u(q)?q:[q],s=0;s<q.length;s++)q[s]&&Js(a,new qs(e,c,q[s]));return d>=k.length&&l>g?(b.offset=l,Is(this,b)):l},function(a){ie(this.logger,"Fail to store into the database for module "+
c+": "+a)},this)}return l}throw Error("Invalid REST respond on entry list query on "+c+": "+JSON.stringify(a));},a)}function Ks(a,b){if(!b){for(var c=[],d=0;d<Nr.length;d++)c[d]=Ks(a,Nr[d]);c.push(Ks(a,"Users"));return zn(c)}var e={module_name:b},f="module/"+b;return a.a.get("Meta",f).n(function(a){return a?a:Hs(this,"get_module_fields",e).n(function(a){a&&a.module_name&&a.module_fields?this.a.put("Meta",a,f):ie(this.logger,"Invalid module for "+b+" "+Dh(a));return a},this)},a)}
function Ls(a,b){var c=new Zm(b,"date_modified",null,!0),d="EmailTemplates"!=b;return a.a.keys(c,1).n(function(a){var c={};a[0]&&d&&(c.query=b.toLowerCase()+".date_modified>'"+a[0]+"'");c.module_name=b;c.order_by="date_modified";a=Is(this,c);a.m(function(a){this.logger.info(this+" module "+b+" synced, "+a+" records updated.");this.a.put("Meta",{module:b,updated:z(),"last-update-count":a},"sync/"+b)},function(a){var c=".";a&&(c=" with "+a.name+": "+a.message);ie(this.logger,this+" module "+b+" failed"+
c)},this);return a},a)}function Hs(a,b,c,d){var e=d||0,f=new B;if(!a.b||!a.b.user_id)return 2>e?(ke(a.logger,"Request require login, tried "+e),Es(a).n(function(){e++;nc(Hs(a,b,c,e),f)})):(K(a.logger,"Cannot do request, not login. Give up after "+e+" retry"),f.p()),f;d=Fs(a,b,c);a.request(b,d.keys,d.$,function(d,k){Ti(k)&&x(d)?11==d.number&&/invalid/i.test(d.name)?(this.b=null,nc(Hs(a,b,c,e),f)):f.callback(d):f.p(k.H()+" "+k.Da())},a);return f}
h.query=function(a,b){if(!u(a)||0==a.length)return C("invalid query");for(var c=[],d=0;d<a.length;d++){var e=a[d],f=e.limit||5,g=e.offset||0,k=!!e.reverse;if(!x(e))return C("invalid query at "+d+"");var l=e.store;if(-1==Nr.indexOf(l))return C("invalid store name at "+d+": "+l);var m=e.index||"id",n=null;null!=e.key?(n=e.key,"ydn$phones"==m?n=xo(n):"ydn$emails"==m&&(n=n.toLowerCase()),n=e.prefix?Lk(n):U.only(n)):null!=e.keyRange&&(n=Mk(e.keyRange));"id"==m?b?c.push(this.a.keys(l,n,f,g,k)):c.push(this.a.lg(l,
n,f,g,k)):Em(this.db,l,m)?b?c.push(this.a.keys(l,m,n,f,g,k)):c.push(this.a.He(l,m,n,f,g,k)):c.push(sc([]))}return(new yn(c)).m(function(c){for(var d=0;d<c.length;d++)if(c[d][0]){if(a[d].result=c[d][1],!b)for(var e=0;e<a[d].result.length;e++)a[d].result[e]._module=a[d].store}else ie(this.logger,"query "+d+" failed."),a[d].result=[];return a},function(b){ie(this.logger,"list failed "+b);return a},this)};
h.$=function(a,b){if(u(a)||!x(a))return C("invalid query");var c=a.limit||5,d=a.offset||0,e=!!a.reverse,f=a.store;if(-1==Nr.indexOf(f))return C("invalid store name : "+f);var g=a.index||"id";if(!v(g)||0==g.length)return C("index name missing in "+f);var k=null;null!=a.key?(k=a.key,"ydn$phones"==g&&v(k)?k=xo(k):"ydn$emails"==g&&v(k)&&(k=k.toLowerCase()),k=a.prefix?Lk(k):U.only(k)):null!=a.keyRange&&(k=Mk(a.keyRange));return"id"==g?b?this.a.keys(f,k,c,d,e):this.a.lg(f,k,c,d,e):Em(this.db,f,g)?b?this.a.keys(f,
g,k,c,d,e):this.a.He(f,g,k,c,d,e):C("invalid index name: "+g+" for "+f)};
h.search=function(a){if(!u(a)||0==a.length)return C("invalid query");for(var b=[],c=ps(this.T),d=0;d<a.length;d++){var e=a[d];if(!x(e))return C("invalid query at "+d+"");var f=e.q;if(!v(f)||0==f.length)return C("query term missing "+d+"");var g="ft-"+e.store+"-"+(e.index||"name");0<=ib(c.fullTextCatalogs,function(a){return a.name==g})?(f=this.db.search(g,e.q),e.fetchFull&&(f=f.n(function(a){if(0<a.length){for(var b=[],c=0;c<a.length;c++)b.push(new Ck(a[c].storeName,a[c].primaryKey));return this.a.$(b).n(function(b){for(var c=
0;c<b.length;c++)a.record=b[c];return a})}},this)),b.push(f)):b.push(sc([]))}return(new yn(b)).m(function(b){for(var c=0;c<b.length;c++)b[c][0]?a[c].fullTextResult=b[c][1]:(ie(this.logger,"query "+c+" failed."),a[c].fullTextResult=[]);return a},function(b){ie(this.logger,"list failed "+b);return a},this)};
function Ms(a,b,c,d){var e={module_name:b},f="get_entry";d?(e.query=d+" = '"+c+"'",e.order_by="id",f="get_entry_list"):e.id=c;return Hs(a,f,e).n(function(a){if(a&&a.entry_list&&x(a.entry_list[0]))return Bs(a.entry_list[0]);K(this.logger,"record "+b+":"+c+" not found.");return null},a)}
function Ns(a){if(a.isLogin()){var b="login_data/"+a.b.user_id;return a.a.get("Meta",b).n(function(a){var d=Ms(this,"Users",this.b.user_id).n(function(d){a&&a.date_modified==d.date_modified||this.a.put("Meta",d,b)},this);return a?a:d},a)}return C("Not login")}
function Os(a,b,c,d){if(!v(c)||0==c.length)return C("record id required.");if(0<=Nr.indexOf(b)){var e;d?(e=U.only(c),e=a.a.$(b,d,e).n(function(a){return a[0]},a)):e=a.a.get(b,c);return e.n(function(a){if(!a)return Ms(this,b,c,d)},a)}return 0<=Mr.indexOf(b)?Ms(a,b,c,d):C("module: "+b+" not registerred")}
function Ps(a,b){return zn([a.a.count(b),a.a.$(b,"date_modified",null,1,0,!0),a.a.get("Meta","sync/"+b)]).n(function(a){var d=a[2];d||(d={module:b});var e=a[1][0];d.count=a[0];d.modified=e?e.date_modified:void 0;return d})}
function Qs(a){if(a.d&&a.d.isLogin)return sc(a.d);var b=new B;a.a.get("Meta","info/server").V(function(a){a&&a.version?(this.d=a,b.callback(a)):this.request("get_server_info",[],[],function(a,c){if(0==c.H())this.d=null,b.p("service "+(this.i+"/service/v4/rest.php")+" not responding");else if(Ti(c)){var f=Wj(c);if((!a||!a.version)&&v(f))try{a=JSON.parse(f)}catch(g){a=Wj(c)}a&&a.version?(f=a,this.d=Fb(f),b.callback({info:f,about:this.about()}),this.a.put("Meta",f,"info/server")):(this.d=null,b.p("invalid respond "+
Wj(c)))}else this.d=null,b.p("request fail "+c.H()+" "+c.Da())},this)},a);return b}function Rs(a){return a.a.get("Meta","available_modules").n(function(a){if(a)return a;this.request("get_available_modules",["filter"],["all"],function(a){if(a&&a.modules){var b=a.modules;this.a.put("Meta",[b],["available_modules"])}else ie(this.logger,"AvailableModules failed.");return b},this)},a)}
h.about=function(){var a=this.e,a=a instanceof xp&&/proxy/.test(a.c);return{baseUrl:this.i,domain:this.c,userName:this.h,isLogin:this.isLogin(),hostPermission:!a}};function Ss(a){return(new yn([Qs(a),Rs(a),Ks(a)])).n(function(a){return{serverInfo:a[0][1],availableModules:a[1][1],modulesInfo:a[2][1],about:this.about()}},a)}
function Ts(a,b,c){var d=[],e;for(e in c)d.push({name:e,value:c[e]});var f={module_name:b,name_value_list:d};return Hs(a,"set_entry",f).n(function(a){if(a&&a.id){var c={id:a.id};a=a.entry_list||{};for(var d in a)c[d]=a[d].value;for(var e in c)"date_modified"!=e&&(f[e]=c[e]);this.a.put(b,f);Ls(this,b);return c}throw Error("creating "+b+" entry fail");},a)}
function Us(a,b,c){if(c){var d=Vs(b,Ws,a.c,void 0,c.id),e=d.module,f=new qs(a.c,e,c);K(a.logger,"synchronizing "+b+" to "+f);if(ss(f)==d.b){var g=new dq("update-gdata-record");eq(g,c);b=b.getData();x(b)&&Am(b);zs(b,c)&&Ts(a,e,c).m(function(a){x(a)?g.a=Am(a):g.a=a;this.history.add(g)},function(a){ie(this.logger,"Fail to put record "+c.id+" to server "+a.message)},a)}}}
function Xs(a,b){for(var c=Ys(b),d=0;d<c.length;d++)0<=Nr.indexOf(c[d].module)&&a.a.get(c[d].module,c[d].a).n(function(a){Us(this,b,a)},a)}function Zs(a,b,c){var d={};zs(c,d);return Ts(a,b,d)}h.isLogin=function(){return!!this.b&&!!this.b.user_id};
h.update=function(){if(this.e&&this.e instanceof xp)this.logger.info(this+" updating skipped since no direct connection is not available.");else{var a;if(this.F)je(this.logger,"Modules are already updating now at "+a+" / "+Nr.length);else{this.F=!0;this.l=z();a=0;var b=this,c=function(){var d=Nr[a];d?(K(b.logger,"Syncing module "+d),a++,Ls(b,d).V(function(){b.l=z();r.setTimeout(function(){c()},500)})):(je(b.logger,"Updating module done"),b.F=!1)};c();r.setTimeout(function(){2E3<b.l-z()&&c()},2E3)}}};
function Es(a){if(!window.navigator.onLine){var b=new B;chrome.storage.local.get("last-login",function(c){(c=c["last-login"])&&nc(a.db.get("Meta","login_data/"+c).n(function(a){this.b=a},a),b)});return b}if(!a.h)return C("username required.");if(!a.C)return C("password required.");b=new B;a.request("login",["user_auth","application_name","name_value_list"],[{user_name:a.h,password:a.C},"Yathit CRM",{language:"",notifyonsave:"false"}],function(a,d){if(a&&a.id){this.b=Bs(a);this.b.id=a.id;var e={};
e["last-login"]=this.b.user_id;chrome.storage.local.set(e);this.dispatchEvent(new E($s,this));b.callback(a)}else a&&a.description?b.p(a.description+" ("+a.name+")"):(e=d.H()+" "+d.Da()+" "+Wj(d),b.p("Login fail: "+e.substr(0,200)))},a,!0);return b}
function at(a){var b=new B;if(a.b&&a.b.user_id){var c="login_data/"+a.b.user_id;chrome.storage.local.remove("last-login");a.a.remove("Meta",c)}a.request("logout",[],[],function(a,c){this.b=null;Ti(c)?(ie(this.logger,"Logout request fail with "+c.H()+" "+c.Da()),b.callback(!0)):b.p(c.H()+" "+c.Da())},a,!0);return b}
function bt(a){function b(){var a=new B;g.request(new Qi(f.toString())).execute(function(b,c){/sugarcrm/i.test(Wj(c))?a.p("Look like SugarCRM web site, but REST V4 API is not available."):200==c.H()?a.p("Not a SugarCRM web site"):a.p("Invalid respond, "+c.H())});return a}function c(a){var b=new B;e(a+"/service/v4/rest.php",function(c,e){if(200==e.H()){if(!c||!c.version){var f=Wj(e);if(v(f))try{c=JSON.parse(f)}catch(g){b.p(d(a,e));return}else c=f}c&&c.version&&(c.baseUrl=a,b.callback(c))}else b.p(d(a,
e))});return b}function d(a,b){var c="GET "+a+" "+b.H()+" "+b.Da()+" "+Wj(b);return{name:"HttpRequestError: "+b.H()+" GET "+a,message:c}}function e(a,b){var c=new Ne;c.add("method","get_server_info");c.add("input_type","json");c.add("response_type","json");c.add("rest_data","{}");g.request(new Qi(a,"POST",{},{"Content-Type":"application/x-www-form-urlencoded"},c.toString())).execute(b)}a=a.trim();va(a,"http")||(a="https://"+a);var f=new Ge(a);f.Kc="";Le(f,null);var g=Oi("proxy"),k=f.clone();a=f.yc;
/rest.php$/.test(a)||/index.php$/.test(a)&&Ke(k,a.replace("/index.php",""));var l=k.toString();wa(l,"/")&&(l=l.substring(0,l.length-1));return c(l).m(function(a){a.isLogin=!1;a.userName=null;a.domain=k.Mb;a.baseUrl=l;return a},function(a){if(200==a.errorCode||ya(k.yc))return b();Ke(k,"");l=k.toString();return c(l)})}h.toString=function(){return"SugarClient:"+this.c};
function ct(a,b){var c=b&&v(b.assigned_user_id)?b.assigned_user_id:null;if(!v(c)||0==c.length)return C("assigned_user_id required");var d=z()-604800,d=Cs(new Date(d)),c=U.bound([c,d],[c,"\uffff"]),c=[new bn("Meetings",us("Meetings"),c),new bn("Calls",us("Calls"),c),new bn("Tasks",us("Tasks"),c),new bn("Opportunities",us("Opportunities"),c)],e=[];return gn(a.a,function(a,b){for(var c=[],d=0;d<b.length;d++)b[d]&&(e.push(b[d]),c[d]=!0);return c},c).n(function(){return e})}
function dt(a,b){var c=[],d=null,e=b||{},f=e.limit||10;(e=e.since)&&e instanceof Date&&(d=Cs(e),d=U.upperBound(d));for(e=0;e<Nr.length;e++)c[e]=new bn(Nr[e],"date_modified",d,!0,!0);var g=[];return gn(a.a,function(a,b){for(var c=[],d=-1,e=null,q=0;q<b.length;q++)b[q]&&(e?e<b[q].date_modified&&(e=b[q].date_modified,d=q,c=[],c[q]=!0):(e=b[q].date_modified,d=q,c[q]=!0));0<=d&&(b[d]._module=Nr[d],g.push(b[d]));return g.length>=f?[]:c},c).n(function(){return g})}
function et(a,b,c){if("about"==b)a=sc(a.about());else if("activity-stream"==b)a=dt(a,c);else if("activity-upcoming"==b)a=ct(a,c);else if("delete-record"==b)a=(b=c.module)&&-1!=Mr.indexOf(b)?(c=c.id)?c?Ts(a,b,{id:c,deleted:"1"}):C("deleting in-exist record."):C("record id required"):C("invalid module name: "+b);else if("details"==b)a=Ss(a);else if("get"==b)a=Os(a,c.module,c.id,c.index);else if("fetch-module"==b)a=Ls(a,c);else if("info-module"==b)x(c)&&v(c.module)&&(c=c.module),a=Ks(a,c);else if("keys"==
b)a=a.$(c,!0);else if("list-module"==b)a=Rs(a);else if("login-user"==b)a=Ns(a);else if("put-record"==b||"new-record"==b)(b=c.module)&&-1!=Mr.indexOf(b)?(c=c.record,a=x(c)?Ts(a,b,c):C("record object required")):a=C("invalid module name: "+b);else if("search"==b)a=u(c)?a.search(c):C("query must be an array");else if("query"==b)a=a.query(c);else if("server-info"==b)a=Qs(a);else if("stats"==b){c=[];for(b=0;b<Nr.length;b++)c.push(Ps(a,Nr[b]));a=zn(c)}else"rest"==b?x(c)?(b=c.method,c=c.params,a=v(b)&&0!=
b.length?x(c)?Hs(a,b,c):C("REST parameter must be an object"):C("method must be valid string")):a=C("REST parameter must be an object"):a="values"==b?a.$(c):C("invalid req "+b);return a};function ft(a){Error.captureStackTrace?Error.captureStackTrace(this,ft):this.stack=Error().stack||"";a&&(this.message=String(a))}A(ft,Error);ft.prototype.name="ydn.gdata.error.InvalidAtomFormatError";function gt(a){Error.captureStackTrace?Error.captureStackTrace(this,gt):this.stack=Error().stack||"";a&&(this.message=String(a))}A(gt,Error);gt.prototype.name="ydn.gdata.error.IncompatibleError";var ht="atom app gd xhtml batch openSearch".split(" ");function it(a){if(!t(this.type))throw new Bi("Abstract class cannot be instantiated.");if(v(a))a={id:{$t:a}};else if(!t(a.id)||!v(a.id.$t))throw new wi("Invalid GDataFeed");this.id=a.id.$t;this.data=a;t(this.data.entry)?u(this.data.entry)||(this.data.entry=[this.data.entry]):this.data.entry=[];this.d={};this.h={};a=u(this.data.entry)?this.data.entry.length:0;for(var b=0;b<a;b++){var c=this.data.entry[b],c=c.id?c.id.$t:c.fi?c.fi.$t:"";if(0==c.length)throw new ft("entry "+b);if(0==c.match(/\w+$/)[0].length)throw new ft("entry "+
b+" of "+c);var d=c.match(/\w+$/)[0];this.d[c]=this.data.entry[b];this.h[d]=this.data.entry[b]}this.c=!0;this.r=[];this.l=new ph(function(){this.dispatchEvent(jt)},300,this);this.Kh=null;this.b=NaN;this.i=void 0}A(it,xh);var jt="i";h=it.prototype;h.tg=function(){return this.kind};h.logger=L("ydn.gdata.Feed");
h.$a=function(a){var b=new B;ke(this.logger,this+" receiving a task, ready: "+this.c);var c=this;this.c?(this.c=!1,b.V(function(){O(c.logger,c+" finish the task.");c.c=!0;var a=c.r.shift();a&&a.call(this)}),a.call(this,b)):this.r.push(pa(oa(a,this),b));return b};h.Kh=null;function kt(a){var b;if(!(b=a.Kh))if(a=a.Ue(),t(a)){b=a;for(var c=0;c<Oj.length;c++){var d=(0,Oj[c])(a);if(d){b=d;break}}O(Mj,"Resolving "+a+" to "+b);b=Nj[b]||null}else b=Nj["default"];return b}h.ug=function(){this.dispatchEvent("e")};
h.Wg=function(){return ht};h.ii=function(a){a.a()||ie(this.logger,"Batch submission failed. "+a.responseText)};
h.Ng=function(a,b){var c=this.Wg(),d=void 0;t(c)||(c=ht);for(var e="",f=0;f<c.length;f++)var g=c[f],e=0==f?e+(' xmlns="'+Oq[g]+'" '):e+(" xmlns:"+g+'="'+Oq[g]+'" ');d=t(d)?"<id>"+d+"</id>":"";d=ui("<feed"+e+">"+d+"</feed>");for(f=c=0;e=this.Mc(f);f++)if(er(e))cr(e,"");else if(fr(e.getData())){var g="delete"==dr(e.getData()),k=!(!e.data.id||!e.data.id.$t);cr(e,null);var l=$q(new Vq(null,"entry",e.data),d.documentElement),m=l.getElementsByTagNameNS(Qq("batch"),"operation");m[0]?m=m[0]:m=l.appendChild(d.createElementNS(Qq("batch"),
"operation"));l=d.createAttribute("type");l.nodeValue=g?"delete":k?"update":"insert";m.setAttributeNode(l);cr(e,"committed");c++;a&&a.message({id:this.sg(),code:"operation: "+l.nodeValue+" "+e})}if(0==c)return je(this.logger,this+" Nothing to commit."),0;je(this.logger,this+" committing "+c+" entries.");d=vi(d);b?((e=this.logger)&&e.info("Commit ignored for dry run.",void 0),window.console.log(d)):(e=oa(this.ii,this),this.C&&this.C.stop(),f=kt(this),g=this.pf(),f.send(g,e,{method:"POST",body:d,headers:{"Content-Type":"application/atom+xml"},
params:{}}));return c};h.Te=function(a){return new ar(a)};h.Mc=function(a){return 0<=a&&a<this.data.entry.length?this.Te(this.data.entry[a]):null};h.rg=function(a){return(a=this.d[a])?this.Te(a):null};
h.save=function(a){if(this.store){var b=this;this.e||(this.e=new ph(function(){this.$a(function(a){var d=b.toJSON(),e=b.data.entry,f,g,k;b.store.e(function(a){a.put("ydn.gdata.feed",d).Hc(function(a){throw a;}).n(function(){f=!0});a.put("ydn.gdata.entry",e).Hc(function(a){throw a;}).n(function(a){k=a.length;g=!0})},["ydn.gdata.feed","ydn.gdata.entry"],"readwrite").m(function(){f&&g?ke(this.logger,b+": saved "+k+" entries."):ke(this.logger,b+": saved failed"+e.length+" entries.");a.callback(!0)},function(a){throw a;
},this)})},1E3,this));a?rh(this.e):qh(this.e)}};
function lt(a,b,c){c=c||new B;var d=kt(a);if(!d)return ie(a.logger,a+": No transport available."),c.p(Error("No transport available.")),c;d.send(b,function(b){if(200==b.status){a.b=z();b=b.O?ag(b.O.responseText):void 0;if(!b.feed)throw new ft("feed missing.");var d=b.feed;if(!t(d))throw b=Eh(d),new ft(b.substr(0,50));if(d.id.$t!=a.s())throw new gt(d.id.$t+" is not "+a.s());var g=b=0,k=u(d.entry)?d.entry:d.entry?[d.entry]:[];b=k.length;0==b&&O(a.logger,a+": fetch return no result.");for(var l=0;l<
b;l++){for(var m=a,n=k[l],p=n instanceof ar?n:m.Te(n),q=p,s=0;s<q.Ic.length;s++)null!=q.data[q.Ic[s]]&&!u(q.data[q.Ic[s]])&&(q.data[q.Ic[s]]=[q.data[q.Ic[s]]]);cr(q,null);q=q.getData();q.batch$status&&(q.batch$status=void 0);q.batch$operation&&(q.batch$operation=void 0);var q=p.s(),w=m.rg(q);(s=!!w)?w.update(p):(w=br(p),m.data.entry.push(n),m.d[q]=p.getData(),m.h[w]=p.getData());!s&&g++}je(a.logger,a+" "+b+" ("+g+" new) entries received");a.ug();(d=gq(d,"next"))?(a.save(),qh(a.l),a.i=d.$t,lt(a,d.href,
c)):(0<b&&(a.save(),qh(a.l)),c.callback(!0))}else ie(a.logger,"Fetching "+b.uri+" failed: "+b.status),c.p(!1)});return c}h.toString=function(){return this.type+":"+this.id};function mt(a,b){a.Uh&&b.a.set("v",a.Uh);b.a.set("alt","json");b.a.set("showdeleted",!0)}
function nt(a,b){var c="lu",d=!1;if("lf"==c){if(a.b){var d=!0,e=new Date(a.b),e=e.toISOString();b.a.set("updated-min",e)}}else if("lu"==c){for(var e=0,f=-1,g,k=0;g=a.Mc(k);k++)g=g.data.updated.$t,e<g&&(e=g,f=k);if(e=a.Mc(f))e=new Date(e.data.updated.$t),e=new Date(1+ +e),e=e.toISOString(),b.a.set("updated-min",e)}else"lo"==c?(b.a.set("orderby","lastmodified"),a.b&&b.a.set("max-results","1")):c="no";ke(a.logger,a+" updating "+(d?"continue":"begin")+" by "+c)}h.Kj=Lq.prototype.Je;h.s=Lq.prototype.s;
h.Mj=Lq.prototype.zj;h.Lj=Lq.prototype.yj;h.Ue=function(){return this.Mj()||""};h.sg=function(){return this.id};h.pf=function(){return this.Lj()};function ot(a){return a.$a(function(a){var c=new Ge(this.Ue());mt(this,c);nt(this,c);yh(this,vh,!1);lt(this,c.toString()).V(function(c){zh(this);c?a.callback(!0):a.p(void 0)},this)})}h.update=function(a){return a||!0!==("undefined"==typeof this.a?null:(this.a&vh)==vh)?ot(this):(ke(this.logger,this+" already loaded."),sc(!1))};
h.count=function(a){if(a){a=0;for(var b,c=0;b=this.Mc(c);c++)er(b)||"deleted"==dr(b.getData())||a++;return a}return this.data.entry.length};h.toJSON=function(){return{id:this.id,key:this.sg(),last_fetch_next_uri:this.i,last_fetch:this.b}};function pt(a){var b,c=a.match(/^\D*0*(\d{1,2}\D)?\D*0*(.+)/);c?(b=c[1].replace(/\D/g,""),a=c[2].replace(/\D/g,"")):a=a.replace(/\D/g,"");return{rb:b,bb:a}}function qt(a,b){var c=pt(a),d=pt(b);if(t(c.rb)&&t(d.rb)&&0!=c.rb.length&&0!=d.rb.length&&c.rb!==d.rb)return 0;if(t(c.ab)&&0!=c.ab.length){if(t(d.ab)&&0!=d.ab.length){if(c.ab.length>=d.ab.length){for(var e=0;e<d.ab.length;e++)if(c.ab[e]!=d.ab[e])return 0;return 1}for(e=0;e<c.ab.length;e++)if(c.ab[e]!=d.ab[e])return 0}return-1}return 1}
function rt(a,b){if(!a||!b||0==a.length||0==b.length)return 0;a=a.trim();b=b.trim();var c=pt(a),d=pt(b);return c.rb&&c.bb&&c.rb==d.rb&&c.bb==d.bb?6<=c.bb.length?1:4<=c.bb.length?.8:.4:c.bb&&4<=c.bb.length&&c.bb==d.bb?8<=c.bb.length?.8:4<=c.bb.length?.6:.4:0};function st(a){ar.call(this,a);a=(a=this.id.match(/https?:\/\/www.google.com\/m8\/feeds\/(group|contact|batch)s?\/([^\/]+)\/?(\w+)\/?(\w*)?/))?{ck:"m8",kind:a[1],user_id:a[2]?a[2].replace("%40","@"):"",projection:a[3],id:a[4]}:null;window.console.assert(!!a,"Invalid m8 entry: "+this.id);this.user_id=a.user_id;window.console.assert(a.kind==this.kind,"Invalid kind: "+a.kind+" vs "+this.kind)}A(st,ar);st.prototype.logger=L("ydn.gdata.m8.Entry");st.prototype.a="3.0";st.prototype.type="m8";
st.prototype.toString=function(){var a=this.id?br(this):void 0;return"m8.Entry."+this.kind+":"+a};function tt(a){if(!t(this.kind))throw new Bi("Abstract class cannot be instantiated.");it.call(this,a);this.user_id=this.s()}A(tt,it);h=tt.prototype;h.tg=function(){return this.kind};h.Uh="3.0";h.type="m8";h.toString=function(){return"Feed:"+this.kind+":"+this.user_id};h.Ue=function(){return"https://www.google.com/m8/feeds/"+this.tg()+"s/"+this.user_id.replace("@","%40")+"/full?v=3.0"};
h.pf=function(){var a=tt.f.pf.call(this);return a?a:"https://www.google.com/m8/feeds/"+this.tg()+"s/"+this.user_id.replace("@","%40")+"/full/batch?v=3.0"};var ut=ht.concat(["gContact"]);tt.prototype.Wg=function(){return ut};function vt(a,b,c,d,e,f){this.scheme=a;this.domain=b;this.module=c;this.a=d;this.c=ha(e)?e:NaN;this.b=ha(f)?f:NaN}var Ws="sugarcrm";function wt(a,b){var c=xt(a);if(!c)return null;var d=NaN,e=NaN;if(v(b)){var f=b.indexOf("#"),g=b.indexOf("-");0<f&&0<g&&g>f&&(d=parseInt(b.substring(f,g),10),e=parseInt(b.substring(g),10))}return new vt(c[1],c[2],c[3],c[4],d,e)}function yt(a){return x(a)&&v(a.value)?wt(a.value,a.label):null}function xt(a){return a?a.match(/(\w+):\/\/([^\/]+)\/([^\/]+)\/(.*)/):null}
vt.prototype.K=function(){return this.scheme+"://"+this.domain+"/"+this.module+"/"+this.a};function zt(a){st.call(this,a)}A(zt,st);h=zt.prototype;h.kind="contact";h.logger=L("ydn.gdata.m8.ContactEntry");h.Se=function(){return"contact"};h.getName=function(a){var b=a?"":this.Cd();if(a||0==b.length)a=this.getData().gd$name,x(a)&&(b=a.gd$fullName.$t||"",0==b.length&&(b=(a.gd$givenName.$t||"")+" "+(a.gd$familyName.$t||"")));return Aa(b)};function At(a){var b=a.data.gd$email;a=[];for(var b=u(b)?b:b?[b]:[],c=0;c<b.length;c++)a.push(b[c].address);return a}
function Bt(a){a=a.data.gd$phoneNumber;a=u(a)?a:x(a)?[a]:[];for(var b=[],c=0;c<a.length;c++)a[c].$t&&!ya(a[c].$t)&&b.push(a[c].$t);return b}h.rf=function(){var a=zt.f.rf.call(this);if(a.ydn$emails||a.ydn$xp||a.ydn$externalIds)a==this.data&&(a=Am(this.data)),delete a.ydn$emails,delete a.ydn$xp,delete a.ydn$externalIds;return a};function Ct(a,b){return"https://mail.google.com/mail/u/"+(b||0)+"/#contact/"+br(a)}h.Ic="link category gd$email gd$im gd$organization gd$phoneNumber gd$structuredPostalAddress gd$formattedAddress".split(" ");
function Dt(a,b){function c(a){var b=hb(e,function(b){return b.address===a.address});b?b.rel=t(a.rel)?a.rel:b.rel:d(a)}function d(a){a=Am(a);f&&delete a.primary;t(void 0)&&(a.rel=void 0);e.push(a)}for(var e=[Am(a.data.gd$email[0])],f=!!a.data.gd$email[0].primary,g=1;g<a.data.gd$email.length;g++)c(a.data.gd$email[g]);for(g=0;g<b.length;g++)c(b[g]);g=hm(e,a.data.gd$email);g||(a.data.gd$email=e);return!g}
function Et(a,b){function c(a){var b=db(e,function(b){return rt(b.$t,a.$t)}),c=Mi(b);if(.4<c.value){var b=e[c.index],f=t(a.rel)?a.rel:b.rel;1==c.value?(b.rel=f,b.$t=a.$t):t(a.rel)&&t(b.rel)&&b.rel!==a.rel?d(a,f):(b.rel=f,c=qt(b,a),-1==c?b.$t=a.$t:0==c&&(b.$t=a.$t))}else d(a)}function d(a,b){a=Am(a);f&&delete a.primary;t(b)&&(a.rel=b);e.push(a)}for(var e=[Am(a.data.gd$phoneNumber[0])],f=!!a.data.gd$phoneNumber[0].primary,g=1;g<a.data.gd$phoneNumber.length;g++)c(a.data.gd$phoneNumber[g]);for(g=0;g<
b.length;g++)c(b[g]);g=hm(e,a.data.gd$phoneNumber);g||(a.data.gd$phoneNumber=e);return!g}h.Xf=function(a,b){if("gd$phoneNumber"==a){if(null!=this.data.gd$phoneNumber)return Et(this,b);this.data.gd$phoneNumber=Am(b);return!0}if("gd$email"==a){if(null!=this.data.gd$email)return Dt(this,b);this.data.gd$email=Am(b);return!0}return zt.f.Xf.call(this,a,b)};
function Vs(a,b,c,d,e){a=a.getData();a=u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:[];for(var f=0;f<a.length;f++){var g=yt(a[f]);if(g&&!(b&&b!=g.scheme||c&&c!=g.domain||e&&e!=g.a||d&&d!=g.module))return g}return null}function Ys(a){a=a.getData();a=u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:[];for(var b=[],c=0;c<a.length;c++){var d=yt(a[c]);d&&b.push(d)}return b};function Ft(a){tt.call(this,a)}A(Ft,tt);h=Ft.prototype;h.logger=L("ydn.gdata.m8.ContactFeed");h.kind="contact";h.ug=function(){Ft.f.ug.call(this)};h.rg=function(a){return Ft.f.rg.call(this,a)};h.Te=function(a){return new zt(a)};h.Mc=function(a){return Ft.f.Mc.call(this,a)};h.Ue=function(){return"https://www.google.com/m8/feeds/contacts/"+this.s()+"/full"};h.sg=function(){return"http://www.google.com/m8/feeds/contacts/"+this.s().replace("@","%40")};function Gt(a){function b(a){va(a,"atom:")&&(a=a.substring(5,a.length));return a.replace("#text","$t").replace(/:/g,"$")}v(a)&&(a=ui(a));var c={};if(1==a.nodeType){if(0<a.attributes.length)for(var d=0;d<a.attributes.length;d++){var e=a.attributes.item(d);c[b(e.nodeName)]=e.value}}else 3==a.nodeType&&(c=a.nodeValue);if(a.hasChildNodes())for(d=0;d<a.childNodes.length;d++){var e=a.childNodes.item(d),f=b(e.nodeName);if("undefined"==typeof c[f])"content"==f?(c[f]={$t:vi(e)},e.namespaceURI&&(c[f].xmlns=
e.namespaceURI)):c[f]=Gt(e);else{if("undefined"==typeof c[f].length){var g=c[f];c[f]=[];c[f].push(g)}c[f].push(Gt(e))}}return c};function Ht(a,b){this.id=b.replace("@","%40");this.client=this.a=null;this.c=new sh(function(){je(this.logger,"updating gdata "+this);It(this).m(function(a){this.logger.info(this+" synced, "+a+" new entries updated.")},function(){ie(this.logger,this+" update failed.")},this)},6E4,this);this.d=a;this.b=null}h=Ht.prototype;h.logger=L("ydn.ds.gdata.GData");h.update=function(){th(this.c)};h.I=function(){return this.d};
function Jt(a){var b=new B;a.execute(function(a,d){a?b.callback(a):b.p(d)});return b}
function Kt(a,b){var c=(a.client?a.client:Oi("gse")).request(b);return Jt(c).m(function(a){a=a.feed;if(!a.entry)return 0;for(var b=(new Ft(a)).Kj("next"),c=a.entry.length,g=!!this.b,k=0;g&&k<c;k++){var l=a.entry[k];l.gContact$externalId&&this.b(l)}return this.I().put(this.D(),a.entry).n(function(){return b?Kt(this,new Qi(b.href)).n(function(a){return c+a},this):c},this)},function(a){ie(this.logger,"fetching fail "+(a?a.H()+" "+a.Da():""))},a)}h.getParams=function(){return{alt:"json"}};
h.get=function(a){return v(a)&&0!=a.length?this.I().get(this.D(),a):C("invalid key")};h.put=function(a){return this.I().put(this.D(),a)};h.Th=function(a){return new ar(a)};function Lt(a,b){var c=a.Th(b);cr(c,"modified");return c.Ng().n(function(a){a=Gt(a);var b=a.entry;if(!b||!b.id)throw Error("Invalid respond on saving gdata "+Dh(a));delete b.updated;this.I().put(this.D(),b);return b},a)}
function It(a){if(!a.I().getName())return C(Error("database not ready"));if(!a.a){var b=new Zm(a.D(),"updated.$t",null,!0);a.a=a.I().keys(b,1).n(function(a){var b=this.getParams();b.orderby="lastmodified";a[0]?(b.sortorder="descending",a=(new Date(1+ +new Date(a[0]))).toISOString(),b["updated-min"]=a):b.sortorder="ascending";return Kt(this,new Qi(Mt(this)+"/full","GET",b)).V(function(){this.a=null},this)},a)}return a.a}h.toString=function(){return"GData:contact:"+this.id.replace("%40","@")};function Nt(a,b){Ht.call(this,a,b)}A(Nt,Ht);Nt.prototype.D=function(){return"contact"};Nt.prototype.getParams=function(){var a=Nt.f.getParams.call(this);a.v="3.0";return a};function Mt(a){return"https://www.google.com/m8/feeds/contacts/"+a.id}Nt.prototype.Th=function(a){var b=!!a.id;b||(a.id={$t:Mt(this)+"/base/0"});var c=new zt(a);b||delete a.id;return c};function Ot(a,b){return v(b)?0==b.length?sc([]):a.I().$(a.D(),"ydn$emails",U.only(b),100,0,!1,!0):C("invalid key for email "+b)}
function Pt(a,b){var c=b.K();if(!v(c)||0==c.length)return C("invalid key for external id "+c);c=U.only(c);return a.I().$(a.D(),"ydn$externalIds",c)}
function Qt(a,b,c){return a.I().get(a.D(),b).n(function(a){if(a){if(!c||!c.label||!c.value)return C("invalid external_id_data");var e=c.label,f=c.value;a.gContact$externalId=u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:[];for(var g=!1,k=0;k<a.gContact$externalId.length;k++)if(a.gContact$externalId[k].value==f){a.gContact$externalId[k].label=e;g=!0;break}g||a.gContact$externalId.push({label:e,value:f});return Lt(this,a)}throw Error("gdata entry "+b+" not found");
},a)}function Rt(a,b,c){return a.I().get(a.D(),b).n(function(a){if(a){a.gContact$externalId=u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:[];for(var e=!1,f=0;f<a.gContact$externalId.length;f++)if(a.gContact$externalId[f].value==c){a.gContact$externalId.splice(f,1);e=!0;break}if(!e)throw Error("ExternalId value "+c+" not found.");return Lt(this,a)}throw Error("gdata entry "+b+" not found");},a)};function St(a){var b=document.querySelector('span[name="me"][email]');if(b)return b=b.getAttribute("email"),sc(b);if(b=document.title.match(/- (\S+@\S+\.\S+) -/))return sc(b[1]);a--;var c=new B;0<a?setTimeout(function(){nc(St(a),c)},500):c.p(null);return c}function Tt(){if("https://mail.google.com"!=location.origin)return C(null);document.querySelector('span[name="me"][email]');return St(3).Hc(function(){return Ut()})}
function Ut(){if("https://mail.google.com"!=location.origin)return C("");var a=new Qi("https://mail.google.com/mail/feed/atom/bazinga","GET",{zx:"124"}),a=Oi("default").request(a),b=new B;window.setTimeout(function(){b.b||(b.p(),b=null)},2E3);a.execute(function(a,d){if(b)if(Ti(d)){var e=Wj(d).match(/<title>(.+?)(\S+)<\/title>/);e?b.callback(e[2]):b.p()}else b.p()});return b}
function Vt(){var a=window.location.pathname.match(/^\/mail\/[^\/]+\/(\d+)\//);return a?(a=parseInt(a[1],10),isNaN(a)?0:a):0};function Wt(a,b){this.a=new nn(a,b);this.e=Pm(b);this.d=new sh(this.update,2E3,this);$f(function(){th(this.d)},2500,this);this.c=b.Q(this.a,"BeaconTrack");this.b=b.Q(this.a,"AccessTokenRecord")}Wt.prototype.logger=L("ydn.crm.tracking.Client");
Wt.prototype.update=function(){re(this.logger,"Updating tracking data");var a=this.c.update().m(function(a){re(this.logger,a+" new track points received.")},function(a){M(this.logger,"error on updating beacon points",a)},this),b=this.b.update().m(function(a){re(this.logger,a+" new access points received.")},function(a){M(this.logger,"error on updating access data",a)},this);return zn([a,b])};
function Xt(a,b){if(!x(b))return C("Invalid parameters object.");var c=b.storeName,d="";if("BeaconTrack"==c)d="path";else if("AccessTokenRecord"==c)d="Path";else return C("invalid storeName: "+c);var e=null;if(b.keyRange){if(e=Ok(b.keyRange))return C("invalid keyRange: "+e);e=Mk(b.keyRange)}return a.e.He(c,d,e,5E3,0,!0)};/*
 Copyright 2014 YDN Authors, Yathit. All Rights Reserved.
 GNU Lesser General Public License (Version 3).
*/
function Yt(){this.a={};this.b=null;var a=this.C=Si.B(),b=chrome.extension.getURL("option-page.html");a.i=b;this.t=new ip;this.c=this.h=this.d=this.i=this.r=null;this.l=new ih(new mh,"XMLHttpRequest"+location.host);this.e={};this.P=new Tf(this);chrome.permissions.onAdded.addListener(this.Si.bind(this))}h=Yt.prototype;h.logger=L("ydn.crm.app.App");
h.Si=function(a){for(var b=(a=a.origins)?a.length:0,c=0;c<b;c++){var d=a[c].match(/https:\/\/([^\/]+)/);if(d){var d=d[1],e=this.a[d];if(e){je(this.logger,"host permission granted to "+e);if(e.e instanceof xp){var f=Oi("default");this.a[d]=new Ds(f,e.G,e.i,e.h,e.C);this.a[d].update()}Zt(this,{req:"host-permission",data:{grant:d}})}}}};
h.init=function(){K(this.logger,"init "+this);Yp();chrome.runtime.onInstalled.addListener(function(a){Lj({event:"onInstalled",details:a,version:"1.3.3","install-id":Sp})});setTimeout(function(){},6E4*(.5+Math.random()))};function $t(a,b){return Es(b).n(function(){var a=b.c,d=b.isLogin()?b.h+"@":" (not login) ";this.logger.info("connected to sugarcrm client: "+d+a);b.isLogin()&&(b.update(),au(this));d=b.about();Qp("sugar-login",a);this.P.listen(b,$s,this.eh);return d},a)}h.eh=function(a){a.target.about()};
function bu(a,b){var c=b.baseUrl,d=b.domain||c;if(!d)return C("domain or url required.");d=d.trim();va(d,"http")&&(d=Ve(new Ge(d)));/\//.test(d)&&(d=Ve(new Ge("https://"+d)));if(c&&(c=c.trim(),!va(c,"http"))){var c=c.replace(/:?\/\//,""),e=new Ge("https://"+c);e.yc||Ke(e,"/");c=e.toString()}var f=a.a[d],g="sugar-client-"+d,k=a.l.get(g)||{};Kj.log({event:"sugar-init",details:{domain:d}});if(f)return f.isLogin()?sc(f.about()):$t(a,f);var l=b.userName||k.userName;c||(c=k.base_url);c||(c="https://"+d+
"/");if(!l)return K(a.logger,"username not found in "+JSON.stringify(b)),C("username required");var m=b.password;m?b.hashed||(m=CryptoJS.MD5(m).toString()):m=k.password;if(!m)return K(a.logger,"password not found in "+JSON.stringify(b)),C("password required.");k.userName=l;k.password=m;k.base_url=c;var e={origins:[c+"/"]},n=new B;chrome.permissions.contains(e,function(b){b||ie(a.logger,"host permission required for "+c);b=b?Oi("default"):Oi("proxy");f=new Ds(b,a,c,l,m);a.a[d]=f;b=$t(a,f);b.n(function(){a.l.set(g,
k);var b=Object.keys(a.a);pp(a.t,b);Zt(a,{req:"list-sugarcrm-domains",data:b})},a);nc(b,n)});return n}function cu(a,b,c,d){return 0<=Mr.indexOf(b)?a.b.get(c).n(function(a){if(a){var f=Rr(b);return Zs(d,f,a).n(function(a){if(a&&a.id)return a;throw Error("Set Entry to "+f+" failed");},this)}throw Error("contact entry "+c+" not found");},a):C(new wi("invalid module name "+b))}
function du(a,b){var c=new qs(b.domain,b.module,b.obj),d={};As(c,d);c=new vt(Ws,c.domain,c.module,c.s(),NaN,ss(c));d.gContact$externalId=[{label:c.module+"#"+c.c+"-"+c.b,value:c.K()}];return Lt(a.b,d)}function Js(a,b){var c=new vt(Ws,b.domain,b.module,b.s());Pt(a.b,c).n(function(a){for(var c=0;c<a.length;c++){var f=a[c];0<As(b,f)&&this.b.put(f)}},a)}function au(a){for(var b in a.a)if(a.a[b].isLogin())break}
h.sendRequest=function(a){if(!a||!v(a.path))return C('"path" required');var b=a.path;if(!{track:{}}[b])return C('invalid "path": '+b);var c=a.method||"GET";if(-1==["GET","POST","PUT","DELETE"].indexOf(c))return C('invalid "method"');a=Yp().request(new Qi("/"+b,c,null,{"Content-Type":"application/json"},a.body));var d=new B;a.execute(function(a,b){d.callback({headers:b.Nc(),body:Wj(b),status:b.H()})},this);return d};
function eu(a,b){if(!b)return C("domain required");a.l.remove("sugar-client-"+b);Kj.log({event:"sugar-rm",details:{domain:b}});return op(a.t).n(function(a){a=a||[];var d=a.indexOf(b),e=this.a[b];this.P.X(e,$s,this.eh);e.S();delete this.a[b];0<=d&&(a.splice(d,1),pp(this.t,a),Zt(this,{req:"list-sugarcrm-domains",data:a}));return e.isLogin()?at(e).n(function(){this.logger.info("SugarCRM "+b+" removed.");au(this);return!0},this):!1},a)}
h.bj=function(a){for(var b=u(a.gContact$externalId)?a.gContact$externalId:[a.gContact$externalId],c=0;c<b.length;c++)if(b[c]&&b[c].value&&b[c].label){var d=xt(b[c].value);d&&"sugarcrm"==d[1]&&(d=d[2],this.a[d]&&Xs(this.a[d],new zt(a)))}};function fu(a){a.b=new Nt(a.t.a,a.c.email);var b=Oi("gse");a.b.client=b;a.b.b=a.bj.bind(a);a.b.update()}
function gu(a,b){var c=new B,d=b.email||"";if(a.c&&a.c.email==d)return K(a.logger,"already running for "+d),c.callback(a.c),c;a.c=b;a.c.updated=z();d?(a.logger.info(d+" login to YDN server"),Xp(a),jp(a.t,b.Id.$t),a.r=new Wt(Yp(),a.t.b),fu(a),op(a.t).n(function(a){a=a||[];for(var b=0;b<a.length;b++)a[b]&&bu(this,{domain:a[b]})},a)):a.logger.info("Not login to YDN server");c.callback(a.c);return c}
function hu(a){var b=new B;$p().request(new Qi("/token","DELETE")).execute(function(a,d){Ti(d)?(this.d=this.i=null,b.callback(null)):b.p("error "+d.Da())},a);return b}
function iu(a,b){var c=x(b)?b:{last_login:"1"},d=$p(),c=new Qi("/audit","GET",c),e=new B;d.request(c).execute(function(a,b){if(Ti(b)){if(a.LastLoginRecord){var c=a.LastLoginRecord;if(c.timestamp){var d;d=c.timestamp-z();d=Math.abs(d);if(6E4>d)d="0 minutes";else{var m=Math.floor(d/864E5);d%=864E5;var n=Math.floor(d/36E5),p=Math.floor(d%36E5/6E4),q=df(m),s=df(n),w=df(p);d=m*(n+p)?" ":"";var y=n*p?" ":"",m=Sf("{COUNT, plural, =0 {}=1 {{TEXT} day}other {{TEXT} days}}",m,q),n=Sf("{COUNT, plural, =0 {}=1 {{TEXT} hour}other {{TEXT} hours}}",
n,s),p=Sf("{COUNT, plural, =0 {}=1 {{TEXT} minute}other {{TEXT} minutes}}",p,w);d=m+(d+(n+(y+p)))}c.ago=d}}e.callback(a)}else e.p(b)},a);return e}
function wn(a,b){if(a.d)return a.d;if(a.i&&a.i.expires>z())return sc(a.i);if(!a.isLogin())return C(Error("Not login"));a.d=new B;var c={url:b||chrome.extension.getURL("option-page.html")},c=new Qi("/token","GET",c);$p().request(c).execute(function(a,b){if(Ti(b)){var c=a.Tokens[0];c.has_token?(c.expires=1E3*c.expires_in+z(),this.i=c,this.d.callback(c)):this.d.p(c)}else this.i=null,this.d.p(b);this.d=null},a);return a.d}
function ju(a){function b(a){return ib(c,function(b){return b.email==a})}for(var c=[],d=0;d<a.length;d++){var e=a[d].user.raw;0<=b(e.name)||c.push({email:e.name,region:a[d].region,dk:new Date(a[d].timestamp)})}return c}h.ji=function(a){var b=new Qi("/admin");Yp().request(b).execute(function(b){if(a)a(b);else{b=b.LoginRecords;var d=ju(b);window.console.table(d);window.console.info(b.length+" records since "+(new Date(b[b.length-1].timestamp)).toLocaleDateString())}},this)};
function Zt(a,b){delete b.id;for(var c in a.e)a.e[c].port.postMessage(b)}h.isLogin=function(){return!!this.c&&this.c.is_login};function ku(a,b){if(a.h)return a.h;a.h=Ui(a.C,b).n(function(a){return gu(this,a).m(function(){var a;if(this.isLogin()){var b=this;a=this.c.email;Zt(b,{req:"login",data:this.c});setTimeout(function(){b.h=null},9E5)}else this.h=null;Qp("login",Sp,a)},function(a){this.logger.info("Attempting to login YDN server fail: "+Dh(a))},this)},a);return a.h}
function lu(a){var b=new B;a.h=null;if(a.c){var c=a.c.logout_url;a.c=null;a.i=null;a.d=null;a.b=null;var d=new XMLHttpRequest;d.open("GET",c,!0);d.onload=function(){Zt(a,{req:"logout"});d=null};d.send();b.callback(!0)}else b.callback(!1);return b}h.toString=function(){return"SugarApp:1.3.3"};function mu(){Yt.call(this);nu(this)}A(mu,Yt);mu.prototype.logger=L("ydn.crm.app.EventPage");
function ou(a,b,c){var d=c.req;c.done=!0;var e=null!=c.data?c.data:{};K(a.logger,"service req: "+d+":"+c.id);if("app-setting"==d)c.data=r.localStorage.getItem("app-setting"),b.postMessage(c);else if("echo"==d)K(a.logger,"resp: "+d+":"+c.id),b.postMessage(c);else if("export-record"==d)du(a,e).m(function(c){K(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(a){this.data=a;this.error="failed to create a new entry";b.postMessage(this)},c);else if("feed-log"==d){var f=
e.offset||0,e=e.limit||100;Ep.a.$("db-logger",null,e||100,f||0,!0).V(function(c){K(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c)}else if("feed-log-info"==d)f=e.offset||0,e=e.limit||100,Gp(e,f).V(function(c){K(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c);else if("gdata-list-contact"==d)t(e.email)?Ot(a.b,e.email).m(function(c){K(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){K(a.logger,"resp: "+this.req+
":"+this.id);this.error=c;b.postMessage(this)},c):v(e.externalId)?(f=e.externalId,e=wt(f),e||(K(a.logger,"resp error: "+c.req+":"+c.id),c.data="invalid externalId: "+f,b.postMessage(c)),Pt(a.b,e).m(function(c){K(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){K(a.logger,"resp: "+this.req+":"+this.id);this.error=c;b.postMessage(this)},c)):(K(a.logger,"resp error: "+d+":"+c.id),c.error="email or externalId required for "+d,b.postMessage(c));else if("gdata-token"==
d)wn(a,c.data).V(function(c){K(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c);else if("gdata-token-revoke"==d)hu(a).m(function(c){K(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){K(a.logger,"resp: "+this.req+":"+this.id);this.error=c;b.postMessage(this)},c);else if("gdata-update"==d)f=c.data,"contact"==f?a.b?It(a.b).m(function(a){this.data=a;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},c):(c.error="gdata not ready",
b.postMessage(c)):(c.error="invalid kind "+f,b.postMessage(c));else if("list-sugarcrm"==d){e=[];for(f in a.a)e.push(a.a[f].about());K(a.logger,"resp: "+c.req+":"+c.id);c.data=e;b.postMessage(c)}else if("list-sugarcrm-domain"==d){e=[];for(f in a.a)e.push(f);K(a.logger,"resp: "+c.req+":"+c.id);c.data=e;b.postMessage(c)}else"log"==d?(Lj(c.data),b.postMessage(c)):"login-info"==d?r.navigator.onLine?ku(a,c.data).m(function(c){K(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(a){this.data=
a;this.error="InvalidLoginError:"+(a&&a instanceof Error?a:"");b.postMessage(this)},c):(c.data=a.c,b.postMessage(c)):"logged-in"==d?(ku(a,null).n(function(b){Zt(a,{req:d,info:b})}),b.postMessage(c)):"logged-out"==d?lu(a).V(function(){b.postMessage(c)}):"new-entry"==d?x(c.data)?Lt(a.b,c.data).m(function(c){K(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(a){this.data=a;this.error="failed to create a new entry";b.postMessage(this)},c):(c.error="Invalid gdata entry data",
b.postMessage(c)):"new-sugarcrm"==d?bu(a,c.data).m(function(c){K(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},c):"remove-sugar"==d?eu(a,c.data).V(function(a){this.data=a;b.postMessage(this)},c):"request"==d?a.sendRequest(e).m(function(c){K(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){K(a.logger,"resp error: "+this.req+":"+this.id);this.error=c;b.postMessage(this)},c):"server-audit-log"==
d?iu(a,e).m(function(a){this.data=a;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},c):"social-profile"==d?aq(e).m(function(a){this.data=a;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},c):"sugar-server-info"==d?(f=c.data,f=/https?:/.test(f)?new Ge(f):Ie(new Ge,f),(f=a.a[f.Mb])?Qs(f).n(function(c){K(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c):bt(c.data).m(function(c){K(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},
function(c){K(a.logger,"resp error: "+this.req+":"+this.id+" "+c);this.error=c;b.postMessage(this)},c)):"tracking-query"==d?Xt(a.r,e).m(function(c){K(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){K(a.logger,"resp error: "+this.req+":"+this.id);this.error=c;b.postMessage(this)},c):"tracking-update"==d?a.r.update().m(function(c){K(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){K(a.logger,"resp error: "+this.req+":"+this.id);
this.error=c;b.postMessage(this)},c):ie(a.logger,"Main channel unknown req: "+d)}
function pu(a,b,c,d){var e=d.req;d.done=!0;K(a.logger,"sugar service req: "+c+":"+e+":"+d.id);if(a.isLogin())if("echo"==e)b.postMessage(d);else if("import-gdata"==e){var f=d.data,g=f?f["gdata-id"]:"";g?cu(a,f.module,g,c).m(function(a){this.data=a;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},d):(ie(a.logger,"resp error: "+e+":"+d.id),d.error="gdata id required",b.postMessage(d))}else"link"==e?(c=a.b,(e=d.data["gdata-id"])?(f=d.data["external-id"],Qt(c,e,f).m(function(a){this.data=
a;b.postMessage(this)},function(c){ie(a.logger,"error linking gdata "+this.req+":"+this.id);this.error=c.name+": "+c.message;b.postMessage(this)},d)):(d.error="required gdata-id not found.",b.postMessage(d))):"login"==e?bu(a,d.data).m(function(c){this.data=c;b.postMessage(this);au(a)},function(a){this.error=a;b.postMessage(this)},d):"sync-entry"==e?(e=d.data,a.b.get(e).m(function(c){c?new zt(c):(c="GData entry "+this.data+" not found.",K(a.logger,c),this.error=c,b.postMessage(this))},function(c){K(a.logger,
"resp error: "+this.req+":"+this.id+" "+c);this.error=c;b.postMessage(this)},d)):"unlink"==e?(c=a.b,(e=d.data["gdata-id"])?(f=d.data["external-id"])?Rt(c,e,f).m(function(a){this.data=a;b.postMessage(this)},function(c){ie(a.logger,"error linking gdata "+this.req+":"+this.id);this.error=c.name+": "+c.message;b.postMessage(this)},d):(d.error="required external_id not not found",b.postMessage(d)):(d.error="required gdata-id not found.",b.postMessage(d))):et(c,e,d.data).m(function(c){K(a.logger,"resp: "+
this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){K(a.logger,"resp error: "+this.req+":"+this.id+" "+(c&&c instanceof Error?c.name+" "+c.message:c));this.error=c;b.postMessage(this)},d);else d.error="Not login",b.postMessage(d)}function qu(a){for(var b in a.e)if("gmail"==a.e[b].group)break;for(b in a.a)if(a.a[b].isLogin())break}mu.prototype.Q=function(){var a=Object.keys(this.a)[0];return{du:this.ji.bind(this),sugars:this.a,s0:a?this.a[a]:null,gdata:this.b,ports:this.e,so:cq,user_info:this.c}};
function nu(a){var b="";chrome.runtime.onMessage.addListener(function(c,d,e){var f=d.url;f&&/https?:\/\/mail.google.com/.test(f)?(d=c?c.req:null,"inject"==d&&b!=c.id?(b=c.id,Tp().m(function(b){je(a.logger,"injecting "+b+" to "+f);chrome.tabs.executeScript(null,{file:b},function(){je(a.logger,b+" injected, executing");chrome.tabs.executeScript(null,{code:"app = runInjApp();"},function(){je(a.logger,"Content script executed.")})})},function(a){window.console.error(a)}),e(c)):"attach"==d&&(c=c.parent,
je(a.logger,"attaching crm-ex/sidebar.html to "+c+" in "+f),chrome.tabs.executeScript(null,{code:'var parent = document.getElementById("'+c+'");var f = document.createElement("iframe"); f.src = "crm-ex/sidebar.html"; parent.appendChild(f);'},function(){je(a.logger,"crm-ex/sidebar.html attached");e("crm-ex/sidebar.html")}))):je(a.logger,"invalid sender "+f)});chrome.runtime.onConnect.addListener(function(b){var d=b.sender.url,e=b.name.substr(0,b.name.lastIndexOf("-"));jb(Be,e)?(je(a.logger,"Channel "+
b.name+" connected for "+d),a.e[b.name]={name:b.name,group:e,port:b},qu(a),b.onMessage.addListener(function(d){if(d&&x(d)){if("close"==d.req)a.logger.info("closing "+b.name),delete a.e[b.name],b.disconnect(),qu(a);else if(!d.id){ie(a.logger,"Unknown group in pipe info "+b.name);return}if("sugarcrm"==d.group){var e=d.name,k=a.a[e];k?pu(a,b,k,d):ie(a.logger,"SugarCRM instance "+e+" not found.")}else"gmail"!=d.group&&"dev"!=d.group&&"hostper"!=d.group&&"popup"!=d.group&&"options"!=d.group&&ou(a,b,d)}else ie(a.logger,
"invalid message package: "+d)}),b.onDisconnect.addListener(function(){je(a.logger,"disconnected "+b.name);delete a.e[b.name];qu(a)})):ie(a.logger,"channel "+b.name+" ignored from "+d)});je(a.logger,"event page start listening incoming connection")}function ru(){Vp();var a=new mu;a.init();ku(a);return a}qa("ydn.crm.version","1.3.3");qa("runBackgroundApp",ru);mu.prototype.xp=mu.prototype.Q;D&&Jc(8);Jb("area base br col command embed hr img input keygen link meta param source track wbr".split(" "));function su(){this.a="";this.c=tu;this.b=null}su.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};function uu(a){if(a instanceof su&&a.constructor===su&&a.c===tu)return a.a;Ya("expected object of type SafeHtml, got '"+a+"'");return"type_error:SafeHtml"}Jb("action","cite","data","formaction","href","manifest","poster","src");Jb("link","script","style");var tu={};function vu(a,b){var c=new su;c.a=a;c.b=b;return c}var wu=vu("",0);var xu={fk:!0},yu={gk:!0};function zu(){throw Error("Do not instantiate directly");}zu.prototype.gf=null;zu.prototype.W=function(){return this.content};zu.prototype.toString=function(){return this.content};function Au(a){if(!x(a))return String(a);if(a instanceof zu){if(a.Rd===xu)return a.W();if(a.Rd===yu)return Ca(a.W())}Ya("Soy template output is unsafe for use as HTML: "+a);return"zSoyz"};function Bu(a){if(null!=a)switch(a.gf){case 1:return 1;case -1:return-1;case 0:return 0}return null}function Cu(){zu.call(this)}A(Cu,zu);Cu.prototype.Rd=xu;function Du(a){return null!=a&&a.Rd===xu?a:a instanceof su?Eu(uu(a),a.b):Eu(Ca(String(String(a))),Bu(a))}var Eu=function(a){function b(a){this.content=a}b.prototype=a.prototype;return function(a,d){var e=new b(String(a));void 0!==d&&(e.gf=d);return e}}(Cu);
(function(a){function b(a){this.content=a}b.prototype=a.prototype;return function(a,d){var e=String(a);if(!e)return"";e=new b(e);void 0!==d&&(e.gf=d);return e}})(Cu);function Fu(a){null!=a&&a.Rd===xu?(a=a.W(),a=String(a).replace(Gu,"").replace(Hu,"&lt;"),a=String(a).replace(Iu,Ju)):a=Ca(String(a));return a}
var Ku={"\x00":"&#0;","\t":"&#9;","\n":"&#10;","\x0B":"&#11;","\f":"&#12;","\r":"&#13;"," ":"&#32;",'"':"&quot;","&":"&amp;","'":"&#39;","-":"&#45;","/":"&#47;","<":"&lt;","=":"&#61;",">":"&gt;","`":"&#96;","\u0085":"&#133;","\u00a0":"&#160;","\u2028":"&#8232;","\u2029":"&#8233;"};function Ju(a){return Ku[a]}var Iu=/[\x00\x22\x27\x3c\x3e]/g,Gu=/<(?:!|\/?([a-zA-Z][a-zA-Z0-9:\-]*))(?:[^>'"]|"[^"]*"|'[^']*')*>/g,Hu=/</g;function Lu(){return Eu('<div class="setting-dialog"><form class="basic-setting"><div><input type="checkbox" name="log-on-console"/> Log on console<br /></div><div class="group-panel" style="display: none"><div>Gmail context panel location</div>\x3c!-- see this value in ydn.crm.ui.ContextPanelPosition --\x3e<input type="radio" name="context-panel-position" value="in"/> Inline<br /><input type="radio" name="context-panel-position" value="st"/> Stick on right side<br /><input type="radio" name="context-panel-position" value="wg"/> Inside widget panel<br /></div></form></div>')}
Lu.a="templ.ydn.crm.inj.setting";function Mu(a){return Eu("<div>Current you are login as "+Du(a.Nj)+" to Yathit server.</div>")}Mu.a="templ.ydn.crm.inj.wrongLogin";var Nu=xc||Ki||Ji;function Ou(){}da(Ou);Ou.prototype.a=0;function Pu(a){return"y:"+(a.a++).toString(36)};function X(a){F.call(this);this.b=a||Lh();this.ta=Qu;this.ja=null;this.U=!1;this.w=null;this.Qb=void 0;this.i=this.e=this.h=this.a=null}A(X,F);X.prototype.wg=Ou.B();var Qu=null;function Ru(a,b){switch(a){case 1:return b?"disable":"enable";case 2:return b?"highlight":"unhighlight";case 4:return b?"activate":"deactivate";case 8:return b?"select":"unselect";case 16:return b?"check":"uncheck";case 32:return b?"focus":"blur";case 64:return b?"open":"close"}throw Error("Invalid component state");}h=X.prototype;
h.s=function(){return this.ja||(this.ja=Pu(this.wg))};h.g=function(){return this.w};function Y(a){a.Qb||(a.Qb=new Tf(a));return a.Qb}function Su(a,b){if(a==b)throw Error("Unable to set parent component");if(b&&a.h&&a.ja&&Tu(a.h,a.ja)&&a.h!=b)throw Error("Unable to set parent component");a.h=b;X.f.Ce.call(a,b)}h.Aa=function(){return this.h};h.Ce=function(a){if(this.h&&this.h!=a)throw Error("Method not supported");X.f.Ce.call(this,a)};h.J=function(){this.w=this.b.createElement("div")};
h.render=function(a){Uu(this,a)};function Uu(a,b,c){if(a.U)throw Error("Component already rendered");a.w||a.J();b?b.insertBefore(a.w,c||null):a.b.a.body.appendChild(a.w);a.h&&!a.h.U||a.A()}h.A=function(){this.U=!0;Vu(this,function(a){!a.U&&a.g()&&a.A()})};h.ka=function(){Vu(this,function(a){a.U&&a.ka()});this.Qb&&this.Qb.removeAll();this.U=!1};
h.u=function(){this.U&&this.ka();this.Qb&&(this.Qb.S(),delete this.Qb);Vu(this,function(a){a.S()});this.w&&ai(this.w);this.h=this.a=this.w=this.i=this.e=null;X.f.u.call(this)};h.R=function(a,b){this.Hd(a,Wu(this),b)};
h.Hd=function(a,b,c){if(a.U&&(c||!this.U))throw Error("Component already rendered");if(0>b||b>Wu(this))throw Error("Child component index out of bounds");this.i&&this.e||(this.i={},this.e=[]);if(a.Aa()==this){var d=a.s();this.i[d]=a;lb(this.e,a)}else{var d=this.i,e=a.s();if(e in d)throw Error('The object already contains the key "'+e+'"');d[e]=a}Su(a,this);pb(this.e,b,0,a);a.U&&this.U&&a.Aa()==this?(c=this.L(),c.insertBefore(a.g(),c.childNodes[b]||null)):c?(this.w||this.J(),b=Xu(this,b+1),Uu(a,this.L(),
b?b.w:null)):this.U&&!a.U&&a.w&&a.w.parentNode&&1==a.w.parentNode.nodeType&&a.A()};h.L=function(){return this.w};function Yu(a){null==a.ta&&(a.ta=tj(a.U?a.w:a.b.a.body));return a.ta}function Wu(a){return a.e?a.e.length:0}function Tu(a,b){return a.i&&b?Eb(a.i,b)||null:null}function Xu(a,b){return a.e?a.e[b]||null:null}function Vu(a,b,c){a.e&&bb(a.e,b,c)}function Zu(a,b){return a.e&&b?$a(a.e,b):-1}
h.removeChild=function(a,b){if(a){var c=v(a)?a:a.s();a=Tu(this,c);if(c&&a){var d=this.i;c in d&&delete d[c];lb(this.e,a);b&&(a.ka(),a.w&&ai(a.w));Su(a,null)}}if(!a)throw Error("Child is not in parent component");return a};function $u(){X.call(this);this.P=new Tf(this);this.c=null}A($u,X);h=$u.prototype;h.J=function(){$u.f.J.call(this);var a=this.g();a.classList.add("crm-template");a.classList.add("inj");a.classList.add("ydn-crm")};function av(a){a=a.g();return ni(a,"FORM")}function bv(a){for(a=av(a).nextElementSibling;a&&"TABLE"!=a.tagName;)a=a.nextElementSibling;return a}
function cv(a){a=(a=av(a).querySelector("textarea[name=to]"))?a.parentElement:null;if(!a)return[];a=a.querySelectorAll("span[email]");for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c].getAttribute("email");e&&b.push(e)}return b}function dv(a){a=bv(a);var b=a.querySelector('div[aria-label="Message Body"]');b||(b=a.querySelector("div[g_editable=true]"));return b}
h.A=function(){$u.f.A.call(this);var a;a:{a=bv(this).querySelectorAll('div[role="button"]');for(var b=a.length-1;0<=b;b--){var c=a[b],d=c.getAttribute("aria-label");if(d&&(0<d.indexOf("Enter)")||0<d.indexOf("Send)"))){a=c;break a}}a=null}a?this.P.listen(a,"mousedown",this.nj):window.console.warn("Send button not found");(a=dv(this))?(this.c=new ev(a),this.P.listen(this.c,fv,this.jj)):window.console.warn("message body not found");(a=(a=gv(this.g()))?a.querySelector("img ~ img ~ img"):null)?this.P.listen(a,
"mousedown",this.bg):window.console.warn("Close button not found")};h.nj=function(){this.dispatchEvent(new hv(this));this.bg()};h.bg=function(){this.dispatchEvent(new iv(this))};h.jj=function(a){a.a==jv&&(Nu&&a.metaKey||!Nu&&a.ctrlKey)&&(this.dispatchEvent(new hv(this)),this.bg())};function gv(a){return a?"dialog"==a.getAttribute("role")?a:gv(a.parentElement):null}h.u=function(){this.c.S();this.c=null;$u.f.u.call(this)};
function kv(){for(var a=document.querySelectorAll('input[name="subjectbox"]'),b=0;b<a.length;b++){var c=a[b],d=c.getAttribute("data-ydn-subjectbox");if(!d)return d="tag"+z(),c.setAttribute("data-ydn-subjectbox",d),c}return null}function hv(a){E.call(this,"es",a)}A(hv,E);function iv(a){E.call(this,"cc",a)}A(iv,E);$u.prototype.toString=function(){var a;a:{if(a=this.g())if(a=a.querySelector('input[name="subjectbox"]')){a=a.getAttribute("data-ydn-subjectbox");break a}a=""}return"AnchorContainer-"+a};function lv(a){F.call(this);this.P=new Tf(this);this.a=[];this.P.listen(a,mv,this.c)}A(lv,F);lv.prototype.logger=L("ydn.crm.gmail.ComposeObserver");lv.prototype.c=function(a){"cp"==a.c&&nv(this)};lv.prototype.b=function(a){a=a.target;lb(this.a,a)||window.console.warn("Cannot remove "+a);a.S()};function nv(a){var b=kv();b?$f(function(){var a=new $u;Uu(a,b.parentNode,b);this.P.listen(a,"cc",this.b);this.a.push(a);this.dispatchEvent(new ov(a,this))},200,a):M(a.logger,"compose toolbar not found.")}
function ov(a,b){E.call(this,"nc",b);this.c=a}A(ov,E);var pv;function qv(a,b){b?a.setAttribute("role",b):a.removeAttribute("role")}function rv(a,b,c){u(c)&&(c=c.join(" "));var d="aria-"+b;""===c||void 0==c?(pv||(pv={atomic:!1,autocomplete:"none",dropeffect:"none",haspopup:!1,live:"off",multiline:!1,multiselectable:!1,orientation:"vertical",readonly:!1,relevant:"additions text",required:!1,sort:"none",busy:!1,disabled:!1,hidden:!1,invalid:"false"}),c=pv,b in c?a.setAttribute(d,c[b]):a.removeAttribute(d)):a.setAttribute(d,c)}
function sv(a,b){var c=a.getAttribute("aria-"+b);return null==c||void 0==c?"":String(c)};var jv=13;function tv(a,b,c,d,e){if(!(D||Cc&&Jc("525")))return!0;if(xc&&e)return uv(a);if(e&&!d)return!1;ha(b)&&(b=vv(b));if(!c&&(17==b||18==b||xc&&91==b))return!1;if(Cc&&d&&c)switch(a){case 220:case 219:case 221:case 192:case 186:case 189:case 187:case 188:case 190:case 191:case 192:case 222:return!1}if(D&&d&&b==a)return!1;switch(a){case jv:return!0;case 27:return!Cc}return uv(a)}
function uv(a){if(48<=a&&57>=a||96<=a&&106>=a||65<=a&&90>=a||Cc&&0==a)return!0;switch(a){case 32:case 63:case 107:case 109:case 110:case 111:case 186:case 59:case 189:case 187:case 61:case 188:case 190:case 191:case 192:case 222:case 219:case 220:case 221:return!0;default:return!1}}function vv(a){if(Bc)a=wv(a);else if(xc&&Cc)a:switch(a){case 93:a=91;break a}return a}
function wv(a){switch(a){case 61:return 187;case 59:return 186;case 173:return 189;case 224:return 91;case 0:return 224;default:return a}};function ev(a,b){F.call(this);a&&xv(this,a,b)}A(ev,F);h=ev.prototype;h.w=null;h.oe=null;h.Pf=null;h.pe=null;h.Ra=-1;h.Tb=-1;h.Ze=!1;
var fv="key",yv={3:jv,12:144,63232:38,63233:40,63234:37,63235:39,63236:112,63237:113,63238:114,63239:115,63240:116,63241:117,63242:118,63243:119,63244:120,63245:121,63246:122,63247:123,63248:44,63272:46,63273:36,63275:35,63276:33,63277:34,63289:144,63302:45},zv={Up:38,Down:40,Left:37,Right:39,Enter:jv,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"U+007F":46,Home:36,End:35,PageUp:33,PageDown:34,Insert:45},Av=D||Cc&&Jc("525"),Bv=xc&&Bc;h=ev.prototype;
h.Li=function(a){Cc&&(17==this.Ra&&!a.ctrlKey||18==this.Ra&&!a.altKey||xc&&91==this.Ra&&!a.metaKey)&&(this.Tb=this.Ra=-1);-1==this.Ra&&(a.ctrlKey&&17!=a.a?this.Ra=17:a.altKey&&18!=a.a?this.Ra=18:a.metaKey&&91!=a.a&&(this.Ra=91));Av&&!tv(a.a,this.Ra,a.shiftKey,a.ctrlKey,a.altKey)?this.handleEvent(a):(this.Tb=vv(a.a),Bv&&(this.Ze=a.altKey))};h.Mi=function(a){this.Tb=this.Ra=-1;this.Ze=a.altKey};
h.handleEvent=function(a){var b=a.c,c,d,e=b.altKey;D&&"keypress"==a.type?c=this.Tb:Cc&&"keypress"==a.type?c=this.Tb:Ac?c=this.Tb:(c=b.keyCode||this.Tb,d=b.charCode||0,Bv&&(e=this.Ze),xc&&63==d&&224==c&&(c=191));d=c=vv(c);var f=b.keyIdentifier;c?63232<=c&&c in yv?d=yv[c]:25==c&&a.shiftKey&&(d=9):f&&f in zv&&(d=zv[f]);this.Ra=d;a=new Cv(d,0,0,b);a.altKey=e;this.dispatchEvent(a)};h.g=function(){return this.w};
function xv(a,b,c){a.pe&&Dv(a);a.w=b;a.oe=ed(a.w,"keypress",a,c);a.Pf=ed(a.w,"keydown",a.Li,c,a);a.pe=ed(a.w,"keyup",a.Mi,c,a)}function Dv(a){a.oe&&(od(a.oe),od(a.Pf),od(a.pe),a.oe=null,a.Pf=null,a.pe=null);a.w=null;a.Ra=-1;a.Tb=-1}h.u=function(){ev.f.u.call(this);Dv(this)};function Cv(a,b,c,d){Qc.call(this,d);this.type=fv;this.a=a}A(Cv,Qc);function Ev(a){if(a.classList)return a.classList;a=a.className;return v(a)&&a.match(/\S+/g)||[]}function Fv(a,b){return a.classList?a.classList.contains(b):jb(Ev(a),b)}function Gv(a,b){a.classList?a.classList.add(b):Fv(a,b)||(a.className+=0<a.className.length?" "+b:b)}function Hv(a,b){if(a.classList)bb(b,function(b){Gv(a,b)});else{var c={};bb(Ev(a),function(a){c[a]=!0});bb(b,function(a){c[a]=!0});a.className="";for(var d in c)a.className+=0<a.className.length?" "+d:d}}
function Iv(a,b){a.classList?a.classList.remove(b):Fv(a,b)&&(a.className=cb(Ev(a),function(a){return a!=b}).join(" "))}function Jv(a,b){a.classList?bb(b,function(b){Iv(a,b)}):a.className=cb(Ev(a),function(a){return!jb(b,a)}).join(" ")};function Kv(a,b){if(!a)throw Error("Invalid class name "+a);if(!ia(b))throw Error("Invalid decorator function "+b);}var Lv={};function Mv(a){this.a=a}da(Mv);function Nv(a,b){a&&(a.tabIndex=b?0:-1)}Mv.prototype.c=function(a){a=a.g();Aj(a,!0,Bc);D&&(a.hideFocus=!0);var b=this.a;b&&qv(a,b)};Mv.prototype.o=function(){return"goog-container"};Mv.prototype.b=function(a){var b=this.o(),c=[b,a.Vb==Ov?b+"-horizontal":b+"-vertical"];a.isEnabled()||c.push(b+"-disabled");return c};Mv.prototype.e=function(){return Pv};function Qv(){}var Rv;da(Qv);var Sv={button:"pressed",checkbox:"checked",menuitem:"selected",menuitemcheckbox:"checked",menuitemradio:"checked",radio:"checked",tab:"selected",treeitem:"selected"};h=Qv.prototype;h.oc=function(){};h.Fa=function(a){var b=a.b.j("div",Tv(this,a).join(" "),a.W());Uv(this,a,b);return b};h.la=function(a){return a};function Vv(a,b,c){if(a=a.g?a.g():a){var d=[b];D&&!Jc("7")&&(d=Wv(Ev(a),b),d.push(b));(c?Hv:Jv)(a,d)}}
h.Rc=function(a){Yu(a)&&this.Ff(a.g(),!0);a.isEnabled()&&this.Sc(a,a.za)};function Xv(a,b,c){if(a=c||a.oc())c=b.getAttribute("role")||null,a!=c&&qv(b,a)}function Uv(a,b,c){b.za||rv(c,"hidden",!b.za);b.isEnabled()||a.nb(c,1,!b.isEnabled());Yv(b,8)&&a.nb(c,8,Zv(b,8));Yv(b,16)&&a.nb(c,16,Zv(b,16));Yv(b,64)&&a.nb(c,64,Zv(b,64))}h.Ef=function(a,b){Aj(a,!b,!D&&!Ac)};h.Ff=function(a,b){Vv(a,this.o()+"-rtl",b)};h.Df=function(a){var b;return Yv(a,32)&&(b=$v(a))?ii(b)&&ji(b):!1};
h.Sc=function(a,b){var c;if(Yv(a,32)&&(c=$v(a))){if(!b&&Zv(a,32)){try{c.blur()}catch(d){}Zv(a,32)&&a.ie(null)}(ii(c)&&ji(c))!=b&&hi(c,b)}};h.od=function(a,b,c){var d=a.g();if(d){var e=this.ce(b);e&&Vv(a,e,c);this.nb(d,b,c)}};h.nb=function(a,b,c){Rv||(Rv={1:"disabled",8:"selected",16:"checked",64:"expanded"});b=Rv[b];var d=a.getAttribute("role")||null;d&&(d=Sv[d]||b,b="checked"==b||"selected"==b?d:b);b&&rv(a,b,c)};
h.Sb=function(a,b){var c=this.la(a);if(c&&(Zh(c),b))if(v(b))ei(c,b);else{var d=function(a){if(a){var b=Nh(c);c.appendChild(v(a)?b.createTextNode(a):a)}};u(b)?bb(b,d):!fa(b)||"nodeType"in b?d(b):bb(nb(b),d)}};h.bh=function(a){return a.g()};h.o=function(){return"goog-control"};function Tv(a,b){var c=a.o(),d=[c],e=a.o();e!=c&&d.push(e);c=b.getState();for(e=[];c;){var f=c&-c;e.push(a.ce(f));c&=~f}d.push.apply(d,e);(c=b.Ug)&&d.push.apply(d,c);D&&!Jc("7")&&d.push.apply(d,Wv(d));return d}
function Wv(a,b){var c=[];b&&(a=a.concat([b]));bb([],function(d){!fb(d,pa(jb,a))||b&&!jb(d,b)||c.push(d.join("_"))});return c}h.ce=function(a){if(!this.b){var b=this.o();Ra(b.replace(/\xa0|\s/g," ")," ");this.b={1:b+"-disabled",2:b+"-hover",4:b+"-active",8:b+"-selected",16:b+"-checked",32:b+"-focused",64:b+"-open"}}return this.b[a]};function aw(a,b,c){X.call(this,c);if(!b){b=this.constructor;for(var d;b;){d=ja(b);if(d=Lv[d])break;b=b.f?b.f.constructor:null}b=d?ia(d.B)?d.B():new d:null}this.d=b;this.xd(t(a)?a:null)}A(aw,X);h=aw.prototype;h.Gf=null;h.qc=0;h.yd=39;h.$b=255;h.Gb=0;h.za=!0;h.Ug=null;h.Jf=!0;h.Ye=!1;h.Hf=null;function bw(a,b){a.U&&b!=a.Jf&&cw(a,b);a.Jf=b}function $v(a){return a.d.bh(a)}h.J=function(){var a=this.d.Fa(this);this.w=a;Xv(this.d,a,this.he());this.Ye||this.d.Ef(a,!1);this.za||(R(a,!1),a&&rv(a,"hidden",!0))};
h.he=function(){return this.Hf};h.L=function(){return this.d.la(this.g())};h.A=function(){aw.f.A.call(this);this.d.Rc(this);if(this.yd&-2&&(this.Jf&&cw(this,!0),Yv(this,32))){var a=$v(this);if(a){var b=this.l||(this.l=new ev);xv(b,a);Y(this).listen(b,fv,this.Ia).listen(a,"focus",this.ri).listen(a,"blur",this.ie)}}};
function cw(a,b){var c=Y(a),d=a.g();b?(c.listen(d,"mouseover",a.tc).listen(d,"mousedown",a.pc).listen(d,"mouseup",a.uc).listen(d,"mouseout",a.Kf),a.sd!=ca&&c.listen(d,"contextmenu",a.sd),D&&c.listen(d,"dblclick",a.fh)):(c.X(d,"mouseover",a.tc).X(d,"mousedown",a.pc).X(d,"mouseup",a.uc).X(d,"mouseout",a.Kf),a.sd!=ca&&c.X(d,"contextmenu",a.sd),D&&c.X(d,"dblclick",a.fh))}h.ka=function(){aw.f.ka.call(this);this.l&&Dv(this.l);this.za&&this.isEnabled()&&this.d.Sc(this,!1)};
h.u=function(){aw.f.u.call(this);this.l&&(this.l.S(),delete this.l);delete this.d;this.Ug=this.Gf=null};h.W=function(){return this.Gf};function dw(a,b){a.d.Sb(a.g(),b);a.xd(b)}h.xd=function(a){this.Gf=a};h.Ob=function(){var a=this.W();if(!a)return"";a=v(a)?a:u(a)?db(a,mi).join(""):ki(a);return za(a)};h.pd=function(a,b){if(b||this.za!=a&&this.dispatchEvent(a?"show":"hide")){var c=this.g();c&&(R(c,a),c&&rv(c,"hidden",!a));this.isEnabled()&&this.d.Sc(this,a);this.za=a;return!0}return!1};
h.isEnabled=function(){return!Zv(this,1)};h.setEnabled=function(a){var b=this.Aa();b&&"function"==typeof b.isEnabled&&!b.isEnabled()||!ew(this,1,!a)||(a||(fw(this,!1),this.Ga(!1)),this.za&&this.d.Sc(this,a),gw(this,1,!a,!0))};h.Ga=function(a){ew(this,2,a)&&gw(this,2,a)};function fw(a,b){ew(a,4,b)&&gw(a,4,b)}h.Yc=function(a){ew(this,8,a)&&gw(this,8,a)};function hw(a,b){ew(a,16,b)&&gw(a,16,b)}h.ea=function(a){ew(this,64,a)&&gw(this,64,a)};h.getState=function(){return this.qc};
function Zv(a,b){return!!(a.qc&b)}function gw(a,b,c,d){d||1!=b?Yv(a,b)&&c!=Zv(a,b)&&(a.d.od(a,b,c),a.qc=c?a.qc|b:a.qc&~b):a.setEnabled(!c)}function Yv(a,b){return!!(a.yd&b)}h.ra=function(a,b){if(this.U&&Zv(this,a)&&!b)throw Error("Component already rendered");!b&&Zv(this,a)&&gw(this,a,!1);this.yd=b?this.yd|a:this.yd&~a};function iw(a,b){return!!(a.$b&b)&&Yv(a,b)}function ew(a,b,c){return Yv(a,b)&&Zv(a,b)!=c&&(!(a.Gb&b)||a.dispatchEvent(Ru(b,c)))&&!a.t}
h.tc=function(a){!jw(a,this.g())&&this.dispatchEvent("enter")&&this.isEnabled()&&iw(this,2)&&this.Ga(!0)};h.Kf=function(a){!jw(a,this.g())&&this.dispatchEvent("leave")&&(iw(this,4)&&fw(this,!1),iw(this,2)&&this.Ga(!1))};h.sd=ca;function jw(a,b){return!!a.e&&ci(b,a.e)}h.pc=function(a){this.isEnabled()&&(iw(this,2)&&this.Ga(!0),Sc(a)&&(iw(this,4)&&fw(this,!0),this.d.Df(this)&&$v(this).focus()));!this.Ye&&Sc(a)&&a.preventDefault()};
h.uc=function(a){this.isEnabled()&&(iw(this,2)&&this.Ga(!0),Zv(this,4)&&this.Ta(a)&&iw(this,4)&&fw(this,!1))};h.fh=function(a){this.isEnabled()&&this.Ta(a)};h.Ta=function(a){iw(this,16)&&hw(this,!Zv(this,16));iw(this,8)&&this.Yc(!0);iw(this,64)&&this.ea(!Zv(this,64));var b=new E("action",this);a&&(b.altKey=a.altKey,b.ctrlKey=a.ctrlKey,b.metaKey=a.metaKey,b.shiftKey=a.shiftKey,b.i=a.i);return this.dispatchEvent(b)};h.ri=function(){iw(this,32)&&ew(this,32,!0)&&gw(this,32,!0)};
h.ie=function(){iw(this,4)&&fw(this,!1);iw(this,32)&&ew(this,32,!1)&&gw(this,32,!1)};h.Ia=function(a){return this.za&&this.isEnabled()&&this.Tc(a)?(a.preventDefault(),a.stopPropagation(),!0):!1};h.Tc=function(a){return a.a==jv&&this.Ta(a)};if(!ia(aw))throw Error("Invalid component class "+aw);if(!ia(Qv))throw Error("Invalid renderer class "+Qv);var kw=ja(aw);Lv[kw]=Qv;Kv("goog-control",function(){return new aw(null)});function lw(a,b,c){X.call(this,c);this.mc=b||Mv.B();this.Vb=a||this.mc.e()}A(lw,X);var Ov="horizontal",Pv="vertical";h=lw.prototype;h.Qf=null;h.lc=null;h.mc=null;h.Vb=null;h.ya=!0;h.kc=!0;h.Jc=!0;h.ma=-1;h.na=null;h.Za=!1;h.sb=null;function mw(a){return a.Qf||a.g()}h.J=function(){this.w=this.b.j("div",this.mc.b(this).join(" "))};h.L=function(){return this.g()};
h.A=function(){lw.f.A.call(this);Vu(this,function(a){a.U&&nw(this,a)},this);var a=this.g();this.mc.c(this);this.nc(this.ya,!0);Y(this).listen(this,"enter",this.If).listen(this,"highlight",this.oi).listen(this,"unhighlight",this.qi).listen(this,"open",this.Ti).listen(this,"close",this.ni).listen(a,"mousedown",this.pi).listen(Nh(a),"mouseup",this.Fi).listen(a,["mousedown","mouseup","mouseover","mouseout","contextmenu"],this.Ci);this.Jc&&ow(this,!0)};
function ow(a,b){var c=Y(a),d=mw(a);b?c.listen(d,"focus",a.nd).listen(d,"blur",a.ah).listen(a.lc||(a.lc=new ev(mw(a))),fv,a.Ia):c.X(d,"focus",a.nd).X(d,"blur",a.ah).X(a.lc||(a.lc=new ev(mw(a))),fv,a.Ia)}h.ka=function(){this.Xa(-1);this.na&&this.na.ea(!1);this.Za=!1;lw.f.ka.call(this)};h.u=function(){lw.f.u.call(this);this.lc&&(this.lc.S(),this.lc=null);this.mc=this.na=this.sb=this.Qf=null};h.If=function(){return!0};
h.oi=function(a){var b=Zu(this,a.target);if(-1<b&&b!=this.ma){var c=pw(this);c&&c.Ga(!1);this.ma=b;c=pw(this);this.Za&&fw(c,!0);this.na&&c!=this.na&&(Yv(c,64)?c.ea(!0):this.na.ea(!1))}b=this.g();null!=a.target.g()&&rv(b,"activedescendant",a.target.g().id)};h.qi=function(a){a.target==pw(this)&&(this.ma=-1);this.g().removeAttribute("aria-activedescendant")};h.Ti=function(a){(a=a.target)&&a!=this.na&&a.Aa()==this&&(this.na&&this.na.ea(!1),this.na=a)};h.ni=function(a){a.target==this.na&&(this.na=null)};
h.pi=function(a){this.kc&&(this.Za=!0);var b=mw(this);b&&ii(b)&&ji(b)?b.focus():a.preventDefault()};h.Fi=function(){this.Za=!1};h.Ci=function(a){var b;a:{b=a.target;if(this.sb)for(var c=this.g();b&&b!==c;){var d=b.id;if(d in this.sb){b=this.sb[d];break a}b=b.parentNode}b=null}if(b)switch(a.type){case "mousedown":b.pc(a);break;case "mouseup":b.uc(a);break;case "mouseover":b.tc(a);break;case "mouseout":b.Kf(a);break;case "contextmenu":b.sd(a)}};h.nd=function(){};
h.ah=function(){this.Xa(-1);this.Za=!1;this.na&&this.na.ea(!1)};h.Ia=function(a){return this.isEnabled()&&this.ya&&(0!=Wu(this)||this.Qf)&&this.Cf(a)?(a.preventDefault(),a.stopPropagation(),!0):!1};
h.Cf=function(a){var b=pw(this);if(b&&"function"==typeof b.Ia&&b.Ia(a)||this.na&&this.na!=b&&"function"==typeof this.na.Ia&&this.na.Ia(a))return!0;if(a.shiftKey||a.ctrlKey||a.metaKey||a.altKey)return!1;switch(a.a){case 27:if(this.Jc)mw(this).blur();else return!1;break;case 36:qw(this);break;case 35:rw(this);break;case 38:if(this.Vb==Pv)sw(this);else return!1;break;case 37:if(this.Vb==Ov)Yu(this)?tw(this):sw(this);else return!1;break;case 40:if(this.Vb==Pv)tw(this);else return!1;break;case 39:if(this.Vb==
Ov)Yu(this)?sw(this):tw(this);else return!1;break;default:return!1}return!0};function nw(a,b){var c=b.g(),c=c.id||(c.id=b.s());a.sb||(a.sb={});a.sb[c]=b}h.R=function(a,b){lw.f.R.call(this,a,b)};h.Hd=function(a,b,c){a.Gb|=2;a.Gb|=64;a.ra(32,!1);bw(a,!1);var d=a.Aa()==this?Zu(this,a):-1;lw.f.Hd.call(this,a,b,c);a.U&&this.U&&nw(this,a);a=d;-1==a&&(a=Wu(this));a==this.ma?this.ma=Math.min(Wu(this)-1,b):a>this.ma&&b<=this.ma?this.ma++:a<this.ma&&b>this.ma&&this.ma--};
h.removeChild=function(a,b){if(a=v(a)?Tu(this,a):a){var c=Zu(this,a);-1!=c&&(c==this.ma?(a.Ga(!1),this.ma=-1):c<this.ma&&this.ma--);var d=a.g();d&&d.id&&this.sb&&(c=this.sb,d=d.id,d in c&&delete c[d])}a=lw.f.removeChild.call(this,a,b);bw(a,!0);return a};h.nc=function(a,b){if(b||this.ya!=a&&this.dispatchEvent(a?"show":"hide")){this.ya=a;var c=this.g();c&&(R(c,a),this.Jc&&Nv(mw(this),this.kc&&this.ya),b||this.dispatchEvent(this.ya?"aftershow":"afterhide"));return!0}return!1};h.isEnabled=function(){return this.kc};
h.setEnabled=function(a){this.kc!=a&&this.dispatchEvent(a?"enable":"disable")&&(a?(this.kc=!0,Vu(this,function(a){a.Nh?delete a.Nh:a.setEnabled(!0)})):(Vu(this,function(a){a.isEnabled()?a.setEnabled(!1):a.Nh=!0}),this.Za=this.kc=!1),this.Jc&&Nv(mw(this),a&&this.ya))};function uw(a,b){b!=a.Jc&&a.U&&ow(a,b);a.Jc=b;a.kc&&a.ya&&Nv(mw(a),b)}h.Xa=function(a){(a=Xu(this,a))?a.Ga(!0):-1<this.ma&&pw(this).Ga(!1)};function pw(a){return Xu(a,a.ma)}function qw(a){vw(a,function(a,c){return(a+1)%c},Wu(a)-1)}
function rw(a){vw(a,function(a,c){a--;return 0>a?c-1:a},0)}function tw(a){vw(a,function(a,c){return(a+1)%c},a.ma)}function sw(a){vw(a,function(a,c){a--;return 0>a?c-1:a},a.ma)}function vw(a,b,c){c=0>c?Zu(a,a.na):c;var d=Wu(a);c=b.call(a,c,d);for(var e=0;e<=d;){var f=Xu(a,c);if(f&&a.Jg(f)){a.gg(c);break}e++;c=b.call(a,c,d)}}h.Jg=function(a){return a.za&&a.isEnabled()&&Yv(a,2)};h.gg=function(a){this.Xa(a)};function ww(){}A(ww,Qv);da(ww);ww.prototype.o=function(){return"goog-menuheader"};function xw(a,b,c){aw.call(this,a,c||ww.B(),b);this.ra(1,!1);this.ra(2,!1);this.ra(4,!1);this.ra(32,!1);this.qc=1}A(xw,aw);Kv("goog-menuheader",function(){return new xw(null)});function yw(){this.a=[]}A(yw,Qv);da(yw);function zw(a,b){var c=a.a[b];if(!c){switch(b){case 0:c=a.o()+"-highlight";break;case 1:c=a.o()+"-checkbox";break;case 2:c=a.o()+"-content"}a.a[b]=c}return c}h=yw.prototype;h.oc=function(){return"menuitem"};h.Fa=function(a){var b=a.b.j("div",Tv(this,a).join(" "),Aw(this,a.W(),a.b));Bw(this,a,b,Yv(a,8)||Yv(a,16));return b};h.la=function(a){return a&&a.firstChild};
h.Sb=function(a,b){var c=this.la(a),d=Cw(this,a)?c.firstChild:null;yw.f.Sb.call(this,a,b);d&&!Cw(this,a)&&c.insertBefore(d,c.firstChild||null)};function Aw(a,b,c){a=zw(a,2);return c.j("div",a,b)}function Cw(a,b){var c=a.la(b);if(c){var c=c.firstChild,d=zw(a,1);return!!c&&bi(c)&&Fv(c,d)}return!1}function Bw(a,b,c,d){Xv(a,c,b.he());Uv(a,b,c);d!=Cw(a,c)&&(d?Gv(c,"goog-option"):Iv(c,"goog-option"),c=a.la(c),d?(a=zw(a,1),c.insertBefore(b.b.j("div",a),c.firstChild||null)):c.removeChild(c.firstChild))}
h.ce=function(a){switch(a){case 2:return zw(this,0);case 16:case 8:return"goog-option-selected";default:return yw.f.ce.call(this,a)}};h.o=function(){return"goog-menuitem"};function Dw(a,b,c,d){aw.call(this,a,d||yw.B(),c);this.a=b}A(Dw,aw);h=Dw.prototype;h.K=function(){var a=this.a;return null!=a?a:this.Ob()};h.ra=function(a,b){Dw.f.ra.call(this,a,b);switch(a){case 8:Zv(this,16)&&!b&&hw(this,!1);var c=this.g();c&&this&&c&&Bw(this.d,this,c,b);break;case 16:(c=this.g())&&this&&c&&Bw(this.d,this,c,b)}};
h.Ob=function(){var a=this.W();return u(a)?(a=db(a,function(a){return bi(a)&&(Fv(a,"goog-menuitem-accel")||Fv(a,"goog-menuitem-mnemonic-separator"))?"":mi(a)}).join(""),za(a)):Dw.f.Ob.call(this)};h.uc=function(a){var b=this.Aa();if(b){var c=b.c;b.c=null;if(b=c&&ha(a.clientX))b=new Ih(a.clientX,a.clientY),b=c==b?!0:c&&b?c.x==b.x&&c.y==b.y:!1;if(b)return}Dw.f.uc.call(this,a)};h.Tc=function(a){return a.a==this.Zf&&this.Ta(a)?!0:Dw.f.Tc.call(this,a)};h.mi=function(){return this.Zf};
Kv("goog-menuitem",function(){return new Dw(null)});Dw.prototype.he=function(){return Yv(this,16)?"menuitemcheckbox":Yv(this,8)?"menuitemradio":Dw.f.he.call(this)};Dw.prototype.Aa=function(){return aw.prototype.Aa.call(this)};Dw.prototype.Oc=function(){return aw.prototype.Oc.call(this)};function Ew(){}A(Ew,Qv);da(Ew);Ew.prototype.Fa=function(a){return a.b.j("div",this.o())};Ew.prototype.Sb=function(){};Ew.prototype.o=function(){return"goog-menuseparator"};function Fw(a,b){aw.call(this,null,a||Ew.B(),b);this.ra(1,!1);this.ra(2,!1);this.ra(4,!1);this.ra(32,!1);this.qc=1}A(Fw,aw);Fw.prototype.A=function(){Fw.f.A.call(this);var a=this.g();qv(a,"separator")};Kv("goog-menuseparator",function(){return new Fw});function Gw(a){this.a=a||"menu"}A(Gw,Mv);da(Gw);Gw.prototype.tb=function(a,b){return ci(a.g(),b)};Gw.prototype.o=function(){return"goog-menu"};Gw.prototype.c=function(a){Gw.f.c.call(this,a);a=a.g();rv(a,"haspopup","true")};function Hw(a){Fw.call(this,Ew.B(),a)}A(Hw,Fw);Kv("goog-menuseparator",function(){return new Fw});function Iw(a,b){lw.call(this,Pv,b||Gw.B(),a);uw(this,!1)}A(Iw,lw);h=Iw.prototype;h.Kd=!0;h.o=function(){return this.mc.o()};h.tb=function(a){if(this.mc.tb(this,a))return!0;for(var b=0,c=Wu(this);b<c;b++){var d=Xu(this,b);if("function"==typeof d.tb&&d.tb(a))return!0}return!1};h.ic=function(){var a=[];Vu(this,function(b){a.push(b)});return a};h.nc=function(a,b,c){(b=Iw.f.nc.call(this,a,b))&&a&&this.U&&this.Kd&&mw(this).focus();a&&c&&ha(c.clientX)?this.c=new Ih(c.clientX,c.clientY):this.c=null;return b};
h.If=function(a){this.Kd&&mw(this).focus();return Iw.f.If.call(this,a)};h.Jg=function(a){return a.isEnabled()&&a.za&&Yv(a,2)};h.Cf=function(a){var b=Iw.f.Cf.call(this,a);b||Vu(this,function(c){!b&&c.mi&&c.Zf==a.a&&(this.isEnabled()&&this.Xa(Zu(this,c)),b=c.Ia(a))},this);return b};
h.Xa=function(a){Iw.f.Xa.call(this,a);if(a=Xu(this,a)){var b=a.g();a=this.g();var c=sj(b),d=sj(a),e=Fj(a),f=c.x-d.x-e.left,c=c.y-d.y-e.top,d=a.clientHeight-b.offsetHeight,e=a.scrollLeft,g=a.scrollTop,e=e+Math.min(f,Math.max(f-(a.clientWidth-b.offsetWidth),0)),g=g+Math.min(c,Math.max(c-d,0)),b=new Ih(e,g);a.scrollLeft=b.x;a.scrollTop=b.y}};function Jw(a,b,c,d,e,f,g,k,l){var m,n;if(m=c.offsetParent){var p="HTML"==m.tagName||"BODY"==m.tagName;p&&"static"==mj(m)||(n=sj(m),p||(p=(p=tj(m))&&Bc?-m.scrollLeft:!p||D&&Jc("8")||"visible"==lj(m,"overflowX")?m.scrollLeft:m.scrollWidth-m.clientWidth-m.scrollLeft,n=Jh(n,new Ih(p,m.scrollTop))))}m=n||new Ih;n=xj(a);if(p=rj(a)){var q=new jj(p.left,p.top,p.right-p.left,p.bottom-p.top),p=Math.max(n.left,q.left),s=Math.min(n.left+n.width,q.left+q.width);if(p<=s){var w=Math.max(n.top,q.top),q=Math.min(n.top+
n.height,q.top+q.height);w<=q&&(n.left=p,n.top=w,n.width=s-p,n.height=q-w)}}p=Lh(a);w=Lh(c);if(p.a!=w.a){var s=p.a.body,w=Vh(w.a),q=new Ih(0,0),y=Uh(Nh(s)),G=s;do{var H;if(y==w)H=sj(G);else{var J=G;H=void 0;if(J.getBoundingClientRect)H=pj(J),H=new Ih(H.left,H.top);else{H=ri(Lh(J));var Z=sj(J);H=new Ih(Z.x-H.x,Z.y-H.y)}if(Bc&&!Jc(12)){b:{var Z=J,Ua=Va("transform");if(void 0===Z.style[Ua]&&(Ua=hj()+Wa(Ua),void 0!==Z.style[Ua])){Z=(Cc?"-webkit":Bc?"-moz":D?"-ms":Ac?"-o":null)+"-transform";break b}Z=
"transform"}J=(J=lj(J,Z)||lj(J,"transform"))?(J=J.match(Gj))?new Ih(parseFloat(J[1]),parseFloat(J[2])):new Ih(0,0):new Ih(0,0);H=new Ih(H.x+J.x,H.y+J.y)}}q.x+=H.x;q.y+=H.y}while(y&&y!=w&&(G=y.frameElement)&&(y=y.parent));s=Jh(q,sj(s));!D||D&&9<=Lc||qi(p)||(s=Jh(s,ri(p)));n.left+=s.x;n.top+=s.y}a=Kw(a,b);b=new Ih(a&2?n.left+n.width:n.left,a&1?n.top+n.height:n.top);b=Jh(b,m);e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var P;if(g)if(l)P=l;else if(P=rj(c))P.top-=m.y,P.right-=m.x,P.bottom-=m.y,P.left-=
m.x;e=P;l=b.clone();P=Kw(c,d);d=vj(c);a=k?k.clone():d.clone();k=l;l=a;k=k.clone();l=l.clone();a=0;if(f||0!=P)P&2?k.x-=l.width+(f?f.right:0):f&&(k.x+=f.left),P&1?k.y-=l.height+(f?f.bottom:0):f&&(k.y+=f.top);g&&(e?(f=k,P=l,a=0,65==(g&65)&&(f.x<e.left||f.x>=e.right)&&(g&=-2),132==(g&132)&&(f.y<e.top||f.y>=e.bottom)&&(g&=-5),f.x<e.left&&g&1&&(f.x=e.left,a|=1),f.x<e.left&&f.x+P.width>e.right&&g&16&&(P.width=Math.max(P.width-(f.x+P.width-e.right),0),a|=4),f.x+P.width>e.right&&g&1&&(f.x=Math.max(e.right-
P.width,e.left),a|=1),g&2&&(a=a|(f.x<e.left?16:0)|(f.x+P.width>e.right?32:0)),f.y<e.top&&g&4&&(f.y=e.top,a|=2),f.y<=e.top&&f.y+P.height<e.bottom&&g&32&&(P.height=Math.max(P.height-(e.top-f.y),0),f.y=e.top,a|=8),f.y>=e.top&&f.y+P.height>e.bottom&&g&32&&(P.height=Math.max(P.height-(f.y+P.height-e.bottom),0),a|=8),f.y+P.height>e.bottom&&g&4&&(f.y=Math.max(e.bottom-P.height,e.top),a|=2),g&8&&(a=a|(f.y<e.top?64:0)|(f.y+P.height>e.bottom?128:0)),g=a):g=256,a=g);f=new jj(0,0,0,0);f.left=k.x;f.top=k.y;f.width=
l.width;f.height=l.height;g=a;g&496||(nj(c,new Ih(f.left,f.top)),a=new Kh(f.width,f.height),d==a||d&&a&&d.width==a.width&&d.height==a.height||(f=a,d=qi(Lh(Nh(c))),!D||Jc("10")||d&&Jc("8")?(c=c.style,Bc?c.MozBoxSizing="border-box":Cc?c.WebkitBoxSizing="border-box":c.boxSizing="border-box",c.width=Math.max(f.width,0)+"px",c.height=Math.max(f.height,0)+"px"):(k=c.style,d?(D?(d=Cj(c,"paddingLeft"),e=Cj(c,"paddingRight"),l=Cj(c,"paddingTop"),P=Cj(c,"paddingBottom"),d=new ij(l,e,P,d)):(d=kj(c,"paddingLeft"),
e=kj(c,"paddingRight"),l=kj(c,"paddingTop"),P=kj(c,"paddingBottom"),d=new ij(parseFloat(l),parseFloat(e),parseFloat(P),parseFloat(d))),c=Fj(c),k.pixelWidth=f.width-c.left-d.left-d.right-c.right,k.pixelHeight=f.height-c.top-d.top-d.bottom-c.bottom):(k.pixelWidth=f.width,k.pixelHeight=f.height))));return g}function Kw(a,b){return(b&4&&tj(a)?b^2:b)&-5};function Lw(){}Lw.prototype.c=function(){};function Mw(a,b,c){this.a=a;this.b=b;this.i=c}A(Mw,Lw);Mw.prototype.c=function(a,b,c){Jw(this.a,this.b,a,b,void 0,c,this.i)};function Nw(a,b,c,d){Mw.call(this,a,b);this.d=c?5:0;this.e=d||void 0}A(Nw,Mw);Nw.prototype.h=function(){return this.d};Nw.prototype.t=function(a){this.d=a};Nw.prototype.c=function(a,b,c,d){var e=Jw(this.a,this.b,a,b,null,c,10,d,this.e);if(e&496){var f=Ow(e,this.b);b=Ow(e,b);e=Jw(this.a,f,a,b,null,c,10,d,this.e);e&496&&(f=Ow(e,f),b=Ow(e,b),Jw(this.a,f,a,b,null,c,this.d,d,this.e))}};function Ow(a,b){a&48&&(b^=2);a&192&&(b^=1);return b};function Pw(a,b,c,d){Nw.call(this,a,b,c||d);(c||d)&&this.t(65|(d?32:132))}A(Pw,Nw);function Qw(){}A(Qw,Qv);da(Qw);h=Qw.prototype;h.oc=function(){return"button"};h.nb=function(a,b,c){switch(b){case 8:case 16:rv(a,"pressed",c);break;default:case 64:case 1:Qw.f.nb.call(this,a,b,c)}};h.Fa=function(a){var b=Qw.f.Fa.call(this,a);this.sa(b,a.Pb());var c=a.K();c&&this.md(b,c);Yv(a,16)&&this.nb(b,16,Zv(a,16));return b};h.K=ca;h.md=ca;h.Pb=function(a){return a.title};h.sa=function(a,b){a&&(b?a.title=b:a.removeAttribute("title"))};h.o=function(){return"goog-button"};function Rw(){}A(Rw,Qw);da(Rw);h=Rw.prototype;h.oc=function(){};h.Fa=function(a){bw(a,!1);a.$b&=-256;a.ra(32,!1);return a.b.j("button",{"class":Tv(this,a).join(" "),disabled:!a.isEnabled(),title:a.Pb()||"",value:a.K()||""},a.Ob()||"")};h.Rc=function(a){Y(a).listen(a.g(),"click",a.Ta)};h.Ef=ca;h.Ff=ca;h.Df=function(a){return a.isEnabled()};h.Sc=ca;h.od=function(a,b,c){Rw.f.od.call(this,a,b,c);(a=a.g())&&1==b&&(a.disabled=c)};h.K=function(a){return a.value};h.md=function(a,b){a&&(a.value=b)};h.nb=ca;function Sw(a,b,c){aw.call(this,a,b||Rw.B(),c)}A(Sw,aw);h=Sw.prototype;h.K=function(){return this.Yb};h.Rb=function(a){this.Yb=a;this.d.md(this.g(),a)};h.Pb=function(){return this.F};h.sa=function(a){this.F=a;this.d.sa(this.g(),a)};h.Ah=function(a){this.F=a};h.u=function(){Sw.f.u.call(this);delete this.Yb;delete this.F};h.A=function(){Sw.f.A.call(this);if(Yv(this,32)){var a=$v(this);a&&Y(this).listen(a,"keyup",this.Tc)}};
h.Tc=function(a){return a.a==jv&&a.type==fv||32==a.a&&"keyup"==a.type?this.Ta(a):32==a.a};Kv("goog-button",function(){return new Sw(null)});function Tw(){}A(Tw,Qw);da(Tw);h=Tw.prototype;h.Fa=function(a){var b=Tv(this,a),b=a.b.j("div",{"class":"goog-inline-block "+b.join(" ")},this.hf(a.W(),a.b));this.sa(b,a.Pb());Uv(this,a,b);return b};h.oc=function(){return"button"};h.la=function(a){return a&&a.firstChild&&a.firstChild.firstChild};h.hf=function(a,b){return b.j("div","goog-inline-block "+(this.o()+"-outer-box"),b.j("div","goog-inline-block "+(this.o()+"-inner-box"),a))};h.o=function(){return"goog-custom-button"};function Uw(){}A(Uw,Tw);da(Uw);Uw.prototype.la=function(a){return Uw.f.la.call(this,a&&a.firstChild)};Uw.prototype.hf=function(a,b){return Uw.f.hf.call(this,[this.a(a,b),b.j("div","goog-inline-block "+(this.o()+"-dropdown"),"\u00a0")],b)};Uw.prototype.a=function(a,b){return b.j("div","goog-inline-block "+(this.o()+"-caption"),a)};Uw.prototype.o=function(){return"goog-menu-button"};function Vw(a,b,c,d,e){Sw.call(this,a,c||Uw.B(),d);this.ra(64,!0);this.r=new Pw(null,5);b&&this.rd(b);this.ba=new Xf(500);!Ji&&!Ki||Jc("533.17.9")||(this.ne=!0);this.Gc=e||Gw.B()}A(Vw,Sw);h=Vw.prototype;h.ne=!1;h.A=function(){Vw.f.A.call(this);Ww(this,!0);this.c&&Xw(this,this.c,!0);rv(this.w,"haspopup",!!this.c)};h.ka=function(){Vw.f.ka.call(this);Ww(this,!1);if(this.c){this.ea(!1);this.c.ka();Xw(this,this.c,!1);var a=this.c.g();a&&ai(a)}};
h.u=function(){Vw.f.u.call(this);this.c&&(this.c.S(),delete this.c);delete this.Ag;this.ba.S()};h.pc=function(a){Vw.f.pc.call(this,a);Zv(this,4)&&(this.ea(!Zv(this,64),a),this.c&&(this.c.Za=Zv(this,64)))};h.uc=function(a){Vw.f.uc.call(this,a);this.c&&!Zv(this,4)&&(this.c.Za=!1)};h.Ta=function(){fw(this,!1);return!0};h.Ei=function(a){this.c&&this.c.ya&&!this.tb(a.target)&&this.ea(!1)};h.tb=function(a){return a&&ci(this.g(),a)||this.c&&this.c.tb(a)||!1};
h.Tc=function(a){if(32==a.a){if(a.preventDefault(),"keyup"!=a.type)return!0}else if(a.type!=fv)return!1;if(this.c&&this.c.ya){var b=a.a==jv||32==a.a,c=this.c.Ia(a);return 27==a.a||b?(this.ea(!1),!0):c}return 40==a.a||38==a.a||32==a.a||a.a==jv?(this.ea(!0,a),!0):!1};h.qd=function(){this.ea(!1)};h.Oi=function(){Zv(this,4)||this.ea(!1)};h.ie=function(a){this.ne||this.ea(!1);Vw.f.ie.call(this,a)};
h.rd=function(a){var b=this.c;if(a!=b&&(b&&(this.ea(!1),this.U&&Xw(this,b,!1),delete this.c),this.U&&rv(this.w,"haspopup",!!a),a)){this.c=a;Su(a,this);a.nc(!1);var c=this.ne;(a.Kd=c)&&uw(a,!0);this.U&&Xw(this,a,!0)}return b};h.pd=function(a,b){var c=Vw.f.pd.call(this,a,b);c&&!this.za&&this.ea(!1);return c};h.setEnabled=function(a){Vw.f.setEnabled.call(this,a);this.isEnabled()||this.ea(!1)};
h.ea=function(a,b){Vw.f.ea.call(this,a);if(this.c&&Zv(this,64)==a){if(a)this.c.U||this.c.render(),this.Zb=rj(this.g()),this.T=xj(this.g()),Yw(this),this.c.Xa(!b||40!=b.a&&38!=b.a?-1:0);else{fw(this,!1);this.c.Za=!1;var c=this.g();c&&(rv(c,"activedescendant",""),rv(c,"owns",""));null!=this.C&&(this.C=void 0,(c=this.c.g())&&uj(c,"",""))}this.c.nc(a,!1,b);if(!this.t){var c=Y(this),d=a?c.listen:c.X;d.call(c,this.b.a,"mousedown",this.Ei,!0);this.ne&&d.call(c,this.c,"blur",this.Oi);d.call(c,this.ba,Zf,
this.oj);a?Yf(this.ba):this.ba.stop()}}this.c&&this.c.g()&&this.c.w.removeAttribute("aria-hidden")};function Yw(a){if(a.c.U){var b=a.Ag||a.g(),c=a.r;a.r.a=b;b=a.c.g();a.c.ya||(b.style.visibility="hidden",R(b,!0));!a.C&&a.r.h&&a.r.d&32&&(a.C=vj(b));c.c(b,c.b^1,null,a.C);a.c.ya||(R(b,!1),b.style.visibility="visible")}}
h.oj=function(){var a=xj(this.g()),b=rj(this.g()),c=this.T;(c=!(c==a||c&&a&&c.left==a.left&&c.width==a.width&&c.top==a.top&&c.height==a.height))||(c=this.Zb,c=!(c==b||c&&b&&c.top==b.top&&c.right==b.right&&c.bottom==b.bottom&&c.left==b.left));c&&(this.T=a,this.Zb=b,Yw(this))};function Xw(a,b,c){var d=Y(a);c=c?d.listen:d.X;c.call(d,b,"action",a.qd);c.call(d,b,"close",a.si);c.call(d,b,"highlight",a.ti);c.call(d,b,"unhighlight",a.ui)}
function Ww(a,b){var c=Y(a);(b?c.listen:c.X).call(c,a.g(),"keydown",a.Ki)}h.ti=function(a){(a=a.target.g())&&Zw(this,a)};h.Ki=function(a){Yv(this,32)&&$v(this)&&this.c&&this.c.ya&&a.stopPropagation()};h.ui=function(){if(!pw(this.c)){var a=this.g();rv(a,"activedescendant","");rv(a,"owns","")}};h.si=function(a){if(Zv(this,64)&&a.target instanceof Dw){a=a.target;var b=a.g();a.za&&Zv(a,2)&&null!=b&&Zw(this,b)}};
function Zw(a,b){var c=a.g(),d=sv(b,"activedescendant"),d=Nh(b).getElementById(d)||b;if(!d.id){var e=Ou.B();d.id=Pu(e)}e="";d&&(e=d.id);rv(c,"activedescendant",e);rv(c,"owns",d.id)}Kv("goog-menu-button",function(){return new Vw(null)});function $w(a,b,c){F.call(this);this.target=a;this.d=b||a;this.c=c||new jj(NaN,NaN,NaN,NaN);this.b=Nh(a);this.a=new Tf(this);a=pa(wc,this.a);this.Q||(this.Q=[]);this.Q.push(t(void 0)?oa(a,void 0):a);ed(this.d,["touchstart","mousedown"],this.Ch,!1,this)}A($w,F);var ax=D||Bc&&Jc("1.9.3");h=$w.prototype;h.clientX=0;h.clientY=0;h.Dh=0;h.Eh=0;h.Pc=0;h.Qc=0;h.xf=!0;h.hc=!1;h.setEnabled=function(a){this.xf=a};
h.u=function(){$w.f.u.call(this);nd(this.d,["touchstart","mousedown"],this.Ch,!1,this);this.a.removeAll();ax&&this.b.releaseCapture();this.d=this.target=null};
h.Ch=function(a){var b="mousedown"==a.type;if(!this.xf||this.hc||b&&!Sc(a))this.dispatchEvent("earlycancel");else if(bx(a),this.dispatchEvent(new cx("start",this,a.clientX,a.clientY))){this.hc=!0;a.preventDefault();var b=this.b,c=b.documentElement,d=!ax;this.a.listen(b,["touchmove","mousemove"],this.Ri,d);this.a.listen(b,["touchend","mouseup"],this.Xd,d);ax?(c.setCapture(!1),this.a.listen(c,"losecapture",this.Xd)):this.a.listen(Uh(b),"blur",this.Xd);this.h&&this.a.listen(this.h,"scroll",this.mj,d);
this.clientX=this.Dh=a.clientX;this.clientY=this.Eh=a.clientY;this.Pc=this.target.offsetLeft;this.Qc=this.target.offsetTop;this.e=ri(Lh(this.b));z()}};h.Xd=function(a){this.a.removeAll();ax&&this.b.releaseCapture();if(this.hc){bx(a);this.hc=!1;var b=dx(this,this.Pc),c=ex(this,this.Qc);this.dispatchEvent(new cx("end",this,a.clientX,a.clientY,0,b,c))}else this.dispatchEvent("earlycancel")};
function bx(a){var b=a.type;"touchstart"==b||"touchmove"==b?a.init(a.c.targetTouches[0],a.b):"touchend"!=b&&"touchcancel"!=b||a.init(a.c.changedTouches[0],a.b)}
h.Ri=function(a){if(this.xf){bx(a);var b=1*(a.clientX-this.clientX),c=a.clientY-this.clientY;this.clientX=a.clientX;this.clientY=a.clientY;if(!this.hc){var d=this.Dh-this.clientX,e=this.Eh-this.clientY;if(0<d*d+e*e)if(this.dispatchEvent(new cx("start",this,a.clientX,a.clientY)))this.hc=!0;else{this.t||this.Xd(a);return}}c=fx(this,b,c);b=c.x;c=c.y;this.hc&&this.dispatchEvent(new cx("beforedrag",this,a.clientX,a.clientY,0,b,c))&&(gx(this,a,b,c),a.preventDefault())}};
function fx(a,b,c){var d=ri(Lh(a.b));b+=d.x-a.e.x;c+=d.y-a.e.y;a.e=d;a.Pc+=b;a.Qc+=c;b=dx(a,a.Pc);a=ex(a,a.Qc);return new Ih(b,a)}h.mj=function(a){var b=fx(this,0,0);a.clientX=this.clientX;a.clientY=this.clientY;gx(this,a,b.x,b.y)};function gx(a,b,c,d){a.target.style.left=c+"px";a.target.style.top=d+"px";a.dispatchEvent(new cx("drag",a,b.clientX,b.clientY,0,c,d))}
function dx(a,b){var c=a.c,d=isNaN(c.left)?null:c.left,c=isNaN(c.width)?0:c.width;return Math.min(null!=d?d+c:Infinity,Math.max(null!=d?d:-Infinity,b))}function ex(a,b){var c=a.c,d=isNaN(c.top)?null:c.top,c=isNaN(c.height)?0:c.height;return Math.min(null!=d?d+c:Infinity,Math.max(null!=d?d:-Infinity,b))}function cx(a,b,c,d,e,f,g){E.call(this,a);this.clientX=c;this.clientY=d;this.left=t(f)?f:b.Pc;this.top=t(g)?g:b.Qc}A(cx,E);function hx(a){F.call(this);this.w=a;a=D?"focusout":"blur";this.a=ed(this.w,D?"focusin":"focus",this,!D);this.b=ed(this.w,a,this,!D)}A(hx,F);hx.prototype.handleEvent=function(a){var b=new Qc(a.c);b.type="focusin"==a.type||"focus"==a.type?"focusin":"focusout";this.dispatchEvent(b)};hx.prototype.u=function(){hx.f.u.call(this);od(this.a);od(this.b);delete this.w};function ix(a,b){X.call(this,b);this.Yb=!!a;this.r=null}A(ix,X);h=ix.prototype;h.nf=null;h.sc=!1;h.Ka=null;h.wa=null;h.eb=null;h.cf=!1;h.o=function(){return"goog-modalpopup"};h.ae=function(){return this.Ka};
h.J=function(){ix.f.J.call(this);var a=this.g(),b=Aa(this.o()).split(" ");Hv(a,b);hi(a,!0);R(a,!1);this.Yb&&!this.wa&&(this.wa=this.b.j("iframe",{frameborder:0,style:"border:0;vertical-align:bottom;",src:'javascript:""'}),this.wa.className=this.o()+"-bg",R(this.wa,!1),yj(this.wa,0));this.Ka||(this.Ka=this.b.j("div",this.o()+"-bg"),R(this.Ka,!1));this.eb||(this.eb=this.b.createElement("span"),R(this.eb,!1),hi(this.eb,!0),this.eb.style.position="absolute")};h.yh=function(){this.cf=!1};
h.A=function(){this.wa&&$h(this.wa,this.g());$h(this.Ka,this.g());ix.f.A.call(this);var a=this.g();a.parentNode&&a.parentNode.insertBefore(this.eb,a.nextSibling);this.nf=new hx(this.b.a);Y(this).listen(this.nf,"focusin",this.onFocus);jx(this,!1)};h.ka=function(){this.sc&&this.Pa(!1);wc(this.nf);ix.f.ka.call(this);ai(this.wa);ai(this.Ka);ai(this.eb)};
h.Pa=function(a){if(a!=this.sc)if(this.F&&this.F.stop(),this.Y&&this.Y.stop(),this.C&&this.C.stop(),this.T&&this.T.stop(),this.U&&jx(this,a),a){if(this.dispatchEvent("beforeshow")){try{this.r=this.b.a.activeElement}catch(b){}this.eg();var c=Uh(this.b.a)||window;if("fixed"==mj(this.g()))var d=a=0;else d=ri(this.b),a=d.x,d=d.y;var e;e=this.g();e=vj(e);c=Sh(c);a=Math.max(a+c.width/2-e.width/2,0);d=Math.max(d+c.height/2-e.height/2,0);nj(this.g(),a,d);nj(this.eb,a,d);Y(this).listen(Vh(this.b.a),"resize",
this.eg);kx(this,!0);this.vi();this.sc=!0;this.F&&this.Y?(md(this.F,"end",this.xe,!1,this),this.Y.play(),this.F.play()):this.xe()}}else if(this.dispatchEvent("beforehide")){Y(this).X(Vh(this.b.a),"resize",this.eg);this.sc=!1;this.C&&this.T?(md(this.C,"end",this.ve,!1,this),this.T.play(),this.C.play()):this.ve();a:{try{d=this.b;c=d.a.body;e=d.a.activeElement||c;if(!this.r||this.r==c){this.r=null;break a}(e==c||d.contains(this.g(),e))&&this.r.focus()}catch(f){}this.r=null}}};
function jx(a,b){if(b){a.l||(a.l=[]);for(var c=a.b,c=c.getChildren(c.a.body),d=0;d<c.length;d++){var e=c[d];e==a.w||sv(e,"hidden")||(rv(e,"hidden",!0),a.l.push(e))}}else if(a.l){for(d=0;d<a.l.length;d++)a.l[d].removeAttribute("aria-hidden");a.l=null}}function kx(a,b){a.wa&&R(a.wa,b);a.Ka&&R(a.Ka,b);R(a.g(),b);R(a.eb,b)}h.xe=function(){this.dispatchEvent("show")};h.ve=function(){kx(this,!1);this.dispatchEvent("hide")};h.vi=function(){this.Vg()};
h.eg=function(){this.wa&&R(this.wa,!1);this.Ka&&R(this.Ka,!1);var a=this.b.a,b=Sh(Uh(a)||window),c=Math.max(b.width,Math.max(a.body.scrollWidth,a.documentElement.scrollWidth)),a=Math.max(b.height,Math.max(a.body.scrollHeight,a.documentElement.scrollHeight));this.wa&&(R(this.wa,!0),uj(this.wa,c,a));this.Ka&&(R(this.Ka,!0),uj(this.Ka,c,a))};h.onFocus=function(a){this.cf?this.yh():a.target==this.eb&&$f(this.Vg,0,this)};h.Vg=function(){try{D&&this.b.a.body.focus(),this.g().focus()}catch(a){}};
h.u=function(){wc(this.F);this.F=null;wc(this.C);this.C=null;wc(this.Y);this.Y=null;wc(this.T);this.T=null;ix.f.u.call(this)};function lx(a,b,c){ix.call(this,b,c);this.d=a||"modal-dialog";this.c=mx()}A(lx,ix);h=lx.prototype;h.Yd=!0;h.ke=!0;h.$f=!0;h.bf=.5;h.Jh="";h.Uc=null;h.Nb=null;h.Vd=!1;h.Zc=null;h.Cc=null;h.Ih=null;h.fb=null;h.bc=null;h.ib=null;h.o=function(){return this.d};h.setTitle=function(a){this.Jh=a;this.Cc&&ei(this.Cc,a)};h.W=function(){return null!=this.Uc?uu(this.Uc):""};h.L=function(){this.g()||this.render();return this.bc};h.ae=function(){this.g()||this.render();return lx.f.ae.call(this)};
function nx(a){1!=a.$f&&ox(a,!0)}function ox(a,b){a.$f=b;if(a.U){var c=a.b,d=a.ae(),e=a.wa;b?(e&&c.ih(e,a.g()),c.ih(d,a.g())):(c.$g(e),c.$g(d))}a.sc&&jx(a,b)}function px(a,b){var c=Aa(a.d+"-title-draggable").split(" ");a.g()&&(b?Hv(a.Zc,c):Jv(a.Zc,c));if(b&&!a.Nb){var d;d=new $w(a.g(),a.Zc);a.Nb=d;Hv(a.Zc,c);ed(a.Nb,"start",a.sj,!1,a)}else!b&&a.Nb&&(a.Nb.S(),a.Nb=null)}
h.J=function(){lx.f.J.call(this);var a=this.g(),b=this.b;this.Zc=b.j("div",this.d+"-title",this.Cc=b.j("span",{className:this.d+"-title-text",id:this.s()},this.Jh),this.fb=b.j("span",this.d+"-title-close"));Yh(a,this.Zc,this.bc=b.j("div",this.d+"-content"),this.ib=b.j("div",this.d+"-buttons"));qv(this.Cc,"heading");qv(this.fb,"button");hi(this.fb,!0);rv(this.fb,"label",qx);this.Ih=this.Cc.id;qv(a,"dialog");rv(a,"labelledby",this.Ih||"");this.Uc&&(this.bc.innerHTML=uu(this.Uc));R(this.fb,this.ke);
this.c&&(a=this.c,a.w=this.ib,a.render());R(this.ib,!!this.c);this.bf=this.bf;this.g()&&(a=this.ae())&&yj(a,this.bf)};h.A=function(){lx.f.A.call(this);Y(this).listen(this.g(),"keydown",this.rh).listen(this.g(),"keypress",this.rh);Y(this).listen(this.ib,"click",this.ej);px(this,!0);Y(this).listen(this.fb,"click",this.qj);var a=this.g();qv(a,"dialog");""!==this.Cc.id&&rv(a,"labelledby",this.Cc.id);this.$f||ox(this,!1)};h.ka=function(){this.sc&&this.Pa(!1);px(this,!1);lx.f.ka.call(this)};
h.Pa=function(a){a!=this.sc&&(this.U||this.render(),lx.f.Pa.call(this,a))};h.xe=function(){lx.f.xe.call(this);this.dispatchEvent(rx)};h.ve=function(){lx.f.ve.call(this);this.dispatchEvent(sx);this.Vd&&this.S()};
h.sj=function(){var a=this.b.a,b=Sh(Uh(a)||window),c=Math.max(a.body.scrollWidth,b.width),a=Math.max(a.body.scrollHeight,b.height),d;d=this.g();d=vj(d);"fixed"==mj(this.g())?(b=new jj(0,0,Math.max(0,b.width-d.width),Math.max(0,b.height-d.height)),this.Nb.c=b||new jj(NaN,NaN,NaN,NaN)):this.Nb.c=new jj(0,0,c-d.width,a-d.height)||new jj(NaN,NaN,NaN,NaN)};h.qj=function(){tx(this)};function tx(a){if(a.ke){var b=a.c,c=b&&b.df;c?(b=b.get(c),a.dispatchEvent(new ux(c,b))&&a.Pa(!1)):a.Pa(!1)}}
function vx(a,b){a.ke=b;a.fb&&R(a.fb,a.ke)}h.u=function(){this.ib=this.fb=null;lx.f.u.call(this)};function wx(a,b){a.c=b;if(a.ib){if(a.c){var c=a.c;c.w=a.ib;c.render()}else a.ib.innerHTML=uu(wu);R(a.ib,!!a.c)}}h.ej=function(a){a:{for(a=a.target;null!=a&&a!=this.ib;){if("BUTTON"==a.tagName)break a;a=a.parentNode}a=null}if(a&&!a.disabled){a=a.name;var b=this.c.get(a);this.dispatchEvent(new ux(a,b))&&this.Pa(!1)}};
h.rh=function(a){var b=!1,c=!1,d=this.c,e=a.target;if("keydown"==a.type)if(this.Yd&&27==a.a){var f=d&&d.df,e="SELECT"==e.tagName&&!e.disabled;f&&!e?(c=!0,b=d.get(f),b=this.dispatchEvent(new ux(f,b))):e||(b=!0)}else{if(9==a.a&&a.shiftKey&&e==this.g()){this.cf=!0;try{this.eb.focus()}catch(g){}$f(this.yh,0,this)}}else if(a.a==jv){if("BUTTON"==e.tagName&&!e.disabled)f=e.name;else if(e==this.fb)tx(this);else if(d){var k=d.kf,l;if(l=k)a:{l=d.w.getElementsByTagName("BUTTON");for(var m=0,n;n=l[m];m++)if(n.name==
k||n.id==k){l=n;break a}l=null}e=("TEXTAREA"==e.tagName||"SELECT"==e.tagName||"A"==e.tagName)&&!e.disabled;!l||l.disabled||e||(f=k)}f&&d&&(c=!0,b=this.dispatchEvent(new ux(f,String(d.get(f)))))}else e==this.fb&&32==a.a&&tx(this);if(b||c)a.stopPropagation(),a.preventDefault();b&&this.Pa(!1)};function ux(a,b){this.type=xx;this.key=a;this.caption=b}A(ux,E);var xx="dialogselect",sx="afterhide",rx="aftershow";function yx(a){a||Lh();Jd.call(this)}A(yx,Jd);h=yx.prototype;h.kf=null;h.w=null;h.df=null;
h.set=function(a,b,c,d){Jd.prototype.set.call(this,a,b);c&&(this.kf=a);d&&(this.df=a);return this};function zx(a,b,c,d){return a.set(b.key,b.caption,c,d)}h.render=function(){if(this.w){this.w.innerHTML=uu(wu);var a=Lh(this.w);this.forEach(function(b,c){var d=a.j("button",{name:c},b);c==this.kf&&(d.className="goog-buttonset-default");this.w.appendChild(d)},this)}};h.g=function(){return this.w};
var qx="Close",Ax={key:"ok",caption:"OK"},Bx={key:"cancel",caption:"Cancel"},Cx={key:"yes",caption:"Yes"},Dx={key:"no",caption:"No"},Ex={key:"save",caption:"Save"},Fx={key:"continue",caption:"Continue"};function mx(){return zx(zx(new yx,Ax,!0),Bx,!1,!0)}"undefined"!=typeof document&&(zx(new yx,Ax,!0,!0),mx(),zx(zx(new yx,Cx,!0),Dx,!1,!0),zx(zx(zx(new yx,Cx),Dx,!0),Bx,!1,!0),zx(zx(zx(new yx,Fx),Ex),Bx,!0,!0));function Gx(){this.a=[]}A(Gx,yw);da(Gx);Gx.prototype.Fa=function(a){var b=Gx.f.Fa.call(this,a);Gv(b,"goog-submenu");var c=a.b.j("span");c.className="goog-submenu-arrow";Hx(a,c);this.la(b).appendChild(c);return b};Gx.prototype.Sb=function(a,b){var c=this.la(a),d=c&&c.lastChild;Gx.f.Sb.call(this,a,b);d&&c.lastChild!=d&&Fv(d,"goog-submenu-arrow")&&c.appendChild(d)};
Gx.prototype.Rc=function(a){Gx.f.Rc.call(this,a);var b=a.L(),c=Ph(a.b.a,"span","goog-submenu-arrow",b)[0];Hx(a,c);c!=b.lastChild&&b.appendChild(c);a=a.g();rv(a,"haspopup","true")};function Hx(a,b){Yu(a)?(Gv(b,"goog-submenu-arrow-rtl"),ei(b,"\u25c4")):(Iv(b,"goog-submenu-arrow-rtl"),ei(b,"\u25ba"))};function Ix(a,b,c,d){Dw.call(this,a,b,c,d||Gx.B())}A(Ix,Dw);h=Ix.prototype;h.hd=null;h.jg=null;h.Vf=!1;h.oa=null;h.Zd=!1;h.A=function(){Ix.f.A.call(this);Y(this).listen(this.Aa(),"hide",this.sh);this.oa&&Jx(this,this.oa,!0)};h.ka=function(){Y(this).X(this.Aa(),"hide",this.sh);this.oa&&(Jx(this,this.oa,!1),this.Zd||(this.oa.ka(),ai(this.oa.g())));Ix.f.ka.call(this)};h.u=function(){this.oa&&!this.Zd&&this.oa.S();this.oa=null;Ix.f.u.call(this)};
h.Ga=function(a,b){Ix.f.Ga.call(this,a);b&&(Kx(this).Za=!0);a||(this.hd&&r.clearTimeout(this.hd),this.hd=$f(this.ub,218,this))};h.ig=function(){var a=this.Aa();a&&pw(a)==this&&(Lx(this,!0),Mx(this))};h.ub=function(){var a=this.oa;a&&a.Aa()==this&&(Lx(this,!1),Vu(a,function(a){"function"==typeof a.ub&&a.ub()}))};function Nx(a){a.hd&&r.clearTimeout(a.hd);a.jg&&r.clearTimeout(a.jg)}h.pd=function(a,b){var c=Ix.f.pd.call(this,a,b);c&&!this.za&&this.ub();return c};
function Mx(a){Vu(a.Aa(),function(a){a!=this&&"function"==typeof a.ub&&(a.ub(),Nx(a))},a)}h.Ia=function(a){var b=a.a,c=Yu(this)?37:39,d=Yu(this)?39:37;if(!this.Vf){if(!this.isEnabled()||b!=c&&b!=this.Zf)return!1;this.ig();qw(Kx(this));Nx(this)}else if(!Kx(this).Ia(a))if(b==d)this.ub();else return!1;a.preventDefault();return!0};h.fj=function(){if(this.oa.Aa()==this){Nx(this);var a=this.Oc();a.Xa(Zu(a,this));Mx(this)}};h.sh=function(a){a.target==this.Oc()&&(this.ub(),Nx(this))};
h.tc=function(a){this.isEnabled()&&(Nx(this),this.jg=$f(this.ig,218,this));Ix.f.tc.call(this,a)};h.Ta=function(a){Nx(this);if(Yv(this,8))return Ix.f.Ta.call(this,a);this.ig();return!0};
function Lx(a,b){a.dispatchEvent(Ru(64,b));var c=Kx(a);if(b!=a.Vf){var d=a.g();b?Gv(d,"goog-submenu-open"):Iv(d,"goog-submenu-open")}if(b!=c.ya&&(b&&(c.U||c.render(),c.Xa(-1)),c.nc(b),b)){var c=new Nw(a.g(),6,!1),d=Kx(a),e=d.g();d.ya||(e.style.visibility="hidden",R(e,!0));c.c(e,4);d.ya||(R(e,!1),e.style.visibility="visible")}a.Vf=b}function Jx(a,b,c){var d=Y(a);(c?d.listen:d.X).call(d,b,"enter",a.fj)}h.ic=function(){return Kx(this).ic()};
function Kx(a){if(a.oa)a.Zd&&a.oa.Aa()!=a&&Su(a.oa,a);else{var b=new Iw(a.b),c=a.oa;b!=c&&(c&&(a.ub(),a.U&&Jx(a,c,!1)),a.oa=b,a.Zd=!1,b&&(Su(b,a),b.nc(!1,!0),b.Kd=!1,uw(b,!1),a.U&&Jx(a,b,!0)))}a.oa.g()||a.oa.J();return a.oa}h.tb=function(a){return Kx(this).tb(a)};Kv("goog-submenu",function(){return new Ix(null)});function Ox(a,b){var c;c=a.replace("@","%40");c="http://www.google.com/m8/feeds/contacts/"+c+"/base/"+ ++Px;b.id={$t:c};st.call(this,b)}A(Ox,zt);var Px=0;function Qx(a,b,c){this.c=a;this.a=b;this.b=c;this.kind=Rx}var Rx="d";
function Sx(a,b){var c,d={gd$email:[{address:a.a}]};a.b&&(d.gd$name={gd$fullName:{$t:a.b}});c=new Ox(a.c,d);for(var d=[],e=0;e<b.length;e++){for(var f=e,g=c,k=b[e],l=0,m=At(g),n=At(k),p=0;p<m.length;p++)for(var q=m[p],s=0;s<n.length;s++){var w=n[s];q&&q==w&&(l+=1)}m=0;q=g.data.gd$name;s=k.data.gd$name;if(q&&s)for(w=["gd$familyName","gd$givenName","gd$additionalName","gd$fullName"],n=[.06,.06,.06,.12],p=0;4>p;p++){var y=q[w[p]],G=s[w[p]];y&&G==y&&(m+=n[p])}p=0;n=g.Cd();q=k.Cd();n&&n==q&&(p+=.2);s=
0;g=Bt(g);k=Bt(k);q=g.length;for(n=[];q--;){s=g[q];w=k.length;for(n[q]=0;w--;)y=k[w],s.$t&&y.$t&&(y=.7*rt(s,y),n[q]=Math.max(n[q],y));s=Mi(n).value}d[f]=l+m+p+s}c=[];for(e=0;e<b.length;e++)f=rb(c,ub,d[e]),0>f?(pb(c,-(f+1),0,d[e]),l=b.splice(e,1),pb(b,-(f+1),0,l[0])):pb(c,f,0,d[e])}Qx.prototype.toString=function(){return"ContactModel:"+this.a};function Tx(a,b){this.parent=a;this.ia=b}Tx.prototype.Dc=function(){return Ux(this.parent.module).module_fields[this.ia]};function Vx(a){return(a=a.Dc())?a.group:""}Tx.prototype.ob=function(){return this.parent.module.value(this.ia)};Tx.prototype.jd=function(){return this.ob()};function Wx(a){a=a.Dc();return v(a.label)?a.label.replace(/:$/,""):a.label}function Xx(a){return(a=a.Dc())?a.type||"varchar":"varchar"}function Yx(a){return(a=a.Dc())?!!a.calculated:!1}
var Zx={Oj:"add",Qj:"edit",Wj:"optout",Xj:"primary",Yj:"remove"};Tx.prototype.a=function(){return[]};Tx.prototype.toString=function(){return this.parent+";Field:"+this.ia};Tx.prototype.Ph=function(a){if(Yx(this)||a===this.ob())return null;var b={};b[this.ia]=a;return b};function $x(a,b){Tx.call(this,a,b)}A($x,Tx);$x.prototype.ob=function(){var a;a:{var b=this.parent;a=this.ia;var c=b.module.value("email");if(u(c)){for(b=0;b<c.length;b++){var d=c[b];if(d.email_address_id==a){a=d.email_address;break a}}a=null}else a=b.module.value(a)}return a};$x.prototype.Dc=function(){return Ux(this.parent.module).module_fields[this.ia]||Ux(this.parent.module).module_fields.email};
$x.prototype.Ph=function(a){if(!a)return null;var b=this.parent;if(ay(b)){for(var b=by(b),c=0;c<b.length;c++){var d=b[c];if(b[c].email_address_id==this.ia){if(d.email_address==a)return null;b[c].email_address=a;b[c].email_address_caps=a.toUpperCase();return{email:b}}}b={};b[this.ia]=a;return b}if(b.module.value(this.ia)==a)return null;b={};b[this.ia]=a;return b};
function cy(a){var b=a.parent;if(ay(b)){for(var c=by(b),b=0;b<c.length;b++)if(c[b].email_address_id==a.ia)return a=Am(c),a.splice(b,1),{email:a};return null}return b.module.value(a.ia)?(b={},b[a.ia]=void 0,b):null}
$x.prototype.a=function(){var a;a:{var b=this.parent;a=this.ia;var c=b.module.value("email");if(u(c)){for(b=0;b<c.length;b++){var d=c[b];if(d.email_address_id==a){a="1"==d.opt_out;break a}}a=null}else a="email"==a?"1"==b.module.value("email_opt_out"):null}return[{name:"remove",label:"Remove"},{name:"optout",label:"Opt out",type:"bool",value:a}]};function dy(a,b){this.qb=null;this.a=a||{};this.Of=Am(b||[])}dy.prototype.render=function(a){this.qb=document.createElement("div");this.qb.className="more-menu";var b=ey(this.a.className||"more-vert"),c=document.createElement("div");c.className="svg-button";c.appendChild(b);b=fy(this.Of);b.classList.add("flyout-menu");this.qb.appendChild(c);this.qb.appendChild(b);a.appendChild(this.qb)};
function gy(a){var b=ni(a.target,null,"goog-menuitem");if(b){a.preventDefault();a.stopPropagation();a=b.getAttribute("name");var c=b.classList.contains("goog-menuitem-disabled"),d=ni(b,null,"flyout-menu");R(d,!1);setTimeout(function(){R(d,!0)},1E3);return c?null:a}return null}dy.prototype.g=function(){return this.qb};
function fy(a){for(var b=Lh(),c=[],d=0;d<a.length;d++){var e=a[d];if(e){var f=[b.j("div",{"class":"goog-menuitem-content"},e.label)];if("bool"==e.type){var g=b.j("div",{"class":"goog-menuitem-checkbox",role:"menuitem"});f.unshift(g)}e.children&&(g=ey("arrow-drop-right"),g.classList.add("left-arrow"),f.unshift(g));g={"class":"goog-menuitem",role:"bool"==e.type?"goog-menuitem-checkbox":"menuitem"};e.title&&(g.title=e.title);f=b.j("div",g,f);f.setAttribute("name",e.name);e.value&&f.classList.add("goog-option-selected");
e.children&&(g=fy(e.children),f.appendChild(g));e.disabled&&f.classList.add("goog-menuitem-disabled");c.push(f)}else e=b.j("div",{"class":"goog-menuseparator",role:"separator"}),c.push(e)}return b.j("div",{"class":"goog-menu goog-menu-vertical",role:"menu"},c)}function hy(a,b){var c=document.createElement("span");c.className="flyout-button";var d=ey("more-vert"),e=fy(b);e.classList.add("flyout-menu");c.appendChild(d);c.appendChild(e);a.appendChild(c)}
function iy(a,b,c){(a=a.g().querySelector('div.goog-menuitem[name="'+b+'"]'))&&(c?a.classList.remove("goog-menuitem-disabled"):a.classList.add("goog-menuitem-disabled"))}function jy(a,b){var c=a.g().querySelector('div.goog-menuitem[name="sync"]');c&&(c.querySelector(".goog-menuitem-content").textContent=b)};function ky(a,b){this.module=a;this.Ha=b||""}h=ky.prototype;h.Ib=function(a){var b=Ux(this.module),c;for(c in b.module_fields)if(c==a)return!0;return!1};h.Tf=function(){var a=Ux(this.module),b=[],c;for(c in a.module_fields){var d=a.module_fields[c];this.Ha&&d.group==this.Ha?b.push(c):this.Ha||d.group||b.push(c)}return b};function ly(a,b){var c=a.module.value(b);return v(c)?c:""}h.uf=function(){var a=this.Ha.replace("_"," ");return a=a.charAt(0).toUpperCase()+a.substr(1)};h.Dd=function(){return null};
h.of=function(){return null};function my(a,b){ky.call(this,a,b)}A(my,ky);function ny(a,b){return a.module.value(a.Ha+"_"+b)}function oy(a,b,c,d,e,f){var g="";a&&(g+=a);c?g=d?c+" "+d+", "+g:g+(" "+c):d&&(g+=" "+d);g||(g=e||"");g||(g=f||"");b&&(g=b+" "+g);return g}my.prototype.Dd=function(){var a=ny(this,"country"),b=ny(this,"city"),c=ny(this,"state"),d=ny(this,"postalcode"),e=ny(this,"street")||"",f=ny(this,"street_2")||"";return oy(a,b,c,d,e,f)};my.prototype.of=function(){return{label:"Edit",name:"edit",type:"text"}};function py(a,b){ky.call(this,a,b);this.La=[]}A(py,ky);py.prototype.a=function(a){var b=qy(this,a);if(b)return b;b=new Tx(this,a);this.La.push(b);return b};function qy(a,b){for(var c=0;c<a.La.length;c++)if(a.La[c].ia==b)return a.La[c];return null};function ry(a){py.call(this,a,"email")}A(ry,py);ry.prototype.Tf=function(){var a=this.module.value("email");if(u(a))return a.map(function(a){return a.email_address_id});var a=ay(this),b=Ux(this.module),c=[],d;for(d in b.module_fields)"email"!=b.module_fields[d].group||a&&"email"==d||c.push(d);return c};ry.prototype.a=function(a){var b=qy(this,a);if(b)return b;b=new $x(this,a);this.La.push(b);return b};function ay(a){var b=a.module.value("email");return t(b)?u(b):!!sy(a.module.parent)}
ry.prototype.Ib=function(a){var b=this.module.value("email");return u(b)?b.some(function(b){return b.email_address_id==a}):ry.f.Ib.call(this,a)};function by(a){var b=a.module.value("email");if(u(b))return b;a=Ux(a.module);var c=[],d;for(d in a.module_fields)"email"==a.module_fields[d].group&&c.push({email_address_id:d,email_address:b,primary_address:"0"});return c};function ty(a){ky.call(this,a,"name")}A(ty,ky);
function uy(a,b){b=b.trim();if(!a.Ib("last_name"))return{full_name:b?b:void 0};var c={salutation:void 0,full_name:void 0,first_name:void 0,last_name:void 0};if(!b)return c;var d=b.split(/\s+/);if(!a.Ib("last_name"))return{name:b};var e=a.module.value("salutation"),f=a.module.value("first_name"),g=a.module.value("last_name");d[0]==e&&(c.salutation=d.shift(),b=b.substr(e.length+1).trim());if((e=a.Ib("salutation"))&&!(e=f&&d[1]==f)&&(e=2<=d.length))if(e=d[0]){"."!=e.charAt(e.length-1)&&(e+=".");var k=
Ux(a.module).module_fields.salutation,e=0<=(k.options?Object.keys(k.options):["Mrs.","Mr."]).indexOf(e)}else e=!1;e&&(c.salutation=d.shift(),b=b.substr(c.salutation.length+1).trim());e=b.indexOf(g);g&&0<=e?(c.first_name=b.substr(0,e-1).trim(),c.last_name=b.substr(e).trim()):(g=b.indexOf(f),f&&0<=g?(c.first_name=f,c.last_name=b.substr(g+f.length+1,b.length).trim()):(c.first_name=d.shift(),c.last_name=d.join(" ")));c.first_name&&(c.full_name=c.first_name);c.last_name&&(c.full_name=c.full_name?c.full_name+
(" "+c.last_name):c.last_name);return c}ty.prototype.uf=function(){return"Name"};ty.prototype.Dd=function(){var a;if(this.Ib("full_name")){a="";var b=this.module.value("full_name");b?a+=b:(a+=this.module.value("first_name")||"",(b=this.module.value("last_name"))&&(a+=" "+b))}else a=this.module.value("name")||"";return a};ty.prototype.of=function(){return{label:"Edit",name:"edit",type:"text"}};function vy(a,b){Tx.call(this,a,b)}A(vy,Tx);vy.prototype.a=function(){return[{name:"remove",label:"Remove"}]};function wy(a){py.call(this,a,"phone")}A(wy,py);wy.prototype.a=function(a){var b=this.La.indexOf(a);if(0<=b)return this.La[b];a=new vy(this,a);this.La.push(a);return a};function xy(a,b){F.call(this);this.parent=a;this.M=b;this.a={}}A(xy,F);h=xy.prototype;h.logger=L("ydn.crm.sugarcrm.model.Record");h.s=function(){return this.M.s()};h.value=function(a){return this.M.value(a)};function yy(a){return rs(a.M)?ws(a.M):""}function zy(a){return a.M.module}function Ux(a){return a.parent.d[zy(a)]}h.save=function(a){return Ay(this.parent,new qs($(this.parent),zy(this),a)).n(function(a){By(this,a)},this)};
function Cy(a){return rs(a.M)?(a=(new vt(Ws,$(a.parent),zy(a),a.s())).K(),ze().c().send("gdata-list-contact",{externalId:a}).n(function(a){return a[0]||null})):sc(null)}function By(a,b){rs(a.M)&&a.M.s();var c=a.M;if(b){c.a||(c.a={});for(var d in b)c.a[d]=b[d]}rs(a.M)?a.dispatchEvent(new Dy):a.dispatchEvent(new Ey)}function Fy(a,b){if(!b||0==Object.keys(b))return sc(!1);var c=Am(a.M.getData()),d;for(d in b)c[d]=b[d];return Ay(a.parent,new qs($(a.parent),zy(a),c)).n(function(a){By(this,a)},a)}
function Gy(a){if(!rs(a.M))return C(Error("record not defined."));var b={module:zy(a),id:a.s()};return Hy(a.parent).send("delete-record",b)}h.u=function(){xy.f.u.call(this);this.a=null};function Iy(a){return rs(a.M)?Jy(a.parent,zy(a),a.s()):null}
function Ky(a,b){if(b!=a.M)if(b)if(b.module!=a.M.module){var c=a.M.module;a.M=b;a.dispatchEvent(new Ly(c,a))}else rs(b)?rs(a.M)?b.s()!=a.M.s()?(a.M.s(),a.M=b,a.dispatchEvent(new Ey(0,a))):(a.M=b,a.dispatchEvent(new Dy(a))):rs(b)&&(a.M=b,a.dispatchEvent(new Ey(0,a))):rs(a.M)&&(a.M.s(),a.M=b,a.dispatchEvent(new Ey(0,a)));else rs(a.M)&&(a.M.a={},a.dispatchEvent(new Ey(0,a)))}h.toString=function(){return"ydn.crm.sugarcrm.model.Record:"+this.M};function My(a,b){E.call(this,a,b)}A(My,E);function Ny(a,b,c,d){E.call(this,"context-change",d);this.c=a;this.t=b||null;this.e=c||null}A(Ny,My);function Ey(a,b){E.call(this,"record-change",b)}A(Ey,My);function Ly(a,b){E.call(this,"module-change",b);this.module=a}A(Ly,My);function Dy(a){E.call(this,"record-update",a)}A(Dy,My);function Oy(a,b,c,d){E.call(this,a,d)}A(Oy,My);function Py(a,b,c){E.call(this,"gdata-updated",c)}A(Py,Oy);function Qy(a,b,c){F.call(this);this.about=a;a={};if(u(b))for(var d=0;d<b.length;d++)a[b[d].module_name]=b[d];else a=b;this.d=a;this.info=c||{};this.P=new Tf(this);this.Ge=new qs($(this),"Users");Ry(this);b=ze();this.P.listen(b,["login","host-permission"],this.Pi);this.e=null}A(Qy,F);var $s="login";h=Qy.prototype;
h.Pi=function(a){"login"==a.type?(a=a.getData())&&a.domain==$(this)&&Sy(this,a):"host-permission"==a.type&&this.about&&(a=a.getData(),a.grant&&a.grant==$(this)&&(this.about.hostPermission=!0,this.dispatchEvent(new E("hag"))))};function sy(a){if(null==a.e&&a.info){var b;b=0<=Sa(a.info?a.info.version||"":"","7");a.e=b}return a.e}function Sy(a,b){if(b){var c=a.about.isLogin,d=!!b&&b.isLogin;a.about=b;!c&&d?a.dispatchEvent(new E($s,a)):c&&!d&&a.dispatchEvent(new E("logout",a))}}h.isLogin=function(){return!!this.about.isLogin};
function Ry(a){a.about&&a.about.userName&&a.send("login-user").n(function(a){a&&a.id&&(this.Ge.a=a||{})},a)}function Ty(a){return a.send("about").n(function(a){Sy(this,a)},a)}function Hy(a){return Ce("sugarcrm",$(a))}function $(a){return a.about.domain}function Uy(a){return a.about.baseUrl?a.about.baseUrl:"https://"+a.about.domain}h.getInfo=function(){return Fb(this.info)};function Jy(a,b,c){return sy(a)?Uy(a)+"#"+b+"/"+c:Uy(a)+"/index.php?module="+b+"&action=DetailView&record="+c}
function Vy(a,b,c){var d={};d.domain=$(a);d.baseUrl=a.about.baseUrl||null;d.username=b;d.password=c;return a.send("login",d).n(function(a){Sy(this,a)},a)}h.send=function(a,b){return Ce("sugarcrm",$(this)).send(a,b)};function Wy(a,b,c,d,e,f){b={store:b};c&&(b.index=c);d&&(d instanceof U?b.range=d.toJSON():b.key=d);b.prefix=!!e;f&&(b.limit=void 0);return Hy(a).send("query",[b])}
function Xy(a,b,c){c={store:b,index:"name",q:c,fetchFull:!1};"Notes"==b&&(c.index="content");return Hy(a).send("search",[c])}
function Yy(a,b,c,d){var e=document.createElement("div");e.innerHTML=b.Mf;var f=b.Sg,f=f&&f instanceof Date&&!isNaN(f.getTime())?Cs(b.Sg):"",g=a.about?a.about.userName||"":"",k;k=a.Ge.value("name")||a.about.userName||null;return a.send("new-record",{module:"Emails",record:{assigned_user_id:g,assigned_user_name:k,type:"archived",date_sent:f,description:e.textContent,description_html:b.Mf,name:b.subject,from_addr:b.li,to_addrs:b.uj,parent_id:d||"",parent_type:c||"",mailbox_id:b.dj||"",message_id:b.Yf||
"",status:"read"}})}function Ay(a,b){var c={module:b.module,record:b.getData()};return a.send("put-record",c)}h.clone=function(){return new Qy(this.about,this.d)};h.u=function(){Qy.f.u.call(this);this.info=null;this.P.S();this.P=null};h.toString=function(){return"ydn.crm.sugarcrm.model.Sugar:"+$(this)};h.ng=function(a){return Ce().send("export-record",a.toJSON()).n(function(a){return new zt(a)},this)};function Zy(a,b,c,d){Qy.call(this,a,b,d);this.a=this.b=this.c=null}A(Zy,Qy);Zy.prototype.yb=function(){return this.a};
function $y(a){if(!a.a)return C("No SugarCRM Record to link with Gmail contact.");a.a.s();var b=a.a.module,c=a.b;if(!c)return C("Not Gmail contact data to link.");var d=Vs(c,Ws,$(a),b);if(d)return C("Contact "+br(c)+" already link to "+d.a+" with the module "+b);b=new vt(Ws,$(a),b,a.a.s(),+new Date(c.data.updated.$t),ss(a.a));c={kind:c.Se(),"gdata-id":c.s(),"external-id":{label:b.module+"#"+b.c+"-"+b.b,value:b.K()}};return Hy(a).send("link",c).n(function(a){this.b=new zt(a);this.dispatchEvent(new Ny(this.c,
this.b,this.a))},a)}function az(a){if(!a.a)return C("No SugarCRM Record to unlink with Gmail contact.");var b=a.a.s(),c=a.a.module,d=a.b;if(!d)return C("Not Gmail contact data to link.");var e=Vs(d,Ws,$(a),c,b);if(!e)return C("No link exists between SugarCRM "+c+" "+b+" and Gmail Contact "+br(d));b={kind:d.Se(),"gdata-id":d.s(),"external-id":e.K()};return Hy(a).send("unlink",b).n(function(a){this.b=new zt(a);this.dispatchEvent(new Ny(this.c,this.b,this.a))},a)}
function bz(a,b){if(a.a)return C("already imported as "+a.a.s()+" in "+a.a.module);var c=a.b;if(!c)return C("no contact gdata to import?");c={module:b,kind:c.Se(),"gdata-id":c.s()};return Hy(a).send("import-gdata",c).n(function(a){this.a=new qs($(this),b,a);this.dispatchEvent(new Ny(this.c,this.b,this.a));return this.a},a)}Zy.prototype.ng=function(a){return Zy.f.ng.call(this,a).n(function(a){this.b=a;this.dispatchEvent(new Py(0,0,this))},this)};
Zy.prototype.update=function(a){return this.isLogin()?cz(this,a):Ty(this).V(function(){return cz(this,a)},this)};function dz(a,b,c){for(var d=b.a,e=[],f=0;f<Pr.length;f++)e[f]={store:Pr[f],index:"ydn$emails",key:d};return Hy(a).send("query",e).n(function(a){for(var d=0;d<a.length;d++){var e=a[d];if(e.result[0])return new Ny(b,c,new qs($(this),e.store,e.result[0]))}return new Ny(b,c)},a)}function ez(a){return a.b&&a.a?!!Vs(a.b,Ws,$(a),a.a.module,a.a.s()):!1}
function fz(a,b,c){var d=Vs(c,Ws,$(a));if(d){var e=[{store:d.module,index:"id",key:d.a}];return Hy(a).send("query",e).n(function(a){if((a=a[0])&&a.result[0])return new Ny(b,c,new qs($(this),a.store,a.result[0]));window.console.warn("link id: "+d.a+" no longer available, deleting..");window.console.error("Removing external id not implemented");dz(this,b,c)},a)}return dz(a,b,c)}
function gz(a,b){if(b){var c=b.a;return Ce().send("gdata-list-contact",{email:c}).n(function(a){a=a.map(function(a){return new zt(a)});Sx(b,a);return a[0]?fz(this,b,a[0]):dz(this,b)},a)}return sc(new Ny(null))}function cz(a,b){return gz(a,b).m(function(a){this.b=a.t;this.c=a.c;this.a=a.e;this.dispatchEvent(a)},function(a){window.console.error(a.stack||a)},a)}
function hz(a,b){if(a.a)return C("already exist as "+a.a.s()+" in "+a.a.module);var c=a.c.a;if(!c)return C("No data to import.");new se;var d=a.c.b,c={email1:c,full_name:d};d&&0<d.length&&(d=d.split(/\s/),d[0]&&(c.first_name=d[0]),d[1]&&(c.last_name=d[d.length-1]));d={module:b,record:c};return Hy(a).send("put-record",d).n(function(a){this.a=new qs($(this),b,a);this.dispatchEvent(new Ny(this.c,this.b,this.a))},a)};function iz(a){this.a=a;this.P=new Tf(this);this.b=null}iz.prototype.logger=L("ydn.crm.gmail.Template");function jz(a,b,c,d,e){kz(a,c.id,d).m(function(a){var g=c.name;av(b).querySelector('input[name="subjectbox"]').value=g;e&&(av(b).querySelector('textarea[name="to"]').value=d);var g=dv(b),k=document.createElement("div");k.innerHTML=a;a=k.querySelectorAll("script");for(var l=0;l<a.length;l++)k.removeChild(a[l]);g.appendChild(k)},function(a){window.console.error(a.stack||a)},a)}
iz.prototype.d=function(a){if(a.target instanceof Dw){var b=a.b;a=a.target.a;var c=this.a;if(a){var d=cv(b)[0],e=!1;d||(d=c.c?c.c.a:null,e=!!d);d?jz(this,b,a,d,e):window.alert("A valid recipient email address is required in To input field.")}else window.open(Uy(c)+"/index.php?module=EmailTemplates&action=EditView&return_module=EmailTemplates&return_action=DetailView",$(c))}};iz.prototype.c=function(a){a=a.target;this.P.X(a,"action",this.d);this.P.X(a,"cc",this.c)};
iz.prototype.e=function(a){a=a.c;var b=a.b,c=new Iw(b),d=ey("drive-document"),b=new Vw(d,c,null,b);b.sa("Insert SugarCRM template");lz(this,function(a){for(var b=[],d=0;d<a.length;d++)-1==b.indexOf(a[d].type)&&b.push(a[d].type);for(d=0;d<b.length;d++)if(b[d]){for(var k=new Ix(b[d],null,c.b),l=0;l<a.length;l++)if(a[l].type==b[d]){var m=new Dw(a[l].name,a[l]);Kx(k).R(m,!0)}c.R(k,!0)}for(l=0;l<a.length;l++)a[l].type||(m=new Dw(a[l].name,a[l]),c.R(m,!0));c.R(new Hw,!0);c.R(new Dw("New template...",null),
!0)},this);a.R(b,!0);this.P.listen(a,"action",this.d);this.P.listen(a,"cc",this.c)};function mz(a){return 0<=a.indexOf("$contact_name")||0<=a.indexOf("$contact_account_name")}function lz(a,b,c){Wy(a.a,"EmailTemplates",void 0,void 0,void 0,200).m(function(a){a=a[0];for(var e=[],f=0;f<a.result.length;f++){var g=a.result[f];e.push({id:g.id,name:g.name,type:g.type||"",bk:mz(g.body_html)})}b.call(c,e)},function(a){throw a;},a)}
function kz(a,b,c){var d=a.a;if(v(c))return d.send("query",[{store:"Contacts",index:"ydn$emails",key:c,limit:1},{store:"Leads",index:"ydn$emails",key:c,limit:1}]).n(function(a){var f=null;a[0].result[0]?f=new qs($(d),"Contacts",a[0].result[0]):a[1].result[0]&&(f=new qs($(d),"Leads",a[1].result[0]));return f?(a=new xy(d,f),kz(this,b,a)):ze().c().send("gdata-list-contact",{email:c}).n(function(a){if(a&&a[0]){var c={};zs(a[0],c);a=new xy(d,new qs($(d),"Contacts",c));return kz(this,b,a)}return null},
this)},a);if(!v(b)||16>b.length)throw Error("valid template id required, but "+b+" found.");return d.send("get",{module:"EmailTemplates",id:b}).n(function(a){a=a.body_html;if(v(a)){var d=a,g=this.a;a=sy(g);if(!1===a)var k=document,d=Ra(d,"&")?Ka(d,k):d;if((g=g.Ge)&&rs(g)){var k=this.a.d.Users,l;for(l in k.module_fields)k=g.value(l),v(k)&&(a?d=d.replace(new RegExp("{::future::Users::"+l+"::}","g"),k):(d=d.replace(new RegExp("\\$user_"+l,"g"),k),d=d.replace(new RegExp("\\$contact_user_"+l,"g"),k)))}else M(this.logger,
"Login user info not available");if(c&&0<Object.keys(c.M.a).length)for(l in g=Ux(c),g.module_fields)k=c.value(l),v(k)&&(d=a?d.replace(new RegExp("{::future::Contacts::"+l+"::}","g"),k):d.replace(new RegExp("\\$contact_"+l,"g"),k));return d}throw Error("Template record: "+b+" does not have body_html");},a)};function nz(a){for(var b=oz,c=0;c<b.b.length;c++){var d=b.b[c],e=b.a[a];e&&d.a&&(d.a.children[0].textContent=e.title+" ",e.ud?(d.a.children[1].textContent=e.Rf,d.a.children[1].href=e.ud,d.a.children[1].title=e.qe,d.a.children[1].style.display=""):d.a.children[1].style.display="none",d.a.children[2].textContent=" "+(e.update||""))}}var oz=new function(){this.a=[];this.b=[]};
function pz(a,b){oz.a.push({title:a,update:b,type:"n"});var c=oz.a.length-20;0<=c&&(oz.a[c]=void 0);c=oz.a.length-1;nz(c);return c}function qz(a,b,c,d){var e=oz.a[a];e&&(e.title=b,c&&(e.update=c),d&&(e.type=d),nz(a))}function rz(a,b){var c=oz.a[a];c&&(c.update=b,c.type="e",nz(a))}function sz(a,b,c,d){var e=oz.a[a];e&&(b?(e.ud=b,e.Rf=c,e.qe=d):(e.ud=void 0,e.Rf=void 0,e.qe=void 0),nz(a))};function tz(a){var b=a.type;if(!t(b))return null;switch(b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":for(var b=[],c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return t(a.value)?a.value:null}}function uz(a,b){var c=a.elements[b];if(c){if(c.type)return tz(c);for(var d=0;d<c.length;d++){var e=tz(c[d]);if(e)return e}}return null};function vz(a,b,c,d){lx.call(this);this.G=d;wx(this,c);this.setTitle(a);this.Uc=a=vu(b,null);this.bc&&(this.bc.innerHTML=uu(a));this.Yd=!0;vx(this,!1);nx(this);this.Vd=!0;a=Y(this);a.listen(this,xx,this.Gc);a.listen(this,xx,this.Zb)}A(vz,lx);vz.prototype.Gc=function(a){this.G&&(this.G.callback(a.key),this.G=null)};vz.prototype.Zb=function(){this.G&&(this.G.callback("cancel"),this.G=null)};
function wz(){var a=new B,b=zx(new yx,Ax,!0,!0);(new vz("Yathit CRM Setting","User setting cannot change because you are not login Yathit server.",b,a)).Pa(!0);return a};function xz(){this.c=this.b=this.h=this.a=null;Vp();this.d=null;this.e=""}da(xz);xz.prototype.logger=L("ydn.crm.ui.UserSetting");xz.prototype.isLogin=function(){return!!this.a&&this.a.is_login};function yz(a){return a.isLogin()&&(!a.d||a.d==a.a.email)}
xz.prototype.$a=function(){if(!this.c){var a=this;chrome.storage.sync.get("user-setting",function(b){a.h=b["user-setting"]||zz});Az(this);this.c=Tt().V(function(a){(this.d=a)?pz("Loading user setting for "+a):pz("User setting not available.");return Ce().send("login-info",{gmail:a}).m(function(a){(this.a=a)?a.is_login?pz(a.email+" login."):pz("Not login to Yathit server."):pz("Login to Yathit server failed.")},function(){this.a=null;pz("login error.");ie(this.logger,"login fail")},this)},this)}return this.c};
function Bz(a){a.a=null;a.h=null;a.c=null;a.$a()}function Cz(a){return a.a.email}var zz={},Dz={Group:{},Field:{}};function Az(a){if(a.b)sc(a.b);else{var b=new B;chrome.storage.sync.get("sugar-setting",function(c){a.b=c["sugar-setting"]||Dz;b.callback(a.b)})}}function Ez(a){var b={};b["sugar-setting"]=a.b;var c=new B;chrome.storage.sync.set(b,function(){c.callback(b)})}function Fz(){var a=xz.B();a.b||Az(a);return a.b||Am(Dz)}
function Gz(a){lx.call(this);this.G=a;wx(this,mx());this.setTitle("Yathit CRM Setting");this.Yd=!0;vx(this,!1);nx(this);this.Vd=!0;a=this.L();a.classList.add("ydn-crm");a.innerHTML=Au(Lu());a=Y(this);a.listen(this,xx,this.Gc);a.listen(this,xx,this.Zb)}A(Gz,lx);Gz.prototype.Gc=function(){if(this.G){var a=this.L().querySelector("form.basic-setting"),b={};b["cp-po"]=uz(a,"context-panel-position");b["lg-cc"]=!!uz(a,"log-on-console");this.G.callback(b);this.G=null}};
Gz.prototype.Zb=function(){this.G&&(this.G.callback(null),this.G=null)};
xz.prototype.show=function(){if(!yz(this))return wz();var a=new B,b=new Gz(a),c,d=["lg-cc","cp-po"];chrome.storage.sync.get(d,function(a){c=a;var d=b.L().querySelector("form.basic-setting"),g=d.querySelector("input[name=log-on-console]");a=!!a["lg-cc"];var k=g.type;if(t(k))switch(k.toLowerCase()){case "checkbox":case "radio":g.checked=a?"checked":null;break;case "select-one":g.selectedIndex=-1;if(v(a))for(var l=0;k=g.options[l];l++)if(k.value==a){k.selected=!0;break}break;case "select-multiple":v(a)&&
(a=[a]);for(l=0;k=g.options[l];l++)if(k.selected=!1,a)for(var m,n=0;m=a[n];n++)k.value==m&&(k.selected=!0);break;default:g.value=null!=a?a:""}d=d.querySelectorAll("input[name=context-panel-position]");g=Np["cp-po"]||Pp;for(a=0;a<d.length;a++)if(g==d[a].value){d[a].setAttribute("checked","1");break}b.Pa(!0)}.bind(this));return a.n(function(a){if(a){for(var b={},g=0;g<d.length;g++){var k=d[g];a[k]!=c[k]&&(b[k]=a[k])}(a=0<Object.keys(b).length)&&chrome.storage.sync.set(b);return a}})};
function Hz(a){var b=qp();return"tk"==a?!0:"su"==a||"gc"==a?b==tp:!1};function Iz(a){this.name=a||""}Iz.prototype.Le=function(){return this.name.toUpperCase()};Iz.prototype.getName=function(){return this.name};function Jz(a){this.name=a.name||"";this.a=a}A(Jz,Iz);h=Jz.prototype;h.Le=function(){return this.a.label||""};h.getName=function(){return this.a.name||""};h.Yg=function(){this.getName();return!0};h.Me=function(){return Fz().Field[this.a.name]||null};h.Rg=function(){var a=Fz();a.Field[this.a.name]||(a.Field[this.a.name]={});return a.Field[this.a.name]};
h.kb=function(){var a=this.Me();a&&t(a.normallyHide)?a=!!a.normallyHide:this.a.group?a=-1==Kz.indexOf(this.a.group):(this.getName(),a=!0);return a};function Lz(a){this.name=a||""}A(Lz,Iz);Lz.prototype.Le=function(){return Lz.f.Le.call(this).toUpperCase()};Lz.prototype.Me=function(){return Fz().Group[this.name]||null};Lz.prototype.Rg=function(){var a=Fz();a.Group[this.name]||(a.Group[this.name]={});return a.Group[this.name]};var Kz=["name","email","phone",""];
Lz.prototype.kb=function(){var a=this.Me();return a?!!a.normallyHide:-1==Kz.indexOf(this.name)};Lz.prototype.Yg=function(){var a=this.getName();return-1==Kz.indexOf(a)};function Mz(a,b){E.call(this,"field-change",b);this.c=a}A(Mz,E);function Nz(a,b){E.call(this,"action",b);this.c=a}A(Nz,E);function Oz(){}da(Oz);Oz.prototype.o=function(){return"field"};function Pz(a,b){var c="ydnf-"+(a+"-"+b.name);if(b.options){if(!document.getElementById(c)){var d=document.createElement("datalist");d.id=c;for(var e in b.options)if(e){var f=document.createElement("option");f.setAttribute("value",e);d.appendChild(f)}document.body.appendChild(d)}return c}return null}Oz.prototype.a=function(a){var b=a.a,c=a.b.j("div");c.classList.add(this.o());c.setAttribute("name",b.ia);return a.w=c};
Oz.prototype.refresh=function(a){var b=a.g(),c=a.a;R(b,!!c);if(c){var d=c.ob();b.textContent=d;var e=Wx(c);e?b.setAttribute("title",e):b.removeAttribute("title");(v(d)?ya(d):null==d)?b.classList.add("empty"):b.classList.remove("empty");!Vx(c)&&Qz(a).kb()?b.classList.add("normally-hide"):b.classList.remove("normally-hide")}};Oz.prototype.b=function(a){return a.L().textContent};function Rz(){}A(Rz,Oz);da(Rz);Rz.prototype.a=function(a){var b=Rz.f.a.call(this,a),c=a.a;a=a.b;var d=Wx(c),c=Yx(c),e=Pu(Ou.B()),f=a.j("input",{type:"checkbox",id:e});a=a.j("label",{"for":e},d);c&&f.setAttribute("disabled","true");f.classList.add("value");b.appendChild(f);b.appendChild(a);return b};
Rz.prototype.refresh=function(a){var b=a.g(),c=a.a;R(b,!!c);if(c){var d=c.ob(),e=v(d)?!ya(d):null!=d,f=b.querySelector(".value");"bool"!=Xx(c)||ga(d)||(d="1"==d||"on"==d||"true"==d?!0:!1);f.value=d;e?b.classList.remove("empty"):b.classList.add("empty");!Vx(c)&&Qz(a).kb()&&b.classList.add("normally-hide")}};Rz.prototype.b=function(a){a=a.L().querySelector(".value");return"LABEL"==a.tagName||"SPAN"==a.tagName||"DIV"==a.tagName?a.textContent:"checkbox"==a.type?a.checked:a.value};function Sz(){}A(Sz,Oz);da(Sz);Sz.prototype.a=function(a){var b=Sz.f.a.call(this,a),c=a.a;a=a.b;var d=Wx(c),d=a.j("input",{type:"text","class":"value",title:d,placeholder:d});b.appendChild(d);Yx(c)&&d.setAttribute("disabled","1");c=c.a();0<c.length&&(a=a.j("div",{"class":"hover-button more-menu"}),b.appendChild(a),hy(a,c));return b};
Sz.prototype.refresh=function(a){var b=a.g(),c=a.a;R(b,!!c);if(c){var d=c.ob(),e=v(d)?!ya(d):null!=d;b.querySelector(".value").value=e?d:"";if(d=b.querySelector(".more-menu")){d.innerHTML="";var f=c.a();hy(d,f)}e?b.classList.remove("empty"):b.classList.add("empty");!Vx(c)&&Qz(a).kb()&&b.classList.add("normally-hide")}};Sz.prototype.b=function(a){return a.L().querySelector(".value").value};function Tz(){}A(Tz,Sz);da(Tz);Tz.prototype.a=function(a){var b=Tz.f.a.call(this,a),c=b.querySelector(".value");c.classList.add("enum");(a=Uz(a))&&c.setAttribute("list",a);return b};function Vz(){}A(Vz,Oz);da(Vz);Vz.prototype.a=function(a){var b=Vz.f.a.call(this,a),c=a.b;a=Wx(a.a);c=c.j("TEXTAREA",{"class":"value",title:a,placeholder:a});b.appendChild(c);return b};Vz.prototype.refresh=function(a){var b=a.g(),c=a.a;R(b,!!c);if(c){var d=c.ob(),e=v(d)?!ya(d):null!=d;b.querySelector(".value").value=e?d:"";e?b.classList.remove("empty"):b.classList.add("empty");!Vx(c)&&Qz(a).kb()&&b.classList.add("normally-hide")}};
Vz.prototype.b=function(a){a=a.L().querySelector(".value");return"LABEL"==a.tagName||"SPAN"==a.tagName||"DIV"==a.tagName?a.textContent:"checkbox"==a.type?a.checked:a.value};function Wz(a,b,c){X.call(this,c);b||(b=Xx(a),b="bool"==b?Rz.B():"text"==b?Vz.B():"enum"==b?Tz.B():Sz.B());this.c=b;this.a=a}A(Wz,X);function Qz(a){return new Jz(a.a.Dc())}h=Wz.prototype;h.J=function(){this.c.a(this)};h.A=function(){var a=this.g().querySelector("input");a&&Y(this).listen(a,"blur",this.Fj);(a=this.g().getElementsByClassName("more-menu")[0])&&Y(this).listen(a,"click",this.Gj)};
h.Gj=function(a){a=a.target;var b=ni(a,null,"goog-menuitem").getAttribute("name");if(b){b=new Nz(b,this);this.dispatchEvent(b);var c=ni(a,null,"more-menu");R(c,!1);setTimeout(function(){R(c,!0)},1E3);b.h||("remove"==b.c?(a=this.Qg(),this.dispatchEvent(new Mz(a,this))):"edit"==b.c&&Xz(this))}};function Yz(a){var b=a.a;a=Uz(a);return{La:[{label:Wx(b),name:b.ia,value:b.ob(),type:Xx(b),se:a}]}}function Uz(a){a=a.a;return Pz(zy(a.parent.module),a.Dc())}
function Zz(a){var b=new lx;wx(b,mx());b.setTitle("Edit name");b.Yd=!0;vx(b,!0);nx(b);b.Vd=!0;b.L().classList.add("ydn-crm");var c;c='<div class="field-edit-dialog"><table><tbody>';a=a.La;for(var d=a.length,e=0;e<d;e++){var f=a[e];c+='<tr class="field" name="'+Fu(f.name)+'"><td class="name">'+Du(f.label)+'</td><td><input class="value" type="'+Fu(f.type)+'"'+(f.se?'list="'+Fu(f.se)+'"':"")+'value="'+Fu(f.value)+'" /></td></tr>'}c=Eu(c+"</tbody></table></div>");c=vu(c.toString(),null);b.Uc=c;b.bc&&
(b.bc.innerHTML=uu(c));return b}function Xz(a){var b=Zz(Yz(a));Y(a).listen(b,xx,a.Qh,!1);Vf(Y(a),b,function(){Y(this).X(b,xx,this.Qh,!1)});b.Pa(!0)}h.Qh=function(a){if("ok"==a.key){a=a.target.L().querySelectorAll(".field");for(var b={},c=this.a,d=0;d<a.length;d++){var e=a[d].getAttribute("name"),f=a[d].querySelector(".value").value;c.ob()!=f&&(b[e]=f)}this.dispatchEvent(new Mz(b,this))}};h.Fj=function(){var a=this.c.b(this);(a=this.a.Ph(a))&&this.dispatchEvent(new Mz(a,this))};
h.Qg=function(){var a={};a[this.a.ia]="";return a};h.refresh=function(){this.c.refresh(this)};function $z(a){var b=a.c.b(a);a=a.a;var c=a.jd();if("bool"==Xx(a)&&t(c)&&!ga(c))if("on"==c||"off"==c)b=b?"on":"off";else if("true"==c||"false"==c)b=b?"true":"false";else{if("1"==c||"0"==c)b=b?"1":"0"}else!1===c&&"bool"!=!Xx(a)&&"false"==b?b=c:t(c)||b||(b=c);return b!=c?b:null}h.K=function(){return this.a.ob()};function aA(a,b){X.call(this,b);this.a=a}A(aA,X);function bA(a,b){var c=a.g();b?(c.classList.add("edit"),c.classList.remove("view")):(c.classList.remove("edit"),c.classList.add("view"))}function cA(a){var b=a.g();b.classList.add("view");b.classList.remove("edit");for(b=0;b<Wu(a);b++)Xu(a,b).Ke()}aA.prototype.o=function(){return"record-body"};aA.prototype.J=function(){aA.f.J.call(this);var a=this.g();a.classList.add(this.o());a.classList.add("view")};
aA.prototype.refresh=function(){for(var a=0;a<Wu(this);a++)Xu(this,a).refresh()};function dA(a,b){var c=Sz.B();Wz.call(this,a,c,b)}A(dA,Wz);dA.prototype.Qg=function(){return cy(this.a)};function eA(a,b){var c=Sz.B();Wz.call(this,a,c,b)}A(eA,Wz);function fA(){}da(fA);fA.prototype.o=function(){return"record-group"};fA.prototype.refresh=function(a){for(var b=0;b<Wu(a);b++)Xu(a,b).refresh()};function gA(a){this.data=a||{}}function hA(a){a=a.trim().replace("%40","@");return-1==a.indexOf("@")||-1==a.indexOf(".")?C(Error("Invalid email "+a)):Ce().send("social-profile",{email:a}).m(function(a){return new gA(a)},function(){return new gA(null)})};function iA(a,b){X.call(this,b);this.a=a}A(iA,X);h=iA.prototype;h.L=function(){return Oh("content",this.g())};h.ad=function(){return null};h.o=function(){return"record-group"};h.J=function(){var a=this.b,b=a.j("div",this.o()),c=a.j("div","header"),a=a.j("div","content");b.appendChild(c);b.appendChild(a);this.w=b;b.setAttribute("name",this.a.Ha);(new Lz(this.a.Ha)).kb()&&b.classList.add("normally-hide")};h.refresh=function(){};
h.Ke=function(){var a=(new Lz(this.a.Ha)).kb(),b=this.g();a?b.classList.add("normally-hide"):b.classList.remove("normally-hide")};h.kg=function(a,b){var c=a?'[name="'+a+'"]':"";if(c=this.L().querySelector("div.field"+c+" input.value"))c.value=b};h.og=function(){return!1};function jA(){}da(jA);function kA(a,b){a.L().querySelector("input.value").value=b}jA.prototype.refresh=function(a){var b=a.a;a=a.L();R(a,!!b);if(b){a=a.querySelector(".value");var c=b.Dd();"INPUT"==a.tagName?a.value=c:a.textContent=c;(b=b.uf())?a.setAttribute("title",b):a.removeAttribute("title");(v(c)?ya(c):null==c)?a.classList.add("empty"):a.classList.remove("empty")}};function lA(a,b,c){this.d=b||jA.B();iA.call(this,a,c)}A(lA,iA);h=lA.prototype;
h.J=function(){lA.f.J.call(this);var a=this.a,b=this.b,c=b.j("div","field"),d=a.uf(),d=b.j("input",{type:"text","class":"value",title:d,placeholder:d});c.appendChild(d);a=a.of();u(a)?(b=b.j("div",{"class":"hover-button more-menu"}),c.appendChild(b),hy(b,a)):x(a)&&(d=a.name==Zx?"delete-field":"detail-field",b=b.j("div",{"class":"hover-button "+d,title:a.label}),d=ey("delete-field"==d?"delete":"more-horiz"),b.appendChild(d),b.setAttribute("name",a.name),c.appendChild(b));this.L().appendChild(c)};
h.A=function(){lA.f.A.call(this);var a=this.g().querySelector("input");a&&Y(this).listen(a,"blur",this.Hj);(a=this.g().getElementsByClassName("hover-button")[0])&&Y(this).listen(a,"click",this.hj)};h.Hj=function(){var a=this.ad();var b=this.a;if(x(a)){var c=!1,d={},e;for(e in a)if(b.Ib(e)){var f=b.module.value(e);a[e]!==f&&(c=!0,d[e]=a[e])}else c=!0,d[e]=a[e];a=c?d:null}else a=null;a&&this.dispatchEvent(new Mz(a,this))};
h.hj=function(a){if(a=a.b.getAttribute("name"))a=new Nz(a,this),this.dispatchEvent(a),a.h||mA(this,a)};h.ad=function(){for(var a=null,b=0;b<Wu(this);b++){var c=Xu(this,b),d=$z(c);null!==d&&(a||(a={}),a[c.a.ia]=d)}return a};function mA(a,b){if("edit"==b.c){var c=Zz(a.pg());Y(a).listen(c,xx,a.Rh,!1);Vf(Y(a),c,function(){Y(this).X(c,xx,this.Rh,!1)});c.Pa(!0)}}
h.Rh=function(a){if("ok"==a.key){a=a.target.L().querySelectorAll(".field");for(var b={},c=this.a,d=0;d<a.length;d++){var e=a[d].getAttribute("name"),f=a[d].querySelector(".value").value;ly(c,e)!=f&&(b[e]=f)}a=new Mz(b,this);this.dispatchEvent(a);a.h||this.Tg(a)}};h.Tg=function(){};h.refresh=function(){this.d.refresh(this)};h.pg=function(){return{La:[]}};function nA(a,b){lA.call(this,a,null,b);this.c=null}A(nA,lA);h=nA.prototype;h.A=function(){nA.f.A.call(this);this.g().querySelector("input").setAttribute("disabled","1")};function oA(a,b){return a.c&&a.c[b]?a.c[b]:ly(a.a,b)}function pA(a,b,c){a.c||(a.c={});a.c[b]=c}h.pg=function(){var a=this.a,b=[],c=Ux(a.module),d=a.Ha,e;for(e in c.module_fields){var f=c.module_fields[e];f.group==d&&b.push({name:e,label:f.label,type:f.type,value:oA(this,e),se:Pz(zy(a.module),f)})}return{La:b}};
h.og=function(a){if(!a)return!1;var b=Db(a.data,"fc","demographics","locationDeduced");a=!1;if(b){var c=this.a.Ha+"_";!oA(this,c+"country")&&b.country&&(b.country.code?(pA(this,c+"country",b.country.code),a=!0):b.country.name&&(pA(this,c+"country",b.country.name),a=!0));!oA(this,c+"city")&&b.city&&b.city.name&&(pA(this,c+"city",b.city.name),a=!0);!oA(this,c+"state")&&b.state&&b.state.name&&(pA(this,c+"state",b.state.name),a=!0);a&&(b=qA(this),kA(this,b))}return a};
function qA(a){var b=a.a;if(a.c){var c=a.a.Ha+"_",b=oA(a,c+"country"),d=oA(a,c+"city"),e=oA(a,c+"state"),f=oA(a,c+"postalcode"),g=oA(a,c+"street");a=oA(a,c+"street_2");return oy(b,d,e,f,g,a)}return b.Dd()}h.Tg=function(a){this.c=Am(a.c);a=qA(this);kA(this,a)};h.ad=function(){return this.c||null};function rA(a,b,c){b||fA.B();iA.call(this,a,c)}A(rA,iA);h=rA.prototype;h.J=function(){rA.f.J.call(this);tA(this)};function tA(a){for(var b=a.a,c=a.b,d=b.Tf(),e=0;e<d.length;e++){var f=b.a(d[e]),g;f instanceof $x?g=new dA(f,c):f instanceof vy?g=new eA(f,c):g=new Wz(f,null,c);a.R(g,!0)}}h.A=function(){rA.f.A.call(this);Y(this).listen(this,"action",this.ij)};h.ij=function(){};h.ad=function(){for(var a=null,b=0;b<Wu(this);b++){var c=Xu(this,b),d=$z(c);null!==d&&(a||(a={}),a[c.a.ia]=d)}return a};
h.refresh=function(){for(var a=0;a<Wu(this);a++)Xu(this,a).refresh()};h.Ke=function(){rA.f.Ke.call(this);for(var a=0;a<Wu(this);a++){var b=Xu(this,a),c=Qz(b).kb(),b=b.g();c?b.classList.add("normally-hide"):b.classList.remove("normally-hide")}};function uA(a,b){var c=fA.B();rA.call(this,a,c,b)}A(uA,rA);uA.prototype.Ke=function(){for(var a=Wu(this)-1;0<=a;a--)this.removeChild(Xu(this,a),void 0).S();tA(this)};function vA(){}A(vA,fA);da(vA);vA.prototype.o=function(){return"record-group"};vA.prototype.refresh=function(a){for(var b=a.a,c=a.b,d=[],e=0;e<Wu(a);e++){var f=Xu(a,e);f.refresh();d.push(f.a.ia)}f=b.Tf();for(e=0;e<f.length;e++){var g=f[e],k=b.a(g);(new Lz(a.a.Ha)).kb()||-1!=d.indexOf(g)||(g=new Wz(k,null,c),a.R(g,!0))}};function wA(){}A(wA,fA);da(wA);wA.prototype.o=function(){return"list"};function xA(a,b){var c=wA.B();rA.call(this,a,c,b)}A(xA,rA);xA.prototype.L=function(){return Oh("content",this.g())};xA.prototype.refresh=function(){for(var a=0;a<Wu(this);a++)Xu(this,a).refresh()};function yA(a,b){lA.call(this,a,null,b)}A(yA,lA);yA.prototype.pg=function(){var a=this.a;if(a.Ib("full_name"))var b=Pz(zy(a.module),Ux(a.module).module_fields.salutation),a=[{name:"salutation",label:"Salutation",type:"enum",value:ly(a,"salutation"),se:b},{name:"first_name",label:"First name",type:"text",value:ly(a,"first_name")},{name:"last_name",label:"Last name",type:"text",value:ly(a,"last_name")}];else a=[{name:"name",label:"Name",type:"text",value:ly(a,"name")}];return{La:a}};
yA.prototype.ad=function(){var a=this.a,b=this.L().querySelector("input.value").value,c=a.Dd();if(b==c)return null;if(!a.Ib("full_name"))return{name:b};var b=uy(a,b),c=a.module.value("salutation"),d=a.module.value("first_name"),e=a.module.value("last_name"),a=a.module.value("full_name");return c!=b.salutation||d!=b.first_name||e!=b.last_name||a!=b.full_name?b:null};yA.prototype.kg=function(a,b){"full_name"!=a&&"name"!=a||yA.f.kg.call(this,null,b)};
yA.prototype.og=function(a){var b=this.L().querySelector("input.value").value;a=a.data.fc?a.data.fc.contactInfo.fullName:null;return!b&&a?(kA(this,a),!0):!1};function zA(a,b){xA.call(this,a,b)}A(zA,xA);function AA(a,b){aA.call(this,a,b)}A(AA,aA);
AA.prototype.J=function(){AA.f.J.call(this);this.g();var a=this.b,b=this.a,c=[],d=Ux(b),e;for(e in d.module_fields){var f=d.module_fields[e].group;-1==c.indexOf(f)&&c.push(f)}for(d=0;d<c.length;d++){e=c[d];var f=b,g=e;f.a[g]||("name"==g?f.a[g]=new ty(f):0<=["address","alt_address","primary_address"].indexOf(g)?f.a[g]=new my(f,g):f.a[g]="email"==g?new ry(f):"phone"==g?new wy(f):new py(f,g));f=f.a[g];if(f instanceof ry)e=new uA(f,a);else if(f instanceof my)e=new nA(f,a);else if(f instanceof wy)e=new zA(f,
a);else if(f instanceof ty)e=new yA(f,a);else if(f instanceof py)e=f,f=null,""==e.Ha&&(f=vA.B()),e=new rA(e,f,a);else throw Error("Invalid group: "+e);this.R(e,!0)}};function BA(){}da(BA);function CA(a){a=a.g().querySelector(".record-footer div.message");a.textContent="";a.classList.remove("error")};function DA(a,b,c){Dw.call(this,a,b,c);this.ra(16,!0)}A(DA,Dw);Kv("goog-checkbox-menuitem",function(){return new DA(null)});var EA={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",
darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",
ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",
lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",
moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",
seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function FA(a){var b={};a=String(a);var c="#"==a.charAt(0)?a:"#"+a;if(GA.test(c))return b.le=HA(c),b.type="hex",b;c=IA(a);if(c.length){var d=c[0];a=c[1];c=c[2];d=Number(d);a=Number(a);c=Number(c);if(isNaN(d)||0>d||255<d||isNaN(a)||0>a||255<a||isNaN(c)||0>c||255<c)throw Error('"('+d+","+a+","+c+'") is not a valid RGB color');d=JA(d.toString(16));a=JA(a.toString(16));c=JA(c.toString(16));b.le="#"+d+a+c;b.type="rgb";return b}if(EA&&(c=EA[a.toLowerCase()]))return b.le=c,b.type="named",b;throw Error(a+
" is not a valid color string");}var KA=/#(.)(.)(.)/;function HA(a){if(!GA.test(a))throw Error("'"+a+"' is not a valid hex color");4==a.length&&(a=a.replace(KA,"#$1$1$2$2$3$3"));return a.toLowerCase()}var GA=/^#(?:[0-9a-f]{3}){1,2}$/i,LA=/^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i;function IA(a){var b=a.match(LA);if(b){a=Number(b[1]);var c=Number(b[2]),b=Number(b[3]);if(0<=a&&255>=a&&0<=c&&255>=c&&0<=b&&255>=b)return[a,c,b]}return[]}
function JA(a){return 1==a.length?"0"+a:a};function MA(){}A(MA,Uw);da(MA);MA.prototype.a=function(a,b){return MA.f.a.call(this,b.j("div","goog-color-menu-button-indicator",a),b)};MA.prototype.md=function(a,b){if(a){var c=this.la(a);if(c&&c.firstChild){var d;if(d=b)d=!!(GA.test("#"==b.charAt(0)?b:"#"+b)||IA(b).length||EA&&EA[b.toLowerCase()]);d=d?FA(b).le:null;c.firstChild.style.borderBottomColor=d||(D?"":"transparent")}}};MA.prototype.Rc=function(a){var b=a.g();this.md(b,a.K());Gv(b,"goog-color-menu-button");MA.f.Rc.call(this,a)};function NA(a,b,c,d,e){this.a=!!b;a&&OA(this,a,d);this.b=void 0!=e?e:this.Hb||0;this.a&&(this.b*=-1);this.c=!c}A(NA,Ed);h=NA.prototype;h.Fb=null;h.Hb=0;h.Fh=!1;function OA(a,b,c){if(a.Fb=b)a.Hb=ha(c)?c:1!=a.Fb.nodeType?0:a.a?-1:1;ha(void 0)&&(a.b=void 0)}h.clone=function(){return new NA(this.Fb,this.a,!this.c,this.Hb,this.b)};
h.next=function(){var a;if(this.Fh){if(!this.Fb||this.c&&0==this.b)throw Dd;a=this.Fb;var b=this.a?-1:1;if(this.Hb==b){var c=this.a?a.lastChild:a.firstChild;c?OA(this,c):OA(this,a,-1*b)}else(c=this.a?a.previousSibling:a.nextSibling)?OA(this,c):OA(this,a.parentNode,-1*b);this.b+=this.Hb*(this.a?-1:1)}else this.Fh=!0;a=this.Fb;if(!this.Fb)throw Dd;return a};
h.splice=function(a){var b=this.Fb,c=this.a?1:-1;this.Hb==c&&(this.Hb=-1*c,this.b+=this.Hb*(this.a?-1:1));this.a=!this.a;NA.prototype.next.call(this);this.a=!this.a;for(var c=fa(arguments[0])?arguments[0]:arguments,d=c.length-1;0<=d;d--)b.parentNode&&b.parentNode.insertBefore(c[d],b.nextSibling);ai(b)};function PA(a,b,c,d){NA.call(this,a,b,c,null,d)}A(PA,NA);PA.prototype.next=function(){do PA.f.next.call(this);while(-1==this.Hb);return this.Fb};function QA(){}A(QA,Qv);da(QA);var RA=0;QA.prototype.Fa=function(a){var b=Tv(this,a);a=a.b.j("DIV",b?b.join(" "):null,SA(this,a.W(),a.Qa,a.b));qv(a,"grid");return a};function SA(a,b,c,d){for(var e=[],f=0,g=0;f<c.height;f++){for(var k=[],l=0;l<c.width;l++){var m=b&&b[g++];k.push(TA(a,m,d))}e.push(UA(a,k,d))}a=d.j("TABLE",a.o()+"-table",d.j("TBODY",a.o()+"-body",e));a.cellSpacing=0;a.cellPadding=0;return a}function UA(a,b,c){a=c.j("TR",a.o()+"-row",b);qv(a,"row");return a}
function TA(a,b,c){a=c.j("TD",{"class":a.o()+"-cell",id:a.o()+"-cell-"+RA++},b);qv(a,"gridcell");rv(a,"selected",!1);if(!ki(a)&&!sv(a,"label")){var d;b=new PA(a);for(c="";!c&&(d=Id(b));)1==d.nodeType&&(c=sv(d,"label")||d.title);(d=c)&&rv(a,"label",d)}return a}
QA.prototype.Sb=function(a,b){if(a){var c=Ph(document,"TBODY",this.o()+"-body",a)[0];if(c){var d=0;bb(c.rows,function(a){bb(a.cells,function(a){Zh(a);if(b){var c=b[d++];c&&a.appendChild(c)}})});if(d<b.length){for(var e=[],f=Lh(a),g=c.rows[0].cells.length;d<b.length;){var k=b[d++];e.push(TA(this,k,f));e.length==g&&(k=UA(this,e,f),c.appendChild(k),e.length=0)}if(0<e.length){for(;e.length<g;)e.push(TA(this,"",f));k=UA(this,e,f);c.appendChild(k)}}}Aj(a,!0,Bc)}};
function VA(a,b,c){for(b=b.g();c&&1==c.nodeType&&c!=b;){if("TD"==c.tagName&&Fv(c,a.o()+"-cell"))return c.firstChild;c=c.parentNode}return null}QA.prototype.o=function(){return"goog-palette"};function WA(a){F.call(this);this.a=[];XA(this,a)}A(WA,F);h=WA.prototype;h.Xb=null;h.fg=null;function XA(a,b){b&&(bb(b,function(a){YA(this,a,!1)},a),ob(a.a,b))}h.ic=function(){return nb(this.a)};function ZA(a,b){b!=a.Xb&&(YA(a,a.Xb,!1),a.Xb=b,YA(a,b,!0));a.dispatchEvent("select")}function $A(a){var b=a.Xb;return b?$a(a.a,b):-1}h.clear=function(){kb(this.a);this.Xb=null};h.u=function(){WA.f.u.call(this);delete this.a;this.Xb=null};
function YA(a,b,c){b&&("function"==typeof a.fg?a.fg(b,c):"function"==typeof b.Yc&&b.Yc(c))};function aB(a,b,c){aw.call(this,a,b||QA.B(),c);this.$b&=-89;this.c=new bB;this.c.Ce(this);this.G=-1}A(aB,aw);h=aB.prototype;h.Qa=null;h.Bb=-1;h.ua=null;h.u=function(){aB.f.u.call(this);this.ua&&(this.ua.S(),this.ua=null);this.Qa=null;this.c.S()};h.xd=function(a){aB.f.xd.call(this,a);cB(this);this.ua?(this.ua.clear(),XA(this.ua,a)):(this.ua=new WA(a),a=oa(this.xi,this),this.ua.fg=a,Y(this).listen(this.ua,"select",this.wi));this.Bb=-1};h.Ob=function(){return""};
h.tc=function(a){aB.f.tc.call(this,a);var b=VA(this.d,this,a.target);b&&a.e&&ci(b,a.e)||b==dB(this)||(a=this.W(),eB(this,a?$a(a,b):-1))};h.pc=function(a){aB.f.pc.call(this,a);if(Zv(this,4)&&(a=VA(this.d,this,a.target),a!=dB(this))){var b=this.W();eB(this,b?$a(b,a):-1)}};h.Ta=function(a){var b=dB(this);return b?(this.ua&&ZA(this.ua,b),aB.f.Ta.call(this,a)):!1};
h.Ia=function(a){var b=this.W(),b=b?b.length:0,c=this.Qa.width;if(0==b||!this.isEnabled())return!1;if(a.a==jv||32==a.a)return this.Ta(a);if(36==a.a)return eB(this,0),!0;if(35==a.a)return eB(this,b-1),!0;var d=0>this.Bb?this.ua?$A(this.ua):-1:this.Bb;switch(a.a){case 37:if(-1==d||0==d)d=b;eB(this,d-1);a.preventDefault();return!0;case 39:return d==b-1&&(d=-1),eB(this,d+1),a.preventDefault(),!0;case 38:-1==d&&(d=b+c-1);if(d>=c)return eB(this,d-c),a.preventDefault(),!0;break;case 40:if(-1==d&&(d=-c),
d<b-c)return eB(this,d+c),a.preventDefault(),!0}return!1};h.wi=function(){};function dB(a){var b=a.W();return b&&b[a.Bb]}function eB(a,b){b!=a.Bb&&(fB(a,a.Bb,!1),a.G=a.Bb,a.Bb=b,fB(a,b,!0),a.dispatchEvent("j"))}function gB(a,b){if(a.ua){var c=a.ua;ZA(c,c.a[b]||null)}}
function fB(a,b,c){if(a.g()){var d=a.W();if(d&&0<=b&&b<d.length){var e;e=(e=dB(a))?e.parentNode:null;a.c.g()!=e&&(a.c.w=e);e=a.c;e.Ga(c);Zv(e,2)==c&&(b=d[b])&&(b=b?b.parentNode:null,d=a.d.o()+"-cell-hover",c?Gv(b,d):Iv(b,d),c?rv(a.w,"activedescendant",b.id):b.id==sv(a.w,"activedescendant")&&a.w.removeAttribute("aria-activedescendant"))}}}h.Ga=function(a){a&&-1==this.Bb?eB(this,-1<this.G?this.G:0):a||eB(this,-1);aB.f.Ga.call(this,a)};
h.xi=function(a,b){if(this.g()&&a){var c=a.parentNode,d=this.d.o()+"-cell-selected";b?Gv(c,d):Iv(c,d);rv(c,"selected",b)}};function cB(a){var b=a.W();if(b)if(a.Qa&&a.Qa.width){if(b=Math.ceil(b.length/a.Qa.width),!ha(a.Qa.height)||a.Qa.height<b)a.Qa.height=b}else b=Math.ceil(Math.sqrt(b.length)),a.Qa=new Kh(b,b);else a.Qa=new Kh(0,0)}function bB(){aw.call(this,null);this.Gb|=2}A(bB,aw);function hB(a,b,c){this.r=a||[];aB.call(this,null,b||QA.B(),c);this.r=this.r;this.F=this.C=null;dw(this,iB(this))}A(hB,aB);hB.prototype.F=null;hB.prototype.C=null;hB.prototype.wf=function(){var a=this.ua?this.ua.Xb:null;if(a){var b=a.style[Va("background-color")];if("undefined"!==typeof b)a=b;else{b=a.style;a:{var c=Va("background-color");if(void 0===a.style[c]){var d=hj()+Wa(c);if(void 0!==a.style[d]){a=d;break a}}a=c}a=b[a]||""}return jB(a)}return null};
hB.prototype.hg=function(a){a=jB(a);this.F||(this.F=db(this.r,function(a){return jB(a)}));gB(this,a?$a(this.F,a):-1)};function iB(a){return db(a.r,function(a,c){var d=this.b.j("div",{"class":this.d.o()+"-colorswatch",style:"background-color:"+a}),e;this.C&&this.C[c]?e=this.C[c]:"#"==a.charAt(0)?(e=HA(a),e="RGB ("+[parseInt(e.substr(1,2),16),parseInt(e.substr(3,2),16),parseInt(e.substr(5,2),16)].join(", ")+")"):e=a;d.title=e;return d},a)}
function jB(a){if(a)try{return FA(a).le}catch(b){}return null};function kB(a,b,c,d){Vw.call(this,a,b,c||MA.B(),d)}A(kB,Vw);var lB={t:"#000 #444 #666 #999 #ccc #eee #f3f3f3 #fff".split(" "),ja:"#f00 #f90 #ff0 #0f0 #0ff #00f #90f #f0f".split(" "),C:"#f4cccc #fce5cd #fff2cc #d9ead3 #d0e0e3 #cfe2f3 #d9d2e9 #ead1dc #ea9999 #f9cb9c #ffe599 #b6d7a8 #a2c4c9 #9fc5e8 #b4a7d6 #d5a6bd #e06666 #f6b26b #ffd966 #93c47d #76a5af #6fa8dc #8e7cc3 #c27ba0 #cc0000 #e69138 #f1c232 #6aa84f #45818e #3d85c6 #674ea7 #a64d79 #990000 #b45f06 #bf9000 #38761d #134f5c #0b5394 #351c75 #741b47 #660000 #783f04 #7f6000 #274e13 #0c343d #073763 #20124d #4c1130".split(" ")};
function mB(a){var b=new Iw(a);Ab(lB,function(c){c=new hB(c,null,a);if(c.g())throw Error("Component already rendered");c.Qa=ha(8)?new Kh(8,void 0):8;cB(c);b.R(c,!0)});return b}h=kB.prototype;h.wf=function(){return this.K()};h.hg=function(a){this.Rb(a)};h.Rb=function(a){for(var b=0,c;c=this.c?Xu(this.c,b):null;b++)"function"==typeof c.hg&&c.hg(a);kB.f.Rb.call(this,a)};
h.qd=function(a){"function"==typeof a.target.wf?this.Rb(a.target.wf()):"none"==a.target.K()&&this.Rb(null);kB.f.qd.call(this,a);a.stopPropagation();this.dispatchEvent("action")};h.ea=function(a,b){a&&0==(this.c?Wu(this.c):0)&&(this.rd(mB(this.b)),this.Rb(this.K()));kB.f.ea.call(this,a,b)};Kv("goog-color-menu-button",function(){return new kB(null)});function nB(){}A(nB,Qw);da(nB);nB.prototype.la=function(a){return a};nB.prototype.Fa=function(a){var b=Tv(this,a);return a.b.j("div",{"class":"goog-inline-block "+b.join(" "),title:a.Pb()||""},a.W())};nB.prototype.o=function(){return"goog-css3-button"};Kv("goog-css3-button",function(){return new Sw(null,nB.B())});Kv("goog-css3-toggle-button",function(){var a=new Sw(null,nB.B());a.ra(16,!0);return a});function oB(a,b,c){Sw.call(this,a,b||Tw.B(),c)}A(oB,Sw);Kv("goog-custom-button",function(){return new oB(null)});function pB(a,b,c){Sw.call(this,a,b||Tw.B(),c);this.ra(16,!0)}A(pB,Sw);Kv("goog-toggle-button",function(){return new pB(null)});function qB(){this.a="toolbar"}A(qB,Mv);da(qB);qB.prototype.o=function(){return"goog-toolbar"};qB.prototype.e=function(){return Ov};function rB(a,b,c){lw.call(this,b,a||qB.B(),c)}A(rB,lw);rB.prototype.nd=function(a){rB.f.nd.call(this,a);this.Za||qw(this)};function sB(a,b){X.call(this,b);this.a=a}A(sB,X);sB.prototype.o=function(){return"secondary"};sB.prototype.J=function(){sB.f.J.call(this);this.g().classList.add(this.o())};sB.prototype.A=function(){sB.f.A.call(this);var a=this.a;if(0<=Or.indexOf(zy(a))){var b=Y(this);b.listen(a,"module-change",this.c);b.listen(a,"record-change",this.c);this.c()}};
sB.prototype.c=function(){for(;this.e&&0!=this.e.length;){var a=Xu(this,0);this.removeChild(a,!0);a.S()}a=this.a;if(rs(a.M)){var b=a.parent,a=[{store:"Notes",index:"parent",reverse:!0,keyRange:Lk([zy(a),a.s()])}];b.send("query",a).m(function(a){for(var d=0;d<a.length;d++){var e=a[d];e.result&&0<e.result.length&&(e=new xy(this.a.parent,new qs($(b),"Notes",e.result[0])),e=new tB(e,this.b),this.R(e,!0))}},function(a){throw a;},this)}};var Pp="in",uB=null;function vB(){if(!uB){var a=chrome.extension.getURL("image/all-icons.svg"),b=new XMLHttpRequest;b.open("GET",a,!1);b.onload=function(){uB=b.responseXML;b=null};b.send()}return uB}function ey(a,b){var c=document.createElementNS("http://www.w3.org/2000/svg","svg"),d=vB().getElementById(a);d&&(c.setAttribute("viewBox",d.getAttribute("viewBox")),c.innerHTML=d.innerHTML);2>arguments.length?c.classList.add("icons"):v(b)&&c.classList.add(b);return c};var wB=null,xB=null;function yB(){if(!wB){if(!xB)throw Error("default template document not set.");var a=new XMLHttpRequest;a.open("GET",xB,!1);a.onload=function(){wB=(new DOMParser).parseFromString(a.responseText,"text/html");a=null};a.send()}return wB}function zB(a){var b=document.getElementById(a);b||(b=yB().documentElement.querySelector("#"+a));document.body.contains(b)||(b=document.importNode(b,!0),document.body.appendChild(b));return b}
function AB(a){a.preventDefault();var b=600,c=400,d=a.target.getAttribute("data-window-height"),e=a.target.getAttribute("data-window-width");e&&(b=parseInt(e,10));d&&(c=parseInt(d,10));window.open(a.target.href,void 0,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+b+", height="+c+", top="+(window.innerWidth/2-c/2+window.screenTop)+", left="+(window.innerWidth/2-b/2+window.screenLeft))};function BB(a,b){this.a=document.createElement("dialog");var c=document.createElement("div");c.className="header";var d=document.createElement("div");d.className="content";var e=document.createElement("div");e.className="button-bar";var f=document.createElement("h3");f.textContent=a;c.appendChild(f);v(b)?(f=document.createElement("div"),f.textContent=b,d.appendChild(f)):b&&d.appendChild(b);f=document.createElement("button");f.className="ok default";f.value="ok";f.textContent="OK";e.appendChild(f);
this.a.appendChild(c);this.a.appendChild(d);this.a.appendChild(e);this.a.className="ydn-crm";document.body.appendChild(this.a)}BB.prototype.S=function(){for(var a=this.a.querySelector(".button-bar").querySelectorAll("button"),b=a.length-1;0<=b;b--)a[b].onclick=null;this.a.onclose=null;document.body.removeChild(this.a);this.a=null};
function CB(){var a=new BB("Export to Gmail Contact","SugarCRM Record does not exist"),b=new B;a.a.querySelector(".button-bar").querySelector("button.default").onclick=function(){a.a.close("apply");a.S()};a.a.onclose=function(){b.callback(a.a.returnValue);a.S()};a.a.showModal()};function tB(a,b){X.call(this,b);this.a=a;this.d=new dy({className:"menu"});this.c=new AA(this.a,this.b);this.l=new sB(a,b);BA.B()}A(tB,X);h=tB.prototype;h.logger=L("ydn.crm.sugarcrm.ui.record.Record");h.o=function(){return"record-panel"};h.L=function(){return this.g().querySelector(".content")};function DB(a){return a.g().querySelector(".head")}
h.J=function(){tB.f.J.call(this);var a=this.g(),b=this.b;a.className=this.o()+" "+zy(this.a);var c=b.j("div","head"),d=b.j("div","content");a.appendChild(c);a.appendChild(d);c.classList.add("record-header");c.classList.add("flex-bar");var d=b.j("a",{"class":"title center",title:"Open in SugarCRM"}),e=b.j("span","icon"),f=b.j("a",{title:"View in Gmail contact","class":"badge-icon google"},ey("google","icons-small")),g=b.j("span","svg-button ok-button",ey("check-circle"));g.setAttribute("title","Save");
c.appendChild(e);c.appendChild(f);c.appendChild(d);c.appendChild(g);this.d.render(c);this.R(this.c,!0);this.R(this.l,!0);b=b.j("div","record-footer");a.appendChild(b);b=this.b;a=this.g().querySelector(".record-footer");b=b.j("div","message");a.appendChild(b)};
h.A=function(){tB.f.A.call(this);var a=Y(this),b=this.a;a.listen(b,"click",this.gh,!1);this.g().querySelector(".record-footer");var c=this.g().querySelector(".head .more-menu");a.listen(b,"module-change",this.gh);a.listen(b,"record-change",this.Ui);a.listen(b,"record-update",this.Vi);a.listen(this.L(),"click",this.Di,!1);a.listen(this,["field-change"],this.Ji);a.listen(c,"click",this.Hi);b=DB(this).querySelector(".ok-button");a.listen(b,"click",this.lj);EB(this)};
function FB(a){var b=a.a,c=zB("record-delete-dialog");a=c.querySelector("a.record");a.href=Iy(b);a.textContent=yy(b);c.querySelector("span.type").textContent=zy(b);c.showModal(document.getElementById("sticky-hud-base"));c.querySelector("button[name=cancel]").onclick=function(){c.close("cancel")};a=c.querySelector("button[name=ok]");a.onclick=function(){c.close("ok")};a.focus();c.onclose=function(a){if("ok"==a.target.returnValue){var c=pz("Deleting","...");sz(c,Iy(b),yy(b));Gy(b).m(function(){qz(c,
yy(b)," deleted.")},function(a){rz(c,a.message)},this)}}}function GB(a){var b=a.a;if(rs(b.M)){var c=pz("exporting...");(rs(b.M)?b.parent.ng(b.M):C(Error("no Record to export."))).m(function(a){var b=Vt();qz(c,"Exported to ");b=Ct(a,b);sz(c,b,"View in Gmail contact","Gmail Contact "+br(a));HB(this)},function(a){qz(c,"Error exporting: "+a.message||a)},a)}else CB()}
h.Hi=function(a){a=gy(a);var b=IB+"-";"edit"==a?this.bd(!this.g().classList.contains("edit")):a==JB?FB(this):a==KB?GB(this):a==LB?MB(this):a==NB?OB(this):a&&va(a,"new-")?(a=a.substr(4),PB(this,a,!1)):a&&va(a,b)&&(a=a.substr(b.length),PB(this,a,!0))};h.lj=function(){for(var a=this.c,b=null,c=0;c<Wu(a);c++){var d=Xu(a,c).ad();if(d){b||(b={});for(var e in d)b[e]=d[e]}}QB(this,b)};
function MB(a){var b=document.querySelector("#field-display-dialog")||zB("field-display-dialog"),c=b.querySelector(".content"),d=c.getAttribute("name");if(!d){var e=b.querySelector("button.apply"),f=b.querySelector("button.cancel");e.onclick=function(){b.close("apply")};f.onclick=function(){b.close("cancel")};b.onclose=a.gj.bind(a)}a=a.a;e=zy(a);if(d!=e){c.innerHTML="";c.setAttribute("name",e);d=zB("field-table").content;c.appendChild(d.cloneNode(!0));d=c.querySelector("tbody.group-body");c=c.querySelector("tbody.field-body");
a=Ux(a);e=[];xz.B();for(var g in a.module_fields){var k=a.module_fields[g],l=k.group,f=document.createElement("tr");if(l)if(-1==e.indexOf(l))e.push(l),d.appendChild(f),k=new Lz(l);else continue;else c.appendChild(f),k=new Jz(k);f.setAttribute("name",k.getName());var l=document.createElement("td"),m=document.createElement("td"),n=document.createElement("input");l.appendChild(n);n.type="checkbox";k.kb()||(n.checked=!0);m.textContent=k.Le();f.appendChild(l);f.appendChild(m)}}b.showModal()}
h.gj=function(a){a=a.target;if("apply"==a.returnValue){var b=a.querySelector(".group-body"),b=RB(b);SB(this,!0,b);a=a.querySelector(".field-body");a=RB(a);SB(this,!1,a);a=this.g().classList.contains("edit");cA(this.c);this.c.refresh();a&&bA(this.c,!0)}};function RB(a){for(var b={},c=a.childElementCount,d=0;d<c;d++){var e=a.children[d],f=e.children[0].children[0];b[e.getAttribute("name")]=!f.checked}return b}
function SB(a,b,c){a=Ux(a.a);xz.B();for(var d in c){var e=a.module_fields[d],f;b?f=new Lz(d):f=new Jz(e);var e=f,g=c[d],k=xz.B(),l=e.Me(),m=e.Yg();g==m?l?(delete l.normallyHide,Ez(k)):sc(!1):(l||(l=e.Rg()),l.normallyHide=!!g,Ez(k))}}
function OB(a){a=Am(a.a.M.getData());var b=zB("record-detail-dialog");b.querySelector("button.ok").onclick=function(){b.close("close")};var c=b.querySelector(".content");c.innerHTML="";var d=document.createElement("pre");if(a){for(var e in a)va(e,"ydn$")&&delete a[e];d.textContent=JSON.stringify(a,null,2)}c.appendChild(d);b.showModal()}h.Ji=function(a){this.g().classList.contains("edit")?TB(this,!0):(a.preventDefault(),QB(this,a.c))};
function TB(a,b){var c=DB(a).querySelector(".ok-button");R(c,!!b)}function QB(a,b){var c=a.a,d=pz("Updating...");Fy(c,b).m(function(){TB(this,!1);qz(d,zy(c)," updated.");var a=Iy(c);sz(d,a,yy(c),"View in SugarCRM")},function(a){rz(d,a.message)},a)}h.bd=function(a){var b=this.g();a?b.classList.add("edit"):b.classList.remove("edit");bA(this.c,a)};h.Di=function(a){if(a.target.classList.contains("value"))a:{var b=this.c;if(a=ni(a.target,null,"record-group"))for(var c=0;c<Wu(b);c++)if(Xu(b,c).g()==a)break a}};
h.gh=function(){this.removeChild(this.c,!0);this.c.S();this.c=new AA(this.a,this.b);this.Hd(this.c,1,!0);EB(this)};h.Ui=function(){EB(this)};h.Vi=function(){this.refresh()};function HB(a){UB(a)&&Cy(a.a).n(function(a){if(a){var c=DB(this).querySelector("a.google");R(c,!0);a=new zt(a);c.href=Ct(a,Vt());iy(this.d,KB,!1)}else iy(this.d,KB,!0)},a)}
function EB(a){var b=a.a,c=a.g(),d=DB(a),e=zy(a.a);d.querySelector("span.icon").textContent=e?e.substr(0,2):"";e=d.querySelector("a.google");R(e,!1);e.removeAttribute("href");var e=a.d,f=[];f.push({name:"edit",label:"Edit"},{name:JB,label:"Delete"},null);var g=a.vf();if(0<g.length){for(var k=[],l=0;l<g.length;l++)k[l]={name:"new-"+g[l],label:g[l]};f.push({name:"new",label:"New",children:k})}k=a.tf();if(0<k.length){for(var m=[],l=0;l<k.length;l++)m[l]={name:IB+"-"+k[l],label:k[l]};f.push({name:IB,
label:"Duplicate to",children:m})}(l=UB(a))&&f.push({name:KB,label:"To Gmail",title:"Export SugarCRM Contacts record to Gmail Contact and sync"});(l||0<g.length||0<k.length)&&f.push(null);f.push({name:NB,label:"View details ..."},{name:LB,label:"Fields ..."});e.Of=Am(f);e.qb&&(f=e.qb.querySelector(".flyout-menu"),e.qb.removeChild(f),f=fy(e.Of),f.classList.add("flyout-menu"),e.qb.appendChild(f));d=d.querySelector(".ok-button");R(d,!1);VB(a);CA(a);cA(a.c);a.c.refresh();c.className=rs(b.M)?a.o()+" "+
zy(b):a.o()+" "+zy(b)+" empty";HB(a)}h.ka=function(){tB.f.ka.call(this)};h.refresh=function(){rs(this.a.M)?this.g().classList.remove("empty"):this.g().classList.add("empty");VB(this);CA(this);this.c.refresh()};function WB(a,b){if(b){var c=a.c,d;for(d in b){var e;a:{if(e=Ux(c.a).module_fields[d]){e=e.group||"";for(var f=0;f<Wu(c);f++){var g=Xu(c,f);if(g.a.Ha==e){e=g;break a}}}e=null}e&&e.kg(d,b[d])}}}h.toString=function(){return"ydn.crm.sugarcrm.ui.record.Record:"+this.a};
function PB(a,b,c){var d=a.a,e=null;c&&(e=Am(d.M.getData()),delete e.id,delete e._module,delete e.date_entered,delete e.date_modified);Ky(d,new qs($(d.parent),b));e&&WB(a,e);a.bd(!0)}var JB="delete",NB="record-detail",IB="duplicate",KB="export",LB="field-option";tB.prototype.vf=function(){return[]};tB.prototype.tf=function(){return[]};function UB(a){return(a=a.a)&&"Contacts"==zy(a)?!0:!1}
function VB(a){var b=DB(a),c=a.a,b=b.querySelector("a.title");rs(c.M)?(b.textContent=yy(c),b.href=Iy(c),b.target=$(c.parent),iy(a.d,IB,!0)):(b.innerHTML="",b.href="",iy(a.d,IB,!1))};function XB(a,b){tB.call(this,a,b)}A(XB,tB);h=XB.prototype;h.o=function(){return XB.f.o.call(this)+" new-record"};h.A=function(){XB.f.A.call(this);var a=this.a;Y(this).listen(a.parent,"context-change",this.Cj)};h.Cj=function(a){var b=this.a;a.e?Ky(b,a.e):a.e||Ky(b,new qs($(b.parent),zy(b)))};h.vf=function(){return[]};h.tf=function(){return Pr};var YB;function ZB(a){var b=z(),c=Math.floor((b-a)/6E4),b=!1;0>c&&(b=!0,c*=-1);if(60>c)return YB(c,b,0);c=Math.floor(c/60);if(24>c)return YB(c,b,1);c=new Date(z());c.setHours(0);c.setMinutes(0);c.setSeconds(0);c.setMilliseconds(0);c=Math.ceil((c.getTime()-a)/864E5);b&&(c*=-1);return 14>c?YB(c,b,2):""}
YB=function(a,b,c){var d=df(a);return b||0!=c?b&&0==c?1==a?"in "+(d+" minute"):"in "+(d+" minutes"):b||1!=c?b&&1==c?1==a?"in "+(d+" hour"):"in "+(d+" hours"):b||2!=c?b&&2==c?1==a?"in "+(d+" day"):"in "+(d+" days"):"":1==a?d+" day ago":d+" days ago":1==a?d+" hour ago":d+" hours ago":1==a?d+" minute ago":d+" minutes ago"};function $B(){}A($B,Qv);da($B);h=$B.prototype;h.o=function(){return"goog-tab"};h.oc=function(){return"tab"};h.Fa=function(a){var b=$B.f.Fa.call(this,a);(a=a.Pb())&&this.sa(b,a);return b};h.Pb=function(a){return a.title||""};h.sa=function(a,b){a&&(a.title=b||"")};function aC(a,b,c){aw.call(this,a,b||$B.B(),c);this.ra(8,!0);this.Gb|=9}A(aC,aw);aC.prototype.Pb=function(){return this.c};aC.prototype.sa=function(a){this.d.sa(this.g(),a);this.Ah(a)};aC.prototype.Ah=function(a){this.c=a};Kv("goog-tab",function(){return new aC(null)});function bC(){this.a="tablist"}A(bC,Mv);da(bC);bC.prototype.o=function(){return"goog-tab-bar"};bC.prototype.b=function(a){var b=bC.f.b.call(this,a);if(!this.d){var c=this.o();this.d=Ib(cC,c+"-top",dC,c+"-bottom",eC,c+"-start",fC,c+"-end")}b.push(this.d[a.d]);return b};function gC(a,b,c){a=a||cC;var d=a==eC||a==fC?Pv:Ov;if(this.g())throw Error("Component already rendered");this.Vb=d;this.d=a;lw.call(this,this.Vb,b||bC.B(),c);hC(this)}A(gC,lw);var cC="top",dC="bottom",eC="start",fC="end";h=gC.prototype;h.Ua=null;h.A=function(){gC.f.A.call(this);hC(this)};h.u=function(){gC.f.u.call(this);this.Ua=null};h.removeChild=function(a,b){iC(this,a);return gC.f.removeChild.call(this,a,b)};h.gg=function(a){gC.f.gg.call(this,a);jC(this,Xu(this,a))};
function jC(a,b){b?b.Yc(!0):a.Ua&&a.Ua.Yc(!1)}function iC(a,b){if(b&&b==a.Ua){for(var c=Zu(a,b),d=c-1;b=Xu(a,d);d--)if(b.za&&b.isEnabled()){jC(a,b);return}for(c+=1;b=Xu(a,c);c++)if(b.za&&b.isEnabled()){jC(a,b);return}jC(a,null)}}h.Yi=function(a){this.Ua&&this.Ua!=a.target&&this.Ua.Yc(!1);this.Ua=a.target};h.aj=function(a){a.target==this.Ua&&(this.Ua=null)};h.Wi=function(a){iC(this,a.target)};h.Xi=function(a){iC(this,a.target)};h.nd=function(){pw(this)||this.Xa(Zu(this,this.Ua||Xu(this,0)))};
function hC(a){Y(a).listen(a,"select",a.Yi).listen(a,"unselect",a.aj).listen(a,"disable",a.Wi).listen(a,"hide",a.Xi)}Kv("goog-tab-bar",function(){return new gC});function kC(a,b){tB.call(this,a,b)}A(kC,tB);h=kC.prototype;h.o=function(){return kC.f.o.call(this)+" new-record"};h.A=function(){kC.f.A.call(this);var a=this.a;Y(this).listen(a.parent,"context-change",this.Dj);this.bd(!0)};h.Dj=function(a){var b=this.a;a.e||a.t?R(this.g(),!1):(Ky(b,new qs($(b.parent),zy(b))),this.bd(!0),a.c&&"s"==a.c.kind?(WB(this,{email1:a.c.a||"",full_name:a.c.b||""}),lC(this,a.c),R(this.g(),!0)):R(this.g(),!1))};
function lC(a,b){if(b&&b.a){var c=b.a,d=pz("Querying social data for "+c);hA(b.a).m(function(a){if(a&&a.data.fc){qz(d,"Social data for "+c+" applied.");for(var b=this.c,g=!1,k=0;k<Wu(b);k++)g|=!!Xu(b,k).og(a);g&&TB(this,!0)}else qz(d,"Social data for "+c+" not available, dispatching crawlers now.")},function(a){qz(d,"Fail request due to "+(a.message?a.message:a))},a)}}h.vf=function(){return Nr};h.tf=function(){return[]};h.bd=function(){kC.f.bd.call(this,!0)};h.toString=function(){return"NewRecord"};function mC(a,b,c,d,e){Vw.call(this,a,b,c,d,e||new Gw("listbox"));this.Y=this.W();this.G=null;this.Hf="listbox"}A(mC,Vw);h=mC.prototype;h.fa=null;h.A=function(){mC.f.A.call(this);nC(this);oC(this)};h.u=function(){mC.f.u.call(this);this.fa&&(this.fa.S(),this.fa=null);this.Y=null};h.qd=function(a){pC(this,a.target);mC.f.qd.call(this,a);a.stopPropagation();this.dispatchEvent("action")};h.yi=function(){var a=qC(this);mC.f.Rb.call(this,a&&a.K());nC(this)};
h.rd=function(a){var b=mC.f.rd.call(this,a);a!=b&&(this.fa&&this.fa.clear(),a&&(this.fa?Vu(a,function(a){rC(a);var b=this.fa,e=b.a.length;a&&(YA(b,a,!1),pb(b.a,e,0,a))},this):sC(this,a)));return b};function pC(a,b){if(a.fa){var c=qC(a);ZA(a.fa,b);b!=c&&a.dispatchEvent("change")}}h.Rb=function(a){if(null!=a&&this.fa)for(var b=0,c;c=this.fa.a[b]||null;b++)if(c&&"function"==typeof c.K&&c.K()==a){pC(this,c);return}pC(this,null)};h.K=function(){var a=qC(this);return a?a.K():null};
function qC(a){return a.fa?a.fa.Xb:null}function sC(a,b){a.fa=new WA;b&&Vu(b,function(a){rC(a);var b=this.fa,e=b.a.length;a&&(YA(b,a,!1),pb(b.a,e,0,a))},a);oC(a)}function oC(a){a.fa&&Y(a).listen(a.fa,"select",a.yi)}function nC(a){var b=qC(a);dw(a,b?b.Ob():a.Y);var c=a.d.la(a.g());c&&a.b.cj(c)&&(null==a.G&&(a.G=sv(c,"label")),b=(b=b?b.g():null)?sv(b,"label"):a.G,rv(c,"label",b),tC(a))}
function tC(a){var b=a.d;if(b&&(b=b.la(a.g()))){var c=a.w;b.id||(b.id=Pu(Ou.B()));qv(b,"option");rv(c,"activedescendant",b.id);a.fa&&(c=a.fa.ic(),c=gb(c,function(a){return a instanceof Dw}),rv(b,"setsize",c),rv(b,"posinset",1+$A(a.fa)))}}function rC(a){a.Hf=a instanceof Dw?"option":"separator"}h.ea=function(a,b){mC.f.ea.call(this,a,b);Zv(this,64)?(this.c||this.rd(new Iw(this.b,this.Gc)),(this.c||null).Xa(this.fa?$A(this.fa):-1)):tC(this)};Kv("goog-select",function(){return new mC(null)});function uC(){}A(uC,Uw);da(uC);uC.prototype.o=function(){return"goog-toolbar-menu-button"};function vC(a,b,c,d){mC.call(this,a,b,c||uC.B(),d)}A(vC,mC);Kv("goog-toolbar-select",function(){return new vC(null)});function wC(){}A(wC,Qv);da(wC);h=wC.prototype;h.oc=function(){};h.Fa=function(a){var b=a.b,c=b.j("div","goog-inline-block "+Tv(this,a).join(" "));a=b.j("input",{type:"text",value:a.W()||"",disabled:!a.isEnabled()});var d=b.j("div",this.o()+"-inner-box"),e=b.j("div",this.o()+"-clear","\u00d7"),e=b.j("div",this.o()+"-outer-box",[d,e]);b.appendChild(c,e);b.appendChild(d,a);return c};
h.la=function(a){if(a)a:{a=a.getElementsByTagName("input");for(var b=0;b<a.length;++b){var c=a[b];if(!c.type||"TEXT"==c.type.toUpperCase()){a=c;break a}}a=null}else a=null;return a};h.bh=function(a){return this.la(a.g())};h.Ff=ca;h.Df=function(a){return a.isEnabled()};h.Sc=ca;h.od=function(a,b,c){wC.f.od.call(this,a,b,c);1==b&&(a=this.la(a.g()))&&(a.disabled=c)};h.nb=ca;h.Sb=function(a,b){var c=this.la(a);c&&(c.value=b)};h.W=function(a){return(a=this.la(a))?a.value:null};h.o=function(){return"wgui-textinput"};function xC(a,b,c,d){aw.call(this,a,b||wC.B(),c);this.c=!d;bw(this,!1);this.Ye=!0;(b=this.g())&&this.d.Ef(b,!0);this.$b&=-256;this.ra(32,!1);a||this.xd("")}A(xC,aw);h=xC.prototype;h.A=function(){xC.f.A.call(this);var a=$v(this);if(a){var b=this.l||(this.l=new ev);xv(b,a);Y(this).listen(b,fv,this.Ia)}a=this.c;b=Oh(this.d.o()+"-clear",this.g());this.c=!!a;b&&(this.c?(Y(this).listen(b,"click",this.dh),R(b,!0)):(Y(this).X(b,"click",this.dh),R(b,!1)))};
h.dh=function(a){a.preventDefault();dw(this,"");this.dispatchEvent(new E("action",this))};h.W=function(){return this.g()?this.d.W(this.g()):null};h.K=function(){return this.W()};h.Ob=function(){return this.W()||""};function yC(a,b){this.result=b;xy.call(this,a,new qs($(a),b.storeName,b.record));rs(this.M)||zC(this)}A(yC,xy);function zC(a){a.parent.send("query",[{store:a.result.storeName,index:"id",key:a.result.primaryKey}]).n(function(a){a=a[0].result;if(a[0]){var c=Rr(this.result.storeName);Ky(this,new qs($(this.parent),c,a[0]))}},a)}function AC(a,b){b&&(a.result=b,b.record?Ky(a,new qs($(a.parent),b.storeName,b.record)):b.storeName&&t(b.primaryKey)&&zC(a))}
yC.prototype.clear=function(){this.Ma()||(Ky(this,null),this.result=null)};yC.prototype.toString=function(){return"ydn.crm.sugarcrm.model.ResultRecord:"+this.M};yC.prototype.Ma=function(){return!rs(this.M)&&!this.result};function BC(a,b){X.call(this,b);this.a=a;this.d=new X(b);this.c=null;this.l=[];this.r=0}A(BC,X);h=BC.prototype;h.o=function(){return"search-panel"};
h.J=function(){BC.f.J.call(this);var a=this.b,b=this.g();b.classList.add(this.o());var c=a.j("div","header");b.appendChild(c);this.c=new rB(null,null,a);for(var d=new Iw(a),e=0;e<Nr.length;e++)d.R(new Dw(Nr[e]),!0);e=new vC("Module",d,null,a);this.c.R(e,!0);d=new xC("");this.c.R(d,!0);this.c.render(c);e.pd(!1);c=a.j("div","content");a=a.j("div","content-wrapper",[c]);b.appendChild(a);this.R(this.d,!0);b=d.g().querySelector("input");b.setAttribute("placeholder","Search ...");b.setAttribute("title",
"Search name, email, phone, id, title, description, etc.")};h.A=function(){BC.f.A.call(this);var a=Xu(this.c,1);Y(this).listen(a,"action",this.zi,!0)};function CC(a,b){if(b){for(var c=Wu(a.d),d=0;d<c;d++){var e=Xu(a.d,d).a;if(e.Ma()){AC(e,b);return}}30<c?(e=Xu(a.d,0).a,AC(e,b)):(c=new yC(a.a,b),c=new tB(c,a.b),a.d.R(c,!0))}}
function DC(a,b,c,d){Wy(a.a,b,c,d,!0).m(function(a){var b=a[0];b.result[0]&&(a=Rr(b.store),b=b.result[0],CC(this,{storeName:a,primaryKey:b.id,record:b,value:d,tokens:[{keyPath:c}]}));EC(this)},function(a){EC(this);throw a;},a)}
function FC(a,b){0==a.r&&(a.r=b);var c=100*(a.r-b)/a.r,d=Xu(a.c,1).g(),d=Ph(document,"input",null,d)[0].style,e=c+.1,f=["rgb(255, 255, 255) 0%"];99>c&&(f[1]="rgb(135, 224, 253) "+c.toFixed(1)+"%",f[2]="rgb(255, 255, 255) "+e.toFixed(1)+"%");f.push("rgb(255, 255, 255) 100%");d.background="linear-gradient(to right, "+f.join(", ")+")"}
function EC(a){var b=a.l[0];if(b){b.Bc++;FC(a,4*(a.l.length-1)+(4-b.Bc));var c=a.a;0==b.Bc?DC(a,b.module,"id",b.Wc):1==b.Bc?DC(a,b.module,"ydn$emails",b.Wc):2==b.Bc?(c=b.Wc.match(/\d/g),3>(c?c.length:0)?EC(a):DC(a,b.module,"ydn$phones",b.Wc)):3==b.Bc?Xy(c,b.module,b.Wc).m(function(a){a=a[0].fullTextResult;for(var b=a.length||0,c=0;c<b;c++)CC(this,a[c]);EC(this)},function(a){throw a;},a):(a.l.shift(),0<a.l.length&&EC(a))}}
h.zi=function(){for(var a=Xu(this.c,1).W(),b=Wu(this.d)-1;0<=b;b--)Xu(this.d,b).a.clear();this.r=0;if(a&&(a=a.trim(),2<=a.length)){b=(b=qC(Xu(this.c,0)))?b.Ob():null;this.l.length=0;if(b)this.l[0]={module:b,Wc:a,Bc:-1};else for(b=0;b<Nr.length;b++)this.l[b]={module:Nr[b],Wc:a,Bc:-1};EC(this)}};h.L=function(){return Oh("content",this.g())};function GC(a,b){X.call(this,b);this.a=a}A(GC,X);h=GC.prototype;h.o=function(){return"detail-panel"};h.J=function(){GC.f.J.call(this);var a=this.b,b=this.g();b.classList.add(this.o());b.appendChild(a.j("div","header"));b.appendChild(a.j("div","content"))};h.L=function(){return this.g().querySelector(".content")};h.A=function(){GC.f.A.call(this)};h.clear=function(){this.L().innerHTML="";this.g().querySelector(".header").innerHTML=""};
function HC(a,b){var c=a.a.Ge.s(),d=Cs(new Date),c=U.bound([c,d],[c,"\uffff"]);return{store:b,index:us(b),keyRange:c}}
function IC(a){a.g();a.a.send("activity-stream").m(function(a){var c=this.b,d=c.j("span");if(0<a.length)c=ts(a[a.length-1].date_modified),c=ZB(c.getTime())||c.toLocaleDateString(),d.textContent=a.length+" records updated since "+c;else{d.appendChild(pi(c,"No activity? Have you "));var e=c.j("a",{href:chrome.extension.getURL("setup.html")},"setup");d.appendChild(e);d.appendChild(pi(c,"?"))}c=this.g().querySelector(".header");c.innerHTML="";c.appendChild(d);for(d=0;d<a.length;d++){var c=a[d],e=this.b,
f=this.a,g=c._module,k=new qs($(f),g,c),l=e.j("div","icon small",c._module.substr(0,2)),m=e.j("span"),n=k.value("modified_user_id"),p=k.value("created_by");n?(n=e.j("a",{href:Jy(f,"Users",n),target:"_blank"},k.value("modified_user_name")),m.appendChild(n),m.appendChild(pi(e," "))):p&&(n=e.j("a",{href:Jy(f,"Users",p),target:"_blank"},k.value("created_by_name")),m.appendChild(n),m.appendChild(pi(e," ")));m.appendChild(pi(e,c.date_modified==c.date_entered?"created ":"updated "));f=e.j("a",{href:Jy(f,
k.module,k.s()),target:"_blank"},ws(k));m.appendChild(f);g=g.replace(/ies$/,"y").replace(/s$/,"");m.appendChild(pi(e," "+g+""));g=ts(c.date_modified);g=ZB(g.getTime())||"on "+g.toLocaleDateString();m.appendChild(pi(e," "+g+"."));e=e.j("div",null,[l,m]);e.className="detail-item record-header "+c._module;this.L().appendChild(e)}},function(a){throw a;},a)}
function JC(a,b){var c=HC(a,b);a.a.send("values",c).m(function(a){var c=this.b.j("span");c.textContent=a.length+" upcoming "+b;var f=this.g().querySelector(".header");f.innerHTML="";f.appendChild(c);for(c=0;c<a.length;c++){var f=a[c],g=b,k=this.b,l=this.a,m=$(l),n=new qs(m,g,f),p=k.j("span"),g="Calls"==g?"call":"Tasks"==g?"finish":"Meetings"==g?"meet":"Opportunities"==g?"close":"do",g=g.charAt(0).toUpperCase()+g.substr(1)+" ";p.appendChild(pi(k,g));l=k.j("a",{href:Jy(l,n.module,n.s()),target:m},ws(n));
p.appendChild(l);n=n.a?ts(n.a[vs(n.module)]):new Date("NaN");n=ZB(n.getTime())||"on "+n.toLocaleDateString();p.appendChild(pi(k," "+n+"."));k=k.j("div",null,[p]);k.className="detail-item record-header "+f._module;this.L().appendChild(k)}},function(a){throw a;},a)};function KC(a,b){X.call(this,b);this.a=a;this.c=new gC(cC,void 0,b);this.d=new GC(a,b);this.search=new BC(a,b);var c=new xy(a,new qs($(a),"Leads"));this.l=new kC(c,b)}A(KC,X);h=KC.prototype;h.o=function(){return"activity-panel"};h.L=function(){return this.g().querySelector(".content")};
h.J=function(){KC.f.J.call(this);var a=this.b,b=this.g();Gv(b,this.o());var c=a.j("div","content");b.appendChild(c);this.R(this.c,!0);b=a.j("div");c=ey("magnifying-glass");b.appendChild(c);b=new aC(b);b.sa("Search");this.c.R(b,!0);b.L().classList.add("activity-search");b=a.j("div");c=ey("plus");b.appendChild(c);b=new aC(b);b.sa("Create a new record");this.c.R(b,!0);b.L().classList.add("new");b=a.j("div");c=ey("rss");b.appendChild(c);b=new aC(b);b.sa("Activity feed");this.c.R(b,!0);b.L().classList.add("activity-feed");
for(b=0;b<Qr.length;b++){var c=Qr[b],d=ey(c),d=a.j("div","activity-tab-label",d),d=new aC(d);d.sa(c);this.c.R(d,!0);d.L().classList.add(c)}this.R(this.search,!0);this.R(this.l,!0);this.R(this.d,!0)};h.A=function(){KC.f.A.call(this);var a=this.a,b=Y(this);b.listen(a,$s,this.Lh);b.listen(this.c,"select",this.Zi);b.listen(this.c,"unselect",this.$i);R(this.g(),!1);R(this.l.g(),!1);R(this.d.g(),!1);a.isLogin()&&this.Lh()};h.$i=function(){this.d.clear()};
h.Zi=function(){var a;a=this.c;a=Zu(a,a.Ua);0==a?(R(this.search.g(),!0),R(this.l.g(),!1),R(this.d.g(),!1)):1==a?(R(this.search.g(),!1),R(this.l.g(),!0),R(this.d.g(),!1)):(R(this.search.g(),!1),R(this.l.g(),!1),R(this.d.g(),!0),2==a?IC(this.d):JC(this.d,Qr[a-3]))};h.Lh=function(){var a=this;setTimeout(function(){LC(a)},2E3);setTimeout(function(){MC(a)},3E3)};
function LC(a){a.a.send("activity-stream").m(function(a){if(0<a.length){var c=ts(a[a.length-1].date_modified);R(this.g(),!0);a=a.length;var d=Xu(this.c,2);d.L();0<a?(c=ZB(c.getTime())||c.toLocaleDateString(),d.sa(a+" records updated since "+c)):d.sa("")}},function(a){throw a;},a)}
function MC(a,b){var c=b||0,d=Qr[c];if(d){var e=HC(a.d,d);a.a.send("keys",e).m(function(a){MC(this,c+1);R(this.g(),!0);a=a.length;var b=Qr.indexOf(d),b=Xu(this.c,b+3);b.L().querySelector(".activity-tab-label");a?b.sa(a+" upcoming "+d):b.sa("No upcoming "+d)},function(a){throw a;},a)}};function NC(a,b){X.call(this,b);this.a=a}A(NC,X);h=NC.prototype;h.logger=L("ydn.crm.sugarcrm.ui.Header");h.o=function(){return"sugar-header"};h.L=function(){return this.g().querySelector(".sugar-header-content")};
h.J=function(){NC.f.J.call(this);var a=this.g(),b=this.a,c=this.b;Gv(a,this.o());var d=c.j("a");d.textContent=$(b);d.href=Uy(b);var e=ey("sugarcrm"),e=c.j("div","icon-box",e),d=c.j("div",{"class":"main-title",title:"SugarCRM"},[e,d]);a.appendChild(d);d=[];e=chrome.extension.getURL("option-page.html")+"#credentials";e=chrome.extension.getURL("host-permission.html")+"?"+$(b);e=c.j("a",{className:"maia-button blue",href:e,"data-window-height":"40","data-window-width":"200",target:"host-permission"},
"Grant host permission");e.setAttribute("title","Your permission is required to connect your server from this extension. Without permission request to server will be slow.");d.push(e);d=c.j("div",{"class":"host-permission"},d);a.appendChild(d);var e=c.j("input",{name:"username",type:"text"}),e=c.j("div",null,[e]),f=c.j("input",{name:"password",type:"password"}),f=c.j("div",null,[f]),g=c.j("div","message"),e=c.j("div","login-form",[e,f,g]),f=c.j("div","sugar-header-content");a.appendChild(e);a.appendChild(f);
R(d,!b.about.hostPermission);R(e,!b.isLogin());R(f,!!this.a.about.hostPermission);a=new KC(b,c);this.R(a,!0)};h.A=function(){NC.f.A.call(this);var a=this.g(),b=Y(this),c=this.g().querySelector(".host-permission"),a=a.querySelector(".login-form"),a=new ev(a);b.listen(a,fv,this.Ni);c=c.querySelector("a");b.listen(c,"click",AB,!0);b.listen(this.a,"hag",this.Ii);b.listen(this.a,$s,this.Qi)};h.Qi=function(){var a=this.g().querySelector(".login-form");R(a,!this.a.isLogin())};
h.Ii=function(){var a=this.g().querySelector(".host-permission"),b=!!this.a.about.hostPermission;R(a,!b);R(this.L(),b)};h.Ni=function(a){if(a.a==jv){var b=this.g().querySelector(".login-form"),c=this.a;a=b.querySelector("input[name=username]").value;var d=b.querySelector("input[name=password]").value,e=b.querySelector(".message");e.textContent="logging in...";Vy(c,a,d).m(function(){c.isLogin()?(e.textContent="",R(b,!1)):e.textContent="login failed"},function(a){e.textContent="Error: "+a},this)}};function OC(a,b){X.call(this,b);this.a=a}A(OC,X);h=OC.prototype;h.o=function(){return"sugar-panel"};h.L=function(){return this.g().querySelector(".sugar-panel-content")};h.J=function(){OC.f.J.call(this);var a=this.b,b=this.g();Gv(b,this.o());var c=a.j("div","sugar-panel-head"),a=a.j("div","sugar-panel-content");b.appendChild(c);b.appendChild(a)};h.A=function(){OC.f.A.call(this);Y(this).listen(this.a,["gdata-change"],this.Ej)};h.Ej=function(){var a=this.a,a=!(!a.c||!a.c.a);R(this.L(),a)};
h.logger=L("ydn.crm.sugarcrm.ui.SimpleSugarPanel");function PC(){F.call(this);this.b=this.a=null}A(PC,F);PC.prototype.u=function(){this.a&&(this.a.S(),this.b=this.a=null)};PC.prototype.g=function(){return this.b};PC.prototype.c=function(a){var b=this.g();this.getState()==QC?(a.preventDefault(),b.textContent="Error reported, thanks.",b.removeAttribute("href"),b.removeAttribute("title"),b.classList.remove("error")):this.dispatchEvent(a)};var QC="e";PC.prototype.getState=function(){var a=this.g();return a.classList.contains("error")?QC:a.href?"n":"v"};
function RC(a,b,c){a=a.g();a.classList.remove("error");c?a.href=c:a.removeAttribute("href");b?(a.textContent=b,R(a,!0)):R(a,!1);a.removeAttribute("title")}function SC(a,b){var c=a.g();c.classList.add("error");c.href="#error";c.textContent="error";b&&b instanceof Error&&(b=b.name+": "+b.message);c.setAttribute("title","Click to report error"+(b?" for "+b:""))};function TC(a,b){X.call(this);this.a=a;this.parent=b||null;this.c=new PC}A(TC,X);h=TC.prototype;h.logger=L("ydn.crm.ui.GmailCmd");h.o=function(){return"gmail-cmd-panel"};h.J=function(){TC.f.J.call(this);var a=this.g(),b=this.b;a.classList.add(this.o());var b=b.j("a",{"class":"archive"},"."),c=this.c;c.b=b;c.a=new Tf(c);c.a.listen(b,"click",c.c,!0);a.appendChild(b)};
function UC(a,b){var c=Jy(a.a,"Emails",b.id);RC(a.c,"View",c);c=a.c.g();c.setAttribute("target","gmail");c.setAttribute("title","View archived email in SugarCRM")}function VC(a){RC(a.c,"Archive","#archive");a.c.g().setAttribute("title","Archive this email message to SugarCRM")}
function WC(a){RC(a.c,".");setTimeout(function(){RC(a.c,"..");var b=XC(a.g());b.Yf?(RC(a.c,"..."),a.a.send("query",[{store:"Emails",index:"message_id",key:b.Yf}]).m(function(b){(b=b[0]&&b[0].result?b[0].result[0]:null)?UC(a,b):VC(a)},function(b){VC(a);throw b;})):1<b.Mf.length?VC(a):SC(a.c,"gmail message cannot be parsed")},100)}h.A=function(){TC.f.A.call(this);Y(this).listen(this.c,"click",this.Ai);WC(this)};
function XC(a){var b="",c="",d="",e="",f="",g=ni(a,"TR");if(b=g.children[0].querySelector("span[email]"))b=b.getAttribute("email");else return ie(Kp,"cannot sniff sender email"),null;if(a=g.children[1].querySelector("span[alt]"))a=a.getAttribute("alt"),a=new Date(a.replace(" at",""));else return ie(Kp,"cannot sniff date sent"),null;var k=g.nextElementSibling;if(!k||"TR"!=k.tagName)return ie(Kp,"to email address TR expect after title TR"),null;for(var l=k.querySelectorAll("span[email]"),k=0;k<l.length;k++)c&&
(c+=", "),c+=l[k].getAttribute("email");for(var g=ni(g,"TABLE"),m=g.parentElement.nextElementSibling,k=0;m&&10>k;k++)if(l=m.querySelector("div[style]")){d=l.parentElement.className.split(/\s/);k=d.map(function(a){return a.length});k=k.indexOf(Math.max.apply(Math,k));10<d[k].length&&(e=d[k].substring(1),"m"!=d[k].charAt(0)&&K(Kp,"not start with m? "+d[k]));d=l.innerHTML;break}else m=m.nextElementSibling;g=ni(g.parentElement,"TABLE");for(k=0;g&&10>k&&"presentation"!=g.getAttribute("role");k++)g=ni(g,
"TABLE");"presentation"==g.getAttribute("role")?(g=g.querySelector("h2"))?f=g.textContent:ie(Kp,"email subject cannot be sniff"):ie(Kp,"expect a presentation role TABLE");g=Cz(xz.B());return{li:b,uj:c,Sg:a,Mf:d,dj:g,Yf:e,subject:f}}
h.Ai=function(a){if(wa(a.target.href,"#archive")){a.preventDefault();RC(this.c,"archiving...");var b=a=void 0,c=this.parent?YC(this.parent):null;c&&(a=c.module,b=c.id);(c=XC(this.g()))?Yy(this.a,c,a,b).m(function(a){UC(this,a)},function(a){SC(this.c,a)},this):SC(this.c,"Cannot gather email message")}};function ZC(a){this.b=a;this.a=[];a=document.body;(new MutationObserver(this.c.bind(this))).observe(a,{childList:!1,attributes:!0,characterData:!1,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1,attributeFilter:["data-tooltip"]})}ZC.prototype.logger=L("ydn.crm.ui.GmailCmdInjector");
ZC.prototype.c=function(a){for(var b=a.length,c=0;c<b;c++){var d=a[c].target;if("Show details"==d.getAttribute("data-tooltip")){d=ni(d,"TABLE");if(!d)break;d=ni(d.parentElement,"TABLE");if(!d)break;d=d.querySelector('div[data-tooltip="Reply"]');if(!d)break;var e;a:{for(e=0;e<this.a.length;e++)if(!document.body.contains(this.a[e].g())){this.a[e].U&&this.a[e].ka();e=this.a[e];break a}e=new TC(this.b);this.a.push(e)}var f=document.createElement("span");f.setAttribute("data-sugarcrm",$(this.b));d.parentElement.insertBefore(f,
d);e.render(f)}}};function $C(a,b){X.call(this,b);this.a=a;for(var c=[],d=0;d<Pr.length;d++){var e=Pr[d];c[d]={label:e,name:e}}this.c=new dy({className:"menu"},[{name:"add",label:"Add to",children:c},null,{label:"Sync",name:"sync"}])}A($C,X);h=$C.prototype;h.logger=L("ydn.crm.ui.gmail.ContactPanel");
h.J=function(){$C.f.J.call(this);var a=this.g();a.classList.add("gmail-contact-panel");var b=this.b,c=ey("google","icons-small"),c=b.j("div","badge-icon google",c);c.setAttribute("title","Gmail contact");var d=b.j("a","title center");d.setAttribute("title","Open in Gmail contact");d.setAttribute("target","gmail");b=b.j("div","head flex-bar",[c,d]);this.c.render(b);a.appendChild(b)};
h.A=function(){$C.f.A.call(this);Y(this).listen(this.a,["context-change"],this.Ij);var a=this.g().getElementsByClassName("more-menu")[0];Y(this).listen(a,"click",this.Jj)};h.Ij=function(){this.refresh()};
h.refresh=function(){var a=this.a,b=a.b;if(b){var c=this.g().querySelector(".head").querySelector(".title"),d;d=b.getData();d=Db(d,"gd$name","gd$fullName","$t")||"";c.textContent=d;c.href="#contact/"+br(b);R(this.g(),!0);b=!!a.yb();iy(this.c,"add",!b);b?(iy(this.c,"sync",!0),ez(a)?jy(this.c,"Remove sync"):jy(this.c,"Sync")):(iy(this.c,"sync",!1),jy(this.c,"Sync"))}else R(this.g(),!1)};h.Jj=function(a){if(a=gy(a))"sync"==a?(a=this.a,a.yb()?ez(a)?aD(this):bD(this):aD(this)):cD(this,a)};
function bD(a){a=a.a;var b=pz("Linking gmail contact...");$y(a).m(function(){qz(b,"Linked ")},function(a){window.console.error(a.stack||a);qz(b,"Linked failed "+(a.message||"."),"e")})}function aD(a){a=a.a;var b=a.yb(),c=" all records.";if(b)var d=b.module,b=b.s(),c=d+" record "+b;var e=pz("Removing gmail contact link to "+c);az(a).m(function(){qz(e,"Removed link from "+c)},function(a){window.console.error(a.stack||a);qz(e,"Removing link failed "+(a.message||"."),"e")})}
function cD(a,b){var c=a.a,d=pz("Adding... to "+b),e;c.b?(e=bz(c,b),e=e.n(function(){qz(d,"Linking GData and SugarCRM...");return $y(c)},a)):e=hz(c,b);e.m(function(){qz(d,"Added.")},function(a){a=a instanceof Error?a.name+" "+a.message:x(a)?Dh(a):a;qz(d,a,"","e");throw Error(a);},a)};function dD(a,b){OC.call(this,a,b);new ZC(a)}A(dD,OC);dD.prototype.J=function(){dD.f.J.call(this);var a=this.b;this.g().querySelector(".sugar-panel-head");this.L();var b=this.a,c=new xy(b,new qs($(b),"Leads")),c=new kC(c,a);this.R(c,!0);c=new $C(b,a);this.R(c,!0);b=new xy(b,new qs($(b),"Leads"));a=new XB(b,a);this.R(a,!0)};dD.prototype.logger=L("ydn.crm.sugarcrm.ui.ContextSugarPanel");function YC(a){for(var b=0;b<Wu(a);b++){var c=Xu(a,b).a;if(rs(c.M))return{module:zy(c),id:c.s()}}return null};function eD(a){this.a=this.b=null;this.t=(this.c=!!a)?"&#x25BC;":"&#x25B2;";this.d=this.c?"&#x25B2;":"&#x25BC;";this.e=this.h.bind(this)}
eD.prototype.render=function(a){this.b=document.createElement("div");this.a=document.createElement("span");var b=document.createElement("div");this.b.className="status-base";b.className="status-panel";this.a.className="status-bar";var c=document.createElement("span"),d=document.createElement("a"),e=document.createElement("span"),f=document.createElement("span");f.className="status-detail-button";f.innerHTML=this.d;f.setAttribute("title","Show previous messages");this.a.appendChild(c);this.a.appendChild(d);
this.a.appendChild(e);c=document.createElement("div");c.className="status-message";c.appendChild(this.a);c.appendChild(f);this.b.appendChild(c);this.b.appendChild(b);a.appendChild(this.b);f.onclick=this.i.bind(this)};eD.prototype.i=function(){this.b.querySelector(".status-panel").classList.contains("open")?fD(this,!1):fD(this,!0)};
function fD(a,b){var c=a.b.querySelector(".status-detail-button");c.innerHTML=b?a.t:a.d;var d=a.b.querySelector(".status-panel");if(b){d.classList.add("open");c.classList.add("open");c.setAttribute("title","Hide message panel");c=a.b.querySelector(".status-panel");c.innerHTML="";for(var d=document.createDocumentFragment(),e=oz.a.length-1;0<=e;e--){var f=oz.a[e];if(!f)break;var g=document.createElement("div");if(f.title){var k=document.createElement("span");k.textContent=f.title;g.appendChild(k)}f.ud&&
(k=document.createElement("a"),k.textContent=f.Rf,k.href=f.ud,f.qe&&(k.setAttribute("title",f.qe),k.setAttribute("target","_blank")),g.appendChild(k));f.update&&(k=document.createElement("span"),k.textContent=f.update,g.appendChild(k));d.appendChild(g)}c.appendChild(d);a.c&&(c.style.marginTop=-18-c.clientHeight+"px");document.body.addEventListener("click",a.e,!0)}else d.classList.remove("open"),c.classList.remove("open"),c.setAttribute("title","Show previous messages"),d.innerHTML="",document.body.removeEventListener("click",
a.e,!0)}eD.prototype.h=function(a){var b=a.target,c=this.b.querySelector(".status-panel");b&&b instanceof Element&&b!=c&&!c.contains(b)&&(c.classList.contains("open")&&(a.preventDefault(),a.stopPropagation()),fD(this,!1))};function gD(a){X.call(this,a)}A(gD,X);h=gD.prototype;h.o=function(){return"sidebar"};
h.J=function(){gD.f.J.call(this);var a=this.g(),b=this.b;a.classList.add(this.o());var c=b.j("div","head"),d=b.j("div","content");a.appendChild(c);a.appendChild(d);a=b.j("div","no-sugar-panel");b=b.createElement("a");b.textContent="Setup SugarCRM";b.href=chrome.extension.getURL("setup.html")+"#modal";b.className="sugarcrm-link maia-button blue";b.setAttribute("data-window-height","600");b.setAttribute("data-window-width","800");a.appendChild(b);R(a,!1);c.appendChild(a)};h.L=function(){return this.g().querySelector(".content")};
function hD(a){return a.g().querySelector(".head")}h.A=function(){gD.f.A.call(this);var a=Y(this),b=hD(this).querySelector("a.sugarcrm-link");a.listen(b,"click",AB,!0)};h.Ec=function(){xz.B().isLogin()?R(this.L(),!0):R(this.L(),!1)};h.logger=L("ydn.crm.ui.SugarListPanel");
function iD(a,b){var c=Ce("sugarcrm",b).send("details");xz.B();return c.n(function(a){for(var c=0;c<a.modulesInfo.length;c++){var f=a.modulesInfo[c],g="",k="",l=void 0;for(l in f.module_fields){var m=f.module_fields[l];0<="created_by created_by_name date_entered date_modified deleted modified_user_id modified_by_name id".split(" ").indexOf(l)&&(m.calculated=!0);if(0<=["salutation","name","last_name","first_name","full_name"].indexOf(l))m.group="name";else if(/^email\d?$/.test(l))m.group="email";else if(/^phone?/.test(l))m.group=
"phone";else if(!m.group&&va(l,g)){m.group=k;continue}g=l;k=m.group}for(l in f.link_fields)g=f.link_fields[l],"contact"!=l||g.module||(g.module="Contacts")}a=new Zy(a.about,a.modulesInfo,0,a.serverInfo);jD(this,b)||this.Xe(a)},a)}h.Xe=function(a){a=new OC(a,this.b);this.R(a,!0)};function jD(a,b){for(var c=0;c<Wu(a);c++){var d=Xu(a,c);if(d instanceof OC&&$(d.a)==b)return!0}return!1}
function kD(a,b){var c=hD(a).querySelector(".no-sugar-panel");c.querySelector("a");if(xz.B().isLogin()){0==b.length?R(c,!0):R(c,!1);for(var c=[],d=Wu(a)-1;0<d;d--){var e=Xu(a,d);e instanceof OC&&!(0<=b.indexOf($(e.a)))&&(je(a.logger,"disposing sugar panel "+$(e.a)),e.a.S(),a.removeChild(e,!0),e.S())}for(d=0;d<b.length;d++)jD(a,b[d])||(je(a.logger,"adding sugar panel "+b[d]),c.push(iD(a,b[d])));zn(c)}else R(c,!1),sc(!1)};function lD(a,b){X.call(this,b);this.d=null;this.l=a;this.c=new ph(this.vj,500,this)}A(lD,gD);h=lD.prototype;h.logger=L("ydn.crm.gmail.ContextSidebar");
h.J=function(){lD.f.J.call(this);var a=this.b,b=this.g();b.classList.add("context-sidebar");var c=b.querySelector(".head"),d=a.j("div","sidebar-status"),e=new eD(!0);e.render(d);oz.b.push(e);b.appendChild(d);b=a.j("div","toolbar flex-bar");d=a.j("input","target-email");d.setAttribute("list","all-emails");b.appendChild(d);d=ey("search");a=a.j("span","search svg-button");a.appendChild(d);b.appendChild(a);c.appendChild(b);document.getElementById("all-emails")||(c=document.createElement("datalist"),c.id=
"all-emails",document.body.appendChild(c))};h.A=function(){lD.f.A.call(this);var a=Y(this),b=this.g().querySelector(".toolbar"),c=b.querySelector("input"),b=b.querySelector(".search");a.listen(c,"change",this.vh);a.listen(b,"click",this.vh)};h.vh=function(){var a=this.g().querySelector("input.target-email").value,b=0<a.indexOf("@")?a:void 0,a=b?void 0:a,c=Cz(xz.B()),b=new Qx(c,b,a);b.kind="s";mD(this,b)};
h.vj=function(){for(var a=document.querySelectorAll("span[email]"),b=[],c=a.length-1;0<=c;c--){var d=a[c].getAttribute("email");-1==b.indexOf(d)&&-1==d.indexOf("daemon@")&&-1==d.indexOf("noreply@")&&b.push(d)}a=document.getElementById("all-emails");a.innerHTML="";for(c=0;c<b.length;c++)d=document.createElement("option"),d.value=b[c],a.appendChild(d)};h.u=function(){this.c.S();this.c=null;lD.f.u.call(this)};
h.Xe=function(a){var b=new dD(a,this.b);this.R(b,!0);!this.d&&a.isLogin()&&(K(this.logger,"compose template initialized."),a=this.d=new iz(a),b=this.l,a.b&&a.P.listen(a.b,"nc",a.e),b&&(a.b=b,a.P.listen(b,"nc",a.e)))};function mD(a,b){for(var c=Wu(a),d=0;d<c;d++){var e=Xu(a,d);e instanceof dD&&(e.a.update(b),qh(a.c))}}h.Ec=function(){lD.f.Ec.call(this)};function nD(){F.call(this);this.P=new Tf(this);this.b=new Xf(400);ed(this.b,Zf,this.h,!0,this);this.a=0;this.c="";var a=this.history=new oD,b=We(new Ge(document.location.href))+"/";a.rj=b;ed(this.history,pD,this.e,!1,this);this.d=null}A(nD,F);nD.prototype.logger=L("ydn.crm.gmail.GmailObserver");
nD.prototype.e=function(a){a.c!=this.d&&(this.d=a.c,this.c=location.href,a=a.c||location.hash,"#"==a.charAt(0)&&(a=a.substr(1)),a=/^contact(\/\[w\W]+)?\/[a-f\d]{2,18}$/.test(a)?"cd":/^contacts(\/\[w\W]+)?/.test(a)?"ct":/compose=new$/.test(a)?"cp":/^(label\/)?[\w\+]+$/.test(a)?"in":/^(label\/)?[\w\+]+\/[a-f\d]{10,18}$/.test(a)?"em":"un","em"==a&&Yf(this.b),this.dispatchEvent(new qD(a,this)))};
function rD(a,b){if(!a)return null;var c=a.querySelector("img[jid]");if(!c){if(b&&(c=a.querySelector("span[title]"))){var d=c.getAttribute("title").trim();if(0<d.length){var e=document.querySelector('span[name="'+d+'"][email]');if(e)return c=Cz(xz.B()),e=e.getAttribute("email"),new Qx(c,e,d)}}return null}for(d=c.getAttribute("jid");c&&"TD"!=c.tagName;)c=c.parentElement;e=c.nextElementSibling.querySelector("span[title]").getAttribute("title");c=Cz(xz.B());return new Qx(c,d,e)}
nD.prototype.setEnabled=function(a){this.history.setEnabled(a)};nD.prototype.h=function(){this.a++;this.c!=location.href&&(M(this.logger,"url already changed"),this.b.stop());40<this.a&&(M(this.logger,"sniff give up after "+this.a),this.b.stop());var a;if(a=(a=document.querySelector('table[role="presentation"]'))?a.querySelector("tr").children[2].querySelector("table"):null){var b=rD(a,5<this.a);b&&(this.b.stop(),this.a=0);this.dispatchEvent(new sD(a,b,this))}};var mv="pc";
function qD(a,b){E.call(this,mv,b);this.c=a}A(qD,E);function sD(a,b,c){E.call(this,"cc",c);this.e=a;this.c=b}A(sD,E);function tD(){this.b=this.c=null;this.P=new Tf(this);this.a=null}h=tD.prototype;h.logger=L("ydn.crm.gmail.Tracker");function uD(a,b){a.c&&a.P.listen(a.c,"nc",a.Oh);b&&(a.c=b,a.P.listen(b,"nc",a.Oh))}function vD(a){if(!a.b){var b=xz.B();if(!b.e){var c=new nh;c.update(b.a.Id.$t);b.e=Tg(c.d())}a.b="https://imgsrv-dot-yathit-app.appspot.com/t/"+b.e+"/"+z()+".gif"}return a.b}
function wD(a,b){var c=dv(b),d=c.querySelector("img.tk-ln");d||(d=document.createElement("img"),d.src=vD(a),d.className="tk-ln",c.insertBefore(d,c.firstChild),c=cv(b),c={path:We(new Ge(vD(a))),recipients:c,subject:av(b).querySelector('input[name="subjectbox"]').value},ze().c().send("request",{path:"track",method:"PUT",body:JSON.stringify(c)}).m(function(a){re(this.logger,"sent track: "+a.status)},function(a){window.console.log(a.stack||a)},a))}h.wh=function(a){this.a=Zv(a.target,16)};
function xD(a){for(var b=0;b<Wu(a);b++){var c=Xu(a,b);if(c instanceof pB)return c}return null}h.oh=function(a){a=a.target;this.P.X(a,"es",this.ph);this.P.X(a,"cc",this.oh);this.P.X(xD(a),"action",this.wh)};h.ph=function(a){a=a.target;var b;(b=xD(a))?b=Zv(b,16):(window.console.warn("Tracking button not found"),b=!1);b&&wD(this,a)};
h.Oh=function(a){a=a.c;var b=ey("visibility"),b=new pB(b);b.sa("Track this email");var c;ga(this.a)?c=this.a:(c=xz.B(),c=Db(c.h||zz,["tracking","user-default"]),c="always"==c?!0:"do-not-track"==c?!1:"disable"==c?!1:qp()==rp?!0:!1);hw(b,c);a.R(b,!0);b.g().classList.add("tracking-button");this.P.listen(a,"es",this.ph);this.P.listen(a,"cc",this.oh);this.P.listen(b,"action",this.wh)};var pD="navigate";function yD(a){E.call(this,pD);this.c=a}A(yD,E);function oD(a){F.call(this);this.a=a||window;ed(this.a,"popstate",this.we,!1,this);ed(this.a,"hashchange",this.we,!1,this)}A(oD,F);h=oD.prototype;h.yf=!1;h.rj="/";h.setEnabled=function(a){a!=this.yf&&(this.yf=a)&&this.dispatchEvent(new yD(this.getToken()))};h.getToken=function(){var a=this.a.location.href,b=a.indexOf("#");return 0>b?"":a.substring(b+1)};h.setToken=function(a,b){a!=this.getToken()&&(this.a.history.pushState(null,b||this.a.document.title||"","#"+a),this.dispatchEvent(new yD(a)))};
h.u=function(){nd(this.a,"popstate",this.we,!1,this);nd(this.a,"hashchange",this.we,!1,this)};h.we=function(){this.yf&&this.dispatchEvent(new yD(this.getToken()))};function zD(a,b){OC.call(this,a,b)}A(zD,OC);zD.prototype.J=function(){zD.f.J.call(this);var a=this.b,b=this.g().querySelector(".sugar-panel-head"),c=this.L();R(c,!1);(new NC(this.a,a)).render(b)};zD.prototype.logger=L("ydn.crm.sugarcrm.ui.SugarPanel");function AD(a){X.call(this,a)}A(AD,gD);h=AD.prototype;h.logger=L("ydn.crm.ui.SidebarPanel");
h.J=function(){AD.f.J.call(this);var a=this.b,b=this.g(),c=b.querySelector(".head"),d=a.j("div","setup-panel"),e=a.createElement("a");e.textContent="Setup";e.href=chrome.extension.getURL("setup.html")+"#modal";e.className="maia-button blue";e.setAttribute("data-window-height","600");e.setAttribute("data-window-width","800");d.appendChild(e);R(d,!1);e=a.j("div","invalid-login-panel");c.appendChild(d);c.appendChild(e);a=a.j("div","sidebar-status");c=new eD;c.render(a);oz.b.push(c);b.insertBefore(a,
b.firstElementChild)};h.A=function(){AD.f.A.call(this);var a=Y(this),b=hD(this).querySelector("div.setup-panel a");a.listen(b,"click",AB,!0)};h.Xe=function(a){a=new zD(a,this.b);this.R(a,!0)};h.Ec=function(){AD.f.Ec.call(this);var a=xz.B(),b=hD(this).querySelector(".setup-panel");a.isLogin()?(R(b,!1),b=hD(this).querySelector(".invalid-login-panel"),yz(a)?R(b,!1):(b.innerHTML=Au(Mu({Nj:Cz(a)})),R(b,!0))):R(b,!0)};function BD(){var a=zB("hub-template").content,b=document.createElement("div");b.appendChild(a.cloneNode(!0));this.a=b.firstElementChild;this.a.querySelector("a[name=option-page-url]").href=chrome.extension.getURL("option-page.html");this.b=new AD;a=Hz("gc")||Hz("su");R(this.a,a)}
BD.prototype.c=function(){this.a.classList.toggle("open");var a=this.a.querySelector(".hud-button").children[1];this.a.classList.contains("open")?(a.classList.remove("arrow-drop-left"),a.classList.add("arrow-drop-right")):(a.classList.add("arrow-drop-left"),a.classList.remove("arrow-drop-right"))};
BD.prototype.render=function(){document.body.appendChild(this.a);var a=this.a.querySelector(".hud-popup"),b=this.a.querySelector(".hud-button");ed(b,"click",this.c,!1,this);a=a.querySelector(".popup-content");this.b.render(a);this.a.querySelector(".logo-box").appendChild(ey("ydn-logo"));this.a.querySelector(".arrow-box").appendChild(ey("arrow-drop-right"))};function CD(a){var b=xz.B();b.isLogin()&&!yz(b)?a.a.classList.add("invalid"):a.a.classList.remove("invalid");a.b.Ec()};function DD(a,b){var c;if(!(c=b)){c=document.createElement("div");c.id="root-panel";c.className="inj ydn-crm";document.body.appendChild(c);R(c,!1);var d=document.createElement("div");d.className="container";c.appendChild(d);for(var e=0;3>e;e++){var f=document.createElement("div");d.appendChild(f)}d=document.createElement("div");e=document.createElement("a");e.textContent="Setup";e.href=chrome.extension.getURL("setup.html");e.className="setup-link";d.appendChild(e);c.firstElementChild.appendChild(d);
R(d,!1)}this.a=c;R(this.a,!1);ed(a,"cc",this.Aj,!1,this);ed(a,mv,this.Bj,!1,this)}h=DD.prototype;h.logger=L("ydn.crm.inj.AppRenderer");h.g=function(){return this.a};h.af=function(){};h.Bj=function(){this.af(null)};h.Aj=function(a){this.af(a.e)};function ED(a,b){DD.call(this,a,b);this.b=!1}A(ED,DD);
ED.prototype.af=function(a){if(!a)this.b=!1,R(this.a,!1);else if(!this.b){for(var b,c=a,d=0;4>d;d++)if(c&&c.parentElement&&(c=c.parentElement,c.nextElementSibling&&"DIV"==c.nextElementSibling.tagName)){var c=c.parentElement,d=c.lastElementChild,e=!!d.querySelector("a[href]");b=document.createElement("div");e&&c.parentElement.contains(d)?c.parentElement.insertBefore(b,d):c.appendChild(b);break}b||(ie(this.logger,"usual root position is not available, locating on second best position"),c=a.ownerDocument,
b=c.createElement("td"),b.setAttribute("colspan","2"),c=c.createElement("tr"),c.className="widget-topraw",c.appendChild(b),(a.querySelector("tbody")||a).appendChild(c));a=this.a;a.parentElement&&a.parentElement.removeChild(a);b.appendChild(a);this.b=!0;R(a,!0)}};function FD(a,b){this.a=new lD(b);var c=new ED(a);this.a.render(c.a.firstElementChild.children[1]);this.b=new BD;this.P=new Tf(this);this.P.listen(a,"cc",this.c);this.P.listen(a,mv,this.d)}FD.prototype.c=function(a){mD(this.a,a.c)};FD.prototype.init=function(){this.b.render()};FD.prototype.d=function(a){"em"==a.c&&mD(this.a,null)};function GD(a,b){yz(b)?(a.a.Ec(),CD(a.b),HD(a)):(a.a.Ec(),CD(a.b),kD(a.a,[]),kD(a.b.b,[]))}
function HD(a){Ce().send("list-sugarcrm-domain").n(function(a){kD(this.a,a);kD(this.b.b,a)},a)};function ID(){var a=chrome.extension.getURL("inj-template.html");v(a)?xB=a:wB=a;Ae("gmail");pz("Starting 1.3.3...");this.b=new nD;this.c=new lv(this.b);this.a=this.d=null}ID.prototype.logger=L("ydn.crm.inj.App");ID.prototype.e=function(a){var b=xz.B();"list-sugarcrm-domains"==a.type?this.a&&HD(this.a):"login"==a.type?yz(b)||(Bz(b),this.a&&GD(this.a,b)):"logout"==a.type&&Cz(b)&&(Bz(b),JD(this))};
function JD(a){var b=xz.B();b.$a().m(function(){O(this.logger,"initiating UI");yz(b)?this.b.setEnabled(!0):(M(this.logger,"user not login"),this.b.setEnabled(!1));this.a&&GD(this.a,b)},function(a){window.console.error(a)},a)}ID.prototype.init=function(){Q(this.logger,"init "+this);Hz("su")&&(this.a=new FD(this.b,this.c),this.a.init());Hz("tk")&&(this.d=new tD,uD(this.d,this.c));ed(ze(),["list-sugarcrm-domains","logout","login"],this.e,!1,this);setTimeout(function(){},6E4*(.5+Math.random()));JD(this)};
ID.prototype.toString=function(){return"inj.Main:1.3.3"};qa("runInjApp",function(){Vp();var a=new ID;window.setTimeout(function(){a.init()},500);return a});qa("ydn.debug.log",Jj);qa("ydn.crm.version","1.3.3");qa("runEventApp",ru);mu.prototype.xp=mu.prototype.Q;qa("ydn.msg.Pipe",we);qa("ydn.msg.initPipe",Ae);qa("ydn.msg.getChannel",Ce);we.prototype.listen=we.prototype.listen;we.prototype.getChannel=we.prototype.c;td.prototype.send=td.prototype.send;qa("goog.async.Deferred",B);B.prototype.addCallback=B.prototype.n;B.prototype.addErrback=B.prototype.Hc;B.prototype.addBoth=B.prototype.V;B.prototype.addCallbacks=B.prototype.m;})();

            //# sourceMappingURL=https://ydn-src-1.storage.googleapis.com/jsc/ydn.crm-1.3.3.js.map
        